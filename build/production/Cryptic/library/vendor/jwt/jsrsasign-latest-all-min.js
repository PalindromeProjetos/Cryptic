if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={}}YAHOO.namespace=function(){var d=arguments,i=null,k,l,j;for(k=0;k<d.length;k=k+1){j=(""+d[k]).split(".");i=YAHOO;for(l=(j[0]=="YAHOO")?1:0;l<j.length;l=l+1){i[j[l]]=i[j[l]]||{};i=i[j[l]]}}return i};YAHOO.log=function(e,i,f){var g=YAHOO.widget.Logger;if(g&&g.log){return g.log(e,i,f)}else{return false}};YAHOO.register=function(l,q,r){var m=YAHOO.env.modules,i,n,o,p,b;if(!m[l]){m[l]={versions:[],builds:[]}}i=m[l];n=r.version;o=r.build;p=YAHOO.env.listeners;i.name=l;i.version=n;i.build=o;i.versions.push(n);i.builds.push(o);i.mainClass=q;for(b=0;b<p.length;b=b+1){p[b](i)}if(q){q.VERSION=n;q.BUILD=o}else{YAHOO.log("mainClass is undefined for module "+l,"warn")}};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=function(b){return YAHOO.env.modules[b]||null};YAHOO.env.parseUA=function(i){var o=function(c){var b=0;return parseFloat(c.replace(/\./g,function(){return(b++==1)?"":"."}))},m=navigator,k={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:m&&m.cajaVersion,secure:false,os:null},p=i||(navigator&&navigator.userAgent),l=window&&window.location,n=l&&l.href,j;k.secure=n&&(n.toLowerCase().indexOf("https")===0);if(p){if((/windows|win32/i).test(p)){k.os="windows"}else{if((/macintosh/i).test(p)){k.os="macintosh"}else{if((/rhino/i).test(p)){k.os="rhino"}}}if((/KHTML/).test(p)){k.webkit=1}j=p.match(/AppleWebKit\/([^\s]*)/);if(j&&j[1]){k.webkit=o(j[1]);if(/ Mobile\//.test(p)){k.mobile="Apple";j=p.match(/OS ([^\s]*)/);if(j&&j[1]){j=o(j[1].replace("_","."))}k.ios=j;k.ipad=k.ipod=k.iphone=0;j=p.match(/iPad|iPod|iPhone/);if(j&&j[0]){k[j[0].toLowerCase()]=k.ios}}else{j=p.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/);if(j){k.mobile=j[0]}if(/webOS/.test(p)){k.mobile="WebOS";j=p.match(/webOS\/([^\s]*);/);if(j&&j[1]){k.webos=o(j[1])}}if(/ Android/.test(p)){k.mobile="Android";j=p.match(/Android ([^\s]*);/);if(j&&j[1]){k.android=o(j[1])}}}j=p.match(/Chrome\/([^\s]*)/);if(j&&j[1]){k.chrome=o(j[1])}else{j=p.match(/AdobeAIR\/([^\s]*)/);if(j){k.air=j[0]}}}if(!k.webkit){j=p.match(/Opera[\s\/]([^\s]*)/);if(j&&j[1]){k.opera=o(j[1]);j=p.match(/Version\/([^\s]*)/);if(j&&j[1]){k.opera=o(j[1])}j=p.match(/Opera Mini[^;]*/);if(j){k.mobile=j[0]}}else{j=p.match(/MSIE\s([^;]*)/);if(j&&j[1]){k.ie=o(j[1])}else{j=p.match(/Gecko\/([^\s]*)/);if(j){k.gecko=1;j=p.match(/rv:([^\s\)]*)/);if(j&&j[1]){k.gecko=o(j[1])}}}}}}return k};YAHOO.env.ua=YAHOO.env.parseUA();(function(){YAHOO.namespace("util","widget","example");if("undefined"!==typeof YAHOO_config){var g=YAHOO_config.listener,i=YAHOO.env.listeners,e=true,f;if(g){for(f=0;f<i.length;f++){if(i[f]==g){e=false;break}}if(e){i.push(g)}}}})();YAHOO.lang=YAHOO.lang||{};(function(){var p=YAHOO.lang,l=Object.prototype,j="[object Array]",n="[object Function]",m="[object Object]",k=[],o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},r=["toString","valueOf"],q={isArray:function(b){return l.toString.apply(b)===j},isBoolean:function(b){return typeof b==="boolean"},isFunction:function(b){return(typeof b==="function")||l.toString.apply(b)===n},isNull:function(b){return b===null},isNumber:function(b){return typeof b==="number"&&isFinite(b)},isObject:function(b){return(b&&(typeof b==="object"||p.isFunction(b)))||false},isString:function(b){return typeof b==="string"},isUndefined:function(b){return typeof b==="undefined"},_IEEnumFix:(YAHOO.env.ua.ie)?function(c,d){var e,f,b;for(e=0;e<r.length;e=e+1){f=r[e];b=d[f];if(p.isFunction(b)&&b!=l[f]){c[f]=b}}}:function(){},escapeHTML:function(b){return b.replace(/[&<>"'\/`]/g,function(c){return o[c]})},extend:function(b,f,c){if(!f||!b){throw new Error("extend failed, please check that all dependencies are included.")}var d=function(){},e;d.prototype=f.prototype;b.prototype=new d();b.prototype.constructor=b;b.superclass=f.prototype;if(f.prototype.constructor==l.constructor){f.prototype.constructor=f}if(c){for(e in c){if(p.hasOwnProperty(c,e)){b.prototype[e]=c[e]}}p._IEEnumFix(b.prototype,c)}},augmentObject:function(g,b){if(!b||!g){throw new Error("Absorb failed, verify dependencies.")}var e=arguments,c,f,d=e[2];if(d&&d!==true){for(c=2;c<e.length;c=c+1){g[e[c]]=b[e[c]]}}else{for(f in b){if(d||!(f in g)){g[f]=b[f]}}p._IEEnumFix(g,b)}return g},augmentProto:function(d,e){if(!e||!d){throw new Error("Augment failed, verify dependencies.")}var c=[d.prototype,e.prototype],b;for(b=2;b<arguments.length;b=b+1){c.push(arguments[b])}p.augmentObject.apply(this,c);return d},dump:function(f,u){var d,b,i=[],g="{...}",e="f(){...}",s=", ",c=" => ";if(!p.isObject(f)){return f+""}else{if(f instanceof Date||("nodeType" in f&&"tagName" in f)){return f}else{if(p.isFunction(f)){return e}}}u=(p.isNumber(u))?u:3;if(p.isArray(f)){i.push("[");for(d=0,b=f.length;d<b;d=d+1){if(p.isObject(f[d])){i.push((u>0)?p.dump(f[d],u-1):g)}else{i.push(f[d])}i.push(s)}if(i.length>1){i.pop()}i.push("]")}else{i.push("{");for(d in f){if(p.hasOwnProperty(f,d)){i.push(d+c);if(p.isObject(f[d])){i.push((u>0)?p.dump(f[d],u-1):g)}else{i.push(f[d])}i.push(s)}}if(i.length>1){i.pop()}i.push("}")}return i.join("")},substitute:function(d,b,i,P){var H,f,J,e,s,u,g=[],M,I=d.length,L="dump",c=" ",K="{",O="}",N,v;for(;;){H=d.lastIndexOf(K,I);if(H<0){break}f=d.indexOf(O,H);if(H+1>f){break}M=d.substring(H+1,f);e=M;u=null;J=e.indexOf(c);if(J>-1){u=e.substring(J+1);e=e.substring(0,J)}s=b[e];if(i){s=i(e,s,u)}if(p.isObject(s)){if(p.isArray(s)){s=p.dump(s,parseInt(u,10))}else{u=u||"";N=u.indexOf(L);if(N>-1){u=u.substring(4)}v=s.toString();if(v===m||N>-1){s=p.dump(s,parseInt(u,10))}else{s=v}}}else{if(!p.isString(s)&&!p.isNumber(s)){s="~-"+g.length+"-~";g[g.length]=M}}d=d.substring(0,H)+s+d.substring(f+1);if(P===false){I=H-1}}for(H=g.length-1;H>=0;H=H-1){d=d.replace(new RegExp("~-"+H+"-~"),"{"+g[H]+"}","g")}return d},trim:function(c){try{return c.replace(/^\s+|\s+$/g,"")}catch(b){return c}},merge:function(){var c={},e=arguments,b=e.length,d;for(d=0;d<b;d=d+1){p.augmentObject(c,e[d],true)}return c},later:function(f,c,e,u,s){f=f||0;c=c||{};var b=e,g=u,i,d;if(p.isString(e)){b=c[e]}if(!b){throw new TypeError("method undefined")}if(!p.isUndefined(u)&&!p.isArray(g)){g=[u]}i=function(){b.apply(c,g||k)};d=(s)?setInterval(i,f):setTimeout(i,f);return{interval:s,cancel:function(){if(this.interval){clearInterval(d)}else{clearTimeout(d)}}}},isValue:function(b){return(p.isObject(b)||p.isString(b)||p.isNumber(b)||p.isBoolean(b))}};p.hasOwnProperty=(l.hasOwnProperty)?function(c,b){return c&&c.hasOwnProperty&&c.hasOwnProperty(b)}:function(c,b){return !p.isUndefined(c[b])&&c.constructor.prototype[b]!==c[b]};q.augmentObject(p,q,true);YAHOO.util.Lang=p;p.augment=p.augmentProto;YAHOO.augment=p.augmentProto;YAHOO.extend=p.extend})();YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});var CryptoJS=CryptoJS||(function(n,x){var u={};var s=u.lib={};var y=s.Base=(function(){function b(){}return{extend:function(c){b.prototype=this;var d=new b();if(c){d.mixIn(c)}if(!d.hasOwnProperty("init")){d.init=function(){d.$super.init.apply(this,arguments)}}d.init.prototype=d;d.$super=this;return d},create:function(){var c=this.extend();c.init.apply(c,arguments);return c},init:function(){},mixIn:function(c){for(var d in c){if(c.hasOwnProperty(d)){this[d]=c[d]}}if(c.hasOwnProperty("toString")){this.toString=c.toString}},clone:function(){return this.init.prototype.extend(this)}}}());var r=s.WordArray=y.extend({init:function(b,c){b=this.words=b||[];if(c!=x){this.sigBytes=c}else{this.sigBytes=b.length*4}},toString:function(b){return(b||v).stringify(this)},concat:function(g){var c=this.words;var d=g.words;var f=this.sigBytes;var i=g.sigBytes;this.clamp();if(f%4){for(var b=0;b<i;b++){var e=(d[b>>>2]>>>(24-(b%4)*8))&255;c[(f+b)>>>2]|=e<<(24-((f+b)%4)*8)}}else{for(var b=0;b<i;b+=4){c[(f+b)>>>2]=d[b>>>2]}}this.sigBytes+=i;return this},clamp:function(){var b=this.words;var c=this.sigBytes;b[c>>>2]&=4294967295<<(32-(c%4)*8);b.length=n.ceil(c/4)},clone:function(){var b=y.clone.call(this);b.words=this.words.slice(0);return b},random:function(b){var c=[];for(var d=0;d<b;d+=4){c.push((n.random()*4294967296)|0)}return new r.init(c,b)}});var B=u.enc={};var v=B.Hex={stringify:function(e){var c=e.words;var f=e.sigBytes;var d=[];for(var g=0;g<f;g++){var b=(c[g>>>2]>>>(24-(g%4)*8))&255;d.push((b>>>4).toString(16));d.push((b&15).toString(16))}return d.join("")},parse:function(e){var c=e.length;var d=[];for(var b=0;b<c;b+=2){d[b>>>3]|=parseInt(e.substr(b,2),16)<<(24-(b%8)*4)}return new r.init(d,c/2)}};var p=B.Latin1={stringify:function(d){var c=d.words;var e=d.sigBytes;var g=[];for(var f=0;f<e;f++){var b=(c[f>>>2]>>>(24-(f%4)*8))&255;g.push(String.fromCharCode(b))}return g.join("")},parse:function(e){var c=e.length;var d=[];for(var b=0;b<c;b++){d[b>>>2]|=(e.charCodeAt(b)&255)<<(24-(b%4)*8)}return new r.init(d,c)}};var o=B.Utf8={stringify:function(c){try{return decodeURIComponent(escape(p.stringify(c)))}catch(b){throw new Error("Malformed UTF-8 data")}},parse:function(b){return p.parse(unescape(encodeURIComponent(b)))}};var q=s.BufferedBlockAlgorithm=y.extend({reset:function(){this._data=new r.init();this._nDataBytes=0},_append:function(b){if(typeof b=="string"){b=o.parse(b)}this._data.concat(b);this._nDataBytes+=b.sigBytes},_process:function(d){var k=this._data;var c=k.words;var b=k.sigBytes;var g=this.blockSize;var e=g*4;var f=b/e;if(d){f=n.ceil(f)}else{f=n.max((f|0)-this._minBufferSize,0)}var i=f*g;var j=n.min(i*4,b);if(i){for(var l=0;l<i;l+=g){this._doProcessBlock(c,l)}var m=c.splice(0,i);k.sigBytes-=j}return new r.init(m,j)},clone:function(){var b=y.clone.call(this);b._data=this._data.clone();return b},_minBufferSize:0});var A=s.Hasher=q.extend({cfg:y.extend(),init:function(b){this.cfg=this.cfg.extend(b);this.reset()},reset:function(){q.reset.call(this);this._doReset()},update:function(b){this._append(b);this._process();return this},finalize:function(c){if(c){this._append(c)}var b=this._doFinalize();return b},blockSize:512/32,_createHelper:function(b){return function(c,d){return new b.init(d).finalize(c)}},_createHmacHelper:function(b){return function(c,d){return new w.HMAC.init(b,d).finalize(c)}}});var w=u.algo={};return u}(Math));(function(d){var b=CryptoJS,i=b.lib,j=i.Base,c=i.WordArray,b=b.x64={};b.Word=j.extend({init:function(e,f){this.high=e;this.low=f}});b.WordArray=j.extend({init:function(e,f){e=this.words=e||[];this.sigBytes=f!=d?f:8*e.length},toX32:function(){for(var e=this.words,l=e.length,f=[],k=0;k<l;k++){var g=e[k];f.push(g.high);f.push(g.low)}return c.create(f,this.sigBytes)},clone:function(){for(var g=j.clone.call(this),f=g.words=this.words.slice(0),k=f.length,e=0;e<k;e++){f[e]=f[e].clone()}return g}})})();CryptoJS.lib.Cipher||function(C){var F=CryptoJS,B=F.lib,E=B.Base,D=B.WordArray,c=B.BufferedBlockAlgorithm,o=F.enc.Base64,y=F.algo.EvpKDF,e=B.Cipher=c.extend({cfg:E.extend(),createEncryptor:function(g,f){return this.create(this._ENC_XFORM_MODE,g,f)},createDecryptor:function(g,f){return this.create(this._DEC_XFORM_MODE,g,f)},init:function(g,f,j){this.cfg=this.cfg.extend(j);this._xformMode=g;this._key=f;this.reset()},reset:function(){c.reset.call(this);this._doReset()},process:function(f){this._append(f);return this._process()},finalize:function(f){f&&this._append(f);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(f){return{encrypt:function(g,k,j){return("string"==typeof k?x:A).encrypt(f,g,k,j)},decrypt:function(g,k,j){return("string"==typeof k?x:A).decrypt(f,g,k,j)}}}});B.StreamCipher=e.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var i=F.mode={},w=function(g,f,l){var k=this._iv;k?this._iv=C:k=this._prevBlock;for(var j=0;j<l;j++){g[f+j]^=k[j]}},b=(B.BlockCipherMode=E.extend({createEncryptor:function(g,f){return this.Encryptor.create(g,f)},createDecryptor:function(g,f){return this.Decryptor.create(g,f)},init:function(g,f){this._cipher=g;this._iv=f}})).extend();b.Encryptor=b.extend({processBlock:function(k,j){var g=this._cipher,f=g.blockSize;w.call(this,k,j,f);g.encryptBlock(k,j);this._prevBlock=k.slice(j,j+f)}});b.Decryptor=b.extend({processBlock:function(g,f){var l=this._cipher,k=l.blockSize,j=g.slice(f,f+k);l.decryptBlock(g,f);w.call(this,g,f,k);this._prevBlock=j}});i=i.CBC=b;b=(F.pad={}).Pkcs7={pad:function(j,g){for(var f=4*g,f=f-j.sigBytes%f,m=f<<24|f<<16|f<<8|f,l=[],k=0;k<f;k+=4){l.push(m)}f=D.create(l,f);j.concat(f)},unpad:function(f){f.sigBytes-=f.words[f.sigBytes-1>>>2]&255}};B.BlockCipher=e.extend({cfg:e.cfg.extend({mode:i,padding:b}),reset:function(){e.reset.call(this);var g=this.cfg,f=g.iv,g=g.mode;if(this._xformMode==this._ENC_XFORM_MODE){var j=g.createEncryptor}else{j=g.createDecryptor,this._minBufferSize=1}this._mode=j.call(g,this,f&&f.words)},_doProcessBlock:function(g,f){this._mode.processBlock(g,f)},_doFinalize:function(){var g=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){g.pad(this._data,this.blockSize);var f=this._process(!0)}else{f=this._process(!0),g.unpad(f)}return f},blockSize:4});var d=B.CipherParams=E.extend({init:function(f){this.mixIn(f)},toString:function(f){return(f||this.formatter).stringify(this)}}),i=(F.format={}).OpenSSL={stringify:function(g){var f=g.ciphertext;g=g.salt;return(g?D.create([1398893684,1701076831]).concat(g).concat(f):f).toString(o)},parse:function(g){g=o.parse(g);var f=g.words;if(1398893684==f[0]&&1701076831==f[1]){var j=D.create(f.slice(2,4));f.splice(0,4);g.sigBytes-=16}return d.create({ciphertext:g,salt:j})}},A=B.SerializableCipher=E.extend({cfg:E.extend({format:i}),encrypt:function(g,f,l,k){k=this.cfg.extend(k);var j=g.createEncryptor(l,k);f=j.finalize(f);j=j.cfg;return d.create({ciphertext:f,key:l,iv:j.iv,algorithm:g,mode:j.mode,padding:j.padding,blockSize:g.blockSize,formatter:k.format})},decrypt:function(k,j,g,f){f=this.cfg.extend(f);j=this._parse(j,f.format);return k.createDecryptor(g,f).finalize(j.ciphertext)},_parse:function(g,f){return"string"==typeof g?f.parse(g,this):g}}),F=(F.kdf={}).OpenSSL={execute:function(k,j,g,f){f||(f=D.random(8));k=y.create({keySize:j+g}).compute(k,f);g=D.create(k.words.slice(j),4*g);k.sigBytes=4*j;return d.create({key:k,iv:g,salt:f})}},x=B.PasswordBasedCipher=A.extend({cfg:A.cfg.extend({kdf:F}),encrypt:function(k,j,g,f){f=this.cfg.extend(f);g=f.kdf.execute(g,k.keySize,k.ivSize);f.iv=g.iv;k=A.encrypt.call(this,k,j,g.key,f);k.mixIn(g);return k},decrypt:function(k,j,g,f){f=this.cfg.extend(f);j=this._parse(j,f.format);g=f.kdf.execute(g,k.keySize,k.ivSize,j.salt);f.iv=g.iv;return A.decrypt.call(this,k,j,g.key,f)}})}();(function(){for(var G=CryptoJS,N=G.lib.BlockCipher,O=G.algo,S=[],d=[],c=[],L=[],M=[],K=[],J=[],p=[],m=[],i=[],T=[],R=0;256>R;R++){T[R]=128>R?R<<1:R<<1^283}for(var P=0,Q=0,R=0;256>R;R++){var U=Q^Q<<1^Q<<2^Q<<3^Q<<4,U=U>>>8^U&255^99;S[P]=U;d[U]=P;var H=T[P],I=T[H],e=T[I],V=257*T[U]^16843008*U;c[P]=V<<24|V>>>8;L[P]=V<<16|V>>>16;M[P]=V<<8|V>>>24;K[P]=V;V=16843009*e^65537*I^257*H^16843008*P;J[U]=V<<24|V>>>8;p[U]=V<<16|V>>>16;m[U]=V<<8|V>>>24;i[U]=V;P?(P=H^T[T[T[e^H]]],Q^=T[T[Q]]):P=Q=1}var o=[0,1,2,4,8,16,32,64,128,27,54],O=O.AES=N.extend({_doReset:function(){for(var g=this._key,l=g.words,k=g.sigBytes/4,g=4*((this._nRounds=k+6)+1),f=this._keySchedule=[],b=0;b<g;b++){if(b<k){f[b]=l[b]}else{var j=f[b-1];b%k?6<k&&4==b%k&&(j=S[j>>>24]<<24|S[j>>>16&255]<<16|S[j>>>8&255]<<8|S[j&255]):(j=j<<8|j>>>24,j=S[j>>>24]<<24|S[j>>>16&255]<<16|S[j>>>8&255]<<8|S[j&255],j^=o[b/k|0]<<24);f[b]=f[b-k]^j}}l=this._invKeySchedule=[];for(k=0;k<g;k++){b=g-k,j=k%4?f[b]:f[b-4],l[k]=4>k||4>=b?j:J[S[j>>>24]]^p[S[j>>>16&255]]^m[S[j>>>8&255]]^i[S[j&255]]}},encryptBlock:function(f,b){this._doCryptBlock(f,b,this._keySchedule,c,L,M,K,S)},decryptBlock:function(g,f){var b=g[f+1];g[f+1]=g[f+3];g[f+3]=b;this._doCryptBlock(g,f,this._invKeySchedule,J,p,m,i,d);b=g[f+1];g[f+1]=g[f+3];g[f+3]=b},_doCryptBlock:function(b,r,g,f,u,y,s,k){for(var j=this._nRounds,B=b[r]^g[0],v=b[r+1]^g[1],n=b[r+2]^g[2],q=b[r+3]^g[3],l=4,w=1;w<j;w++){var x=f[B>>>24]^u[v>>>16&255]^y[n>>>8&255]^s[q&255]^g[l++],C=f[v>>>24]^u[n>>>16&255]^y[q>>>8&255]^s[B&255]^g[l++],A=f[n>>>24]^u[q>>>16&255]^y[B>>>8&255]^s[v&255]^g[l++],q=f[q>>>24]^u[B>>>16&255]^y[v>>>8&255]^s[n&255]^g[l++],B=x,v=C,n=A}x=(k[B>>>24]<<24|k[v>>>16&255]<<16|k[n>>>8&255]<<8|k[q&255])^g[l++];C=(k[v>>>24]<<24|k[n>>>16&255]<<16|k[q>>>8&255]<<8|k[B&255])^g[l++];A=(k[n>>>24]<<24|k[q>>>16&255]<<16|k[B>>>8&255]<<8|k[v&255])^g[l++];q=(k[q>>>24]<<24|k[B>>>16&255]<<16|k[v>>>8&255]<<8|k[n&255])^g[l++];b[r]=x;b[r+1]=C;b[r+2]=A;b[r+3]=q},keySize:8});G.AES=N._createHelper(O)})();(function(){function y(e,j){var g=(this._lBlock>>>e^this._rBlock)&j;this._rBlock^=g;this._lBlock^=g<<e}function u(e,j){var g=(this._rBlock>>>e^this._lBlock)&j;this._lBlock^=g;this._rBlock^=g<<e}var b=CryptoJS,c=b.lib,x=c.WordArray,c=c.BlockCipher,v=b.algo,f=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],w=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],k=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],o=[{"0":8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{"0":1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{"0":260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{"0":2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{"0":128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{"0":268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{"0":1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{"0":134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],i=v.DES=c.extend({_doReset:function(){for(var g=this._key.words,e=[],j=0;56>j;j++){var l=f[j]-1;e[j]=g[l>>>5]>>>31-l%32&1}g=this._subKeys=[];for(l=0;16>l;l++){for(var n=g[l]=[],m=k[l],j=0;24>j;j++){n[j/6|0]|=e[(w[j]-1+m)%28]<<31-j%6,n[4+(j/6|0)]|=e[28+(w[j+24]-1+m)%28]<<31-j%6}n[0]=n[0]<<1|n[0]>>>31;for(j=1;7>j;j++){n[j]>>>=4*(j-1)+3}n[7]=n[7]<<5|n[7]>>>27}e=this._invSubKeys=[];for(j=0;16>j;j++){e[j]=g[15-j]}},encryptBlock:function(e,g){this._doCryptBlock(e,g,this._subKeys)},decryptBlock:function(e,g){this._doCryptBlock(e,g,this._invSubKeys)},_doCryptBlock:function(l,j,r){this._lBlock=l[j];this._rBlock=l[j+1];y.call(this,4,252645135);y.call(this,16,65535);u.call(this,2,858993459);u.call(this,8,16711935);y.call(this,1,1431655765);for(var q=0;16>q;q++){for(var g=r[q],e=this._lBlock,n=this._rBlock,p=0,m=0;8>m;m++){p|=o[m][((n^g[m])&d[m])>>>0]}this._lBlock=n;this._rBlock=e^p}r=this._lBlock;this._lBlock=this._rBlock;this._rBlock=r;y.call(this,1,1431655765);u.call(this,8,16711935);u.call(this,2,858993459);y.call(this,16,65535);y.call(this,4,252645135);l[j]=this._lBlock;l[j+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});b.DES=c._createHelper(i);v=v.TripleDES=c.extend({_doReset:function(){var e=this._key.words;this._des1=i.createEncryptor(x.create(e.slice(0,2)));this._des2=i.createEncryptor(x.create(e.slice(2,4)));this._des3=i.createEncryptor(x.create(e.slice(4,6)))},encryptBlock:function(e,g){this._des1.encryptBlock(e,g);this._des2.decryptBlock(e,g);this._des3.encryptBlock(e,g)},decryptBlock:function(e,g){this._des3.decryptBlock(e,g);this._des2.encryptBlock(e,g);this._des1.decryptBlock(e,g)},keySize:6,ivSize:2,blockSize:2});b.TripleDES=c._createHelper(v)})();(function(){var c=CryptoJS,b=c.lib.WordArray;c.enc.Base64={stringify:function(k){var m=k.words,i=k.sigBytes,e=this._map;k.clamp();k=[];for(var j=0;j<i;j+=3){for(var d=(m[j>>>2]>>>24-8*(j%4)&255)<<16|(m[j+1>>>2]>>>24-8*((j+1)%4)&255)<<8|m[j+2>>>2]>>>24-8*((j+2)%4)&255,l=0;4>l&&j+0.75*l<i;l++){k.push(e.charAt(d>>>6*(3-l)&63))}}if(m=e.charAt(64)){for(;k.length%4;){k.push(m)}}return k.join("")},parse:function(k){var d=k.length,j=this._map,i=j.charAt(64);i&&(i=k.indexOf(i),-1!=i&&(d=i));for(var i=[],m=0,n=0;n<d;n++){if(n%4){var l=j.indexOf(k.charAt(n-1))<<2*(n%4),e=j.indexOf(k.charAt(n))>>>6-2*(n%4);i[m>>>2]|=(l|e)<<24-8*(m%4);m++}}return b.create(i,m)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(i){function c(u,r,q,l,s,n,k){u=u+(r&q|~r&l)+s+k;return(u<<n|u>>>32-n)+r}function b(u,r,q,l,s,n,k){u=u+(r&l|q&~l)+s+k;return(u<<n|u>>>32-n)+r}function p(l,u,s,q,r,n,k){l=l+(u^s^q)+r+k;return(l<<n|l>>>32-n)+u}function o(l,u,s,q,r,n,k){l=l+(s^(u|~q))+r+k;return(l<<n|l>>>32-n)+u}for(var j=CryptoJS,m=j.lib,f=m.WordArray,g=m.Hasher,m=j.algo,d=[],e=0;64>e;e++){d[e]=4294967296*i.abs(i.sin(e+1))|0}m=m.MD5=g.extend({_doReset:function(){this._hash=new f.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(y,F){for(var v=0;16>v;v++){var H=F+v,u=y[H];y[H]=(u<<8|u>>>24)&16711935|(u<<24|u>>>8)&4278255360}var v=this._hash.words,H=y[F+0],u=y[F+1],x=y[F+2],r=y[F+3],n=y[F+4],k=y[F+5],P=y[F+6],O=y[F+7],N=y[F+8],L=y[F+9],I=y[F+10],w=y[F+11],G=y[F+12],s=y[F+13],q=y[F+14],l=y[F+15],M=v[0],K=v[1],E=v[2],J=v[3],M=c(M,K,E,J,H,7,d[0]),J=c(J,M,K,E,u,12,d[1]),E=c(E,J,M,K,x,17,d[2]),K=c(K,E,J,M,r,22,d[3]),M=c(M,K,E,J,n,7,d[4]),J=c(J,M,K,E,k,12,d[5]),E=c(E,J,M,K,P,17,d[6]),K=c(K,E,J,M,O,22,d[7]),M=c(M,K,E,J,N,7,d[8]),J=c(J,M,K,E,L,12,d[9]),E=c(E,J,M,K,I,17,d[10]),K=c(K,E,J,M,w,22,d[11]),M=c(M,K,E,J,G,7,d[12]),J=c(J,M,K,E,s,12,d[13]),E=c(E,J,M,K,q,17,d[14]),K=c(K,E,J,M,l,22,d[15]),M=b(M,K,E,J,u,5,d[16]),J=b(J,M,K,E,P,9,d[17]),E=b(E,J,M,K,w,14,d[18]),K=b(K,E,J,M,H,20,d[19]),M=b(M,K,E,J,k,5,d[20]),J=b(J,M,K,E,I,9,d[21]),E=b(E,J,M,K,l,14,d[22]),K=b(K,E,J,M,n,20,d[23]),M=b(M,K,E,J,L,5,d[24]),J=b(J,M,K,E,q,9,d[25]),E=b(E,J,M,K,r,14,d[26]),K=b(K,E,J,M,N,20,d[27]),M=b(M,K,E,J,s,5,d[28]),J=b(J,M,K,E,x,9,d[29]),E=b(E,J,M,K,O,14,d[30]),K=b(K,E,J,M,G,20,d[31]),M=p(M,K,E,J,k,4,d[32]),J=p(J,M,K,E,N,11,d[33]),E=p(E,J,M,K,w,16,d[34]),K=p(K,E,J,M,q,23,d[35]),M=p(M,K,E,J,u,4,d[36]),J=p(J,M,K,E,n,11,d[37]),E=p(E,J,M,K,O,16,d[38]),K=p(K,E,J,M,I,23,d[39]),M=p(M,K,E,J,s,4,d[40]),J=p(J,M,K,E,H,11,d[41]),E=p(E,J,M,K,r,16,d[42]),K=p(K,E,J,M,P,23,d[43]),M=p(M,K,E,J,L,4,d[44]),J=p(J,M,K,E,G,11,d[45]),E=p(E,J,M,K,l,16,d[46]),K=p(K,E,J,M,x,23,d[47]),M=o(M,K,E,J,H,6,d[48]),J=o(J,M,K,E,O,10,d[49]),E=o(E,J,M,K,q,15,d[50]),K=o(K,E,J,M,k,21,d[51]),M=o(M,K,E,J,G,6,d[52]),J=o(J,M,K,E,r,10,d[53]),E=o(E,J,M,K,I,15,d[54]),K=o(K,E,J,M,u,21,d[55]),M=o(M,K,E,J,N,6,d[56]),J=o(J,M,K,E,l,10,d[57]),E=o(E,J,M,K,P,15,d[58]),K=o(K,E,J,M,s,21,d[59]),M=o(M,K,E,J,n,6,d[60]),J=o(J,M,K,E,w,10,d[61]),E=o(E,J,M,K,x,15,d[62]),K=o(K,E,J,M,L,21,d[63]);v[0]=v[0]+M|0;v[1]=v[1]+K|0;v[2]=v[2]+E|0;v[3]=v[3]+J|0},_doFinalize:function(){var k=this._data,r=k.words,q=8*this._nDataBytes,l=8*k.sigBytes;r[l>>>5]|=128<<24-l%32;var n=i.floor(q/4294967296);r[(l+64>>>9<<4)+15]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360;r[(l+64>>>9<<4)+14]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360;k.sigBytes=4*(r.length+1);this._process();k=this._hash;r=k.words;for(q=0;4>q;q++){l=r[q],r[q]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360}return k},clone:function(){var k=g.clone.call(this);k._hash=this._hash.clone();return k}});j.MD5=g._createHelper(m);j.HmacMD5=g._createHmacHelper(m)})(Math);(function(){var g=CryptoJS,e=g.lib,c=e.WordArray,f=e.Hasher,i=[],e=g.algo.SHA1=f.extend({_doReset:function(){this._hash=new c.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(k,j){for(var d=this._hash.words,r=d[0],q=d[1],m=d[2],l=d[3],b=d[4],s=0;80>s;s++){if(16>s){i[s]=k[j+s]|0}else{var o=i[s-3]^i[s-8]^i[s-14]^i[s-16];i[s]=o<<1|o>>>31}o=(r<<5|r>>>27)+b+i[s];o=20>s?o+((q&m|~q&l)+1518500249):40>s?o+((q^m^l)+1859775393):60>s?o+((q&m|q&l|m&l)-1894007588):o+((q^m^l)-899497514);b=l;l=m;m=q<<30|q>>>2;q=r;r=o}d[0]=d[0]+r|0;d[1]=d[1]+q|0;d[2]=d[2]+m|0;d[3]=d[3]+l|0;d[4]=d[4]+b|0},_doFinalize:function(){var k=this._data,j=k.words,b=8*this._nDataBytes,d=8*k.sigBytes;j[d>>>5]|=128<<24-d%32;j[(d+64>>>9<<4)+14]=Math.floor(b/4294967296);j[(d+64>>>9<<4)+15]=b;k.sigBytes=4*j.length;this._process();return this._hash},clone:function(){var b=f.clone.call(this);b._hash=this._hash.clone();return b}});g.SHA1=f._createHelper(e);g.HmacSHA1=f._createHmacHelper(e)})();(function(p){for(var e=CryptoJS,C=e.lib,A=C.WordArray,D=C.Hasher,C=e.algo,o=[],y=[],q=function(b){return 4294967296*(b-(b|0))|0},f=2,i=0;64>i;){var c;a:{c=f;for(var m=p.sqrt(c),B=2;B<=m;B++){if(!(c%B)){c=!1;break a}}c=!0}c&&(8>i&&(o[i]=q(p.pow(f,0.5))),y[i]=q(p.pow(f,1/3)),i++);f++}var x=[],C=C.SHA256=D.extend({_doReset:function(){this._hash=new A.init(o.slice(0))},_doProcessBlock:function(v,d){for(var g=this._hash.words,b=g[0],k=g[1],E=g[2],n=g[3],s=g[4],w=g[5],u=g[6],r=g[7],l=0;64>l;l++){if(16>l){x[l]=v[d+l]|0}else{var j=x[l-15],F=x[l-2];x[l]=((j<<25|j>>>7)^(j<<14|j>>>18)^j>>>3)+x[l-7]+((F<<15|F>>>17)^(F<<13|F>>>19)^F>>>10)+x[l-16]}j=r+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&w^~s&u)+y[l]+x[l];F=((b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22))+(b&k^b&E^k&E);r=u;u=w;w=s;s=n+j|0;n=E;E=k;k=b;b=j+F|0}g[0]=g[0]+b|0;g[1]=g[1]+k|0;g[2]=g[2]+E|0;g[3]=g[3]+n|0;g[4]=g[4]+s|0;g[5]=g[5]+w|0;g[6]=g[6]+u|0;g[7]=g[7]+r|0},_doFinalize:function(){var d=this._data,j=d.words,b=8*this._nDataBytes,g=8*d.sigBytes;j[g>>>5]|=128<<24-g%32;j[(g+64>>>9<<4)+14]=p.floor(b/4294967296);j[(g+64>>>9<<4)+15]=b;d.sigBytes=4*j.length;this._process();return this._hash},clone:function(){var b=D.clone.call(this);b._hash=this._hash.clone();return b}});e.SHA256=D._createHelper(C);e.HmacSHA256=D._createHmacHelper(C)})(Math);(function(){var g=CryptoJS,e=g.lib.WordArray,i=g.algo,f=i.SHA256,i=i.SHA224=f.extend({_doReset:function(){this._hash=new e.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var b=f._doFinalize.call(this);b.sigBytes-=4;return b}});g.SHA224=f._createHelper(i);g.HmacSHA224=f._createHmacHelper(i)})();(function(){function b(){return l.create.apply(l,arguments)}for(var i=CryptoJS,g=i.lib.Hasher,k=i.x64,l=k.Word,j=k.WordArray,k=i.algo,m=[b(1116352408,3609767458),b(1899447441,602891725),b(3049323471,3964484399),b(3921009573,2173295548),b(961987163,4081628472),b(1508970993,3053834265),b(2453635748,2937671579),b(2870763221,3664609560),b(3624381080,2734883394),b(310598401,1164996542),b(607225278,1323610764),b(1426881987,3590304994),b(1925078388,4068182383),b(2162078206,991336113),b(2614888103,633803317),b(3248222580,3479774868),b(3835390401,2666613458),b(4022224774,944711139),b(264347078,2341262773),b(604807628,2007800933),b(770255983,1495990901),b(1249150122,1856431235),b(1555081692,3175218132),b(1996064986,2198950837),b(2554220882,3999719339),b(2821834349,766784016),b(2952996808,2566594879),b(3210313671,3203337956),b(3336571891,1034457026),b(3584528711,2466948901),b(113926993,3758326383),b(338241895,168717936),b(666307205,1188179964),b(773529912,1546045734),b(1294757372,1522805485),b(1396182291,2643833823),b(1695183700,2343527390),b(1986661051,1014477480),b(2177026350,1206759142),b(2456956037,344077627),b(2730485921,1290863460),b(2820302411,3158454273),b(3259730800,3505952657),b(3345764771,106217008),b(3516065817,3606008344),b(3600352804,1432725776),b(4094571909,1467031594),b(275423344,851169720),b(430227734,3100823752),b(506948616,1363258195),b(659060556,3750685593),b(883997877,3785050280),b(958139571,3318307427),b(1322822218,3812723403),b(1537002063,2003034995),b(1747873779,3602036899),b(1955562222,1575990012),b(2024104815,1125592928),b(2227730452,2716904306),b(2361852424,442776044),b(2428436474,593698344),b(2756734187,3733110249),b(3204031479,2999351573),b(3329325298,3815920427),b(3391569614,3928383900),b(3515267271,566280711),b(3940187606,3454069534),b(4118630271,4000239992),b(116418474,1914138554),b(174292421,2731055270),b(289380356,3203993006),b(460393269,320620315),b(685471733,587496836),b(852142971,1086792851),b(1017036298,365543100),b(1126000580,2618297676),b(1288033470,3409855158),b(1501505948,4234509866),b(1607167915,987167468),b(1816402316,1246189591)],f=[],c=0;80>c;c++){f[c]=b()}k=k.SHA512=g.extend({_doReset:function(){this._hash=new j.init([new l.init(1779033703,4089235720),new l.init(3144134277,2227873595),new l.init(1013904242,4271175723),new l.init(2773480762,1595750129),new l.init(1359893119,2917565137),new l.init(2600822924,725511199),new l.init(528734635,4215389547),new l.init(1541459225,327033209)])},_doProcessBlock:function(a9,a8){for(var o=this._hash.words,aD=o[0],az=o[1],aP=o[2],aQ=o[3],aC=o[4],aO=o[5],ay=o[6],o=o[7],s=aD.high,r=aD.low,aK=az.high,a3=az.low,aM=aP.high,e=aP.low,a0=aQ.high,at=aQ.low,v=aC.high,ba=aC.low,aL=aO.high,aT=aO.low,aH=ay.high,aS=ay.low,av=o.high,aR=o.low,a6=s,aJ=r,ax=aK,aX=a3,q=aM,a4=e,p=a0,aN=at,aB=v,aF=ba,ar=aL,aG=aT,n=aH,u=aS,aA=av,aY=aR,a1=0;80>a1;a1++){var aZ=f[a1];if(16>a1){var au=aZ.high=a9[a8+2*a1]|0,aw=aZ.low=a9[a8+2*a1+1]|0}else{var au=f[a1-15],aw=au.high,aE=au.low,au=(aw>>>1|aE<<31)^(aw>>>8|aE<<24)^aw>>>7,aE=(aE>>>1|aw<<31)^(aE>>>8|aw<<24)^(aE>>>7|aw<<25),aI=f[a1-2],aw=aI.high,aW=aI.low,aI=(aw>>>19|aW<<13)^(aw<<3|aW>>>29)^aw>>>6,aW=(aW>>>19|aw<<13)^(aW<<3|aw>>>29)^(aW>>>6|aw<<26),aw=f[a1-7],a7=aw.high,a5=f[a1-16],d=a5.high,a5=a5.low,aw=aE+aw.low,au=au+a7+(aw>>>0<aE>>>0?1:0),aw=aw+aW,au=au+aI+(aw>>>0<aW>>>0?1:0),aw=aw+a5,au=au+d+(aw>>>0<a5>>>0?1:0);aZ.high=au;aZ.low=aw}var a7=aB&ar^~aB&n,a5=aF&aG^~aF&u,aZ=a6&ax^a6&q^ax&q,a2=aJ&aX^aJ&a4^aX&a4,aE=(a6>>>28|aJ<<4)^(a6<<30|aJ>>>2)^(a6<<25|aJ>>>7),aI=(aJ>>>28|a6<<4)^(aJ<<30|a6>>>2)^(aJ<<25|a6>>>7),aW=m[a1],aV=aW.high,aU=aW.low,aW=aY+((aF>>>14|aB<<18)^(aF>>>18|aB<<14)^(aF<<23|aB>>>9)),d=aA+((aB>>>14|aF<<18)^(aB>>>18|aF<<14)^(aB<<23|aF>>>9))+(aW>>>0<aY>>>0?1:0),aW=aW+a5,d=d+a7+(aW>>>0<a5>>>0?1:0),aW=aW+aU,d=d+aV+(aW>>>0<aU>>>0?1:0),aW=aW+aw,d=d+au+(aW>>>0<aw>>>0?1:0),aw=aI+a2,aZ=aE+aZ+(aw>>>0<aI>>>0?1:0),aA=n,aY=u,n=ar,u=aG,ar=aB,aG=aF,aF=aN+aW|0,aB=p+d+(aF>>>0<aN>>>0?1:0)|0,p=q,aN=a4,q=ax,a4=aX,ax=a6,aX=aJ,aJ=aW+aw|0,a6=d+aZ+(aJ>>>0<aW>>>0?1:0)|0}r=aD.low=r+aJ;aD.high=s+a6+(r>>>0<aJ>>>0?1:0);a3=az.low=a3+aX;az.high=aK+ax+(a3>>>0<aX>>>0?1:0);e=aP.low=e+a4;aP.high=aM+q+(e>>>0<a4>>>0?1:0);at=aQ.low=at+aN;aQ.high=a0+p+(at>>>0<aN>>>0?1:0);ba=aC.low=ba+aF;aC.high=v+aB+(ba>>>0<aF>>>0?1:0);aT=aO.low=aT+aG;aO.high=aL+ar+(aT>>>0<aG>>>0?1:0);aS=ay.low=aS+u;ay.high=aH+n+(aS>>>0<u>>>0?1:0);aR=o.low=aR+aY;o.high=av+aA+(aR>>>0<aY>>>0?1:0)},_doFinalize:function(){var n=this._data,e=n.words,d=8*this._nDataBytes,o=8*n.sigBytes;e[o>>>5]|=128<<24-o%32;e[(o+128>>>10<<5)+30]=Math.floor(d/4294967296);e[(o+128>>>10<<5)+31]=d;n.sigBytes=4*e.length;this._process();return this._hash.toX32()},clone:function(){var d=g.clone.call(this);d._hash=this._hash.clone();return d},blockSize:32});i.SHA512=g._createHelper(k);i.HmacSHA512=g._createHmacHelper(k)})();(function(){var k=CryptoJS,g=k.x64,f=g.Word,i=g.WordArray,g=k.algo,j=g.SHA512,g=g.SHA384=j.extend({_doReset:function(){this._hash=new i.init([new f.init(3418070365,3238371032),new f.init(1654270250,914150663),new f.init(2438529370,812702999),new f.init(355462360,4144912697),new f.init(1731405415,4290775857),new f.init(2394180231,1750603025),new f.init(3675008525,1694076839),new f.init(1203062813,3204075428)])},_doFinalize:function(){var b=j._doFinalize.call(this);b.sigBytes-=16;return b}});k.SHA384=j._createHelper(g);k.HmacSHA384=j._createHmacHelper(g)})();(function(){var c=CryptoJS,j=c.lib,i=j.WordArray,f=j.Hasher,j=c.algo,m=i.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),l=i.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),k=i.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),g=i.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),e=i.create([0,1518500249,1859775393,2400959708,2840853838]),b=i.create([1352829926,1548603684,1836072691,2053994217,0]),j=j.RIPEMD160=f.extend({_doReset:function(){this._hash=i.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(r,y){for(var E=0;16>E;E++){var D=y+E,q=r[D];r[D]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}var D=this._hash.words,q=e.words,u=b.words,p=m.words,n=l.words,o=k.words,I=g.words,G,x,v,w,d,C,A,B,F,s;C=G=D[0];A=x=D[1];B=v=D[2];F=w=D[3];s=d=D[4];for(var H,E=0;80>E;E+=1){H=G+r[y+p[E]]|0,H=16>E?H+((x^v^w)+q[0]):32>E?H+((x&v|~x&w)+q[1]):48>E?H+(((x|~v)^w)+q[2]):64>E?H+((x&w|v&~w)+q[3]):H+((x^(v|~w))+q[4]),H|=0,H=H<<o[E]|H>>>32-o[E],H=H+d|0,G=d,d=w,w=v<<10|v>>>22,v=x,x=H,H=C+r[y+n[E]]|0,H=16>E?H+((A^(B|~F))+u[0]):32>E?H+((A&F|B&~F)+u[1]):48>E?H+(((A|~B)^F)+u[2]):64>E?H+((A&B|~A&F)+u[3]):H+((A^B^F)+u[4]),H|=0,H=H<<I[E]|H>>>32-I[E],H=H+s|0,C=s,s=F,F=B<<10|B>>>22,B=A,A=H}H=D[1]+v+F|0;D[1]=D[2]+w+s|0;D[2]=D[3]+d+C|0;D[3]=D[4]+G+A|0;D[4]=D[0]+x+B|0;D[0]=H},_doFinalize:function(){var o=this._data,d=o.words,n=8*this._nDataBytes,p=8*o.sigBytes;d[p>>>5]|=128<<24-p%32;d[(p+64>>>9<<4)+14]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360;o.sigBytes=4*(d.length+1);this._process();o=this._hash;d=o.words;for(n=0;5>n;n++){p=d[n],d[n]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360}return o},clone:function(){var d=f.clone.call(this);d._hash=this._hash.clone();return d}});c.RIPEMD160=f._createHelper(j);c.HmacRIPEMD160=f._createHmacHelper(j)})(Math);(function(){var d=CryptoJS,b=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(c,p){c=this._hasher=new c.init;"string"==typeof p&&(p=b.parse(p));var o=c.blockSize,m=4*o;p.sigBytes>m&&(p=c.finalize(p));p.clamp();for(var l=this._oKey=p.clone(),k=this._iKey=p.clone(),i=l.words,e=k.words,n=0;n<o;n++){i[n]^=1549556828,e[n]^=909522486}l.sigBytes=k.sigBytes=m;this.reset()},reset:function(){var c=this._hasher;c.reset();c.update(this._iKey)},update:function(c){this._hasher.update(c);return this},finalize:function(e){var c=this._hasher;e=c.finalize(e);c.reset();return c.finalize(this._oKey.clone().concat(e))}})})();(function(){var e=CryptoJS,g=e.lib,j=g.Base,c=g.WordArray,g=e.algo,i=g.HMAC,f=g.PBKDF2=j.extend({cfg:j.extend({keySize:4,hasher:g.SHA1,iterations:1}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(w,d){for(var A=this.cfg,q=i.create(A.hasher,w),m=c.create(),k=c.create([1]),x=m.words,y=k.words,u=A.keySize,A=A.iterations;x.length<u;){var v=q.update(d).finalize(k);q.reset();for(var C=v.words,b=C.length,B=v,l=1;l<A;l++){B=q.finalize(B);q.reset();for(var o=B.words,n=0;n<b;n++){C[n]^=o[n]}}m.concat(v);y[0]++}m.sigBytes=4*u;return m}});e.PBKDF2=function(k,d,b){return f.create(b).compute(k,d)}})();var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";function hex2b64(f){var g;var c;var i="";for(g=0;g+3<=f.length;g+=3){c=parseInt(f.substring(g,g+3),16);i+=b64map.charAt(c>>6)+b64map.charAt(c&63)}if(g+1==f.length){c=parseInt(f.substring(g,g+1),16);i+=b64map.charAt(c<<2)}else{if(g+2==f.length){c=parseInt(f.substring(g,g+2),16);i+=b64map.charAt(c>>2)+b64map.charAt((c&3)<<4)}}if(b64pad){while((i.length&3)>0){i+=b64pad}}return i}function b64tohex(j){var g="";var k;var m=0;var l;var i;for(k=0;k<j.length;++k){if(j.charAt(k)==b64pad){break}i=b64map.indexOf(j.charAt(k));if(i<0){continue}if(m==0){g+=int2char(i>>2);l=i&3;m=1}else{if(m==1){g+=int2char((l<<2)|(i>>4));l=i&15;m=2}else{if(m==2){g+=int2char(l);g+=int2char(i>>2);l=i&3;m=3}else{g+=int2char((l<<2)|(i>>4));g+=int2char(i&15);m=0}}}}if(m==1){g+=int2char(l<<2)}return g}function b64toBA(j){var f=b64tohex(j);var g;var i=new Array();for(g=0;2*g<f.length;++g){i[g]=parseInt(f.substring(2*g,2*g+2),16)}return i}var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(c,g,b){if(c!=null){if("number"==typeof c){this.fromNumber(c,g,b)}else{if(g==null&&"string"!=typeof c){this.fromString(c,256)}else{this.fromString(c,g)}}}}function nbi(){return new BigInteger(null)}function am1(l,i,n,m,j,k){while(--k>=0){var c=i*this[l++]+n[m]+j;j=Math.floor(c/67108864);n[m++]=c&67108863}return j}function am2(v,m,l,x,n,i){var u=m&32767,c=m>>15;while(--i>=0){var j=this[v]&32767;var s=this[v++]>>15;var w=c*j+s*u;j=u*j+((w&32767)<<15)+l[x]+(n&1073741823);n=(j>>>30)+(w>>>15)+c*s+(n>>>30);l[x++]=j&1073741823}return n}function am3(v,m,l,x,n,i){var u=m&16383,c=m>>14;while(--i>=0){var j=this[v]&16383;var s=this[v++]>>14;var w=c*j+s*u;j=u*j+((w&16383)<<14)+l[x]+n;n=(j>>28)+(w>>14)+c*s;l[x++]=j&268435455}return n}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(b){return BI_RM.charAt(b)}function intAt(c,e){var f=BI_RC[c.charCodeAt(e)];return(f==null)?-1:f}function bnpCopyTo(c){for(var d=this.t-1;d>=0;--d){c[d]=this[d]}c.t=this.t;c.s=this.s}function bnpFromInt(b){this.t=1;this.s=(b<0)?-1:0;if(b>0){this[0]=b}else{if(b<-1){this[0]=b+this.DV}else{this.t=0}}}function nbv(d){var c=nbi();c.fromInt(d);return c}function bnpFromString(m,l){var n;if(l==16){n=4}else{if(l==8){n=3}else{if(l==256){n=8}else{if(l==2){n=1}else{if(l==32){n=5}else{if(l==4){n=2}else{this.fromRadix(m,l);return}}}}}}this.t=0;this.s=0;var k=m.length,i=false,j=0;while(--k>=0){var b=(n==8)?m[k]&255:intAt(m,k);if(b<0){if(m.charAt(k)=="-"){i=true}continue}i=false;if(j==0){this[this.t++]=b}else{if(j+n>this.DB){this[this.t-1]|=(b&((1<<(this.DB-j))-1))<<j;this[this.t++]=(b>>(this.DB-j))}else{this[this.t-1]|=b<<j}}j+=n;if(j>=this.DB){j-=this.DB}}if(n==8&&(m[0]&128)!=0){this.s=-1;if(j>0){this[this.t-1]|=((1<<(this.DB-j))-1)<<j}}this.clamp();if(i){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var b=this.s&this.DM;while(this.t>0&&this[this.t-1]==b){--this.t}}function bnToString(n){if(this.s<0){return"-"+this.negate().toString(n)}var k;if(n==16){k=4}else{if(n==8){k=3}else{if(n==2){k=1}else{if(n==32){k=5}else{if(n==4){k=2}else{return this.toRadix(n)}}}}}var m=(1<<k)-1,o,b=false,d="",p=this.t;var i=this.DB-(p*this.DB)%k;if(p-->0){if(i<this.DB&&(o=this[p]>>i)>0){b=true;d=int2char(o)}while(p>=0){if(i<k){o=(this[p]&((1<<i)-1))<<(k-i);o|=this[--p]>>(i+=this.DB-k)}else{o=(this[p]>>(i-=k))&m;if(i<=0){i+=this.DB;--p}}if(o>0){b=true}if(b){d+=int2char(o)}}}return b?d:"0"}function bnNegate(){var b=nbi();BigInteger.ZERO.subTo(this,b);return b}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(e){var f=this.s-e.s;if(f!=0){return f}var g=this.t;f=g-e.t;if(f!=0){return(this.s<0)?-f:f}while(--g>=0){if((f=this[g]-e[g])!=0){return f}}return 0}function nbits(e){var f=1,d;if((d=e>>>16)!=0){e=d;f+=16}if((d=e>>8)!=0){e=d;f+=8}if((d=e>>4)!=0){e=d;f+=4}if((d=e>>2)!=0){e=d;f+=2}if((d=e>>1)!=0){e=d;f+=1}return f}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(f,d){var e;for(e=this.t-1;e>=0;--e){d[e+f]=this[e]}for(e=f-1;e>=0;--e){d[e]=0}d.t=this.t+f;d.s=this.s}function bnpDRShiftTo(f,d){for(var e=f;e<this.t;++e){d[e-f]=this[e]}d.t=Math.max(this.t-f,0);d.s=this.s}function bnpLShiftTo(l,p){var n=l%this.DB;var i=this.DB-n;var o=(1<<i)-1;var k=Math.floor(l/this.DB),c=(this.s<<n)&this.DM,m;for(m=this.t-1;m>=0;--m){p[m+k+1]=(this[m]>>i)|c;c=(this[m]&o)<<n}for(m=k-1;m>=0;--m){p[m]=0}p[k]=c;p.t=this.t+k+1;p.s=this.s;p.clamp()}function bnpRShiftTo(m,i){i.s=this.s;var k=Math.floor(m/this.DB);if(k>=this.t){i.t=0;return}var n=m%this.DB;var j=this.DB-n;var l=(1<<n)-1;i[0]=this[k]>>n;for(var o=k+1;o<this.t;++o){i[o-k-1]|=(this[o]&l)<<j;i[o-k]=this[o]>>n}if(n>0){i[this.t-k-1]|=(this.s&l)<<j}i.t=this.t-k;i.clamp()}function bnpSubTo(l,j){var k=0,i=0,c=Math.min(l.t,this.t);while(k<c){i+=this[k]-l[k];j[k++]=i&this.DM;i>>=this.DB}if(l.t<this.t){i-=l.s;while(k<this.t){i+=this[k];j[k++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(k<l.t){i-=l[k];j[k++]=i&this.DM;i>>=this.DB}i-=l.s}j.s=(i<0)?-1:0;if(i<-1){j[k++]=this.DV+i}else{if(i>0){j[k++]=i}}j.t=k;j.clamp()}function bnpMultiplyTo(l,j){var g=this.abs(),i=l.abs();var k=g.t;j.t=k+i.t;while(--k>=0){j[k]=0}for(k=0;k<i.t;++k){j[k+g.t]=g.am(0,i[k],j,k,0,g.t)}j.s=0;j.clamp();if(this.s!=l.s){BigInteger.ZERO.subTo(j,j)}}function bnpSquareTo(f){var i=this.abs();var g=f.t=2*i.t;while(--g>=0){f[g]=0}for(g=0;g<i.t-1;++g){var c=i.am(g,i[g],f,2*g,0,1);if((f[g+i.t]+=i.am(g+1,2*i[g],f,2*g+1,c,i.t-g-1))>=i.DV){f[g+i.t]-=i.DV;f[g+i.t+1]=1}}if(f.t>0){f[f.t-1]+=i.am(g,i[g],f,2*g,0,1)}f.s=0;f.clamp()}function bnpDivRemTo(G,y,C){var j=G.abs();if(j.t<=0){return}var I=this.abs();if(I.t<j.t){if(y!=null){y.fromInt(0)}if(C!=null){this.copyTo(C)}return}if(C==null){C=nbi()}var H=nbi(),M=this.s,m=G.s;var D=this.DB-nbits(j[j.t-1]);if(D>0){j.lShiftTo(D,H);I.lShiftTo(D,C)}else{j.copyTo(H);I.copyTo(C)}var F=H.t;var L=H[F-1];if(L==0){return}var B=L*(1<<this.F1)+((F>1)?H[F-2]>>this.F2:0);var q=this.FV/B,e=(1<<this.F1)/B,i=1<<this.F2;var E=C.t,r=E-F,J=(y==null)?nbi():y;H.dlShiftTo(r,J);if(C.compareTo(J)>=0){C[C.t++]=1;C.subTo(J,C)}BigInteger.ONE.dlShiftTo(F,J);J.subTo(H,H);while(H.t<F){H[H.t++]=0}while(--r>=0){var K=(C[--E]==L)?this.DM:Math.floor(C[E]*q+(C[E-1]+i)*e);if((C[E]+=H.am(0,K,C,r,0,F))<K){H.dlShiftTo(r,J);C.subTo(J,C);while(C[E]<--K){C.subTo(J,C)}}}if(y!=null){C.drShiftTo(F,y);if(M!=m){BigInteger.ZERO.subTo(y,y)}}C.t=F;C.clamp();if(D>0){C.rShiftTo(D,C)}if(M<0){BigInteger.ZERO.subTo(C,C)}}function bnMod(d){var e=nbi();this.abs().divRemTo(d,null,e);if(this.s<0&&e.compareTo(BigInteger.ZERO)>0){d.subTo(e,e)}return e}function Classic(b){this.m=b}function cConvert(b){if(b.s<0||b.compareTo(this.m)>=0){return b.mod(this.m)}else{return b}}function cRevert(b){return b}function cReduce(b){b.divRemTo(this.m,null,b)}function cMulTo(e,f,d){e.multiplyTo(f,d);this.reduce(d)}function cSqrTo(d,c){d.squareTo(c);this.reduce(c)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var d=this[0];if((d&1)==0){return 0}var c=d&3;c=(c*(2-(d&15)*c))&15;c=(c*(2-(d&255)*c))&255;c=(c*(2-(((d&65535)*c)&65535)))&65535;c=(c*(2-d*c%this.DV))%this.DV;return(c>0)?this.DV-c:-c}function Montgomery(b){this.m=b;this.mp=b.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(b.DB-15))-1;this.mt2=2*b.t}function montConvert(d){var c=nbi();d.abs().dlShiftTo(this.m.t,c);c.divRemTo(this.m,null,c);if(d.s<0&&c.compareTo(BigInteger.ZERO)>0){this.m.subTo(c,c)}return c}function montRevert(d){var c=nbi();d.copyTo(c);this.reduce(c);return c}function montReduce(i){while(i.t<=this.mt2){i[i.t++]=0}for(var f=0;f<this.m.t;++f){var g=i[f]&32767;var e=(g*this.mpl+(((g*this.mph+(i[f]>>15)*this.mpl)&this.um)<<15))&i.DM;g=f+this.m.t;i[g]+=this.m.am(0,e,i,f,0,this.m.t);while(i[g]>=i.DV){i[g]-=i.DV;i[++g]++}}i.clamp();i.drShiftTo(this.m.t,i);if(i.compareTo(this.m)>=0){i.subTo(this.m,i)}}function montSqrTo(d,c){d.squareTo(c);this.reduce(c)}function montMulTo(e,f,d){e.multiplyTo(f,d);this.reduce(d)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(e,i){if(e>4294967295||e<1){return BigInteger.ONE}var m=nbi(),g=nbi(),l=i.convert(this),n=nbits(e)-1;l.copyTo(m);while(--n>=0){i.sqrTo(m,g);if((e&(1<<n))>0){i.mulTo(g,l,m)}else{var k=m;m=g;g=k}}return i.revert(m)}function bnModPowInt(d,e){var f;if(d<256||e.isEven()){f=new Classic(e)}else{f=new Montgomery(e)}return this.exp(d,f)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var b=nbi();this.copyTo(b);return b}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(b){return Math.floor(Math.LN2*this.DB/Math.log(b))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(n){if(n==null){n=10}if(this.signum()==0||n<2||n>36){return"0"}var m=this.chunkSize(n);var o=Math.pow(n,m);var b=nbv(o),d=nbi(),k=nbi(),l="";this.divRemTo(b,d,k);while(d.signum()>0){l=(o+k.intValue()).toString(n).substr(1)+l;d.divRemTo(b,d,k)}return k.intValue().toString(n)+l}function bnpFromRadix(j,p){this.fromInt(0);if(p==null){p=10}var r=this.chunkSize(p);var q=Math.pow(p,r),b=false,i=0,n=0;for(var d=0;d<j.length;++d){var o=intAt(j,d);if(o<0){if(j.charAt(d)=="-"&&this.signum()==0){b=true}continue}n=p*n+o;if(++i>=r){this.dMultiply(q);this.dAddOffset(n,0);i=0;n=0}}if(i>0){this.dMultiply(Math.pow(p,i));this.dAddOffset(n,0)}if(b){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(i,j,b){if("number"==typeof j){if(i<2){this.fromInt(1)}else{this.fromNumber(i,b);if(!this.testBit(i-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(i-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(j)){this.dAddOffset(2,0);if(this.bitLength()>i){this.subTo(BigInteger.ONE.shiftLeft(i-1),this)}}}}else{var k=new Array(),c=i&7;k.length=(i>>3)+1;j.nextBytes(k);if(c>0){k[0]&=((1<<c)-1)}else{k[0]=0}this.fromString(k,256)}}function bnToByteArray(){var d=this.t,k=new Array();k[0]=this.s;var j=this.DB-(d*this.DB)%8,i,g=0;if(d-->0){if(j<this.DB&&(i=this[d]>>j)!=(this.s&this.DM)>>j){k[g++]=i|(this.s<<(this.DB-j))}while(d>=0){if(j<8){i=(this[d]&((1<<j)-1))<<(8-j);i|=this[--d]>>(j+=this.DB-8)}else{i=(this[d]>>(j-=8))&255;if(j<=0){j+=this.DB;--d}}if((i&128)!=0){i|=-256}if(g==0&&(this.s&128)!=(i&128)){++g}if(g>0||i!=this.s){k[g++]=i}}}return k}function bnEquals(c){return(this.compareTo(c)==0)}function bnMin(c){return(this.compareTo(c)<0)?this:c}function bnMax(c){return(this.compareTo(c)>0)?this:c}function bnpBitwiseTo(m,i,k){var f,j,l=Math.min(m.t,this.t);for(f=0;f<l;++f){k[f]=i(this[f],m[f])}if(m.t<this.t){j=m.s&this.DM;for(f=l;f<this.t;++f){k[f]=i(this[f],j)}k.t=this.t}else{j=this.s&this.DM;for(f=l;f<m.t;++f){k[f]=i(j,m[f])}k.t=m.t}k.s=i(this.s,m.s);k.clamp()}function op_and(d,c){return d&c}function bnAnd(d){var e=nbi();this.bitwiseTo(d,op_and,e);return e}function op_or(d,c){return d|c}function bnOr(d){var e=nbi();this.bitwiseTo(d,op_or,e);return e}function op_xor(d,c){return d^c}function bnXor(d){var e=nbi();this.bitwiseTo(d,op_xor,e);return e}function op_andnot(d,c){return d&~c}function bnAndNot(d){var e=nbi();this.bitwiseTo(d,op_andnot,e);return e}function bnNot(){var c=nbi();for(var d=0;d<this.t;++d){c[d]=this.DM&~this[d]}c.t=this.t;c.s=~this.s;return c}function bnShiftLeft(c){var d=nbi();if(c<0){this.rShiftTo(-c,d)}else{this.lShiftTo(c,d)}return d}function bnShiftRight(c){var d=nbi();if(c<0){this.lShiftTo(-c,d)}else{this.rShiftTo(c,d)}return d}function lbit(d){if(d==0){return -1}var c=0;if((d&65535)==0){d>>=16;c+=16}if((d&255)==0){d>>=8;c+=8}if((d&15)==0){d>>=4;c+=4}if((d&3)==0){d>>=2;c+=2}if((d&1)==0){++c}return c}function bnGetLowestSetBit(){for(var b=0;b<this.t;++b){if(this[b]!=0){return b*this.DB+lbit(this[b])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(d){var c=0;while(d!=0){d&=d-1;++c}return c}function bnBitCount(){var f=0,e=this.s&this.DM;for(var d=0;d<this.t;++d){f+=cbit(this[d]^e)}return f}function bnTestBit(c){var d=Math.floor(c/this.DB);if(d>=this.t){return(this.s!=0)}return((this[d]&(1<<(c%this.DB)))!=0)}function bnpChangeBit(f,d){var e=BigInteger.ONE.shiftLeft(f);this.bitwiseTo(e,d,e);return e}function bnSetBit(b){return this.changeBit(b,op_or)}function bnClearBit(b){return this.changeBit(b,op_andnot)}function bnFlipBit(b){return this.changeBit(b,op_xor)}function bnpAddTo(l,j){var k=0,i=0,c=Math.min(l.t,this.t);while(k<c){i+=this[k]+l[k];j[k++]=i&this.DM;i>>=this.DB}if(l.t<this.t){i+=l.s;while(k<this.t){i+=this[k];j[k++]=i&this.DM;i>>=this.DB}i+=this.s}else{i+=this.s;while(k<l.t){i+=l[k];j[k++]=i&this.DM;i>>=this.DB}i+=l.s}j.s=(i<0)?-1:0;if(i>0){j[k++]=i}else{if(i<-1){j[k++]=this.DV+i}}j.t=k;j.clamp()}function bnAdd(d){var e=nbi();this.addTo(d,e);return e}function bnSubtract(d){var e=nbi();this.subTo(d,e);return e}function bnMultiply(d){var e=nbi();this.multiplyTo(d,e);return e}function bnSquare(){var b=nbi();this.squareTo(b);return b}function bnDivide(d){var e=nbi();this.divRemTo(d,e,null);return e}function bnRemainder(d){var e=nbi();this.divRemTo(d,null,e);return e}function bnDivideAndRemainder(e){var f=nbi(),g=nbi();this.divRemTo(e,f,g);return new Array(f,g)}function bnpDMultiply(b){this[this.t]=this.am(0,b-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(c,d){if(c==0){return}while(this.t<=d){this[this.t++]=0}this[d]+=c;while(this[d]>=this.DV){this[d]-=this.DV;if(++d>=this.t){this[this.t++]=0}++this[d]}}function NullExp(){}function nNop(b){return b}function nMulTo(e,f,d){e.multiplyTo(f,d)}function nSqrTo(d,c){d.squareTo(c)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(b){return this.exp(b,new NullExp())}function bnpMultiplyLowerTo(g,i,j){var k=Math.min(this.t+g.t,i);j.s=0;j.t=k;while(k>0){j[--k]=0}var l;for(l=j.t-this.t;k<l;++k){j[k+this.t]=this.am(0,g[k],j,k,0,this.t)}for(l=Math.min(g.t,i);k<l;++k){this.am(0,g[k],j,k,0,i-k)}j.clamp()}function bnpMultiplyUpperTo(i,j,f){--j;var g=f.t=this.t+i.t-j;f.s=0;while(--g>=0){f[g]=0}for(g=Math.max(j-this.t,0);g<i.t;++g){f[this.t+g-j]=this.am(j-g,i[g],f,0,0,this.t+g-j)}f.clamp();f.drShiftTo(1,f)}function Barrett(b){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*b.t,this.r2);this.mu=this.r2.divide(b);this.m=b}function barrettConvert(d){if(d.s<0||d.t>2*this.m.t){return d.mod(this.m)}else{if(d.compareTo(this.m)<0){return d}else{var c=nbi();d.copyTo(c);this.reduce(c);return c}}}function barrettRevert(b){return b}function barrettReduce(b){b.drShiftTo(this.m.t-1,this.r2);if(b.t>this.m.t+1){b.t=this.m.t+1;b.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(b.compareTo(this.r2)<0){b.dAddOffset(1,this.m.t+1)}b.subTo(this.r2,b);while(b.compareTo(this.m)>=0){b.subTo(this.m,b)}}function barrettSqrTo(d,c){d.squareTo(c);this.reduce(c)}function barrettMulTo(e,f,d){e.multiplyTo(f,d);this.reduce(d)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(m,E){var F=m.bitLength(),e,D=nbv(1),B;if(F<=0){return D}else{if(F<18){e=1}else{if(F<48){e=3}else{if(F<144){e=4}else{if(F<768){e=5}else{e=6}}}}}if(F<8){B=new Classic(E)}else{if(E.isEven()){B=new Barrett(E)}else{B=new Montgomery(E)}}var j=new Array(),r=3,H=e-1,w=(1<<e)-1;j[1]=B.convert(this);if(e>1){var g=nbi();B.sqrTo(j[1],g);while(r<=w){j[r]=nbi();B.mulTo(g,j[r-2],j[r]);r+=2}}var C=m.t-1,G,k=true,i=nbi(),n;F=nbits(m[C])-1;while(C>=0){if(F>=H){G=(m[C]>>(F-H))&w}else{G=(m[C]&((1<<(F+1))-1))<<(H-F);if(C>0){G|=m[C-1]>>(this.DB+F-H)}}r=e;while((G&1)==0){G>>=1;--r}if((F-=r)<0){F+=this.DB;--C}if(k){j[G].copyTo(D);k=false}else{while(r>1){B.sqrTo(D,i);B.sqrTo(i,D);r-=2}if(r>0){B.sqrTo(D,i)}else{n=D;D=i;i=n}B.mulTo(i,j[G],D)}while(C>=0&&(m[C]&(1<<F))==0){B.sqrTo(D,i);n=D;D=i;i=n;if(--F<0){F=this.DB-1;--C}}}return B.revert(D)}function bnGCD(m){var g=(this.s<0)?this.negate():this.clone();var i=(m.s<0)?m.negate():m.clone();if(g.compareTo(i)<0){var k=g;g=i;i=k}var l=g.getLowestSetBit(),j=i.getLowestSetBit();if(j<0){return g}if(l<j){j=l}if(j>0){g.rShiftTo(j,g);i.rShiftTo(j,i)}while(g.signum()>0){if((l=g.getLowestSetBit())>0){g.rShiftTo(l,g)}if((l=i.getLowestSetBit())>0){i.rShiftTo(l,i)}if(g.compareTo(i)>=0){g.subTo(i,g);g.rShiftTo(1,g)}else{i.subTo(g,i);i.rShiftTo(1,i)}}if(j>0){i.lShiftTo(j,i)}return i}function bnpModInt(d){if(d<=0){return 0}var f=this.DV%d,g=(this.s<0)?d-1:0;if(this.t>0){if(f==0){g=this[0]%d}else{for(var i=this.t-1;i>=0;--i){g=(f*g+this[i])%d}}}return g}function bnModInverse(p){var o=p.isEven();if((this.isEven()&&o)||p.signum()==0){return BigInteger.ZERO}var m=p.clone(),c=this.clone();var d=nbv(1),q=nbv(0),b=nbv(0),n=nbv(1);while(m.signum()!=0){while(m.isEven()){m.rShiftTo(1,m);if(o){if(!d.isEven()||!q.isEven()){d.addTo(this,d);q.subTo(p,q)}d.rShiftTo(1,d)}else{if(!q.isEven()){q.subTo(p,q)}}q.rShiftTo(1,q)}while(c.isEven()){c.rShiftTo(1,c);if(o){if(!b.isEven()||!n.isEven()){b.addTo(this,b);n.subTo(p,n)}b.rShiftTo(1,b)}else{if(!n.isEven()){n.subTo(p,n)}}n.rShiftTo(1,n)}if(m.compareTo(c)>=0){m.subTo(c,m);if(o){d.subTo(b,d)}q.subTo(n,q)}else{c.subTo(m,c);if(o){b.subTo(d,b)}n.subTo(q,n)}}if(c.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(n.compareTo(p)>=0){return n.subtract(p)}if(n.signum()<0){n.addTo(p,n)}else{return n}if(n.signum()<0){return n.add(p)}else{return n}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(i){var j,f=this.abs();if(f.t==1&&f[0]<=lowprimes[lowprimes.length-1]){for(j=0;j<lowprimes.length;++j){if(f[0]==lowprimes[j]){return true}}return false}if(f.isEven()){return false}j=1;while(j<lowprimes.length){var g=lowprimes[j],k=j+1;while(k<lowprimes.length&&g<lplim){g*=lowprimes[k++]}g=f.modInt(g);while(j<k){if(g%lowprimes[j++]==0){return false}}}return f.millerRabin(i)}function bnpMillerRabin(p){var m=this.subtract(BigInteger.ONE);var j=m.getLowestSetBit();if(j<=0){return false}var o=m.shiftRight(j);p=(p+1)>>1;if(p>lowprimes.length){p=lowprimes.length}var i=nbi();for(var k=0;k<p;++k){i.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var q=i.modPow(o,this);if(q.compareTo(BigInteger.ONE)!=0&&q.compareTo(m)!=0){var n=1;while(n++<j&&q.compareTo(m)!=0){q=q.modPowInt(2,this);if(q.compareTo(BigInteger.ONE)==0){return false}}if(q.compareTo(m)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;function Arcfour(){this.i=0;this.j=0;this.S=new Array()}function ARC4init(e){var f,i,g;for(f=0;f<256;++f){this.S[f]=f}i=0;for(f=0;f<256;++f){i=(i+this.S[f]+e[f%e.length])&255;g=this.S[f];this.S[f]=this.S[i];this.S[i]=g}this.i=0;this.j=0}function ARC4next(){var b;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;b=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=b;return this.S[(b+this.S[this.i])&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour()}var rng_psize=256;var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(b){rng_pool[rng_pptr++]^=b&255;rng_pool[rng_pptr++]^=(b>>8)&255;rng_pool[rng_pptr++]^=(b>>16)&255;rng_pool[rng_pptr++]^=(b>>24)&255;if(rng_pptr>=rng_psize){rng_pptr-=rng_psize}}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(rng_pool==null){rng_pool=new Array();rng_pptr=0;var t;if(window.crypto&&window.crypto.getRandomValues){var ua=new Uint8Array(32);window.crypto.getRandomValues(ua);for(t=0;t<32;++t){rng_pool[rng_pptr++]=ua[t]}}if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t){rng_pool[rng_pptr++]=z.charCodeAt(t)&255}}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr){rng_pool[rng_pptr]=0}rng_pptr=0}return rng_state.next()}function rng_get_bytes(c){var d;for(d=0;d<c.length;++d){c[d]=rng_get_byte()}}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function parseBigInt(c,d){return new BigInteger(c,d)}function linebrk(f,e){var i="";var g=0;while(g+e<f.length){i+=f.substring(g,g+e)+"\n";g+=e}return i+f.substring(g,f.length)}function byte2Hex(b){if(b<16){return"0"+b.toString(16)}else{return b.toString(16)}}function pkcs1pad2(l,j){if(j<l.length+11){alert("Message too long for RSA");return null}var n=new Array();var k=l.length-1;while(k>=0&&j>0){var m=l.charCodeAt(k--);if(m<128){n[--j]=m}else{if((m>127)&&(m<2048)){n[--j]=(m&63)|128;n[--j]=(m>>6)|192}else{n[--j]=(m&63)|128;n[--j]=((m>>6)&63)|128;n[--j]=(m>>12)|224}}}n[--j]=0;var c=new SecureRandom();var i=new Array();while(j>2){i[0]=0;while(i[0]==0){c.nextBytes(i)}n[--j]=i[0]}n[--j]=2;n[--j]=0;return new BigInteger(n)}function oaep_mgf1_arr(k,g,i){var f="",j=0;while(f.length<g){f+=i(String.fromCharCode.apply(String,k.concat([(j&4278190080)>>24,(j&16711680)>>16,(j&65280)>>8,j&255])));j+=1}return f}function oaep_pad(w,E,A,u){var y=Ext.crypto.MessageDigest;var r=Ext.crypto.Util;var s=null;if(!A){A="sha1"}if(typeof A==="string"){s=y.getCanonicalAlgName(A);u=y.getHashLength(s);A=function(b){return hextorstr(r.hashString(b,s))}}if(w.length+2*u+2>E){throw"Message too long for RSA"}var v="",B;for(B=0;B<E-w.length-2*u-2;B+=1){v+="\x00"}var x=A("")+v+"\x01"+w;var C=new Array(u);new SecureRandom().nextBytes(C);var F=oaep_mgf1_arr(C,x.length,A);var n=[];for(B=0;B<x.length;B+=1){n[B]=x.charCodeAt(B)^F.charCodeAt(B)}var i=oaep_mgf1_arr(n,C.length,A);var D=[0];for(B=0;B<C.length;B+=1){D[B+1]=C[B]^i.charCodeAt(B)}return new BigInteger(D.concat(n))}function RSAKey(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function RSASetPublic(c,d){this.isPublic=true;this.isPrivate=false;if(typeof c!=="string"){this.n=c;this.e=d}else{if(c!=null&&d!=null&&c.length>0&&d.length>0){this.n=parseBigInt(c,16);this.e=parseInt(d,16)}else{throw"Invalid RSA public key"}}}function RSADoPublic(b){return b.modPowInt(this.e,this.n)}function RSAEncrypt(f){var i=pkcs1pad2(f,(this.n.bitLength()+7)>>3);if(i==null){return null}var c=this.doPublic(i);if(c==null){return null}var g=c.toString(16);if((g.length&1)==0){return g}else{return"0"+g}}function RSAEncryptOAEP(k,l,c){var i=oaep_pad(k,(this.n.bitLength()+7)>>3,l,c);if(i==null){return null}var j=this.doPublic(i);if(j==null){return null}var m=j.toString(16);if((m.length&1)==0){return m}else{return"0"+m}}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";function pkcs1unpad2(i,c){var b=i.toByteArray();var k=0;while(k<b.length&&b[k]==0){++k}if(b.length-k!=c-1||b[k]!=2){return null}++k;while(b[k]!=0){if(++k>=b.length){return null}}var l="";while(++k<b.length){var d=b[k]&255;if(d<128){l+=String.fromCharCode(d)}else{if((d>191)&&(d<224)){l+=String.fromCharCode(((d&31)<<6)|(b[k+1]&63));++k}else{l+=String.fromCharCode(((d&15)<<12)|((b[k+1]&63)<<6)|(b[k+2]&63));k+=2}}}return l}function oaep_mgf1_str(k,g,i){var f="",j=0;while(f.length<g){f+=i(k+String.fromCharCode.apply(String,[(j&4278190080)>>24,(j&16711680)>>16,(j&65280)>>8,j&255]));j+=1}return f}function oaep_unpad(u,y,i,x){var H=Ext.crypto.MessageDigest;var w=Ext.crypto.Util;var E=null;if(!i){i="sha1"}if(typeof i==="string"){E=H.getCanonicalAlgName(i);x=H.getHashLength(E);i=function(b){return hextorstr(w.hashString(b,E))}}u=u.toByteArray();var v;for(v=0;v<u.length;v+=1){u[v]&=255}while(u.length<y){u.unshift(0)}u=String.fromCharCode.apply(String,u);if(u.length<2*x+2){throw"Cipher too short"}var d=u.substr(1,x);var n=u.substr(x+1);var A=oaep_mgf1_str(n,x,i);var F=[],v;for(v=0;v<d.length;v+=1){F[v]=d.charCodeAt(v)^A.charCodeAt(v)}var C=oaep_mgf1_str(String.fromCharCode.apply(String,F),u.length-x,i);var B=[];for(v=0;v<n.length;v+=1){B[v]=n.charCodeAt(v)^C.charCodeAt(v)}B=String.fromCharCode.apply(String,B);if(B.substr(0,x)!==i("")){throw"Hash mismatch"}B=B.substr(x);var D=B.indexOf("\x01");var G=(D!=-1)?B.substr(0,D).lastIndexOf("\x00"):-1;if(G+1!=D){throw"Malformed data"}return B.substr(D+1)}function RSASetPrivate(f,e,d){this.isPrivate=true;if(typeof f!=="string"){this.n=f;this.e=e;this.d=d}else{if(f!=null&&e!=null&&f.length>0&&e.length>0){this.n=parseBigInt(f,16);this.e=parseInt(e,16);this.d=parseBigInt(d,16)}else{alert("Invalid RSA private key")}}}function RSASetPrivateEx(m,i,o,p,n,l,k,j){this.isPrivate=true;this.isPublic=false;if(m==null){throw"RSASetPrivateEx N == null"}if(i==null){throw"RSASetPrivateEx E == null"}if(m.length==0){throw"RSASetPrivateEx N.length == 0"}if(i.length==0){throw"RSASetPrivateEx E.length == 0"}if(m!=null&&i!=null&&m.length>0&&i.length>0){this.n=parseBigInt(m,16);this.e=parseInt(i,16);this.d=parseBigInt(o,16);this.p=parseBigInt(p,16);this.q=parseBigInt(n,16);this.dmp1=parseBigInt(l,16);this.dmq1=parseBigInt(k,16);this.coeff=parseBigInt(j,16)}else{alert("Invalid RSA private key in RSASetPrivateEx")}}function RSAGenerate(k,m){var l=new SecureRandom();var p=k>>1;this.e=parseInt(m,16);var j=new BigInteger(m,16);for(;;){for(;;){this.p=new BigInteger(k-p,1,l);if(this.p.subtract(BigInteger.ONE).gcd(j).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(p,1,l);if(this.q.subtract(BigInteger.ONE).gcd(j).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var n=this.p;this.p=this.q;this.q=n}var o=this.p.subtract(BigInteger.ONE);var r=this.q.subtract(BigInteger.ONE);var q=o.multiply(r);if(q.gcd(j).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=j.modInverse(q);this.dmp1=this.d.mod(o);this.dmq1=this.d.mod(r);this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=true}function RSADoPrivate(e){if(this.p==null||this.q==null){return e.modPow(this.d,this.n)}var f=e.mod(this.p).modPow(this.dmp1,this.p);var d=e.mod(this.q).modPow(this.dmq1,this.q);while(f.compareTo(d)<0){f=f.add(this.p)}return f.subtract(d).multiply(this.coeff).mod(this.p).multiply(this.q).add(d)}function RSADecrypt(c){var f=parseBigInt(c,16);var e=this.doPrivate(f);if(e==null){return null}return pkcs1unpad2(e,(this.n.bitLength()+7)>>3)}function RSADecryptOAEP(j,k,c){var i=parseBigInt(j,16);var g=this.doPrivate(i);if(g==null){return null}return oaep_unpad(g,(this.n.bitLength()+7)>>3,k,c)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;function ECFieldElementFp(c,d){this.x=d;this.q=c}function feFpEquals(b){if(b==this){return true}return(this.q.equals(b.q)&&this.x.equals(b.x))}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(b){return new ECFieldElementFp(this.q,this.x.add(b.toBigInteger()).mod(this.q))}function feFpSubtract(b){return new ECFieldElementFp(this.q,this.x.subtract(b.toBigInteger()).mod(this.q))}function feFpMultiply(b){return new ECFieldElementFp(this.q,this.x.multiply(b.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(b){return new ECFieldElementFp(this.q,this.x.multiply(b.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(f,i,e,g){this.curve=f;this.x=i;this.y=e;if(g==null){this.z=BigInteger.ONE}else{this.z=g}this.zinv=null}function pointFpGetX(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(e){if(e==this){return true}if(this.isInfinity()){return e.isInfinity()}if(e.isInfinity()){return this.isInfinity()}var f,d;f=e.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(e.z)).mod(this.curve.q);if(!f.equals(BigInteger.ZERO)){return false}d=e.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(e.z)).mod(this.curve.q);return d.equals(BigInteger.ZERO)}function pointFpIsInfinity(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(A){if(this.isInfinity()){return A}if(A.isInfinity()){return this}var u=A.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(A.z)).mod(this.curve.q);var x=A.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(A.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(x)){if(BigInteger.ZERO.equals(u)){return this.twice()}return this.curve.getInfinity()}var C=new BigInteger("3");var E=this.x.toBigInteger();var B=this.y.toBigInteger();var r=A.x.toBigInteger();var q=A.y.toBigInteger();var y=x.square();var v=y.multiply(x);var F=E.multiply(y);var b=u.square().multiply(this.z);var D=b.subtract(F.shiftLeft(1)).multiply(A.z).subtract(v).multiply(x).mod(this.curve.q);var s=F.multiply(C).multiply(u).subtract(B.multiply(v)).subtract(b.multiply(u)).multiply(A.z).add(u.multiply(v)).mod(this.curve.q);var w=v.multiply(this.z).multiply(A.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(D),this.curve.fromBigInteger(s),w)}function pointFpTwice(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var p=new BigInteger("3");var u=this.x.toBigInteger();var o=this.y.toBigInteger();var r=o.multiply(this.z);var m=r.multiply(o).mod(this.curve.q);var n=this.curve.a.toBigInteger();var l=u.square().multiply(p);if(!BigInteger.ZERO.equals(n)){l=l.add(this.z.square().multiply(n))}l=l.mod(this.curve.q);var v=l.square().subtract(u.shiftLeft(3).multiply(m)).shiftLeft(1).multiply(r).mod(this.curve.q);var q=l.multiply(p).multiply(u).subtract(m.shiftLeft(1)).shiftLeft(2).multiply(m).subtract(l.square().multiply(l)).mod(this.curve.q);var s=r.square().multiply(r).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(v),this.curve.fromBigInteger(q),s)}function pointFpMultiply(p){if(this.isInfinity()){return this}if(p.signum()==0){return this.curve.getInfinity()}var n=p;var o=n.multiply(new BigInteger("3"));var k=this.negate();var i=this;var q;for(q=o.bitLength()-2;q>0;--q){i=i.twice();var e=o.testBit(q);var m=n.testBit(q);if(e!=m){i=i.add(e?this:k)}}return i}function pointFpMultiplyTwo(m,i,g){var l;if(m.bitLength()>g.bitLength()){l=m.bitLength()-1}else{l=g.bitLength()-1}var j=this.curve.getInfinity();var k=this.add(i);while(l>=0){j=j.twice();if(m.testBit(l)){if(g.testBit(l)){j=j.add(k)}else{j=j.add(this)}}else{if(g.testBit(l)){j=j.add(i)}}--l}return j}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(b,f,g){this.q=b;this.a=this.fromBigInteger(f);this.b=this.fromBigInteger(g);this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(b){if(b==this){return true}return(this.q.equals(b.q)&&this.a.equals(b.a)&&this.b.equals(b.b))}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(b){return new ECFieldElementFp(this.q,b)}function curveFpDecodePointHex(e){switch(parseInt(e.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var i=(e.length-2)/2;var f=e.substr(2,i);var g=e.substr(i+2,i);return new ECPointFp(this,this.fromBigInteger(new BigInteger(f,16)),this.fromBigInteger(new BigInteger(g,16)));default:return null}}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ECPointFp.prototype.getEncoded=function(k){var j=function(b,d){var c=b.toByteArrayUnsigned();if(d<c.length){c=c.slice(c.length-d)}else{while(d>c.length){c.unshift(0)}}return c};var g=this.getX().toBigInteger();var i=this.getY().toBigInteger();var f=j(g,32);if(k){if(i.isEven()){f.unshift(2)}else{f.unshift(3)}}else{f.unshift(4);f=f.concat(j(i,32))}return f};ECPointFp.decodeFrom=function(m,i){var k=i[0];var p=i.length-1;var o=i.slice(1,1+p/2);var n=i.slice(1+p/2,1+p);o.unshift(0);n.unshift(0);var l=new BigInteger(o);var j=new BigInteger(n);return new ECPointFp(m,m.fromBigInteger(l),m.fromBigInteger(j))};ECPointFp.decodeFromHex=function(m,i){var k=i.substr(0,2);var p=i.length-2;var o=i.substr(2,p/2);var n=i.substr(2+p/2,p/2);var l=new BigInteger(o,16);var j=new BigInteger(n,16);return new ECPointFp(m,m.fromBigInteger(l),m.fromBigInteger(j))};ECPointFp.prototype.add2D=function(m){if(this.isInfinity()){return m}if(m.isInfinity()){return this}if(this.x.equals(m.x)){if(this.y.equals(m.y)){return this.twice()}return this.curve.getInfinity()}var i=m.x.subtract(this.x);var k=m.y.subtract(this.y);var b=k.divide(i);var l=b.square().subtract(this.x).subtract(m.x);var j=b.multiply(this.x.subtract(l)).subtract(this.y);return new ECPointFp(this.curve,l,j)};ECPointFp.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var f=this.curve.fromBigInteger(BigInteger.valueOf(2));var i=this.curve.fromBigInteger(BigInteger.valueOf(3));var g=this.x.square().multiply(i).add(this.curve.a).divide(this.y.multiply(f));var k=g.square().subtract(this.x.multiply(f));var j=g.multiply(this.x.subtract(k)).subtract(this.y);return new ECPointFp(this.curve,k,j)};ECPointFp.prototype.multiply2D=function(p){if(this.isInfinity()){return this}if(p.signum()==0){return this.curve.getInfinity()}var n=p;var o=n.multiply(new BigInteger("3"));var k=this.negate();var i=this;var q;for(q=o.bitLength()-2;q>0;--q){i=i.twice();var e=o.testBit(q);var m=n.testBit(q);if(e!=m){i=i.add2D(e?this:k)}}return i};ECPointFp.prototype.isOnCurve=function(){var n=this.getX().toBigInteger();var m=this.getY().toBigInteger();var l=this.curve.getA().toBigInteger();var o=this.curve.getB().toBigInteger();var j=this.curve.getQ();var b=m.multiply(m).mod(j);var k=n.multiply(n).multiply(n).add(l.multiply(n)).add(o).mod(j);return b.equals(k)};ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ECPointFp.prototype.validate=function(){var f=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var e=this.getX().toBigInteger();var d=this.getY().toBigInteger();if(e.compareTo(BigInteger.ONE)<0||e.compareTo(f.subtract(BigInteger.ONE))>0){throw new Error("x coordinate out of bounds")}if(d.compareTo(BigInteger.ONE)<0||d.compareTo(f.subtract(BigInteger.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(f).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var jsonParse=(function(){var r="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";var v='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';var n='(?:"'+v+'*")';var s=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+r+"|"+n+")","g");var l=new RegExp("\\\\(?:([^u])|u(.{4}))","g");var p={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function o(c,b,d){return b?p[b]:String.fromCharCode(parseInt(d,16))}var u=new String("");var m="\\";var q={"{":Object,"[":Array};var w=Object.hasOwnProperty;return function(x,e){var y=x.match(s);var c;var f=y[0];var b=false;if("{"===f){c={}}else{if("["===f){c=[]}else{c=[];b=true}}var i;var k=[c];for(var j=1-b,d=y.length;j<d;++j){f=y[j];var A;switch(f.charCodeAt(0)){default:A=k[0];A[i||A.length]=+(f);i=void 0;break;case 34:f=f.substring(1,f.length-1);if(f.indexOf(m)!==-1){f=f.replace(l,o)}A=k[0];if(!i){if(A instanceof Array){i=A.length}else{i=f||u;break}}A[i]=f;i=void 0;break;case 91:A=k[0];k.unshift(A[i||A.length]=[]);i=void 0;break;case 93:k.shift();break;case 102:A=k[0];A[i||A.length]=false;i=void 0;break;case 110:A=k[0];A[i||A.length]=null;i=void 0;break;case 116:A=k[0];A[i||A.length]=true;i=void 0;break;case 123:A=k[0];k.unshift(A[i||A.length]={});i=void 0;break;case 125:k.shift();break}}if(b){if(k.length!==1){throw new Error()}c=c[0]}else{if(k.length){throw new Error()}}if(e){var g=function(C,I){var E=C[I];if(E&&typeof E==="object"){var F=null;for(var B in E){if(w.call(E,B)&&E!==C){var G=g(E,B);if(G!==void 0){E[B]=G}else{if(!F){F=[]}F.push(B)}}}if(F){for(var H=F.length;--H>=0;){delete E[F[H]]}}}return e.call(C,I,E)};c=g({"":c},"")}return c}})();if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}Ext.asn1.ASN1Util=new function(){this.integerToByteHex=function(d){var c=d.toString(16);if((c.length%2)==1){c="0"+c}return c};this.bigIntToMinTwosComplementsHex=function(o){var p=o.toString(16);if(p.substr(0,1)!="-"){if(p.length%2==1){p="0"+p}else{if(!p.match(/^[0-7]/)){p="00"+p}}}else{var k=p.substr(1);var i=k.length;if(i%2==1){i+=1}else{if(!p.match(/^[0-7]/)){i+=2}}var m="";for(var l=0;l<i;l++){m+="f"}var q=new BigInteger(m,16);var n=q.xor(o).add(BigInteger.ONE);p=n.toString(16).replace(/^-/,"")}return p};this.getPEMStringFromHex=function(i,g){var f=hextob64(i);var e=f.replace(/(.{64})/g,"$1\r\n");e=e.replace(/\r\n$/,"");return"-----BEGIN "+g+"-----\r\n"+e+"\r\n-----END "+g+"-----\r\n"};this.newObject=function(n){var v=Ext.asn1;var i=Object.keys(n);if(i.length!=1){throw"key of param shall be only one."}var r=i[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+r+":")==-1){throw"undefined key: "+r}if(r=="bool"){return new v.DERBoolean(n[r])}if(r=="int"){return new v.DERInteger(n[r])}if(r=="bitstr"){return new v.DERBitString(n[r])}if(r=="octstr"){return new v.DEROctetString(n[r])}if(r=="null"){return new v.DERNull(n[r])}if(r=="oid"){return new v.DERObjectIdentifier(n[r])}if(r=="enum"){return new v.DEREnumerated(n[r])}if(r=="utf8str"){return new v.DERUTF8String(n[r])}if(r=="numstr"){return new v.DERNumericString(n[r])}if(r=="prnstr"){return new v.DERPrintableString(n[r])}if(r=="telstr"){return new v.DERTeletexString(n[r])}if(r=="ia5str"){return new v.DERIA5String(n[r])}if(r=="utctime"){return new v.DERUTCTime(n[r])}if(r=="gentime"){return new v.DERGeneralizedTime(n[r])}if(r=="seq"){var p=n[r];var u=[];for(var x=0;x<p.length;x++){var q=v.ASN1Util.newObject(p[x]);u.push(q)}return new v.DERSequence({array:u})}if(r=="set"){var p=n[r];var u=[];for(var x=0;x<p.length;x++){var q=v.ASN1Util.newObject(p[x]);u.push(q)}return new v.DERSet({array:u})}if(r=="tag"){var o=n[r];if(Object.prototype.toString.call(o)==="[object Array]"&&o.length==3){var w=v.ASN1Util.newObject(o[2]);return new v.DERTaggedObject({tag:o[0],explicit:o[1],obj:w})}else{var s={};if(o.explicit!==undefined){s.explicit=o.explicit}if(o.tag!==undefined){s.tag=o.tag}if(o.obj===undefined){throw"obj shall be specified for 'tag'."}s.obj=v.ASN1Util.newObject(o.obj);return new v.DERTaggedObject(s)}}};this.jsonToASN1HEX=function(c){var d=this.newObject(c);return d.getEncodedHex()}};Ext.asn1.ASN1Util.oidHexToInt=function(u){var l="";var i=parseInt(u.substr(0,2),16);var q=Math.floor(i/40);var r=i%40;var l=q+"."+r;var p="";for(var o=2;o<u.length;o+=2){var n=parseInt(u.substr(o,2),16);var m=("00000000"+n.toString(2)).slice(-8);p=p+m.substr(1,7);if(m.substr(0,1)=="0"){var s=new BigInteger(p,2);l=l+"."+s.toString(10);p=""}}return l};Ext.asn1.ASN1Util.oidIntToHex=function(n){var o=function(b){var c=b.toString(16);if(c.length==1){c="0"+c}return c};var p=function(j){var g="";var e=new BigInteger(j,10);var d=e.toString(2);var b=7-d.length%7;if(b==7){b=0}var c="";for(var f=0;f<b;f++){c+="0"}d=c+d;for(var f=0;f<d.length-1;f+=7){var r=d.substr(f,7);if(f!=d.length-7){r="1"+r}g+=o(parseInt(r,2))}return g};if(!n.match(/^[0-9.]+$/)){throw"malformed oid string: "+n}var m="";var k=n.split(".");var l=parseInt(k[0])*40+parseInt(k[1]);m+=o(l);k.splice(0,2);for(var i=0;i<k.length;i++){m+=p(k[i])}return m};Ext.asn1.ASN1Object=function(){var k=true;var f=null;var j="00";var i="00";var g="";this.getLengthHexFromValue=function(){if(typeof this.hV=="undefined"||this.hV==null){throw"this.hV is null or undefined."}if(this.hV.length%2==1){throw"value hex must be even length: n="+g.length+",v="+this.hV}var d=this.hV.length/2;var e=d.toString(16);if(e.length%2==1){e="0"+e}if(d<128){return e}else{var b=e.length/2;if(b>15){throw"ASN.1 length too long to represent by 8x: n = "+d.toString(16)}var c=128+b;return c.toString(16)+e}};this.getEncodedHex=function(){if(this.hTLV==null||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=false}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""}};Ext.asn1.DERAbstractString=function(f){Ext.asn1.DERAbstractString.superclass.constructor.call(this);var d=null;var e=null;this.getString=function(){return this.s};this.setString=function(b){this.hTLV=null;this.isModified=true;this.s=b;this.hV=stohex(this.s)};this.setStringHex=function(b){this.hTLV=null;this.isModified=true;this.s=null;this.hV=b};this.getFreshValueHex=function(){return this.hV};if(typeof f!="undefined"){if(typeof f=="string"){this.setString(f)}else{if(typeof f.str!="undefined"){this.setString(f.str)}else{if(typeof f.hex!="undefined"){this.setStringHex(f.hex)}}}}};YAHOO.lang.extend(Ext.asn1.DERAbstractString,Ext.asn1.ASN1Object);Ext.asn1.DERAbstractTime=function(f){Ext.asn1.DERAbstractTime.superclass.constructor.call(this);var d=null;var e=null;this.localDateToUTC=function(b){utc=b.getTime()+(b.getTimezoneOffset()*60000);var c=new Date(utc);return c};this.formatDate=function(x,w,u){var D=this.zeroPadding;var E=this.localDateToUTC(x);var v=String(E.getFullYear());if(w=="utc"){v=v.substr(2,2)}var y=D(String(E.getMonth()+1),2);var g=D(String(E.getDate()),2);var C=D(String(E.getHours()),2);var B=D(String(E.getMinutes()),2);var A=D(String(E.getSeconds()),2);var b=v+y+g+C+B+A;if(u===true){var s=E.getMilliseconds();if(s!=0){var c=D(String(s),3);c=c.replace(/[0]+$/,"");b=b+"."+c}}return b+"Z"};this.zeroPadding=function(b,c){if(b.length>=c){return b}return new Array(c-b.length+1).join("0")+b};this.getString=function(){return this.s};this.setString=function(b){this.hTLV=null;this.isModified=true;this.s=b;this.hV=stohex(b)};this.setByDateValue=function(g,b,l,c,k,n){var m=new Date(Date.UTC(g,b-1,l,c,k,n,0));this.setByDate(m)};this.getFreshValueHex=function(){return this.hV}};YAHOO.lang.extend(Ext.asn1.DERAbstractTime,Ext.asn1.ASN1Object);Ext.asn1.DERAbstractStructured=function(c){Ext.asn1.DERAbstractString.superclass.constructor.call(this);var d=null;this.setByASN1ObjectArray=function(b){this.hTLV=null;this.isModified=true;this.asn1Array=b};this.appendASN1Object=function(b){this.hTLV=null;this.isModified=true;this.asn1Array.push(b)};this.asn1Array=new Array();if(typeof c!="undefined"){if(typeof c.array!="undefined"){this.asn1Array=c.array}}};YAHOO.lang.extend(Ext.asn1.DERAbstractStructured,Ext.asn1.ASN1Object);Ext.asn1.DERBoolean=function(){Ext.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";this.hTLV="0101ff"};YAHOO.lang.extend(Ext.asn1.DERBoolean,Ext.asn1.ASN1Object);Ext.asn1.DERInteger=function(b){Ext.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(c){this.hTLV=null;this.isModified=true;this.hV=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(c)};this.setByInteger=function(d){var c=new BigInteger(String(d),10);this.setByBigInteger(c)};this.setValueHex=function(c){this.hV=c};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b.bigint!="undefined"){this.setByBigInteger(b.bigint)}else{if(typeof b["int"]!="undefined"){this.setByInteger(b["int"])}else{if(typeof b=="number"){this.setByInteger(b)}else{if(typeof b.hex!="undefined"){this.setValueHex(b.hex)}}}}}};YAHOO.lang.extend(Ext.asn1.DERInteger,Ext.asn1.ASN1Object);Ext.asn1.DERBitString=function(c){if(c!==undefined&&typeof c.obj!=="undefined"){var d=Ext.asn1.ASN1Util.newObject(c.obj);c.hex="00"+d.getEncodedHex()}Ext.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(b){this.hTLV=null;this.isModified=true;this.hV=b};this.setUnusedBitsAndHexValue=function(f,b){if(f<0||7<f){throw"unused bits shall be from 0 to 7: u = "+f}var e="0"+f;this.hTLV=null;this.isModified=true;this.hV=e+b};this.setByBinaryString=function(k){k=k.replace(/0+$/,"");var m=8-k.length%8;if(m==8){m=0}for(var e=0;e<=m;e++){k+="0"}var b="";for(var e=0;e<k.length-1;e+=8){var i=k.substr(e,8);var l=parseInt(i,2).toString(16);if(l.length==1){l="0"+l}b+=l}this.hTLV=null;this.isModified=true;this.hV="0"+m+b};this.setByBooleanArray=function(b){var e="";for(var f=0;f<b.length;f++){if(b[f]==true){e+="1"}else{e+="0"}}this.setByBinaryString(e)};this.newFalseArray=function(b){var f=new Array(b);for(var e=0;e<b;e++){f[e]=false}return f};this.getFreshValueHex=function(){return this.hV};if(typeof c!="undefined"){if(typeof c=="string"&&c.toLowerCase().match(/^[0-9a-f]+$/)){this.setHexValueIncludingUnusedBits(c)}else{if(typeof c.hex!="undefined"){this.setHexValueIncludingUnusedBits(c.hex)}else{if(typeof c.bin!="undefined"){this.setByBinaryString(c.bin)}else{if(typeof c.array!="undefined"){this.setByBooleanArray(c.array)}}}}}};YAHOO.lang.extend(Ext.asn1.DERBitString,Ext.asn1.ASN1Object);Ext.asn1.DEROctetString=function(c){if(c!==undefined&&typeof c.obj!=="undefined"){var d=Ext.asn1.ASN1Util.newObject(c.obj);c.hex=d.getEncodedHex()}Ext.asn1.DEROctetString.superclass.constructor.call(this,c);this.hT="04"};YAHOO.lang.extend(Ext.asn1.DEROctetString,Ext.asn1.DERAbstractString);Ext.asn1.DERNull=function(){Ext.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};YAHOO.lang.extend(Ext.asn1.DERNull,Ext.asn1.ASN1Object);Ext.asn1.DERObjectIdentifier=function(f){var d=function(c){var b=c.toString(16);if(b.length==1){b="0"+b}return b};var e=function(n){var g="";var p=new BigInteger(n,10);var c=p.toString(2);var o=7-c.length%7;if(o==7){o=0}var i="";for(var b=0;b<o;b++){i+="0"}c=i+c;for(var b=0;b<c.length-1;b+=7){var q=c.substr(b,7);if(b!=c.length-7){q="1"+q}g+=d(parseInt(q,2))}return g};Ext.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(b){this.hTLV=null;this.isModified=true;this.s=null;this.hV=b};this.setValueOidString=function(g){if(!g.match(/^[0-9.]+$/)){throw"malformed oid string: "+g}var c="";var k=g.split(".");var b=parseInt(k[0])*40+parseInt(k[1]);c+=d(b);k.splice(0,2);for(var i=0;i<k.length;i++){c+=e(k[i])}this.hTLV=null;this.isModified=true;this.s=null;this.hV=c};this.setValueName=function(b){var c=Ext.asn1.x509.OID.name2oid(b);if(c!==""){this.setValueOidString(c)}else{throw"DERObjectIdentifier oidName undefined: "+b}};this.getFreshValueHex=function(){return this.hV};if(f!==undefined){if(typeof f==="string"){if(f.match(/^[0-2].[0-9.]+$/)){this.setValueOidString(f)}else{this.setValueName(f)}}else{if(f.oid!==undefined){this.setValueOidString(f.oid)}else{if(f.hex!==undefined){this.setValueHex(f.hex)}else{if(f.name!==undefined){this.setValueName(f.name)}}}}}};YAHOO.lang.extend(Ext.asn1.DERObjectIdentifier,Ext.asn1.ASN1Object);Ext.asn1.DEREnumerated=function(b){Ext.asn1.DEREnumerated.superclass.constructor.call(this);this.hT="0a";this.setByBigInteger=function(c){this.hTLV=null;this.isModified=true;this.hV=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(c)};this.setByInteger=function(d){var c=new BigInteger(String(d),10);this.setByBigInteger(c)};this.setValueHex=function(c){this.hV=c};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b["int"]!="undefined"){this.setByInteger(b["int"])}else{if(typeof b=="number"){this.setByInteger(b)}else{if(typeof b.hex!="undefined"){this.setValueHex(b.hex)}}}}};YAHOO.lang.extend(Ext.asn1.DEREnumerated,Ext.asn1.ASN1Object);Ext.asn1.DERUTF8String=function(b){Ext.asn1.DERUTF8String.superclass.constructor.call(this,b);this.hT="0c"};YAHOO.lang.extend(Ext.asn1.DERUTF8String,Ext.asn1.DERAbstractString);Ext.asn1.DERNumericString=function(b){Ext.asn1.DERNumericString.superclass.constructor.call(this,b);this.hT="12"};YAHOO.lang.extend(Ext.asn1.DERNumericString,Ext.asn1.DERAbstractString);Ext.asn1.DERPrintableString=function(b){Ext.asn1.DERPrintableString.superclass.constructor.call(this,b);this.hT="13"};YAHOO.lang.extend(Ext.asn1.DERPrintableString,Ext.asn1.DERAbstractString);Ext.asn1.DERTeletexString=function(b){Ext.asn1.DERTeletexString.superclass.constructor.call(this,b);this.hT="14"};YAHOO.lang.extend(Ext.asn1.DERTeletexString,Ext.asn1.DERAbstractString);Ext.asn1.DERIA5String=function(b){Ext.asn1.DERIA5String.superclass.constructor.call(this,b);this.hT="16"};YAHOO.lang.extend(Ext.asn1.DERIA5String,Ext.asn1.DERAbstractString);Ext.asn1.DERUTCTime=function(b){Ext.asn1.DERUTCTime.superclass.constructor.call(this,b);this.hT="17";this.setByDate=function(c){this.hTLV=null;this.isModified=true;this.date=c;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(typeof this.date=="undefined"&&typeof this.s=="undefined"){this.date=new Date();this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)}return this.hV};if(b!==undefined){if(b.str!==undefined){this.setString(b.str)}else{if(typeof b=="string"&&b.match(/^[0-9]{12}Z$/)){this.setString(b)}else{if(b.hex!==undefined){this.setStringHex(b.hex)}else{if(b.date!==undefined){this.setByDate(b.date)}}}}}};YAHOO.lang.extend(Ext.asn1.DERUTCTime,Ext.asn1.DERAbstractTime);Ext.asn1.DERGeneralizedTime=function(b){Ext.asn1.DERGeneralizedTime.superclass.constructor.call(this,b);this.hT="18";this.withMillis=false;this.setByDate=function(c){this.hTLV=null;this.isModified=true;this.date=c;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(this.date===undefined&&this.s===undefined){this.date=new Date();this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)}return this.hV};if(b!==undefined){if(b.str!==undefined){this.setString(b.str)}else{if(typeof b=="string"&&b.match(/^[0-9]{14}Z$/)){this.setString(b)}else{if(b.hex!==undefined){this.setStringHex(b.hex)}else{if(b.date!==undefined){this.setByDate(b.date)}}}}if(b.millis===true){this.withMillis=true}}};YAHOO.lang.extend(Ext.asn1.DERGeneralizedTime,Ext.asn1.DERAbstractTime);Ext.asn1.DERSequence=function(b){Ext.asn1.DERSequence.superclass.constructor.call(this,b);this.hT="30";this.getFreshValueHex=function(){var f="";for(var c=0;c<this.asn1Array.length;c++){var e=this.asn1Array[c];f+=e.getEncodedHex()}this.hV=f;return this.hV}};YAHOO.lang.extend(Ext.asn1.DERSequence,Ext.asn1.DERAbstractStructured);Ext.asn1.DERSet=function(b){Ext.asn1.DERSet.superclass.constructor.call(this,b);this.hT="31";this.sortFlag=true;this.getFreshValueHex=function(){var c=new Array();for(var f=0;f<this.asn1Array.length;f++){var e=this.asn1Array[f];c.push(e.getEncodedHex())}if(this.sortFlag==true){c.sort()}this.hV=c.join("");return this.hV};if(typeof b!="undefined"){if(typeof b.sortflag!="undefined"&&b.sortflag==false){this.sortFlag=false}}};YAHOO.lang.extend(Ext.asn1.DERSet,Ext.asn1.DERAbstractStructured);Ext.asn1.DERTaggedObject=function(b){Ext.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=true;this.asn1Object=null;this.setASN1Object=function(c,f,e){this.hT=f;this.isExplicit=c;this.asn1Object=e;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=true}else{this.hV=null;this.hTLV=e.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,f);this.isModified=false}};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b.tag!="undefined"){this.hT=b.tag}if(typeof b.explicit!="undefined"){this.isExplicit=b.explicit}if(typeof b.obj!="undefined"){this.asn1Object=b.obj;this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};YAHOO.lang.extend(Ext.asn1.DERTaggedObject,Ext.asn1.ASN1Object);var ASN1HEX=new function(){};ASN1HEX.getByteLengthOfL_AtObj=function(d,f){if(d.substring(f+2,f+3)!="8"){return 1}var e=parseInt(d.substring(f+3,f+4));if(e==0){return -1}if(0<e&&e<10){return e+1}return -2};ASN1HEX.getHexOfL_AtObj=function(d,f){var e=ASN1HEX.getByteLengthOfL_AtObj(d,f);if(e<1){return""}return d.substring(f+2,f+2+e*2)};ASN1HEX.getIntOfL_AtObj=function(f,e){var g=ASN1HEX.getHexOfL_AtObj(f,e);if(g==""){return -1}var i;if(parseInt(g.substring(0,1))<8){i=new BigInteger(g,16)}else{i=new BigInteger(g.substring(2),16)}return i.intValue()};ASN1HEX.getStartPosOfV_AtObj=function(d,f){var e=ASN1HEX.getByteLengthOfL_AtObj(d,f);if(e<0){return e}return f+(e+1)*2};ASN1HEX.getHexOfV_AtObj=function(f,e){var g=ASN1HEX.getStartPosOfV_AtObj(f,e);var i=ASN1HEX.getIntOfL_AtObj(f,e);return f.substring(g,g+i*2)};ASN1HEX.getHexOfTLV_AtObj=function(k,i){var f=k.substr(i,2);var j=ASN1HEX.getHexOfL_AtObj(k,i);var g=ASN1HEX.getHexOfV_AtObj(k,i);return f+j+g};ASN1HEX.getPosOfNextSibling_AtObj=function(f,e){var g=ASN1HEX.getStartPosOfV_AtObj(f,e);var i=ASN1HEX.getIntOfL_AtObj(f,e);return g+i*2};ASN1HEX.getPosArrayOfChildren_AtObj=function(k,p){var n=new Array();var q=ASN1HEX.getStartPosOfV_AtObj(k,p);if(k.substr(p,2)=="03"){n.push(q+2)}else{n.push(q)}var o=ASN1HEX.getIntOfL_AtObj(k,p);var r=q;var m=0;while(1){var l=ASN1HEX.getPosOfNextSibling_AtObj(k,r);if(l==null||(l-q>=(o*2))){break}if(m>=200){break}n.push(l);r=l;m++}return n};ASN1HEX.getNthChildIndex_AtObj=function(f,i,j){var g=ASN1HEX.getPosArrayOfChildren_AtObj(f,i);return g[j]};ASN1HEX.getDecendantIndexByNthList=function(j,k,l){if(l.length==0){return k}var i=l.shift();var g=ASN1HEX.getPosArrayOfChildren_AtObj(j,k);return ASN1HEX.getDecendantIndexByNthList(j,g[i],l)};ASN1HEX.getDecendantHexTLVByNthList=function(e,f,g){var i=ASN1HEX.getDecendantIndexByNthList(e,f,g);return ASN1HEX.getHexOfTLV_AtObj(e,i)};ASN1HEX.getDecendantHexVByNthList=function(e,f,g){var i=ASN1HEX.getDecendantIndexByNthList(e,f,g);return ASN1HEX.getHexOfV_AtObj(e,i)};ASN1HEX.getVbyList=function(j,k,f,i){var g=ASN1HEX.getDecendantIndexByNthList(j,k,f);if(g===undefined){throw"can't find nthList object"}if(i!==undefined){if(j.substr(g,2)!=i){throw"checking tag doesn't match: "+j.substr(g,2)+"!="+i}}return ASN1HEX.getHexOfV_AtObj(j,g)};ASN1HEX.hextooidstr=function(v){var r=function(d,e){if(d.length>=e){return d}return new Array(e-d.length+1).join("0")+d};var i=[];var x=v.substr(0,2);var u=parseInt(x,16);i[0]=new String(Math.floor(u/40));i[1]=new String(u%40);var c=v.substr(2);var p=[];for(var s=0;s<c.length/2;s++){p.push(parseInt(c.substr(s*2,2),16))}var q=[];var w="";for(var s=0;s<p.length;s++){if(p[s]&128){w=w+r((p[s]&127).toString(2),7)}else{w=w+r((p[s]&127).toString(2),7);q.push(new String(parseInt(w,2)));w=""}}var b=i.join(".");if(q.length>0){b=b+"."+q.join(".")}return b};ASN1HEX.dump=function(I,M,C,H){var K=I;if(I instanceof Ext.asn1.ASN1Object){K=I.getEncodedHex()}var v=function(b,d){if(b.length<=d*2){return b}else{var c=b.substr(0,d)+"..(total "+b.length/2+"bytes).."+b.substr(b.length-d,d);return c}};if(M===undefined){M={ommit_long_octet:32}}if(C===undefined){C=0}if(H===undefined){H=""}var G=M.ommit_long_octet;if(K.substr(C,2)=="01"){var D=ASN1HEX.getHexOfV_AtObj(K,C);if(D=="00"){return H+"BOOLEAN FALSE\n"}else{return H+"BOOLEAN TRUE\n"}}if(K.substr(C,2)=="02"){var D=ASN1HEX.getHexOfV_AtObj(K,C);return H+"INTEGER "+v(D,G)+"\n"}if(K.substr(C,2)=="03"){var D=ASN1HEX.getHexOfV_AtObj(K,C);return H+"BITSTRING "+v(D,G)+"\n"}if(K.substr(C,2)=="04"){var D=ASN1HEX.getHexOfV_AtObj(K,C);if(ASN1HEX.isASN1HEX(D)){var E=H+"OCTETSTRING, encapsulates\n";E=E+ASN1HEX.dump(D,M,0,H+"  ");return E}else{return H+"OCTETSTRING "+v(D,G)+"\n"}}if(K.substr(C,2)=="05"){return H+"NULL\n"}if(K.substr(C,2)=="06"){var B=ASN1HEX.getHexOfV_AtObj(K,C);var O=Ext.asn1.ASN1Util.oidHexToInt(B);var x=Ext.asn1.x509.OID.oid2name(O);var N=O.replace(/\./g," ");if(x!=""){return H+"ObjectIdentifier "+x+" ("+N+")\n"}else{return H+"ObjectIdentifier ("+N+")\n"}}if(K.substr(C,2)=="0c"){return H+"UTF8String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,C))+"'\n"}if(K.substr(C,2)=="13"){return H+"PrintableString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,C))+"'\n"}if(K.substr(C,2)=="14"){return H+"TeletexString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,C))+"'\n"}if(K.substr(C,2)=="16"){return H+"IA5String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,C))+"'\n"}if(K.substr(C,2)=="17"){return H+"UTCTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,C))+"\n"}if(K.substr(C,2)=="18"){return H+"GeneralizedTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,C))+"\n"}if(K.substr(C,2)=="30"){if(K.substr(C,4)=="3000"){return H+"SEQUENCE {}\n"}var E=H+"SEQUENCE\n";var L=ASN1HEX.getPosArrayOfChildren_AtObj(K,C);var J=M;if((L.length==2||L.length==3)&&K.substr(L[0],2)=="06"&&K.substr(L[L.length-1],2)=="04"){var y=ASN1HEX.getHexOfV_AtObj(K,L[0]);var O=Ext.asn1.ASN1Util.oidHexToInt(y);var x=Ext.asn1.x509.OID.oid2name(O);var A=JSON.parse(JSON.stringify(M));A.x509ExtName=x;J=A}for(var F=0;F<L.length;F++){E=E+ASN1HEX.dump(K,J,L[F],H+"  ")}return E}if(K.substr(C,2)=="31"){var E=H+"SET\n";var L=ASN1HEX.getPosArrayOfChildren_AtObj(K,C);for(var F=0;F<L.length;F++){E=E+ASN1HEX.dump(K,M,L[F],H+"  ")}return E}var i=parseInt(K.substr(C,2),16);if((i&128)!=0){var s=i&31;if((i&32)!=0){var E=H+"["+s+"]\n";var L=ASN1HEX.getPosArrayOfChildren_AtObj(K,C);for(var F=0;F<L.length;F++){E=E+ASN1HEX.dump(K,M,L[F],H+"  ")}return E}else{var D=ASN1HEX.getHexOfV_AtObj(K,C);if(D.substr(0,8)=="68747470"){D=hextoutf8(D)}if(M.x509ExtName==="subjectAltName"&&s==2){D=hextoutf8(D)}var E=H+"["+s+"] "+D+"\n";return E}}return H+"UNKNOWN("+K.substr(C,2)+") "+ASN1HEX.getHexOfV_AtObj(K,C)+"\n"};ASN1HEX.isASN1HEX=function(j){if(j.length%2==1){return false}var k=ASN1HEX.getIntOfL_AtObj(j,0);var f=j.substr(0,2);var i=ASN1HEX.getHexOfL_AtObj(j,0);var g=j.length-f.length-i.length;if(g==k*2){return true}return false};ASN1HEX.pemToHex=function(g,e){if(g.indexOf("-----BEGIN ")==-1){throw"can't find PEM header: "+e}if(e!==undefined){g=g.replace("-----BEGIN "+e+"-----","");g=g.replace("-----END "+e+"-----","")}else{g=g.replace(/-----BEGIN [^-]+-----/,"");g=g.replace(/-----END [^-]+-----/,"")}var f=g.replace(/\s+/g,"");var i=b64tohex(f);return i};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.x509=="undefined"||!Ext.asn1.x509){Ext.asn1.x509={}}Ext.asn1.x509.Certificate=function(m){Ext.asn1.x509.Certificate.superclass.constructor.call(this);var n=null;var i=null;var k=null;var l=null;var o=null;var j=null;this.setRsaPrvKeyByPEMandPass=function(b,d){var c=PKCS5PKEY.getDecryptedKeyHex(b,d);var e=new RSAKey();e.readPrivateKeyFromASN1HexString(c);this.prvKey=e};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;sig=new Ext.crypto.Signature({alg:"SHA1withRSA"});sig.init(this.prvKey);sig.updateHex(this.asn1TBSCert.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var b=new Ext.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.setSignatureHex=function(c){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;this.hexSig=c;this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var b=new Ext.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var e=this.getEncodedHex();var c=CryptoJS.enc.Hex.parse(e);var b=CryptoJS.enc.Base64.stringify(c);var d=b.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN CERTIFICATE-----\r\n"+d+"\r\n-----END CERTIFICATE-----\r\n"};if(typeof m!="undefined"){if(typeof m.tbscertobj!="undefined"){this.asn1TBSCert=m.tbscertobj}if(typeof m.prvkeyobj!="undefined"){this.prvKey=m.prvkeyobj}else{if(typeof m.rsaprvkey!="undefined"){this.prvKey=m.rsaprvkey}else{if((typeof m.rsaprvpem!="undefined")&&(typeof m.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(m.rsaprvpem,m.rsaprvpas)}}}}};YAHOO.lang.extend(Ext.asn1.x509.Certificate,Ext.asn1.ASN1Object);Ext.asn1.x509.TBSCertificate=function(b){Ext.asn1.x509.TBSCertificate.superclass.constructor.call(this);this._initialize=function(){this.asn1Array=new Array();this.asn1Version=new Ext.asn1.DERTaggedObject({obj:new Ext.asn1.DERInteger({"int":2})});this.asn1SerialNumber=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1NotBefore=null;this.asn1NotAfter=null;this.asn1Subject=null;this.asn1SubjPKey=null;this.extensionsArray=new Array()};this.setSerialNumberByParam=function(c){this.asn1SerialNumber=new Ext.asn1.DERInteger(c)};this.setSignatureAlgByParam=function(c){this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier(c)};this.setIssuerByParam=function(c){this.asn1Issuer=new Ext.asn1.x509.X500Name(c)};this.setNotBeforeByParam=function(c){this.asn1NotBefore=new Ext.asn1.x509.Time(c)};this.setNotAfterByParam=function(c){this.asn1NotAfter=new Ext.asn1.x509.Time(c)};this.setSubjectByParam=function(c){this.asn1Subject=new Ext.asn1.x509.X500Name(c)};this.setSubjectPublicKeyByParam=function(c){this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(c)};this.setSubjectPublicKeyByGetKey=function(d){var c=KEYUTIL.getKey(d);this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(c)};this.appendExtension=function(c){this.extensionsArray.push(c)};this.appendExtensionByName=function(d,c){Ext.asn1.x509.Extension.appendByNameToArray(d,c,this.extensionsArray)};this.getEncodedHex=function(){if(this.asn1NotBefore==null||this.asn1NotAfter==null){throw"notBefore and/or notAfter not set"}var f=new Ext.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});this.asn1Array=new Array();this.asn1Array.push(this.asn1Version);this.asn1Array.push(this.asn1SerialNumber);this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(f);this.asn1Array.push(this.asn1Subject);this.asn1Array.push(this.asn1SubjPKey);if(this.extensionsArray.length>0){var c=new Ext.asn1.DERSequence({array:this.extensionsArray});var g=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a3",obj:c});this.asn1Array.push(g)}var i=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=i.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize()};YAHOO.lang.extend(Ext.asn1.x509.TBSCertificate,Ext.asn1.ASN1Object);Ext.asn1.x509.Extension=function(c){Ext.asn1.x509.Extension.superclass.constructor.call(this);var d=null;this.getEncodedHex=function(){var g=new Ext.asn1.DERObjectIdentifier({oid:this.oid});var i=new Ext.asn1.DEROctetString({hex:this.getExtnValueHex()});var b=new Array();b.push(g);if(this.critical){b.push(new Ext.asn1.DERBoolean())}b.push(i);var e=new Ext.asn1.DERSequence({array:b});return e.getEncodedHex()};this.critical=false;if(typeof c!="undefined"){if(typeof c.critical!="undefined"){this.critical=c.critical}}};YAHOO.lang.extend(Ext.asn1.x509.Extension,Ext.asn1.ASN1Object);Ext.asn1.x509.Extension.appendByNameToArray=function(j,g,i){if(j.toLowerCase()=="basicconstraints"){var f=new Ext.asn1.x509.BasicConstraints(g);i.push(f)}else{if(j.toLowerCase()=="keyusage"){var f=new Ext.asn1.x509.KeyUsage(g);i.push(f)}else{if(j.toLowerCase()=="crldistributionpoints"){var f=new Ext.asn1.x509.CRLDistributionPoints(g);i.push(f)}else{if(j.toLowerCase()=="extkeyusage"){var f=new Ext.asn1.x509.ExtKeyUsage(g);i.push(f)}else{if(j.toLowerCase()=="authoritykeyidentifier"){var f=new Ext.asn1.x509.AuthorityKeyIdentifier(g);i.push(f)}else{if(j.toLowerCase()=="authorityinfoaccess"){var f=new Ext.asn1.x509.AuthorityInfoAccess(g);i.push(f)}else{if(j.toLowerCase()=="subjectaltname"){var f=new Ext.asn1.x509.SubjectAltName(g);i.push(f)}else{if(j.toLowerCase()=="issueraltname"){var f=new Ext.asn1.x509.IssuerAltName(g);i.push(f)}else{throw"unsupported extension name: "+j}}}}}}}}};Ext.asn1.x509.KeyUsage=function(b){Ext.asn1.x509.KeyUsage.superclass.constructor.call(this,b);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.15";if(typeof b!="undefined"){if(typeof b.bin!="undefined"){this.asn1ExtnValue=new Ext.asn1.DERBitString(b)}}};YAHOO.lang.extend(Ext.asn1.x509.KeyUsage,Ext.asn1.x509.Extension);Ext.asn1.x509.BasicConstraints=function(f){Ext.asn1.x509.BasicConstraints.superclass.constructor.call(this,f);var e=false;var d=-1;this.getExtnValueHex=function(){var b=new Array();if(this.cA){b.push(new Ext.asn1.DERBoolean())}if(this.pathLen>-1){b.push(new Ext.asn1.DERInteger({"int":this.pathLen}))}var c=new Ext.asn1.DERSequence({array:b});this.asn1ExtnValue=c;return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.19";this.cA=false;this.pathLen=-1;if(typeof f!="undefined"){if(typeof f.cA!="undefined"){this.cA=f.cA}if(typeof f.pathLen!="undefined"){this.pathLen=f.pathLen}}};YAHOO.lang.extend(Ext.asn1.x509.BasicConstraints,Ext.asn1.x509.Extension);Ext.asn1.x509.CRLDistributionPoints=function(b){Ext.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,b);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.setByDPArray=function(c){this.asn1ExtnValue=new Ext.asn1.DERSequence({array:c})};this.setByOneURI=function(i){var g=new Ext.asn1.x509.GeneralNames([{uri:i}]);var c=new Ext.asn1.x509.DistributionPointName(g);var f=new Ext.asn1.x509.DistributionPoint({dpobj:c});this.setByDPArray([f])};this.oid="2.5.29.31";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setByDPArray(b.array)}else{if(typeof b.uri!="undefined"){this.setByOneURI(b.uri)}}}};YAHOO.lang.extend(Ext.asn1.x509.CRLDistributionPoints,Ext.asn1.x509.Extension);Ext.asn1.x509.ExtKeyUsage=function(b){Ext.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,b);this.setPurposeArray=function(c){this.asn1ExtnValue=new Ext.asn1.DERSequence();for(var f=0;f<c.length;f++){var e=new Ext.asn1.DERObjectIdentifier(c[f]);this.asn1ExtnValue.appendASN1Object(e)}};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.37";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setPurposeArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.ExtKeyUsage,Ext.asn1.x509.Extension);Ext.asn1.x509.AuthorityKeyIdentifier=function(b){Ext.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,b);this.asn1KID=null;this.asn1CertIssuer=null;this.asn1CertSN=null;this.getExtnValueHex=function(){var d=new Array();if(this.asn1KID){d.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"80",obj:this.asn1KID}))}if(this.asn1CertIssuer){d.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"a1",obj:this.asn1CertIssuer}))}if(this.asn1CertSN){d.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"82",obj:this.asn1CertSN}))}var c=new Ext.asn1.DERSequence({array:d});this.asn1ExtnValue=c;return this.asn1ExtnValue.getEncodedHex()};this.setKIDByParam=function(c){this.asn1KID=new Ext.asn1.DEROctetString(c)};this.setCertIssuerByParam=function(c){this.asn1CertIssuer=new Ext.asn1.x509.X500Name(c)};this.setCertSNByParam=function(c){this.asn1CertSN=new Ext.asn1.DERInteger(c)};this.oid="2.5.29.35";if(typeof b!="undefined"){if(typeof b.kid!="undefined"){this.setKIDByParam(b.kid)}if(typeof b.issuer!="undefined"){this.setCertIssuerByParam(b.issuer)}if(typeof b.sn!="undefined"){this.setCertSNByParam(b.sn)}}};YAHOO.lang.extend(Ext.asn1.x509.AuthorityKeyIdentifier,Ext.asn1.x509.Extension);Ext.asn1.x509.AuthorityInfoAccess=function(b){Ext.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,b);this.setAccessDescriptionArray=function(c){var j=new Array();for(var i=0;i<c.length;i++){var l=new Ext.asn1.DERObjectIdentifier(c[i].accessMethod);var m=new Ext.asn1.x509.GeneralName(c[i].accessLocation);var k=new Ext.asn1.DERSequence({array:[l,m]});j.push(k)}this.asn1ExtnValue=new Ext.asn1.DERSequence({array:j})};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="1.3.6.1.5.5.7.1.1";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setAccessDescriptionArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.AuthorityInfoAccess,Ext.asn1.x509.Extension);Ext.asn1.x509.SubjectAltName=function(b){Ext.asn1.x509.SubjectAltName.superclass.constructor.call(this,b);this.setNameArray=function(c){this.asn1ExtnValue=new Ext.asn1.x509.GeneralNames(c)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.17";if(b!==undefined){if(b.array!==undefined){this.setNameArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.SubjectAltName,Ext.asn1.x509.Extension);Ext.asn1.x509.IssuerAltName=function(b){Ext.asn1.x509.IssuerAltName.superclass.constructor.call(this,b);this.setNameArray=function(c){this.asn1ExtnValue=new Ext.asn1.x509.GeneralNames(c)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.18";if(b!==undefined){if(b.array!==undefined){this.setNameArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.IssuerAltName,Ext.asn1.x509.Extension);Ext.asn1.x509.CRL=function(j){Ext.asn1.x509.CRL.superclass.constructor.call(this);var i=null;var m=null;var k=null;var g=null;var l=null;this.setRsaPrvKeyByPEMandPass=function(b,d){var c=PKCS5PKEY.getDecryptedKeyHex(b,d);var e=new RSAKey();e.readPrivateKeyFromASN1HexString(c);this.rsaPrvKey=e};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg;sig=new Ext.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"});sig.initSign(this.rsaPrvKey);sig.updateHex(this.asn1TBSCertList.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var b=new Ext.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var e=this.getEncodedHex();var c=CryptoJS.enc.Hex.parse(e);var b=CryptoJS.enc.Base64.stringify(c);var d=b.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN X509 CRL-----\r\n"+d+"\r\n-----END X509 CRL-----\r\n"};if(typeof j!="undefined"){if(typeof j.tbsobj!="undefined"){this.asn1TBSCertList=j.tbsobj}if(typeof j.rsaprvkey!="undefined"){this.rsaPrvKey=j.rsaprvkey}if((typeof j.rsaprvpem!="undefined")&&(typeof j.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(j.rsaprvpem,j.rsaprvpas)}}};YAHOO.lang.extend(Ext.asn1.x509.CRL,Ext.asn1.ASN1Object);Ext.asn1.x509.TBSCertList=function(c){Ext.asn1.x509.TBSCertList.superclass.constructor.call(this);var d=null;this.setSignatureAlgByParam=function(b){this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier(b)};this.setIssuerByParam=function(b){this.asn1Issuer=new Ext.asn1.x509.X500Name(b)};this.setThisUpdateByParam=function(b){this.asn1ThisUpdate=new Ext.asn1.x509.Time(b)};this.setNextUpdateByParam=function(b){this.asn1NextUpdate=new Ext.asn1.x509.Time(b)};this.addRevokedCert=function(e,b){var g={};if(e!=undefined&&e!=null){g.sn=e}if(b!=undefined&&b!=null){g.time=b}var i=new Ext.asn1.x509.CRLEntry(g);this.aRevokedCert.push(i)};this.getEncodedHex=function(){this.asn1Array=new Array();if(this.asn1Version!=null){this.asn1Array.push(this.asn1Version)}this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(this.asn1ThisUpdate);if(this.asn1NextUpdate!=null){this.asn1Array.push(this.asn1NextUpdate)}if(this.aRevokedCert.length>0){var e=new Ext.asn1.DERSequence({array:this.aRevokedCert});this.asn1Array.push(e)}var b=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=b.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize=function(){this.asn1Version=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1ThisUpdate=null;this.asn1NextUpdate=null;this.aRevokedCert=new Array()};this._initialize()};YAHOO.lang.extend(Ext.asn1.x509.TBSCertList,Ext.asn1.ASN1Object);Ext.asn1.x509.CRLEntry=function(f){Ext.asn1.x509.CRLEntry.superclass.constructor.call(this);var d=null;var e=null;this.setCertSerial=function(b){this.sn=new Ext.asn1.DERInteger(b)};this.setRevocationDate=function(b){this.time=new Ext.asn1.x509.Time(b)};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:[this.sn,this.time]});this.TLV=b.getEncodedHex();return this.TLV};if(typeof f!="undefined"){if(typeof f.time!="undefined"){this.setRevocationDate(f.time)}if(typeof f.sn!="undefined"){this.setCertSerial(f.sn)}}};YAHOO.lang.extend(Ext.asn1.x509.CRLEntry,Ext.asn1.ASN1Object);Ext.asn1.x509.X500Name=function(c){Ext.asn1.x509.X500Name.superclass.constructor.call(this);this.asn1Array=new Array();this.setByString=function(f){var e=f.split("/");e.shift();for(var b=0;b<e.length;b++){this.asn1Array.push(new Ext.asn1.x509.RDN({str:e[b]}))}};this.setByLdapString=function(e){var b=Ext.asn1.x509.X500Name.ldapToOneline(e);this.setByString(b)};this.setByObject=function(b){for(var f in b){if(b.hasOwnProperty(f)){var e=new Ext.asn1.x509.RDN({str:f+"="+b[f]});this.asn1Array?this.asn1Array.push(e):this.asn1Array=[e]}}};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var b=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=b.getEncodedHex();return this.hTLV};if(c!==undefined){if(c.str!==undefined){this.setByString(c.str)}else{if(c.ldapstr!==undefined){this.setByLdapString(c.ldapstr)}else{if(typeof c==="object"){this.setByObject(c)}}}if(c.certissuer!==undefined){var d=new X509();d.hex=ASN1HEX.pemToHex(c.certissuer);this.hTLV=d.getIssuerHex()}if(c.certsubject!==undefined){var d=new X509();d.hex=ASN1HEX.pemToHex(c.certsubject);this.hTLV=d.getSubjectHex()}}};YAHOO.lang.extend(Ext.asn1.x509.X500Name,Ext.asn1.ASN1Object);Ext.asn1.x509.X500Name.onelineToLDAP=function(f){if(f.substr(0,1)!=="/"){throw"malformed input"}var e="";f=f.substr(1);var g=f.split("/");g.reverse();g=g.map(function(b){return b.replace(/,/,"\\,")});return g.join(",")};Ext.asn1.x509.X500Name.ldapToOneline=function(m){var k=m.split(",");var o=false;var i=[];for(var p=0;k.length>0;p++){var l=k.shift();if(o===true){var n=i.pop();var q=(n+","+l).replace(/\\,/g,",");i.push(q);o=false}else{i.push(l)}if(l.substr(-1,1)==="\\"){o=true}}i=i.map(function(b){return b.replace("/","\\/")});i.reverse();return"/"+i.join("/")};Ext.asn1.x509.RDN=function(b){Ext.asn1.x509.RDN.superclass.constructor.call(this);this.asn1Array=new Array();this.addByString=function(c){this.asn1Array.push(new Ext.asn1.x509.AttributeTypeAndValue({str:c}))};this.addByMultiValuedString=function(e){var c=Ext.asn1.x509.RDN.parseString(e);for(var f=0;f<c.length;f++){this.addByString(c[f])}};this.getEncodedHex=function(){var c=new Ext.asn1.DERSet({array:this.asn1Array});this.TLV=c.getEncodedHex();return this.TLV};if(typeof b!="undefined"){if(typeof b.str!="undefined"){this.addByMultiValuedString(b.str)}}};YAHOO.lang.extend(Ext.asn1.x509.RDN,Ext.asn1.ASN1Object);Ext.asn1.x509.RDN.parseString=function(p){var r=p.split(/\+/);var u=false;var x=[];for(var v=0;r.length>0;v++){var q=r.shift();if(u===true){var n=x.pop();var i=(n+"+"+q).replace(/\\\+/g,"+");x.push(i);u=false}else{x.push(q)}if(q.substr(-1,1)==="\\"){u=true}}var s=false;var o=[];for(var v=0;x.length>0;v++){var q=x.shift();if(s===true){var w=o.pop();if(q.match(/"$/)){var i=(w+"+"+q).replace(/^([^=]+)="(.*)"$/,"$1=$2");o.push(i);s=false}else{o.push(w+"+"+q)}}else{o.push(q)}if(q.match(/^[^=]+="/)){s=true}}return o};Ext.asn1.x509.AttributeTypeAndValue=function(g){Ext.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var e=null;var f=null;var i="utf8";this.setByString=function(b){var c=b.match(/^([^=]+)=(.+)$/);if(c){this.setByAttrTypeAndValueStr(c[1],c[2])}else{throw"malformed attrTypeAndValueStr: "+b}};this.setByAttrTypeAndValueStr=function(b,c){this.typeObj=Ext.asn1.x509.OID.atype2obj(b);var d=i;if(b=="C"){d="prn"}this.valueObj=this.getValueObj(d,c)};this.getValueObj=function(b,c){if(b=="utf8"){return new Ext.asn1.DERUTF8String({str:c})}if(b=="prn"){return new Ext.asn1.DERPrintableString({str:c})}if(b=="tel"){return new Ext.asn1.DERTeletexString({str:c})}if(b=="ia5"){return new Ext.asn1.DERIA5String({str:c})}throw"unsupported directory string type: type="+b+" value="+c};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:[this.typeObj,this.valueObj]});this.TLV=b.getEncodedHex();return this.TLV};if(typeof g!="undefined"){if(typeof g.str!="undefined"){this.setByString(g.str)}}};YAHOO.lang.extend(Ext.asn1.x509.AttributeTypeAndValue,Ext.asn1.ASN1Object);Ext.asn1.x509.SubjectPublicKeyInfo=function(e){Ext.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var g=null;var f=null;var i=null;this.setRSAKey=function(k){if(!RSAKey.prototype.isPrototypeOf(k)){throw"argument is not RSAKey instance"}this.rsaKey=k;var d=new Ext.asn1.DERInteger({bigint:k.n});var j=new Ext.asn1.DERInteger({"int":k.e});var b=new Ext.asn1.DERSequence({array:[d,j]});var c=b.getEncodedHex();this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+c})};this.setRSAPEM=function(s){if(s.match(/-----BEGIN PUBLIC KEY-----/)){var c=s;c=c.replace(/^-----[^-]+-----/,"");c=c.replace(/-----[^-]+-----\s*$/,"");var d=c.replace(/\s+/g,"");var u=CryptoJS.enc.Base64.parse(d);var q=CryptoJS.enc.Hex.stringify(u);var o=RSAKey.getHexValueArrayOfChildrenFromHex(q);var r=o[1];var j=r.substr(2);var b=RSAKey.getHexValueArrayOfChildrenFromHex(j);var p=new RSAKey();p.setPublic(b[0],b[1]);this.setRSAKey(p)}else{throw"key not supported"}};this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null){throw"algId and/or subjPubKey not set"}var b=new Ext.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]});return b};this.getEncodedHex=function(){var b=this.getASN1Object();this.hTLV=b.getEncodedHex();return this.hTLV};this._setRSAKey=function(d){var b=Ext.asn1.ASN1Util.newObject({seq:[{"int":{bigint:d.n}},{"int":{"int":d.e}}]});var c=b.getEncodedHex();this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+c})};this._setEC=function(c){var b=new Ext.asn1.DERObjectIdentifier({name:c.curveName});this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"ecPublicKey",asn1params:b});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+c.pubKeyHex})};this._setDSA=function(d){var c=new Ext.asn1.ASN1Util.newObject({seq:[{"int":{bigint:d.p}},{"int":{bigint:d.q}},{"int":{bigint:d.g}}]});this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"dsa",asn1params:c});var b=new Ext.asn1.DERInteger({bigint:d.y});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+b.getEncodedHex()})};if(typeof e!="undefined"){if(typeof RSAKey!="undefined"&&e instanceof RSAKey){this._setRSAKey(e)}else{if(typeof Ext.crypto.ECDSA!="undefined"&&e instanceof Ext.crypto.ECDSA){this._setEC(e)}else{if(typeof Ext.crypto.DSA!="undefined"&&e instanceof Ext.crypto.DSA){this._setDSA(e)}else{if(typeof e.rsakey!="undefined"){this.setRSAKey(e.rsakey)}else{if(typeof e.rsapem!="undefined"){this.setRSAPEM(e.rsapem)}}}}}}};YAHOO.lang.extend(Ext.asn1.x509.SubjectPublicKeyInfo,Ext.asn1.ASN1Object);Ext.asn1.x509.Time=function(f){Ext.asn1.x509.Time.superclass.constructor.call(this);var d=null;var e=null;this.setTimeParams=function(b){this.timeParams=b};this.getEncodedHex=function(){var b=null;if(this.timeParams!=null){if(this.type=="utc"){b=new Ext.asn1.DERUTCTime(this.timeParams)}else{b=new Ext.asn1.DERGeneralizedTime(this.timeParams)}}else{if(this.type=="utc"){b=new Ext.asn1.DERUTCTime()}else{b=new Ext.asn1.DERGeneralizedTime()}}this.TLV=b.getEncodedHex();return this.TLV};this.type="utc";if(typeof f!="undefined"){if(typeof f.type!="undefined"){this.type=f.type}else{if(typeof f.str!="undefined"){if(f.str.match(/^[0-9]{12}Z$/)){this.type="utc"}if(f.str.match(/^[0-9]{14}Z$/)){this.type="gen"}}}this.timeParams=f}};YAHOO.lang.extend(Ext.asn1.x509.Time,Ext.asn1.ASN1Object);Ext.asn1.x509.AlgorithmIdentifier=function(i){Ext.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);var g=null;var j=null;var f=null;var k=false;this.getEncodedHex=function(){if(this.nameAlg==null&&this.asn1Alg==null){throw"algorithm not specified"}if(this.nameAlg!=null&&this.asn1Alg==null){this.asn1Alg=Ext.asn1.x509.OID.name2obj(this.nameAlg)}var c=[this.asn1Alg];if(!this.paramEmpty){c.push(this.asn1Params)}var b=new Ext.asn1.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof i!="undefined"){if(typeof i.name!="undefined"){this.nameAlg=i.name}if(typeof i.asn1params!="undefined"){this.asn1Params=i.asn1params}if(typeof i.paramempty!="undefined"){this.paramEmpty=i.paramempty}}if(this.asn1Params==null){this.asn1Params=new Ext.asn1.DERNull()}};YAHOO.lang.extend(Ext.asn1.x509.AlgorithmIdentifier,Ext.asn1.ASN1Object);Ext.asn1.x509.GeneralName=function(e){Ext.asn1.x509.GeneralName.superclass.constructor.call(this);var f=null;var g=null;var i={rfc822:"81",dns:"82",dn:"a4",uri:"86"};this.explicit=false;this.setByParam=function(m){var c=null;var j=null;if(m===undefined){return}if(m.rfc822!==undefined){this.type="rfc822";j=new Ext.asn1.DERIA5String({str:m[this.type]})}if(m.dns!==undefined){this.type="dns";j=new Ext.asn1.DERIA5String({str:m[this.type]})}if(m.uri!==undefined){this.type="uri";j=new Ext.asn1.DERIA5String({str:m[this.type]})}if(m.dn!==undefined){this.type="dn";j=new Ext.asn1.x509.X500Name({str:m.dn})}if(m.ldapdn!==undefined){this.type="dn";j=new Ext.asn1.x509.X500Name({ldapstr:m.ldapdn})}if(m.certissuer!==undefined){this.type="dn";this.explicit=true;var l=m.certissuer;var b=null;if(l.match(/^[0-9A-Fa-f]+$/)){b==l}if(l.indexOf("-----BEGIN ")!=-1){b=ASN1HEX.pemToHex(l)}if(b==null){throw"certissuer param not cert"}var d=new X509();d.hex=b;var n=d.getIssuerHex();j=new Ext.asn1.ASN1Object();j.hTLV=n}if(m.certsubj!==undefined){this.type="dn";this.explicit=true;var l=m.certsubj;var b=null;if(l.match(/^[0-9A-Fa-f]+$/)){b==l}if(l.indexOf("-----BEGIN ")!=-1){b=ASN1HEX.pemToHex(l)}if(b==null){throw"certsubj param not cert"}var d=new X509();d.hex=b;var n=d.getSubjectHex();j=new Ext.asn1.ASN1Object();j.hTLV=n}if(this.type==null){throw"unsupported type in params="+m}this.asn1Obj=new Ext.asn1.DERTaggedObject({explicit:this.explicit,tag:i[this.type],obj:j})};this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()};if(e!==undefined){this.setByParam(e)}};YAHOO.lang.extend(Ext.asn1.x509.GeneralName,Ext.asn1.ASN1Object);Ext.asn1.x509.GeneralNames=function(c){Ext.asn1.x509.GeneralNames.superclass.constructor.call(this);var d=null;this.setByParamArray=function(b){for(var f=0;f<b.length;f++){var e=new Ext.asn1.x509.GeneralName(b[f]);this.asn1Array.push(e)}};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:this.asn1Array});return b.getEncodedHex()};this.asn1Array=new Array();if(typeof c!="undefined"){this.setByParamArray(c)}};YAHOO.lang.extend(Ext.asn1.x509.GeneralNames,Ext.asn1.ASN1Object);Ext.asn1.x509.DistributionPointName=function(f){Ext.asn1.x509.DistributionPointName.superclass.constructor.call(this);var i=null;var k=null;var g=null;var j=null;this.getEncodedHex=function(){if(this.type!="full"){throw"currently type shall be 'full': "+this.type}this.asn1Obj=new Ext.asn1.DERTaggedObject({explicit:false,tag:this.tag,obj:this.asn1V});this.hTLV=this.asn1Obj.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(Ext.asn1.x509.GeneralNames.prototype.isPrototypeOf(f)){this.type="full";this.tag="a0";this.asn1V=f}else{throw"This class supports GeneralNames only as argument"}}};YAHOO.lang.extend(Ext.asn1.x509.DistributionPointName,Ext.asn1.ASN1Object);Ext.asn1.x509.DistributionPoint=function(c){Ext.asn1.x509.DistributionPoint.superclass.constructor.call(this);var d=null;this.getEncodedHex=function(){var e=new Ext.asn1.DERSequence();if(this.asn1DP!=null){var b=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:this.asn1DP});e.appendASN1Object(b)}this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof c!="undefined"){if(typeof c.dpobj!="undefined"){this.asn1DP=c.dpobj}}};YAHOO.lang.extend(Ext.asn1.x509.DistributionPoint,Ext.asn1.ASN1Object);Ext.asn1.x509.OID=new function(b){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"};this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",countryName:"2.5.4.6",streetAddress:"2.5.4.9",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14",};this.objCache={};this.name2obj=function(c){if(typeof this.objCache[c]!="undefined"){return this.objCache[c]}if(typeof this.name2oidList[c]=="undefined"){throw"Name of ObjectIdentifier not defined: "+c}var f=this.name2oidList[c];var e=new Ext.asn1.DERObjectIdentifier({oid:f});this.objCache[c]=e;return e};this.atype2obj=function(c){if(typeof this.objCache[c]!="undefined"){return this.objCache[c]}if(typeof this.atype2oidList[c]=="undefined"){throw"AttributeType name undefined: "+c}var f=this.atype2oidList[c];var e=new Ext.asn1.DERObjectIdentifier({oid:f});this.objCache[c]=e;return e}};Ext.asn1.x509.OID.oid2name=function(d){var f=Ext.asn1.x509.OID.name2oidList;for(var e in f){if(f[e]==d){return e}}return""};Ext.asn1.x509.OID.oid2atype=function(d){var f=Ext.asn1.x509.OID.atype2oidList;for(var e in f){if(f[e]==d){return e}}return d};Ext.asn1.x509.OID.name2oid=function(d){var c=Ext.asn1.x509.OID.name2oidList;if(c[d]===undefined){return""}return c[d]};Ext.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=function(p){var q=null;var s=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(p.n);var o=Ext.asn1.ASN1Util.integerToByteHex(p.e);var y=new Ext.asn1.DERInteger({hex:s});var r=new Ext.asn1.DERInteger({hex:o});var m=new Ext.asn1.DERSequence({array:[y,r]});var w=m.getEncodedHex();var v=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});var x=new Ext.asn1.DERBitString({hex:"00"+w});var n=new Ext.asn1.DERSequence({array:[v,x]});var u=n.getEncodedHex();var q=Ext.asn1.ASN1Util.getPEMStringFromHex(u,"PUBLIC KEY");return q}};Ext.asn1.x509.X509Util.newCertPEM=function(j){var m=Ext.asn1.x509;var k=new m.TBSCertificate();if(j.serial!==undefined){k.setSerialNumberByParam(j.serial)}else{throw"serial number undefined."}if(typeof j.sigalg.name=="string"){k.setSignatureAlgByParam(j.sigalg)}else{throw"unproper signature algorithm name"}if(j.issuer!==undefined){k.setIssuerByParam(j.issuer)}else{throw"issuer name undefined."}if(j.notbefore!==undefined){k.setNotBeforeByParam(j.notbefore)}else{throw"notbefore undefined."}if(j.notafter!==undefined){k.setNotAfterByParam(j.notafter)}else{throw"notafter undefined."}if(j.subject!==undefined){k.setSubjectByParam(j.subject)}else{throw"subject name undefined."}if(j.sbjpubkey!==undefined){k.setSubjectPublicKeyByGetKey(j.sbjpubkey)}else{throw"subject public key undefined."}if(j.ext!==undefined&&j.ext.length!==undefined){for(var g=0;g<j.ext.length;g++){for(key in j.ext[g]){k.appendExtensionByName(key,j.ext[g][key])}}}if(j.cakey===undefined&&j.sighex===undefined){throw"param cakey and sighex undefined."}var l=null;var i=null;if(j.cakey){l=KEYUTIL.getKey.apply(null,j.cakey);i=new m.Certificate({tbscertobj:k,prvkeyobj:l});i.sign()}if(j.sighex){i=new m.Certificate({tbscertobj:k});i.setSignatureHex(j.sighex)}return i.getPEMString()};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.cms=="undefined"||!Ext.asn1.cms){Ext.asn1.cms={}}Ext.asn1.cms.Attribute=function(c){Ext.asn1.cms.Attribute.superclass.constructor.call(this);var d=[];this.getEncodedHex=function(){var g,i,e;g=new Ext.asn1.DERObjectIdentifier({oid:this.attrTypeOid});i=new Ext.asn1.DERSet({array:this.valueList});try{i.getEncodedHex()}catch(b){throw"fail valueSet.getEncodedHex in Attribute(1)/"+b}e=new Ext.asn1.DERSequence({array:[g,i]});try{this.hTLV=e.getEncodedHex()}catch(b){throw"failed seq.getEncodedHex in Attribute(2)/"+b}return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.Attribute,Ext.asn1.ASN1Object);Ext.asn1.cms.ContentType=function(c){Ext.asn1.cms.ContentType.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.3";var d=null;if(typeof c!="undefined"){var d=new Ext.asn1.DERObjectIdentifier(c);this.valueList=[d]}};YAHOO.lang.extend(Ext.asn1.cms.ContentType,Ext.asn1.cms.Attribute);Ext.asn1.cms.MessageDigest=function(i){Ext.asn1.cms.MessageDigest.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.4";if(typeof i!="undefined"){if(i.eciObj instanceof Ext.asn1.cms.EncapsulatedContentInfo&&typeof i.hashAlg=="string"){var f=i.eciObj.eContentValueHex;var g=i.hashAlg;var k=Ext.crypto.Util.hashHex(f,g);var j=new Ext.asn1.DEROctetString({hex:k});j.getEncodedHex();this.valueList=[j]}else{var j=new Ext.asn1.DEROctetString(i);j.getEncodedHex();this.valueList=[j]}}};YAHOO.lang.extend(Ext.asn1.cms.MessageDigest,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningTime=function(f){Ext.asn1.cms.SigningTime.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.5";if(typeof f!="undefined"){var e=new Ext.asn1.x509.Time(f);try{e.getEncodedHex()}catch(d){throw"SigningTime.getEncodedHex() failed/"+d}this.valueList=[e]}};YAHOO.lang.extend(Ext.asn1.cms.SigningTime,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningCertificate=function(e){Ext.asn1.cms.SigningCertificate.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.12";var i=Ext.asn1;var f=Ext.asn1.cms;var g=Ext.crypto;this.setCerts=function(j){var p=[];for(var q=0;q<j.length;q++){var s=ASN1HEX.pemToHex(j[q]);var b=g.Util.hashHex(s,"sha1");var d=new i.DEROctetString({hex:b});d.getEncodedHex();var o=new f.IssuerAndSerialNumber({cert:j[q]});o.getEncodedHex();var c=new i.DERSequence({array:[d,o]});c.getEncodedHex();p.push(c)}var r=new i.DERSequence({array:p});r.getEncodedHex();this.valueList=[r]};if(typeof e!="undefined"){if(typeof e.array=="object"){this.setCerts(e.array)}}};YAHOO.lang.extend(Ext.asn1.cms.SigningCertificate,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningCertificateV2=function(k){Ext.asn1.cms.SigningCertificateV2.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.47";var g=Ext.asn1;var j=Ext.asn1.x509;var m=Ext.asn1.cms;var l=Ext.crypto;this.setCerts=function(e,x){var n=[];for(var s=0;s<e.length;s++){var v=ASN1HEX.pemToHex(e[s]);var b=[];if(x!="sha256"){b.push(new j.AlgorithmIdentifier({name:x}))}var c=l.Util.hashHex(v,x);var d=new g.DEROctetString({hex:c});d.getEncodedHex();b.push(d);var w=new m.IssuerAndSerialNumber({cert:e[s]});w.getEncodedHex();b.push(w);var f=new g.DERSequence({array:b});f.getEncodedHex();n.push(f)}var u=new g.DERSequence({array:n});u.getEncodedHex();this.valueList=[u]};if(typeof k!="undefined"){if(typeof k.array=="object"){var i="sha256";if(typeof k.hashAlg=="string"){i=k.hashAlg}this.setCerts(k.array,i)}}};YAHOO.lang.extend(Ext.asn1.cms.SigningCertificateV2,Ext.asn1.cms.Attribute);Ext.asn1.cms.IssuerAndSerialNumber=function(k){Ext.asn1.cms.IssuerAndSerialNumber.superclass.constructor.call(this);var i=null;var f=null;var g=Ext.asn1;var j=g.x509;this.setByCertPEM=function(c){var e=ASN1HEX.pemToHex(c);var l=new X509();l.hex=e;var b=l.getIssuerHex();this.dIssuer=new j.X500Name();this.dIssuer.hTLV=b;var d=l.getSerialNumberHex();this.dSerial=new g.DERInteger({hex:d})};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:[this.dIssuer,this.dSerial]});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof k!="undefined"){if(typeof k=="string"&&k.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(k)}if(k.issuer&&k.serial){if(k.issuer instanceof Ext.asn1.x509.X500Name){this.dIssuer=k.issuer}else{this.dIssuer=new Ext.asn1.x509.X500Name(k.issuer)}if(k.serial instanceof Ext.asn1.DERInteger){this.dSerial=k.serial}else{this.dSerial=new Ext.asn1.DERInteger(k.serial)}}if(typeof k.cert=="string"){this.setByCertPEM(k.cert)}}};YAHOO.lang.extend(Ext.asn1.cms.IssuerAndSerialNumber,Ext.asn1.ASN1Object);Ext.asn1.cms.AttributeList=function(b){Ext.asn1.cms.AttributeList.superclass.constructor.call(this);this.list=new Array();this.sortFlag=true;this.add=function(c){if(c instanceof Ext.asn1.cms.Attribute){this.list.push(c)}};this.length=function(){return this.list.length};this.clear=function(){this.list=new Array();this.hTLV=null;this.hV=null};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var c=new Ext.asn1.DERSet({array:this.list,sortflag:this.sortFlag});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof b!="undefined"){if(typeof b.sortflag!="undefined"&&b.sortflag==false){this.sortFlag=false}}};YAHOO.lang.extend(Ext.asn1.cms.AttributeList,Ext.asn1.ASN1Object);Ext.asn1.cms.SignerInfo=function(f){Ext.asn1.cms.SignerInfo.superclass.constructor.call(this);var i=Ext.asn1;var g=Ext.asn1.cms;var e=Ext.asn1.x509;this.dCMSVersion=new i.DERInteger({"int":1});this.dSignerIdentifier=null;this.dDigestAlgorithm=null;this.dSignedAttrs=new g.AttributeList();this.dSigAlg=null;this.dSig=null;this.dUnsignedAttrs=new g.AttributeList();this.setSignerIdentifier=function(b){if(typeof b=="string"&&b.indexOf("CERTIFICATE")!=-1&&b.indexOf("BEGIN")!=-1&&b.indexOf("END")!=-1){var c=b;this.dSignerIdentifier=new g.IssuerAndSerialNumber({cert:b})}};this.setForContentAndHash=function(b){if(typeof b!="undefined"){if(b.eciObj instanceof Ext.asn1.cms.EncapsulatedContentInfo){this.dSignedAttrs.add(new g.ContentType({oid:"1.2.840.113549.1.7.1"}));this.dSignedAttrs.add(new g.MessageDigest({eciObj:b.eciObj,hashAlg:b.hashAlg}))}if(typeof b.sdObj!="undefined"&&b.sdObj instanceof Ext.asn1.cms.SignedData){if(b.sdObj.digestAlgNameList.join(":").indexOf(b.hashAlg)==-1){b.sdObj.digestAlgNameList.push(b.hashAlg)}}if(typeof b.hashAlg=="string"){this.dDigestAlgorithm=new e.AlgorithmIdentifier({name:b.hashAlg})}}};this.sign=function(k,j){this.dSigAlg=new e.AlgorithmIdentifier({name:j});var d=this.dSignedAttrs.getEncodedHex();var l=KEYUTIL.getKey(k);var b=new Ext.crypto.Signature({alg:j});b.init(l);b.updateHex(d);var c=b.sign();this.dSig=new i.DEROctetString({hex:c})};this.addUnsigned=function(b){this.hTLV=null;this.dUnsignedAttrs.hTLV=null;this.dUnsignedAttrs.add(b)};this.getEncodedHex=function(){if(this.dSignedAttrs instanceof Ext.asn1.cms.AttributeList&&this.dSignedAttrs.length()==0){throw"SignedAttrs length = 0 (empty)"}var c=new i.DERTaggedObject({obj:this.dSignedAttrs,tag:"a0",explicit:false});var d=null;if(this.dUnsignedAttrs.length()>0){d=new i.DERTaggedObject({obj:this.dUnsignedAttrs,tag:"a1",explicit:false})}var j=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,c,this.dSigAlg,this.dSig,];if(d!=null){j.push(d)}var b=new i.DERSequence({array:j});this.hTLV=b.getEncodedHex();return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.SignerInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.EncapsulatedContentInfo=function(f){Ext.asn1.cms.EncapsulatedContentInfo.superclass.constructor.call(this);var i=Ext.asn1;var g=Ext.asn1.cms;var e=Ext.asn1.x509;this.dEContentType=new i.DERObjectIdentifier({name:"data"});this.dEContent=null;this.isDetached=false;this.eContentValueHex=null;this.setContentType=function(b){if(b.match(/^[0-2][.][0-9.]+$/)){this.dEContentType=new i.DERObjectIdentifier({oid:b})}else{this.dEContentType=new i.DERObjectIdentifier({name:b})}};this.setContentValue=function(b){if(typeof b!="undefined"){if(typeof b.hex=="string"){this.eContentValueHex=b.hex}else{if(typeof b.str=="string"){this.eContentValueHex=utf8tohex(b.str)}}}};this.setContentValueHex=function(b){this.eContentValueHex=b};this.setContentValueStr=function(b){this.eContentValueHex=utf8tohex(b)};this.getEncodedHex=function(){if(typeof this.eContentValueHex!="string"){throw"eContentValue not yet set"}var b=new i.DEROctetString({hex:this.eContentValueHex});this.dEContent=new i.DERTaggedObject({obj:b,tag:"a0",explicit:true});var d=[this.dEContentType];if(!this.isDetached){d.push(this.dEContent)}var c=new i.DERSequence({array:d});this.hTLV=c.getEncodedHex();return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.EncapsulatedContentInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.ContentInfo=function(f){Ext.asn1.cms.ContentInfo.superclass.constructor.call(this);var i=Ext.asn1;var g=Ext.asn1.cms;var e=Ext.asn1.x509;this.dContentType=null;this.dContent=null;this.setContentType=function(b){if(typeof b=="string"){this.dContentType=e.OID.name2obj(b)}};this.getEncodedHex=function(){var b=new i.DERTaggedObject({obj:this.dContent,tag:"a0",explicit:true});var c=new i.DERSequence({array:[this.dContentType,b]});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(f.type){this.setContentType(f.type)}if(f.obj&&f.obj instanceof i.ASN1Object){this.dContent=f.obj}}};YAHOO.lang.extend(Ext.asn1.cms.ContentInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.SignedData=function(f){Ext.asn1.cms.SignedData.superclass.constructor.call(this);var i=Ext.asn1;var g=Ext.asn1.cms;var e=Ext.asn1.x509;this.dCMSVersion=new i.DERInteger({"int":1});this.dDigestAlgs=null;this.digestAlgNameList=[];this.dEncapContentInfo=new g.EncapsulatedContentInfo();this.dCerts=null;this.certificateList=[];this.crlList=[];this.signerInfoList=[new g.SignerInfo()];this.addCertificatesByPEM=function(d){var c=ASN1HEX.pemToHex(d);var b=new i.ASN1Object();b.hTLV=c;this.certificateList.push(b)};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}if(this.dDigestAlgs==null){var o=[];for(var c=0;c<this.digestAlgNameList.length;c++){var q=this.digestAlgNameList[c];var b=new e.AlgorithmIdentifier({name:q});o.push(b)}this.dDigestAlgs=new i.DERSet({array:o})}var j=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(this.dCerts==null){if(this.certificateList.length>0){var n=new i.DERSet({array:this.certificateList});this.dCerts=new i.DERTaggedObject({obj:n,tag:"a0",explicit:false})}}if(this.dCerts!=null){j.push(this.dCerts)}var p=new i.DERSet({array:this.signerInfoList});j.push(p);var d=new i.DERSequence({array:j});this.hTLV=d.getEncodedHex();return this.hTLV};this.getContentInfo=function(){this.getEncodedHex();var b=new g.ContentInfo({type:"signed-data",obj:this});return b};this.getContentInfoEncodedHex=function(){var c=this.getContentInfo();var b=c.getEncodedHex();return b};this.getPEM=function(){var c=this.getContentInfoEncodedHex();var b=i.ASN1Util.getPEMStringFromHex(c,"CMS");return b}};YAHOO.lang.extend(Ext.asn1.cms.SignedData,Ext.asn1.ASN1Object);Ext.asn1.cms.CMSUtil=new function(){};Ext.asn1.cms.CMSUtil.newSignedData=function(l){var n=Ext.asn1.cms;var o=Ext.asn1.cades;var p=new n.SignedData();p.dEncapContentInfo.setContentValue(l.content);if(typeof l.certs=="object"){for(var k=0;k<l.certs.length;k++){p.addCertificatesByPEM(l.certs[k])}}p.signerInfoList=[];for(var k=0;k<l.signerInfos.length;k++){var r=l.signerInfos[k];var i=new n.SignerInfo();i.setSignerIdentifier(r.signerCert);i.setForContentAndHash({sdObj:p,eciObj:p.dEncapContentInfo,hashAlg:r.hashAlg});for(attrName in r.sAttr){var m=r.sAttr[attrName];if(attrName=="SigningTime"){var q=new n.SigningTime(m);i.dSignedAttrs.add(q)}if(attrName=="SigningCertificate"){var q=new n.SigningCertificate(m);i.dSignedAttrs.add(q)}if(attrName=="SigningCertificateV2"){var q=new n.SigningCertificateV2(m);i.dSignedAttrs.add(q)}if(attrName=="SignaturePolicyIdentifier"){var q=new o.SignaturePolicyIdentifier(m);i.dSignedAttrs.add(q)}}i.sign(r.signerPrvKey,r.sigAlg);p.signerInfoList.push(i)}return p};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.tsp=="undefined"||!Ext.asn1.tsp){Ext.asn1.tsp={}}Ext.asn1.tsp.Accuracy=function(c){Ext.asn1.tsp.Accuracy.superclass.constructor.call(this);var d=Ext.asn1;this.seconds=null;this.millis=null;this.micros=null;this.getEncodedHex=function(){var m=null;var k=null;var b=null;var e=[];if(this.seconds!=null){m=new d.DERInteger({"int":this.seconds});e.push(m)}if(this.millis!=null){var j=new d.DERInteger({"int":this.millis});k=new d.DERTaggedObject({obj:j,tag:"80",explicit:false});e.push(k)}if(this.micros!=null){var n=new d.DERInteger({"int":this.micros});b=new d.DERTaggedObject({obj:n,tag:"81",explicit:false});e.push(b)}var l=new d.DERSequence({array:e});this.hTLV=l.getEncodedHex();return this.hTLV};if(typeof c!="undefined"){if(typeof c.seconds=="number"){this.seconds=c.seconds}if(typeof c.millis=="number"){this.millis=c.millis}if(typeof c.micros=="number"){this.micros=c.micros}}};YAHOO.lang.extend(Ext.asn1.tsp.Accuracy,Ext.asn1.ASN1Object);Ext.asn1.tsp.MessageImprint=function(d){Ext.asn1.tsp.MessageImprint.superclass.constructor.call(this);var e=Ext.asn1;var f=Ext.asn1.x509;this.dHashAlg=null;this.dHashValue=null;this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var b=new e.DERSequence({array:[this.dHashAlg,this.dHashValue]});return b.getEncodedHex()};if(typeof d!="undefined"){if(typeof d.hashAlg=="string"){this.dHashAlg=new f.AlgorithmIdentifier({name:d.hashAlg})}if(typeof d.hashValue=="string"){this.dHashValue=new e.DEROctetString({hex:d.hashValue})}}};YAHOO.lang.extend(Ext.asn1.tsp.MessageImprint,Ext.asn1.ASN1Object);Ext.asn1.tsp.TimeStampReq=function(f){Ext.asn1.tsp.TimeStampReq.superclass.constructor.call(this);var e=Ext.asn1;var d=Ext.asn1.tsp;this.dVersion=new e.DERInteger({"int":1});this.dMessageImprint=null;this.dPolicy=null;this.dNonce=null;this.certReq=true;this.setMessageImprint=function(b){if(b instanceof Ext.asn1.tsp.MessageImprint){this.dMessageImprint=b;return}if(typeof b=="object"){this.dMessageImprint=new d.MessageImprint(b)}};this.getEncodedHex=function(){if(this.dMessageImprint==null){throw"messageImprint shall be specified"}var c=[this.dVersion,this.dMessageImprint];if(this.dPolicy!=null){c.push(this.dPolicy)}if(this.dNonce!=null){c.push(this.dNonce)}if(this.certReq){c.push(new e.DERBoolean())}var b=new e.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f.mi=="object"){this.setMessageImprint(f.mi)}if(typeof f.policy=="object"){this.dPolicy=new e.DERObjectIdentifier(f.policy)}if(typeof f.nonce=="object"){this.dNonce=new e.DERInteger(f.nonce)}if(typeof f.certreq=="boolean"){this.certReq=f.certreq}}};YAHOO.lang.extend(Ext.asn1.tsp.TimeStampReq,Ext.asn1.ASN1Object);Ext.asn1.tsp.TSTInfo=function(f){Ext.asn1.tsp.TSTInfo.superclass.constructor.call(this);var i=Ext.asn1;var e=Ext.asn1.x509;var g=Ext.asn1.tsp;this.dVersion=new i.DERInteger({"int":1});this.dPolicy=null;this.dMessageImprint=null;this.dSerialNumber=null;this.dGenTime=null;this.dAccuracy=null;this.dOrdering=null;this.dNonce=null;this.dTsa=null;this.getEncodedHex=function(){var c=[this.dVersion];if(this.dPolicy==null){throw"policy shall be specified."}c.push(this.dPolicy);if(this.dMessageImprint==null){throw"messageImprint shall be specified."}c.push(this.dMessageImprint);if(this.dSerialNumber==null){throw"serialNumber shall be specified."}c.push(this.dSerialNumber);if(this.dGenTime==null){throw"genTime shall be specified."}c.push(this.dGenTime);if(this.dAccuracy!=null){c.push(this.dAccuracy)}if(this.dOrdering!=null){c.push(this.dOrdering)}if(this.dNonce!=null){c.push(this.dNonce)}if(this.dTsa!=null){c.push(this.dTsa)}var b=new i.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f.policy=="string"){if(!f.policy.match(/^[0-9.]+$/)){throw"policy shall be oid like 0.1.4.134"}this.dPolicy=new i.DERObjectIdentifier({oid:f.policy})}if(typeof f.messageImprint!="undefined"){this.dMessageImprint=new g.MessageImprint(f.messageImprint)}if(typeof f.serialNumber!="undefined"){this.dSerialNumber=new i.DERInteger(f.serialNumber)}if(typeof f.genTime!="undefined"){this.dGenTime=new i.DERGeneralizedTime(f.genTime)}if(typeof f.accuracy!="undefind"){this.dAccuracy=new g.Accuracy(f.accuracy)}if(typeof f.ordering!="undefined"&&f.ordering==true){this.dOrdering=new i.DERBoolean()}if(typeof f.nonce!="undefined"){this.dNonce=new i.DERInteger(f.nonce)}if(typeof f.tsa!="undefined"){this.dTsa=new e.X500Name(f.tsa)}}};YAHOO.lang.extend(Ext.asn1.tsp.TSTInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.TimeStampResp=function(f){Ext.asn1.tsp.TimeStampResp.superclass.constructor.call(this);var e=Ext.asn1;var d=Ext.asn1.tsp;this.dStatus=null;this.dTST=null;this.getEncodedHex=function(){if(this.dStatus==null){throw"status shall be specified"}var c=[this.dStatus];if(this.dTST!=null){c.push(this.dTST)}var b=new e.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f.status=="object"){this.dStatus=new d.PKIStatusInfo(f.status)}if(typeof f.tst!="undefined"&&f.tst instanceof Ext.asn1.ASN1Object){this.dTST=f.tst.getContentInfo()}}};YAHOO.lang.extend(Ext.asn1.tsp.TimeStampResp,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatusInfo=function(f){Ext.asn1.tsp.PKIStatusInfo.superclass.constructor.call(this);var e=Ext.asn1;var d=Ext.asn1.tsp;this.dStatus=null;this.dStatusString=null;this.dFailureInfo=null;this.getEncodedHex=function(){if(this.dStatus==null){throw"status shall be specified"}var c=[this.dStatus];if(this.dStatusString!=null){c.push(this.dStatusString)}if(this.dFailureInfo!=null){c.push(this.dFailureInfo)}var b=new e.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f.status=="object"){this.dStatus=new d.PKIStatus(f.status)}if(typeof f.statstr=="object"){this.dStatusString=new d.PKIFreeText({array:f.statstr})}if(typeof f.failinfo=="object"){this.dFailureInfo=new d.PKIFailureInfo(f.failinfo)}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIStatusInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatus=function(i){Ext.asn1.tsp.PKIStatus.superclass.constructor.call(this);var g=Ext.asn1;var f=Ext.asn1.tsp;var j=null;this.getEncodedHex=function(){this.hTLV=this.dStatus.getEncodedHex();return this.hTLV};if(typeof i!="undefined"){if(typeof i.name!="undefined"){var k=f.PKIStatus.valueList;if(typeof k[i.name]=="undefined"){throw"name undefined: "+i.name}this.dStatus=new g.DERInteger({"int":k[i.name]})}else{this.dStatus=new g.DERInteger(i)}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIStatus,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};Ext.asn1.tsp.PKIFreeText=function(c){Ext.asn1.tsp.PKIFreeText.superclass.constructor.call(this);var d=Ext.asn1;this.textList=[];this.getEncodedHex=function(){var f=[];for(var b=0;b<this.textList.length;b++){f.push(new d.DERUTF8String({str:this.textList[b]}))}var e=new d.DERSequence({array:f});this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof c!="undefined"){if(typeof c.array=="object"){this.textList=c.array}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIFreeText,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIFailureInfo=function(e){Ext.asn1.tsp.PKIFailureInfo.superclass.constructor.call(this);var i=Ext.asn1;var g=Ext.asn1.tsp;this.value=null;this.getEncodedHex=function(){if(this.value==null){throw"value shall be specified"}var c=new Number(this.value).toString(2);var b=new i.DERBitString();b.setByBinaryString(c);this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.name=="string"){var f=g.PKIFailureInfo.valueList;if(typeof f[e.name]=="undefined"){throw"name undefined: "+e.name}this.value=f[e.name]}else{if(typeof e["int"]=="number"){this.value=e["int"]}}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIFailureInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};Ext.asn1.tsp.AbstractTSAAdapter=function(b){this.getTSTHex=function(d,c){throw"not implemented yet"}};Ext.asn1.tsp.SimpleTSAAdapter=function(b){Ext.asn1.tsp.SimpleTSAAdapter.superclass.constructor.call(this);this.params=null;this.serial=0;this.getTSTHex=function(c,k){var i=Ext.crypto.Util.hashHex(c,k);this.params.tstInfo.messageImprint={hashAlg:k,hashValue:i};this.params.tstInfo.serialNumber={"int":this.serial++};var j=Math.floor(Math.random()*1000000000);this.params.tstInfo.nonce={"int":j};var g=Ext.asn1.tsp.TSPUtil.newTimeStampToken(this.params);return g.getContentInfoEncodedHex()};if(typeof b!="undefined"){this.params=b}};YAHOO.lang.extend(Ext.asn1.tsp.SimpleTSAAdapter,Ext.asn1.tsp.AbstractTSAAdapter);Ext.asn1.tsp.FixedTSAAdapter=function(b){Ext.asn1.tsp.FixedTSAAdapter.superclass.constructor.call(this);this.params=null;this.getTSTHex=function(f,g){var c=Ext.crypto.Util.hashHex(f,g);this.params.tstInfo.messageImprint={hashAlg:g,hashValue:c};var i=Ext.asn1.tsp.TSPUtil.newTimeStampToken(this.params);return i.getContentInfoEncodedHex()};if(typeof b!="undefined"){this.params=b}};YAHOO.lang.extend(Ext.asn1.tsp.FixedTSAAdapter,Ext.asn1.tsp.AbstractTSAAdapter);Ext.asn1.tsp.TSPUtil=new function(){};Ext.asn1.tsp.TSPUtil.newTimeStampToken=function(k){var m=Ext.asn1.cms;var l=Ext.asn1.tsp;var o=new m.SignedData();var q=new l.TSTInfo(k.tstInfo);var p=q.getEncodedHex();o.dEncapContentInfo.setContentValue({hex:p});o.dEncapContentInfo.setContentType("tstinfo");if(typeof k.certs=="object"){for(var i=0;i<k.certs.length;i++){o.addCertificatesByPEM(k.certs[i])}}var r=o.signerInfoList[0];r.setSignerIdentifier(k.signerCert);r.setForContentAndHash({sdObj:o,eciObj:o.dEncapContentInfo,hashAlg:k.hashAlg});var n=new m.SigningCertificate({array:[k.signerCert]});r.dSignedAttrs.add(n);r.sign(k.signerPrvKey,k.sigAlg);return o};Ext.asn1.tsp.TSPUtil.parseTimeStampReq=function(i){var m={};m.certreq=false;var l=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(l.length<2){throw"TimeStampReq must have at least 2 items"}var o=ASN1HEX.getHexOfTLV_AtObj(i,l[1]);m.mi=Ext.asn1.tsp.TSPUtil.parseMessageImprint(o);for(var p=2;p<l.length;p++){var n=l[p];var k=i.substr(n,2);if(k=="06"){var j=ASN1HEX.getHexOfV_AtObj(i,n);m.policy=ASN1HEX.hextooidstr(j)}if(k=="02"){m.nonce=ASN1HEX.getHexOfV_AtObj(i,n)}if(k=="01"){m.certreq=true}}return m};Ext.asn1.tsp.TSPUtil.parseMessageImprint=function(j){var n={};if(j.substr(0,2)!="30"){throw"head of messageImprint hex shall be '30'"}var l=ASN1HEX.getPosArrayOfChildren_AtObj(j,0);var m=ASN1HEX.getDecendantIndexByNthList(j,0,[0,0]);var r=ASN1HEX.getHexOfV_AtObj(j,m);var q=ASN1HEX.hextooidstr(r);var o=Ext.asn1.x509.OID.oid2name(q);if(o==""){throw"hashAlg name undefined: "+q}var k=o;var p=ASN1HEX.getDecendantIndexByNthList(j,0,[1]);n.hashAlg=k;n.hashValue=ASN1HEX.getHexOfV_AtObj(j,p);return n};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.cades=="undefined"||!Ext.asn1.cades){Ext.asn1.cades={}}Ext.asn1.cades.SignaturePolicyIdentifier=function(k){Ext.asn1.cades.SignaturePolicyIdentifier.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.15";var g=Ext.asn1;var m=Ext.asn1.cades;if(typeof k!="undefined"){if(typeof k.oid=="string"&&typeof k.hash=="object"){var j=new g.DERObjectIdentifier({oid:k.oid});var i=new m.OtherHashAlgAndValue(k.hash);var l=new g.DERSequence({array:[j,i]});this.valueList=[l]}}};YAHOO.lang.extend(Ext.asn1.cades.SignaturePolicyIdentifier,Ext.asn1.cms.Attribute);Ext.asn1.cades.OtherHashAlgAndValue=function(d){Ext.asn1.cades.OtherHashAlgAndValue.superclass.constructor.call(this);var e=Ext.asn1;var f=Ext.asn1.x509;this.dAlg=null;this.dHash=null;this.getEncodedHex=function(){var b=new e.DERSequence({array:[this.dAlg,this.dHash]});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof d!="undefined"){if(typeof d.alg=="string"&&typeof d.hash=="string"){this.dAlg=new f.AlgorithmIdentifier({name:d.alg});this.dHash=new e.DEROctetString({hex:d.hash})}}};YAHOO.lang.extend(Ext.asn1.cades.OtherHashAlgAndValue,Ext.asn1.ASN1Object);Ext.asn1.cades.SignatureTimeStamp=function(f){Ext.asn1.cades.SignatureTimeStamp.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.14";this.tstHex=null;var e=Ext.asn1;if(typeof f!="undefined"){if(typeof f.res!="undefined"){if(typeof f.res=="string"&&f.res.match(/^[0-9A-Fa-f]+$/)){}else{if(f.res instanceof Ext.asn1.ASN1Object){}else{throw"res param shall be ASN1Object or hex string"}}}if(typeof f.tst!="undefined"){if(typeof f.tst=="string"&&f.tst.match(/^[0-9A-Fa-f]+$/)){var d=new e.ASN1Object();this.tstHex=f.tst;d.hTLV=this.tstHex;d.getEncodedHex();this.valueList=[d]}else{if(f.tst instanceof Ext.asn1.ASN1Object){}else{throw"tst param shall be ASN1Object or hex string"}}}}};YAHOO.lang.extend(Ext.asn1.cades.SignatureTimeStamp,Ext.asn1.cms.Attribute);Ext.asn1.cades.CompleteCertificateRefs=function(f){Ext.asn1.cades.CompleteCertificateRefs.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.21";var e=Ext.asn1;var d=Ext.asn1.cades;this.setByArray=function(g){this.valueList=[];for(var c=0;c<g.length;c++){var b=new d.OtherCertID(g[c]);this.valueList.push(b)}};if(typeof f!="undefined"){if(typeof f=="object"&&typeof f.length=="number"){this.setByArray(f)}}};YAHOO.lang.extend(Ext.asn1.cades.CompleteCertificateRefs,Ext.asn1.cms.Attribute);Ext.asn1.cades.OtherCertID=function(e){Ext.asn1.cades.OtherCertID.superclass.constructor.call(this);var i=Ext.asn1;var f=Ext.asn1.cms;var g=Ext.asn1.cades;this.hasIssuerSerial=true;this.dOtherCertHash=null;this.dIssuerSerial=null;this.setByCertPEM=function(b){this.dOtherCertHash=new g.OtherHash(b);if(this.hasIssuerSerial){this.dIssuerSerial=new f.IssuerAndSerialNumber(b)}};this.getEncodedHex=function(){if(this.hTLV!=null){return this.hTLV}if(this.dOtherCertHash==null){throw"otherCertHash not set"}var c=[this.dOtherCertHash];if(this.dIssuerSerial!=null){c.push(this.dIssuerSerial)}var b=new i.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e=="string"&&e.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(e)}if(typeof e=="object"){if(e.hasis===false){this.hasIssuerSerial=false}if(typeof e.cert=="string"){this.setByCertPEM(e.cert)}}}};YAHOO.lang.extend(Ext.asn1.cades.OtherCertID,Ext.asn1.ASN1Object);Ext.asn1.cades.OtherHash=function(f){Ext.asn1.cades.OtherHash.superclass.constructor.call(this);var e=Ext.asn1;var d=Ext.asn1.cades;this.alg="sha256";this.dOtherHash=null;this.setByCertPEM=function(g){if(g.indexOf("-----BEGIN ")==-1){throw"certPEM not to seem PEM format"}var c=ASN1HEX.pemToHex(g);var b=Ext.crypto.Util.hashHex(c,this.alg);this.dOtherHash=new d.OtherHashAlgAndValue({alg:this.alg,hash:b})};this.getEncodedHex=function(){if(this.dOtherHash==null){throw"OtherHash not set"}return this.dOtherHash.getEncodedHex()};if(typeof f!="undefined"){if(typeof f=="string"){if(f.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(f)}else{if(f.match(/^[0-9A-Fa-f]+$/)){this.dOtherHash=new e.DEROctetString({hex:f})}else{throw"unsupported string value for params"}}}else{if(typeof f=="object"){if(typeof f.cert=="string"){if(typeof f.alg=="string"){this.alg=f.alg}this.setByCertPEM(f.cert)}else{this.dOtherHash=new d.OtherHashAlgAndValue(f)}}}}};YAHOO.lang.extend(Ext.asn1.cades.OtherHash,Ext.asn1.ASN1Object);Ext.asn1.cades.CAdESUtil=new function(){};Ext.asn1.cades.CAdESUtil.addSigTS=function(f,d,e){};Ext.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(C){var F=Ext.asn1;var E=Ext.asn1.cms;var G=Ext.asn1.cades.CAdESUtil;var A={};if(ASN1HEX.getDecendantHexTLVByNthList(C,0,[0])!="06092a864886f70d010702"){throw"hex is not CMS SignedData"}var x=ASN1HEX.getDecendantIndexByNthList(C,0,[1,0]);var J=ASN1HEX.getPosArrayOfChildren_AtObj(C,x);if(J.length<4){throw"num of SignedData elem shall be 4 at least"}var y=J.shift();A.version=ASN1HEX.getHexOfTLV_AtObj(C,y);var I=J.shift();A.algs=ASN1HEX.getHexOfTLV_AtObj(C,I);var v=J.shift();A.encapcontent=ASN1HEX.getHexOfTLV_AtObj(C,v);A.certs=null;A.revs=null;A.si=[];var r=J.shift();if(C.substr(r,2)=="a0"){A.certs=ASN1HEX.getHexOfTLV_AtObj(C,r);r=J.shift()}if(C.substr(r,2)=="a1"){A.revs=ASN1HEX.getHexOfTLV_AtObj(C,r);r=J.shift()}var D=r;if(C.substr(D,2)!="31"){throw"Can't find signerInfos"}var H=ASN1HEX.getPosArrayOfChildren_AtObj(C,D);for(var w=0;w<H.length;w++){var u=H[w];var B=G.parseSignerInfoForAddingUnsigned(C,u,w);A.si[w]=B}var i=null;A.obj=new E.SignedData();i=new F.ASN1Object();i.hTLV=A.version;A.obj.dCMSVersion=i;i=new F.ASN1Object();i.hTLV=A.algs;A.obj.dDigestAlgs=i;i=new F.ASN1Object();i.hTLV=A.encapcontent;A.obj.dEncapContentInfo=i;i=new F.ASN1Object();i.hTLV=A.certs;A.obj.dCerts=i;A.obj.signerInfoList=[];for(var w=0;w<A.si.length;w++){A.obj.signerInfoList.push(A.si[w].obj)}return A};Ext.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(A,r,D){var B=Ext.asn1;var q=Ext.asn1.cms;var C={};var y=ASN1HEX.getPosArrayOfChildren_AtObj(A,r);if(y.length!=6){throw"not supported items for SignerInfo (!=6)"}var x=y.shift();C.version=ASN1HEX.getHexOfTLV_AtObj(A,x);var o=y.shift();C.si=ASN1HEX.getHexOfTLV_AtObj(A,o);var s=y.shift();C.digalg=ASN1HEX.getHexOfTLV_AtObj(A,s);var u=y.shift();C.sattrs=ASN1HEX.getHexOfTLV_AtObj(A,u);var v=y.shift();C.sigalg=ASN1HEX.getHexOfTLV_AtObj(A,v);var p=y.shift();C.sig=ASN1HEX.getHexOfTLV_AtObj(A,p);C.sigval=ASN1HEX.getHexOfV_AtObj(A,p);var w=null;C.obj=new q.SignerInfo();w=new B.ASN1Object();w.hTLV=C.version;C.obj.dCMSVersion=w;w=new B.ASN1Object();w.hTLV=C.si;C.obj.dSignerIdentifier=w;w=new B.ASN1Object();w.hTLV=C.digalg;C.obj.dDigestAlgorithm=w;w=new B.ASN1Object();w.hTLV=C.sattrs;C.obj.dSignedAttrs=w;w=new B.ASN1Object();w.hTLV=C.sigalg;C.obj.dSigAlg=w;w=new B.ASN1Object();w.hTLV=C.sig;C.obj.dSig=w;C.obj.dUnsignedAttrs=new q.AttributeList();return C};if(typeof Ext.asn1.csr=="undefined"||!Ext.asn1.csr){Ext.asn1.csr={}}Ext.asn1.csr.CertificationRequest=function(j){Ext.asn1.csr.CertificationRequest.superclass.constructor.call(this);var g=null;var m=null;var k=null;var l=null;var i=null;this.sign=function(b,c){if(this.prvKey==null){this.prvKey=c}this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier({name:b});sig=new Ext.crypto.Signature({alg:b});sig.initSign(this.prvKey);sig.updateHex(this.asn1CSRInfo.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var d=new Ext.asn1.DERSequence({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=d.getEncodedHex();this.isModified=false};this.getPEMString=function(){var b=Ext.asn1.ASN1Util.getPEMStringFromHex(this.getEncodedHex(),"CERTIFICATE REQUEST");return b};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};if(typeof j!="undefined"){if(typeof j.csrinfo!="undefined"){this.asn1CSRInfo=j.csrinfo}}};YAHOO.lang.extend(Ext.asn1.csr.CertificationRequest,Ext.asn1.ASN1Object);Ext.asn1.csr.CertificationRequestInfo=function(b){Ext.asn1.csr.CertificationRequestInfo.superclass.constructor.call(this);this._initialize=function(){this.asn1Array=new Array();this.asn1Version=new Ext.asn1.DERInteger({"int":0});this.asn1Subject=null;this.asn1SubjPKey=null;this.extensionsArray=new Array()};this.setSubjectByParam=function(c){this.asn1Subject=new Ext.asn1.x509.X500Name(c)};this.setSubjectPublicKeyByGetKey=function(d){var c=KEYUTIL.getKey(d);this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(c)};this.appendExtensionByName=function(d,c){Ext.asn1.x509.Extension.appendByNameToArray(d,c,this.extensionsArray)};this.getEncodedHex=function(){this.asn1Array=new Array();this.asn1Array.push(this.asn1Version);this.asn1Array.push(this.asn1Subject);this.asn1Array.push(this.asn1SubjPKey);if(this.extensionsArray.length>0){var i=new Ext.asn1.DERSequence({array:this.extensionsArray});var j=new Ext.asn1.DERSet({array:[i]});var c=new Ext.asn1.DERSequence({array:[new Ext.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.9.14"}),j]});var k=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:c});this.asn1Array.push(k)}else{var k=new Ext.asn1.DERTaggedObject({explicit:false,tag:"a0",obj:new Ext.asn1.DERNull()});this.asn1Array.push(k)}var g=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=g.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize()};YAHOO.lang.extend(Ext.asn1.csr.CertificationRequestInfo,Ext.asn1.ASN1Object);Ext.asn1.csr.CSRUtil=new function(){};Ext.asn1.csr.CSRUtil.newCSRPEM=function(m){var i=Ext.asn1.csr;if(m.subject===undefined){throw"parameter subject undefined"}if(m.sbjpubkey===undefined){throw"parameter sbjpubkey undefined"}if(m.sigalg===undefined){throw"parameter sigalg undefined"}if(m.sbjprvkey===undefined){throw"parameter sbjpubkey undefined"}var n=new i.CertificationRequestInfo();n.setSubjectByParam(m.subject);n.setSubjectPublicKeyByGetKey(m.sbjpubkey);if(m.ext!==undefined&&m.ext.length!==undefined){for(var k=0;k<m.ext.length;k++){for(key in m.ext[k]){n.appendExtensionByName(key,m.ext[k][key])}}}var o=new i.CertificationRequest({csrinfo:n});var j=KEYUTIL.getKey(m.sbjprvkey);o.sign(m.sigalg,j);var l=o.getPEMString();return l};Ext.asn1.csr.CSRUtil.getInfo=function(d){var e={};e.subject={};e.pubkey={};if(d.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1){throw"argument is not PEM file"}var f=ASN1HEX.pemToHex(d,"CERTIFICATE REQUEST");e.subject.hex=ASN1HEX.getDecendantHexTLVByNthList(f,0,[0,1]);e.subject.name=X509.hex2dn(e.subject.hex);e.pubkey.hex=ASN1HEX.getDecendantHexTLVByNthList(f,0,[0,2]);e.pubkey.obj=KEYUTIL.getKey(e.pubkey.hex,null,"pkcs8pub");return e};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.ocsp=="undefined"||!Ext.asn1.ocsp){Ext.asn1.ocsp={}}Ext.asn1.ocsp.DEFAULT_HASH="sha1";Ext.asn1.ocsp.CertID=function(k){Ext.asn1.ocsp.CertID.superclass.constructor.call(this);var g=Ext.asn1;var i=Ext.asn1.x509;this.dHashAlg=null;this.dIssuerNameHash=null;this.dIssuerKeyHash=null;this.dSerialNumber=null;this.setByValue=function(d,e,c,b){if(b===undefined){b=Ext.asn1.ocsp.DEFAULT_HASH}this.dHashAlg=new i.AlgorithmIdentifier({name:b});this.dIssuerNameHash=new g.DEROctetString({hex:d});this.dIssuerKeyHash=new g.DEROctetString({hex:e});this.dSerialNumber=new g.DERInteger({hex:c})};this.setByCert=function(e,r,p){if(p===undefined){p=Ext.asn1.ocsp.DEFAULT_HASH}var b=new X509();b.readCertPEM(r);var d=new X509();d.readCertPEM(e);var c=X509.getPublicKeyInfoPropOfCertPEM(e);var l=c.keyhex;var u=b.getSerialNumberHex();var s=Ext.crypto.Util.hashHex(d.getSubjectHex(),p);var q=Ext.crypto.Util.hashHex(l,p);this.setByValue(s,q,u,p);this.hoge=b.getSerialNumberHex()};this.getEncodedHex=function(){if(this.dHashAlg===null&&this.dIssuerNameHash===null&&this.dIssuerKeyHash===null&&this.dSerialNumber===null){throw"not yet set values"}var c=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber];var b=new g.DERSequence({array:c});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof k!=="undefined"){var f=k;if(typeof f.issuerCert!=="undefined"&&typeof f.subjectCert!=="undefined"){var j=Ext.asn1.ocsp.DEFAULT_HASH;if(typeof f.alg==="undefined"){j=undefined}this.setByCert(f.issuerCert,f.subjectCert,j)}else{if(typeof f.namehash!=="undefined"&&typeof f.keyhash!=="undefined"&&typeof f.serial!=="undefined"){var j=Ext.asn1.ocsp.DEFAULT_HASH;if(typeof f.alg==="undefined"){j=undefined}this.setByValue(f.namehash,f.keyhash,f.serial,j)}else{throw"invalid constructor arguments"}}}};YAHOO.lang.extend(Ext.asn1.ocsp.CertID,Ext.asn1.ASN1Object);Ext.asn1.ocsp.Request=function(c){Ext.asn1.ocsp.Request.superclass.constructor.call(this);this.dReqCert=null;this.dExt=null;this.getEncodedHex=function(){var e=[];if(this.dReqCert===null){throw"reqCert not set"}e.push(this.dReqCert);var b=new Ext.asn1.DERSequence({array:e});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof c!=="undefined"){var d=new Ext.asn1.ocsp.CertID(c);this.dReqCert=d}};YAHOO.lang.extend(Ext.asn1.ocsp.Request,Ext.asn1.ASN1Object);Ext.asn1.ocsp.TBSRequest=function(b){Ext.asn1.ocsp.TBSRequest.superclass.constructor.call(this);this.version=0;this.dRequestorName=null;this.dRequestList=[];this.dRequestExt=null;this.setRequestListByParam=function(c){var g=[];for(var f=0;f<c.length;f++){var i=new Ext.asn1.ocsp.Request(c[0]);g.push(i)}this.dRequestList=g};this.getEncodedHex=function(){var c=[];if(this.version!==0){throw"not supported version: "+this.version}if(this.dRequestorName!==null){throw"requestorName not supported"}var e=new Ext.asn1.DERSequence({array:this.dRequestList});c.push(e);if(this.dRequestExt!==null){throw"requestExtensions not supported"}var f=new Ext.asn1.DERSequence({array:c});this.hTLV=f.getEncodedHex();return this.hTLV};if(typeof b!=="undefined"){if(typeof b.reqList!=="undefined"){this.setRequestListByParam(b.reqList)}}};YAHOO.lang.extend(Ext.asn1.ocsp.TBSRequest,Ext.asn1.ASN1Object);Ext.asn1.ocsp.OCSPRequest=function(c){Ext.asn1.ocsp.OCSPRequest.superclass.constructor.call(this);this.dTbsRequest=null;this.dOptionalSignature=null;this.getEncodedHex=function(){var e=[];if(this.dTbsRequest!==null){e.push(this.dTbsRequest)}else{throw"tbsRequest not set"}if(this.dOptionalSignature!==null){throw"optionalSignature not supported"}var b=new Ext.asn1.DERSequence({array:e});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof c!=="undefined"){if(typeof c.reqList!=="undefined"){var d=new Ext.asn1.ocsp.TBSRequest(c);this.dTbsRequest=d}}};YAHOO.lang.extend(Ext.asn1.ocsp.OCSPRequest,Ext.asn1.ASN1Object);Ext.asn1.ocsp.OCSPUtil={};Ext.asn1.ocsp.OCSPUtil.getRequestHex=function(g,f,i){if(i===undefined){i=Ext.asn1.ocsp.DEFAULT_HASH}var j={alg:i,issuerCert:g,subjectCert:f};var k=new Ext.asn1.ocsp.OCSPRequest({reqList:[j]});return k.getEncodedHex()};Ext.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(n){var i={};try{var m=ASN1HEX.getVbyList(n,0,[0],"0a");i.responseStatus=parseInt(m,16)}catch(k){}if(i.responseStatus!==0){return i}try{var j=ASN1HEX.getDecendantIndexByNthList(n,0,[1,0,1,0,0,2,0,1]);if(n.substr(j,2)==="80"){i.certStatus="good"}else{if(n.substr(j,2)==="a1"){i.certStatus="revoked";i.revocationTime=hextoutf8(ASN1HEX.getDecendantHexVByNthList(n,j,[0]))}else{if(n.substr(j,2)==="82"){i.certStatus="unknown"}}}}catch(k){}try{var l=ASN1HEX.getDecendantIndexByNthList(n,0,[1,0,1,0,0,2,0,2]);i.thisUpdate=hextoutf8(ASN1HEX.getHexOfV_AtObj(n,l))}catch(k){}try{var o=ASN1HEX.getDecendantIndexByNthList(n,0,[1,0,1,0,0,2,0,3]);if(n.substr(o,2)==="a0"){i.nextUpdate=hextoutf8(ASN1HEX.getDecendantHexVByNthList(n,o,[0]))}}catch(k){}return i};var Ext;if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.lang=="undefined"||!Ext.lang){Ext.lang={}}Ext.lang.String=function(){};function Base64x(){}function stoBA(f){var e=new Array();for(var g=0;g<f.length;g++){e[g]=f.charCodeAt(g)}return e}function BAtos(e){var f="";for(var g=0;g<e.length;g++){f=f+String.fromCharCode(e[g])}return f}function BAtohex(i){var j="";for(var f=0;f<i.length;f++){var g=i[f].toString(16);if(g.length==1){g="0"+g}j=j+g}return j}function stohex(b){return BAtohex(stoBA(b))}function stob64(b){return hex2b64(stohex(b))}function stob64u(b){return b64tob64u(hex2b64(stohex(b)))}function b64utos(b){return BAtos(b64toBA(b64utob64(b)))}function b64tob64u(b){b=b.replace(/\=/g,"");b=b.replace(/\+/g,"-");b=b.replace(/\//g,"_");return b}function b64utob64(b){if(b.length%4==2){b=b+"=="}else{if(b.length%4==3){b=b+"="}}b=b.replace(/-/g,"+");b=b.replace(/_/g,"/");return b}function hextob64u(b){if(b.length%2==1){b="0"+b}return b64tob64u(hex2b64(b))}function b64utohex(b){return b64tohex(b64utob64(b))}var utf8tob64u,b64utoutf8;if(typeof Buffer==="function"){utf8tob64u=function(b){return b64tob64u(new Buffer(b,"utf8").toString("base64"))};b64utoutf8=function(b){return new Buffer(b64utob64(b),"base64").toString("utf8")}}else{utf8tob64u=function(b){return hextob64u(uricmptohex(encodeURIComponentAll(b)))};b64utoutf8=function(b){return decodeURIComponent(hextouricmp(b64utohex(b)))}}function utf8tob64(b){return hex2b64(uricmptohex(encodeURIComponentAll(b)))}function b64toutf8(b){return decodeURIComponent(hextouricmp(b64tohex(b)))}function utf8tohex(b){return uricmptohex(encodeURIComponentAll(b))}function hextoutf8(b){return decodeURIComponent(hextouricmp(b))}function hextorstr(f){var d="";for(var e=0;e<f.length-1;e+=2){d+=String.fromCharCode(parseInt(f.substr(e,2),16))}return d}function rstrtohex(f){var e="";for(var d=0;d<f.length;d++){e+=("0"+f.charCodeAt(d).toString(16)).slice(-2)}return e}function hextob64(b){return hex2b64(b)}function hextob64nl(d){var e=hextob64(d);var f=e.replace(/(.{64})/g,"$1\r\n");f=f.replace(/\r\n$/,"");return f}function b64nltohex(d){var e=d.replace(/[^0-9A-Za-z\/+=]*/g,"");var f=b64tohex(e);return f}function hextoArrayBuffer(e){if(e.length%2!=0){throw"input is not even length"}if(e.match(/^[0-9A-Fa-f]+$/)==null){throw"input is not hexadecimal"}var g=new ArrayBuffer(e.length/2);var i=new DataView(g);for(var f=0;f<e.length/2;f++){i.setUint8(f,parseInt(e.substr(f*2,2),16))}return g}function ArrayBuffertohex(g){var e="";var i=new DataView(g);for(var f=0;f<g.byteLength;f++){e+=("00"+i.getUint8(f).toString(16)).slice(-2)}return e}function uricmptohex(b){return b.replace(/%/g,"")}function hextouricmp(b){return b.replace(/(..)/g,"%$1")}function encodeURIComponentAll(i){var e=encodeURIComponent(i);var g="";for(var f=0;f<e.length;f++){if(e[f]=="%"){g=g+e.substr(f,3);f=f+2}else{g=g+"%"+stohex(e[f])}}return g}function newline_toUnix(b){b=b.replace(/\r\n/mg,"\n");return b}function newline_toDos(b){b=b.replace(/\r\n/mg,"\n");b=b.replace(/\n/mg,"\r\n");return b}Ext.lang.String.isInteger=function(b){if(b.match(/^[0-9]+$/)){return true}else{if(b.match(/^-[0-9]+$/)){return true}else{return false}}};Ext.lang.String.isHex=function(b){if(b.length%2==0&&(b.match(/^[0-9a-f]+$/)||b.match(/^[0-9A-F]+$/))){return true}else{return false}};Ext.lang.String.isBase64=function(b){b=b.replace(/\s+/g,"");if(b.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&b.length%4==0){return true}else{return false}};Ext.lang.String.isBase64URL=function(b){if(b.match(/[+/=]/)){return false}b=b64utob64(b);return Ext.lang.String.isBase64(b)};Ext.lang.String.isIntegerArray=function(b){b=b.replace(/\s+/g,"");if(b.match(/^\[[0-9,]+\]$/)){return true}else{return false}};function intarystrtohex(d){d=d.replace(/^\s*\[\s*/,"");d=d.replace(/\s*\]\s*$/,"");d=d.replace(/\s*/g,"");try{var f=d.split(/,/).map(function(c,i,b){var g=parseInt(c);if(g<0||255<g){throw"integer not in range 0-255"}var j=("00"+g.toString(16)).slice(-2);return j}).join("");return f}catch(e){throw"malformed integer array string: "+e}}var strdiffidx=function(f,i){var e=f.length;if(f.length>i.length){e=i.length}for(var g=0;g<e;g++){if(f.charCodeAt(g)!=i.charCodeAt(g)){return g}}if(f.length!=i.length){return e}return -1};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414",};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa",};this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160};this.getDigestInfoHex=function(d,c){if(typeof this.DIGESTINFOHEAD[c]=="undefined"){throw"alg not supported in Util.DIGESTINFOHEAD: "+c}return this.DIGESTINFOHEAD[c]+d};this.getPaddedDigestInfoHex=function(o,w,n){var u=this.getDigestInfoHex(o,w);var r=n/4;if(u.length+22>r){throw"key is too short for SigAlg: keylen="+n+","+w}var v="0001";var i="00"+u;var p="";var m=r-v.length-i.length;for(var q=0;q<m;q+=2){p+="ff"}var s=v+p+i;return s};this.hashString=function(e,f){var d=new Ext.crypto.MessageDigest({alg:f});return d.digestString(e)};this.hashHex=function(d,f){var e=new Ext.crypto.MessageDigest({alg:f});return e.digestHex(d)};this.sha1=function(d){var c=new Ext.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return c.digestString(d)};this.sha256=function(d){var c=new Ext.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return c.digestString(d)};this.sha256Hex=function(d){var c=new Ext.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return c.digestHex(d)};this.sha512=function(d){var c=new Ext.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return c.digestString(d)};this.sha512Hex=function(d){var c=new Ext.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return c.digestHex(d)}};Ext.crypto.Util.md5=function(d){var c=new Ext.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return c.digestString(d)};Ext.crypto.Util.ripemd160=function(d){var c=new Ext.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return c.digestString(d)};Ext.crypto.Util.SECURERANDOMGEN=new SecureRandom();Ext.crypto.Util.getRandomHexOfNbytes=function(c){var d=new Array(c);Ext.crypto.Util.SECURERANDOMGEN.nextBytes(d);return BAtohex(d)};Ext.crypto.Util.getRandomBigIntegerOfNbytes=function(b){return new BigInteger(Ext.crypto.Util.getRandomHexOfNbytes(b),16)};Ext.crypto.Util.getRandomHexOfNbits=function(e){var f=e%8;var i=(e-f)/8;var g=new Array(i+1);Ext.crypto.Util.SECURERANDOMGEN.nextBytes(g);g[0]=(((255<<f)&255)^255)&g[0];return BAtohex(g)};Ext.crypto.Util.getRandomBigIntegerOfNbits=function(b){return new BigInteger(Ext.crypto.Util.getRandomHexOfNbits(b),16)};Ext.crypto.Util.getRandomBigIntegerZeroToMax=function(d){var e=d.bitLength();while(1){var f=Ext.crypto.Util.getRandomBigIntegerOfNbits(e);if(d.compareTo(f)!=-1){return f}}};Ext.crypto.Util.getRandomBigIntegerMinToMax=function(i,f){var k=i.compareTo(f);if(k==1){throw"biMin is greater than biMax"}if(k==0){return i}var g=f.subtract(i);var j=Ext.crypto.Util.getRandomBigIntegerZeroToMax(g);return j.add(i)};Ext.crypto.MessageDigest=function(f){var g=null;var i=null;var e=null;this.setAlgAndProvider=function(b,c){b=Ext.crypto.MessageDigest.getCanonicalAlgName(b);if(b!==null&&c===undefined){c=Ext.crypto.Util.DEFAULTPROVIDER[b]}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(b)!=-1&&c=="cryptojs"){try{this.md=Ext.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[b].create()}catch(d){throw"setAlgAndProvider hash alg set fail alg="+b+"/"+d}this.updateString=function(j){this.md.update(j)};this.updateHex=function(k){var j=CryptoJS.enc.Hex.parse(k);this.md.update(j)};this.digest=function(){var j=this.md.finalize();return j.toString(CryptoJS.enc.Hex)};this.digestString=function(j){this.updateString(j);return this.digest()};this.digestHex=function(j){this.updateHex(j);return this.digest()}}if(":sha256:".indexOf(b)!=-1&&c=="sjcl"){try{this.md=new sjcl.hash.sha256()}catch(d){throw"setAlgAndProvider hash alg set fail alg="+b+"/"+d}this.updateString=function(j){this.md.update(j)};this.updateHex=function(j){var k=sjcl.codec.hex.toBits(j);this.md.update(k)};this.digest=function(){var j=this.md.finalize();return sjcl.codec.hex.fromBits(j)};this.digestString=function(j){this.updateString(j);return this.digest()};this.digestHex=function(j){this.updateHex(j);return this.digest()}}};this.updateString=function(b){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.updateHex=function(b){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestString=function(b){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestHex=function(b){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};if(f!==undefined){if(f.alg!==undefined){this.algName=f.alg;if(f.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};Ext.crypto.MessageDigest.getCanonicalAlgName=function(b){if(typeof b==="string"){b=b.toLowerCase();b=b.replace(/-/,"")}return b};Ext.crypto.MessageDigest.getHashLength=function(f){var d=Ext.crypto.MessageDigest;var e=d.getCanonicalAlgName(f);if(d.HASHLENGTH[e]===undefined){throw"not supported algorithm: "+f}return d.HASHLENGTH[e]};Ext.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};Ext.crypto.Mac=function(g){var j=null;var m=null;var i=null;var k=null;var l=null;this.setAlgAndProvider=function(b,d){b=b.toLowerCase();if(b==null){b="hmacsha1"}b=b.toLowerCase();if(b.substr(0,4)!="hmac"){throw"setAlgAndProvider unsupported HMAC alg: "+b}if(d===undefined){d=Ext.crypto.Util.DEFAULTPROVIDER[b]}this.algProv=b+"/"+d;var f=b.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(f)!=-1&&d=="cryptojs"){try{var c=Ext.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[f];this.mac=CryptoJS.algo.HMAC.create(c,this.pass)}catch(e){throw"setAlgAndProvider hash alg set fail hashAlg="+f+"/"+e}this.updateString=function(n){this.mac.update(n)};this.updateHex=function(o){var n=CryptoJS.enc.Hex.parse(o);this.mac.update(n)};this.doFinal=function(){var n=this.mac.finalize();return n.toString(CryptoJS.enc.Hex)};this.doFinalString=function(n){this.updateString(n);return this.doFinal()};this.doFinalHex=function(n){this.updateHex(n);return this.doFinal()}}};this.updateString=function(b){throw"updateString(str) not supported for this alg/prov: "+this.algProv};this.updateHex=function(b){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv};this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv};this.doFinalString=function(b){throw"digestString(str) not supported for this alg/prov: "+this.algProv};this.doFinalHex=function(b){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv};this.setPassword=function(b){if(typeof b=="string"){var c=b;if(b.length%2==1||!b.match(/^[0-9A-Fa-f]+$/)){c=rstrtohex(b)}this.pass=CryptoJS.enc.Hex.parse(c);return}if(typeof b!="object"){throw"Ext.crypto.Mac unsupported password type: "+b}var c=null;if(b.hex!==undefined){if(b.hex.length%2!=0||!b.hex.match(/^[0-9A-Fa-f]+$/)){throw"Mac: wrong hex password: "+b.hex}c=b.hex}if(b.utf8!==undefined){c=utf8tohex(b.utf8)}if(b.rstr!==undefined){c=rstrtohex(b.rstr)}if(b.b64!==undefined){c=b64tohex(b.b64)}if(b.b64u!==undefined){c=b64utohex(b.b64u)}if(c==null){throw"Ext.crypto.Mac unsupported password type: "+b}this.pass=CryptoJS.enc.Hex.parse(c)};if(g!==undefined){if(g.pass!==undefined){this.setPassword(g.pass)}if(g.alg!==undefined){this.algName=g.alg;if(g.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};Ext.crypto.Signature=function(H){var G=null;var E=null;var w=null;var B=null;var D=null;var u=null;var x=null;var F=null;var v=null;var A=null;var K=-1;var s=null;var C=null;var L=null;var I=null;var y=null;this._setAlgNames=function(){var b=this.algName.match(/^(.+)with(.+)$/);if(b){this.mdAlgName=b[1].toLowerCase();this.pubkeyAlgName=b[2].toLowerCase()}};this._zeroPaddingOfSignature=function(b,c){var d="";var f=c/4-b.length;for(var e=0;e<f;e++){d=d+"0"}return d+b};this.setAlgAndProvider=function(b,c){this._setAlgNames();if(c!="cryptojs/jsrsa"){throw"provider not supported: "+c}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new Ext.crypto.MessageDigest({alg:this.mdAlgName})}catch(d){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+d}this.init=function(f,g){var i=null;try{if(g===undefined){i=KEYUTIL.getKey(f)}else{i=KEYUTIL.getKey(f,g)}}catch(e){throw"init failed:"+e}if(i.isPrivate===true){this.prvKey=i;this.state="SIGN"}else{if(i.isPublic===true){this.pubKey=i;this.state="VERIFY"}else{throw"init failed.:"+i}}};this.initSign=function(e){if(typeof e.ecprvhex=="string"&&typeof e.eccurvename=="string"){this.ecprvhex=e.ecprvhex;this.eccurvename=e.eccurvename}else{this.prvKey=e}this.state="SIGN"};this.initVerifyByPublicKey=function(e){if(typeof e.ecpubhex=="string"&&typeof e.eccurvename=="string"){this.ecpubhex=e.ecpubhex;this.eccurvename=e.eccurvename}else{if(e instanceof Ext.crypto.ECDSA){this.pubKey=e}else{if(e instanceof RSAKey){this.pubKey=e}}}this.state="VERIFY"};this.initVerifyByCertificatePEM=function(f){var e=new X509();e.readCertPEM(f);this.pubKey=e.subjectPublicKeyRSA;this.state="VERIFY"};this.updateString=function(e){this.md.updateString(e)};this.updateHex=function(e){this.md.updateHex(e)};this.sign=function(){this.sHashHex=this.md.digest();if(typeof this.ecprvhex!="undefined"&&typeof this.eccurvename!="undefined"){var e=new Ext.crypto.ECDSA({curve:this.eccurvename});this.hSign=e.signHex(this.sHashHex,this.ecprvhex)}else{if(this.prvKey instanceof RSAKey&&this.pubkeyAlgName=="rsaandmgf1"){this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen)}else{if(this.prvKey instanceof RSAKey&&this.pubkeyAlgName=="rsa"){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName)}else{if(this.prvKey instanceof Ext.crypto.ECDSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{if(this.prvKey instanceof Ext.crypto.DSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}return this.hSign};this.signString=function(e){this.updateString(e);return this.sign()};this.signHex=function(e){this.updateHex(e);return this.sign()};this.verify=function(f){this.sHashHex=this.md.digest();if(typeof this.ecpubhex!="undefined"&&typeof this.eccurvename!="undefined"){var e=new Ext.crypto.ECDSA({curve:this.eccurvename});return e.verifyHex(this.sHashHex,f,this.ecpubhex)}else{if(this.pubKey instanceof RSAKey&&this.pubkeyAlgName=="rsaandmgf1"){return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,f,this.mdAlgName,this.pssSaltLen)}else{if(this.pubKey instanceof RSAKey&&this.pubkeyAlgName=="rsa"){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{if(this.pubKey instanceof Ext.crypto.ECDSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{if(this.pubKey instanceof Ext.crypto.DSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}}}};this.init=function(c,b){throw"init(key, pass) not supported for this alg:prov="+this.algProvName};this.initVerifyByPublicKey=function(b){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName};this.initVerifyByCertificatePEM=function(b){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName};this.initSign=function(b){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName};this.updateString=function(b){throw"updateString(str) not supported for this alg:prov="+this.algProvName};this.updateHex=function(b){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName};this.signString=function(b){throw"digestString(str) not supported for this alg:prov="+this.algProvName};this.signHex=function(b){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName};this.verify=function(b){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName};this.initParams=H;if(H!==undefined){if(H.alg!==undefined){this.algName=H.alg;if(H.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}else{this.provName=H.prov}this.algProvName=this.algName+":"+this.provName;this.setAlgAndProvider(this.algName,this.provName);this._setAlgNames()}if(H.psssaltlen!==undefined){this.pssSaltLen=H.psssaltlen}if(H.prvkeypem!==undefined){if(H.prvkeypas!==undefined){throw"both prvkeypem and prvkeypas parameters not supported"}else{try{var G=new RSAKey();G.readPrivateKeyFromPEMString(H.prvkeypem);this.initSign(G)}catch(J){throw"fatal error to load pem private key: "+J}}}}};Ext.crypto.Cipher=function(b){};Ext.crypto.Cipher.encrypt=function(j,i,k){if(i instanceof RSAKey&&i.isPublic){var l=Ext.crypto.Cipher.getAlgByKeyAndName(i,k);if(l==="RSA"){return i.encrypt(j)}if(l==="RSAOAEP"){return i.encryptOAEP(j,"sha1")}var g=l.match(/^RSAOAEP(\d+)$/);if(g!==null){return i.encryptOAEP(j,"sha"+g[1])}throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+k}else{throw"Cipher.encrypt: unsupported key or algorithm"}};Ext.crypto.Cipher.decrypt=function(j,i,k){if(i instanceof RSAKey&&i.isPrivate){var l=Ext.crypto.Cipher.getAlgByKeyAndName(i,k);if(l==="RSA"){return i.decrypt(j)}if(l==="RSAOAEP"){return i.decryptOAEP(j,"sha1")}var g=l.match(/^RSAOAEP(\d+)$/);if(g!==null){return i.decryptOAEP(j,"sha"+g[1])}throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+k}else{throw"Cipher.decrypt: unsupported key or algorithm"}};Ext.crypto.Cipher.getAlgByKeyAndName=function(c,d){if(c instanceof RSAKey){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(d)!=-1){return d}if(d===null||d===undefined){return"RSA"}throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+d}throw"getAlgByKeyAndName: not supported algorithm name: "+d};Ext.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA",}};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.ECDSA=function(m){var i="secp256r1";var k=null;var o=null;var l=null;var j=new SecureRandom();var p=null;this.type="EC";this.isPrivate=false;this.isPublic=false;function n(b,f,d,g){var c=Math.max(f.bitLength(),g.bitLength());var e=b.add2D(d);var q=b.curve.getInfinity();for(var r=c-1;r>=0;--r){q=q.twice2D();q.z=BigInteger.ONE;if(f.testBit(r)){if(g.testBit(r)){q=q.add2D(e)}else{q=q.add2D(b)}}else{if(g.testBit(r)){q=q.add2D(d)}}}return q}this.getBigRandom=function(b){return new BigInteger(b.bitLength(),j).mod(b.subtract(BigInteger.ONE)).add(BigInteger.ONE)};this.setNamedCurve=function(b){this.ecparams=Ext.crypto.ECParameterDB.getByName(b);this.prvKeyHex=null;this.pubKeyHex=null;this.curveName=b};this.setPrivateKeyHex=function(b){this.isPrivate=true;this.prvKeyHex=b};this.setPublicKeyHex=function(b){this.isPublic=true;this.pubKeyHex=b};this.getPublicKeyXYHex=function(){var b=this.pubKeyHex;if(b.substr(0,2)!=="04"){throw"this method supports uncompressed format(04) only"}var c=this.ecparams.keylen/4;if(b.length!==2+c*2){throw"malformed public key hex length"}var d={};d.x=b.substr(2,c);d.y=b.substr(2+c);return d};this.getShortNISTPCurveName=function(){var b=this.curveName;if(b==="secp256r1"||b==="NIST P-256"||b==="P-256"||b==="prime256v1"){return"P-256"}if(b==="secp384r1"||b==="NIST P-384"||b==="P-384"){return"P-384"}return null};this.generateKeyPairHex=function(){var u=this.ecparams.n;var q=this.getBigRandom(u);var s=this.ecparams.G.multiply(q);var e=s.getX().toBigInteger();var g=s.getY().toBigInteger();var c=this.ecparams.keylen/4;var r=("0000000000"+q.toString(16)).slice(-c);var d=("0000000000"+e.toString(16)).slice(-c);var f=("0000000000"+g.toString(16)).slice(-c);var b="04"+d+f;this.setPrivateKeyHex(r);this.setPublicKeyHex(b);return{ecprvhex:r,ecpubhex:b}};this.signWithMessageHash=function(b){return this.signHex(b,this.prvKeyHex)};this.signHex=function(e,q){var b=new BigInteger(q,16);var g=this.ecparams.n;var c=new BigInteger(e,16);do{var f=this.getBigRandom(g);var w=this.ecparams.G;var d=w.multiply(f);var r=d.getX().toBigInteger().mod(g)}while(r.compareTo(BigInteger.ZERO)<=0);var s=f.modInverse(g).multiply(c.add(b.multiply(r))).mod(g);return Ext.crypto.ECDSA.biRSSigToASN1Sig(r,s)};this.sign=function(f,w){var c=w;var q=this.ecparams.n;var d=BigInteger.fromByteArrayUnsigned(f);do{var g=this.getBigRandom(q);var b=this.ecparams.G;var e=b.multiply(g);var r=e.getX().toBigInteger().mod(q)}while(r.compareTo(BigInteger.ZERO)<=0);var s=g.modInverse(q).multiply(d.add(c.multiply(r))).mod(q);return this.serializeSig(r,s)};this.verifyWithMessageHash=function(b,c){return this.verifyHex(b,c,this.pubKeyHex)};this.verifyHex=function(b,f,q){var d,c;var g=Ext.crypto.ECDSA.parseSigHex(f);d=g.r;c=g.s;var e;e=ECPointFp.decodeFromHex(this.ecparams.curve,q);var r=new BigInteger(b,16);return this.verifyRaw(r,d,c,e)};this.verify=function(f,q,b){var c,g;if(Bitcoin.Util.isArray(q)){var r=this.parseSig(q);c=r.r;g=r.s}else{if("object"===typeof q&&q.r&&q.s){c=q.r;g=q.s}else{throw"Invalid value for signature"}}var d;if(b instanceof ECPointFp){d=b}else{if(Bitcoin.Util.isArray(b)){d=ECPointFp.decodeFrom(this.ecparams.curve,b)}else{throw"Invalid format for pubkey value, must be byte array or ECPointFp"}}var e=BigInteger.fromByteArrayUnsigned(f);return this.verifyRaw(e,c,g,d)};this.verifyRaw=function(f,d,v,g){var q=this.ecparams.n;var x=this.ecparams.G;if(d.compareTo(BigInteger.ONE)<0||d.compareTo(q)>=0){return false}if(v.compareTo(BigInteger.ONE)<0||v.compareTo(q)>=0){return false}var e=v.modInverse(q);var r=f.multiply(e).mod(q);var s=d.multiply(e).mod(q);var b=x.multiply(r).add(g.multiply(s));var c=b.getX().toBigInteger().mod(q);return c.equals(d)};this.serializeSig=function(d,e){var c=d.toByteArraySigned();var f=e.toByteArraySigned();var b=[];b.push(2);b.push(c.length);b=b.concat(c);b.push(2);b.push(f.length);b=b.concat(f);b.unshift(b.length);b.unshift(48);return b};this.parseSig=function(g){var b;if(g[0]!=48){throw new Error("Signature not a valid DERSequence")}b=2;if(g[b]!=2){throw new Error("First element in signature must be a DERInteger")}var c=g.slice(b+2,b+2+g[b+1]);b+=2+g[b+1];if(g[b]!=2){throw new Error("Second element in signature must be a DERInteger")}var f=g.slice(b+2,b+2+g[b+1]);b+=2+g[b+1];var d=BigInteger.fromByteArrayUnsigned(c);var e=BigInteger.fromByteArrayUnsigned(f);return{r:d,s:e}};this.parseSigCompact=function(b){if(b.length!==65){throw"Signature has the wrong length"}var e=b[0]-27;if(e<0||e>7){throw"Invalid signature type"}var f=this.ecparams.n;var c=BigInteger.fromByteArrayUnsigned(b.slice(1,33)).mod(f);var d=BigInteger.fromByteArrayUnsigned(b.slice(33,65)).mod(f);return{r:c,s:d,i:e}};this.readPKCS5PrvKeyHex=function(b){var f=ASN1HEX;var d=Ext.crypto.ECDSA.getName;var g=f.getVbyList;if(f.isASN1HEX(b)===false){throw"not ASN.1 hex string"}var q,c,r;try{q=g(b,0,[2,0],"06");c=g(b,0,[1],"04");try{r=g(b,0,[3,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#1/5 plain ECC private key"}this.curveName=d(q);if(this.curveName===undefined){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(r);this.setPrivateKeyHex(c);this.isPublic=false};this.readPKCS8PrvKeyHex=function(q){var c=ASN1HEX;var b=Ext.crypto.ECDSA.getName;var f=c.getVbyList;if(c.isASN1HEX(q)===false){throw"not ASN.1 hex string"}var s,d,g,r;try{s=f(q,0,[1,0],"06");d=f(q,0,[1,1],"06");g=f(q,0,[2,0,1],"04");try{r=f(q,0,[2,0,2,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#8 plain ECC private key"}this.curveName=b(d);if(this.curveName===undefined){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(r);this.setPrivateKeyHex(g);this.isPublic=false};this.readPKCS8PubKeyHex=function(b){var f=ASN1HEX;var d=Ext.crypto.ECDSA.getName;var g=f.getVbyList;if(f.isASN1HEX(b)===false){throw"not ASN.1 hex string"}var c,q,r;try{c=g(b,0,[0,0],"06");q=g(b,0,[0,1],"06");r=g(b,0,[1],"03").substr(2)}catch(e){throw"malformed PKCS#8 ECC public key"}this.curveName=d(q);if(this.curveName===null){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(r)};this.readCertPubKeyHex=function(b,f){if(f!==5){f=6}var c=ASN1HEX;var d=Ext.crypto.ECDSA.getName;var q=c.getVbyList;if(c.isASN1HEX(b)===false){throw"not ASN.1 hex string"}var g,r;try{g=q(b,0,[0,f,0,1],"06");r=q(b,0,[0,f,1],"03").substr(2)}catch(e){throw"malformed X.509 certificate ECC public key"}this.curveName=d(g);if(this.curveName===null){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(r)};if(m!==undefined){if(m.curve!==undefined){this.curveName=m.curve}}if(this.curveName===undefined){this.curveName=i}this.setNamedCurve(this.curveName);if(m!==undefined){if(m.prv!==undefined){this.setPrivateKeyHex(m.prv)}if(m.pub!==undefined){this.setPublicKeyHex(m.pub)}}};Ext.crypto.ECDSA.parseSigHex=function(i){var g=Ext.crypto.ECDSA.parseSigHexInHexRS(i);var e=new BigInteger(g.r,16);var f=new BigInteger(g.s,16);return{r:e,s:f}};Ext.crypto.ECDSA.parseSigHexInHexRS=function(n){if(n.substr(0,2)!="30"){throw"signature is not a ASN.1 sequence"}var i=ASN1HEX.getPosArrayOfChildren_AtObj(n,0);if(i.length!=2){throw"number of signature ASN.1 sequence elements seem wrong"}var j=i[0];var k=i[1];if(n.substr(j,2)!="02"){throw"1st item of sequene of signature is not ASN.1 integer"}if(n.substr(k,2)!="02"){throw"2nd item of sequene of signature is not ASN.1 integer"}var l=ASN1HEX.getHexOfV_AtObj(n,j);var m=ASN1HEX.getHexOfV_AtObj(n,k);return{r:l,s:m}};Ext.crypto.ECDSA.asn1SigToConcatSig=function(f){var e=Ext.crypto.ECDSA.parseSigHexInHexRS(f);var g=e.r;var i=e.s;if(g.substr(0,2)=="00"&&(((g.length/2)*8)%(16*8))==8){g=g.substr(2)}if(i.substr(0,2)=="00"&&(((i.length/2)*8)%(16*8))==8){i=i.substr(2)}if((((g.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig r length error"}if((((i.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig s length error"}return g+i};Ext.crypto.ECDSA.concatSigToASN1Sig=function(e){if((((e.length/2)*8)%(16*8))!=0){throw"unknown ECDSA concatinated r-s sig  length error"}var f=e.substr(0,e.length/2);var d=e.substr(e.length/2);return Ext.crypto.ECDSA.hexRSSigToASN1Sig(f,d)};Ext.crypto.ECDSA.hexRSSigToASN1Sig=function(g,i){var e=new BigInteger(g,16);var f=new BigInteger(i,16);return Ext.crypto.ECDSA.biRSSigToASN1Sig(e,f)};Ext.crypto.ECDSA.biRSSigToASN1Sig=function(i,k){var f=new Ext.asn1.DERInteger({bigint:i});var g=new Ext.asn1.DERInteger({bigint:k});var j=new Ext.asn1.DERSequence({array:[f,g]});return j.getEncodedHex()};Ext.crypto.ECDSA.getName=function(b){if(b==="2a8648ce3d030107"){return"secp256r1"}if(b==="2b8104000a"){return"secp256k1"}if(b==="2b81040022"){return"secp384r1"}if("|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(b)!==-1){return"secp256r1"}if("|secp256k1|".indexOf(b)!==-1){return"secp256k1"}if("|secp384r1|NIST P-384|P-384|".indexOf(b)!==-1){return"secp384r1"}return null};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.ECParameterDB=new function(){var d={};var f={};function e(b){return new BigInteger(b,16)}this.getByName=function(b){var c=b;if(typeof f[c]!="undefined"){c=f[b]}if(typeof d[c]!="undefined"){return d[c]}throw"unregistered EC curve name: "+c};this.regist=function(C,I,D,L,H,N,K,M,J,G,O,g){d[C]={};var n=e(D);var b=e(L);var c=e(H);var i=e(N);var E=e(K);var p=new ECCurveFp(n,b,c);var B=p.decodePointHex("04"+M+J);d[C]["name"]=C;d[C]["keylen"]=I;d[C]["curve"]=p;d[C]["G"]=B;d[C]["n"]=i;d[C]["h"]=E;d[C]["oid"]=O;d[C]["info"]=g;for(var F=0;F<G.length;F++){f[G[F]]=C}}};Ext.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");Ext.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");Ext.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");Ext.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);Ext.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);Ext.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);Ext.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);Ext.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);Ext.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);Ext.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.DSA=function(){this.p=null;this.q=null;this.g=null;this.y=null;this.x=null;this.type="DSA";this.isPrivate=false;this.isPublic=false;this.setPrivate=function(j,k,f,i,g){this.isPrivate=true;this.p=j;this.q=k;this.g=f;this.y=i;this.x=g};this.setPrivateHex=function(q,s,o,l,k){var r,u,p,n,m;r=new BigInteger(q,16);u=new BigInteger(s,16);p=new BigInteger(o,16);if(typeof l==="string"&&l.length>1){n=new BigInteger(l,16)}else{n=null}m=new BigInteger(k,16);this.setPrivate(r,u,p,n,m)};this.setPublic=function(f,g,i,e){this.isPublic=true;this.p=f;this.q=g;this.g=i;this.y=e;this.x=null};this.setPublicHex=function(m,i,o,k){var p,l,j,n;p=new BigInteger(m,16);l=new BigInteger(i,16);j=new BigInteger(o,16);n=new BigInteger(k,16);this.setPublic(p,l,j,n)};this.signWithMessageHash=function(v){var w=this.p;var x=this.q;var s=this.g;var q=this.y;var p=this.x;var u=Ext.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),x.subtract(BigInteger.ONE));var o=v.substr(0,x.bitLength()/4);var r=new BigInteger(o,16);var y=(s.modPow(u,w)).mod(x);var g=(u.modInverse(x).multiply(r.add(p.multiply(y)))).mod(x);var k=Ext.asn1.ASN1Util.jsonToASN1HEX({seq:[{"int":{bigint:y}},{"int":{bigint:g}}]});return k};this.verifyWithMessageHash=function(y,x){var C=this.p;var q=this.q;var u=this.g;var r=this.y;var A=this.parseASN1Signature(x);var E=A[0];var g=A[1];var v=y.substr(0,q.bitLength()/4);var D=new BigInteger(v,16);if(BigInteger.ZERO.compareTo(E)>0||E.compareTo(q)>0){throw"invalid DSA signature"}if(BigInteger.ZERO.compareTo(g)>0||g.compareTo(q)>0){throw"invalid DSA signature"}var B=g.modInverse(q);var s=D.multiply(B).mod(q);var w=E.multiply(B).mod(q);var p=u.modPow(s,C).multiply(r.modPow(w,C)).mod(C).mod(q);return p.compareTo(E)==0};this.parseASN1Signature=function(i){try{var e=new BigInteger(ASN1HEX.getVbyList(i,0,[0],"02"),16);var f=new BigInteger(ASN1HEX.getVbyList(i,0,[1],"02"),16);return[e,f]}catch(g){throw"malformed ASN.1 DSA signature"}};this.readPKCS5PrvKeyHex=function(q){var r,s,n,m,l;var k=ASN1HEX;var p=k.getVbyList;if(k.isASN1HEX(q)===false){throw"not ASN.1 hex string"}try{r=p(q,0,[1],"02");s=p(q,0,[2],"02");n=p(q,0,[3],"02");m=p(q,0,[4],"02");l=p(q,0,[5],"02")}catch(o){console.log("EXCEPTION:"+o);throw"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(r,s,n,m,l)};this.readPKCS8PrvKeyHex=function(p){var j,k,m,o;var n=ASN1HEX;var l=n.getVbyList;if(n.isASN1HEX(p)===false){throw"not ASN.1 hex string"}try{j=l(p,0,[1,1,0],"02");k=l(p,0,[1,1,1],"02");m=l(p,0,[1,1,2],"02");o=l(p,0,[2,0],"02")}catch(q){console.log("EXCEPTION:"+q);throw"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(j,k,m,null,o)};this.readPKCS8PubKeyHex=function(p){var j,k,m,o;var n=ASN1HEX;var l=n.getVbyList;if(n.isASN1HEX(p)===false){throw"not ASN.1 hex string"}try{j=l(p,0,[0,1,0],"02");k=l(p,0,[0,1,1],"02");m=l(p,0,[0,1,2],"02");o=l(p,0,[1,0],"02")}catch(q){console.log("EXCEPTION:"+q);throw"malformed PKCS#8 DSA public key"}this.setPublicHex(j,k,m,o)};this.readCertPubKeyHex=function(q,n){if(n!==5){n=6}var r,s,m,l;var k=ASN1HEX;var p=k.getVbyList;if(k.isASN1HEX(q)===false){throw"not ASN.1 hex string"}try{r=p(q,0,[0,n,0,1,0],"02");s=p(q,0,[0,n,0,1,1],"02");m=p(q,0,[0,n,0,1,2],"02");l=p(q,0,[0,n,1,0],"02")}catch(o){console.log("EXCEPTION:"+o);throw"malformed X.509 certificate DSA public key"}this.setPublicHex(r,s,m,l)}};var PKCS5PKEY=function(){var A=function(d,b,c){return q(CryptoJS.AES,d,b,c)};var B=function(d,b,c){return q(CryptoJS.TripleDES,d,b,c)};var q=function(e,j,c,g){var f=CryptoJS.enc.Hex.parse(j);var k=CryptoJS.enc.Hex.parse(c);var i=CryptoJS.enc.Hex.parse(g);var d={};d.key=k;d.iv=i;d.ciphertext=f;var b=e.decrypt(d,k,{iv:i});return CryptoJS.enc.Hex.stringify(b)};var w=function(d,b,c){return o(CryptoJS.AES,d,b,c)};var r=function(d,b,c){return o(CryptoJS.TripleDES,d,b,c)};var o=function(m,i,l,d){var c=CryptoJS.enc.Hex.parse(i);var k=CryptoJS.enc.Hex.parse(l);var f=CryptoJS.enc.Hex.parse(d);var g={};var j=m.encrypt(c,k,{iv:f});var e=CryptoJS.enc.Hex.parse(j.toString());var b=CryptoJS.enc.Base64.stringify(e);return b};var v={"AES-256-CBC":{proc:A,eproc:w,keylen:32,ivlen:16},"AES-192-CBC":{proc:A,eproc:w,keylen:24,ivlen:16},"AES-128-CBC":{proc:A,eproc:w,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:B,eproc:r,keylen:24,ivlen:8}};var s=function(b){return v[b]["proc"]};var x=function(d){var b=CryptoJS.lib.WordArray.random(d);var c=CryptoJS.enc.Hex.stringify(b);return c};var C=function(f){var e={};var b=f.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));if(b){e.cipher=b[1];e.ivsalt=b[2]}var c=f.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));if(c){e.type=c[1]}var g=-1;var d=0;if(f.indexOf("\r\n\r\n")!=-1){g=f.indexOf("\r\n\r\n");d=2}if(f.indexOf("\n\n")!=-1){g=f.indexOf("\n\n");d=1}var i=f.indexOf("-----END");if(g!=-1&&i!=-1){var j=f.substring(g+d*2,i-d);j=j.replace(/\s+/g,"");e.data=j}return e};var y=function(f,i,g){var l=g.substring(0,16);var c=CryptoJS.enc.Hex.parse(l);var d=CryptoJS.enc.Utf8.parse(i);var m=v[f]["keylen"]+v[f]["ivlen"];var k="";var e=null;for(;;){var b=CryptoJS.algo.MD5.create();if(e!=null){b.update(e)}b.update(d);b.update(c);e=b.finalize();k=k+CryptoJS.enc.Hex.stringify(e);if(k.length>=m*2){break}}var j={};j.keyhex=k.substr(0,v[f]["keylen"]*2);j.ivhex=k.substr(v[f]["keylen"]*2,v[f]["ivlen"]*2);return j};var u=function(c,e,j,d){var i=CryptoJS.enc.Base64.parse(c);var b=CryptoJS.enc.Hex.stringify(i);var f=v[e]["proc"];var g=f(b,j,d);return g};var p=function(g,d,f,b){var e=v[d]["eproc"];var c=e(g,f,b);return c};return{version:"1.0.5",getHexFromPEM:function(c,b){return ASN1HEX.pemToHex(c,b)},getDecryptedKeyHexByKeyIV:function(e,b,c,d){var f=s(b);return f(e,c,d)},parsePKCS5PEM:function(b){return C(b)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(c,d,b){return y(c,d,b)},decryptKeyB64:function(c,e,b,d){return u(c,e,b,d)},getDecryptedKeyHex:function(f,g){var d=C(f);var l=d.type;var c=d.cipher;var e=d.ivsalt;var b=d.data;var i=y(c,g,e);var j=i.keyhex;var k=u(b,c,j,e);return k},getRSAKeyFromEncryptedPKCS5PEM:function(e,b){var d=this.getDecryptedKeyHex(e,b);var c=new RSAKey();c.readPrivateKeyFromASN1HexString(d);return c},getEncryptedPKCS5PEMFromPrvKeyHex:function(d,g,c,f){if(typeof c=="undefined"||c==null){c="AES-256-CBC"}if(typeof v[c]=="undefined"){throw"PKCS5PKEY unsupported algorithm: "+c}if(typeof f=="undefined"||f==null){var l=v[c]["ivlen"];var m=x(l);f=m.toUpperCase()}var i=y(c,g,f);var k=i.keyhex;var b=p(d,c,k,f);var j=b.replace(/(.{64})/g,"$1\r\n");var e="-----BEGIN RSA PRIVATE KEY-----\r\n";e+="Proc-Type: 4,ENCRYPTED\r\n";e+="DEK-Info: "+c+","+f+"\r\n";e+="\r\n";e+=j;e+="\r\n-----END RSA PRIVATE KEY-----\r\n";return e},getEncryptedPKCS5PEMFromRSAKey:function(d,i,m,G){var n=new Ext.asn1.DERInteger({"int":0});var F=new Ext.asn1.DERInteger({bigint:d.n});var f=new Ext.asn1.DERInteger({"int":d.e});var k=new Ext.asn1.DERInteger({bigint:d.d});var g=new Ext.asn1.DERInteger({bigint:d.p});var D=new Ext.asn1.DERInteger({bigint:d.q});var j=new Ext.asn1.DERInteger({bigint:d.dmp1});var l=new Ext.asn1.DERInteger({bigint:d.dmq1});var c=new Ext.asn1.DERInteger({bigint:d.coeff});var b=new Ext.asn1.DERSequence({array:[n,F,f,k,g,D,j,l,c]});var e=b.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex(e,i,m,G)},newEncryptedPKCS5PEM:function(g,f,c,b){if(typeof f=="undefined"||f==null){f=1024}if(typeof c=="undefined"||c==null){c="10001"}var e=new RSAKey();e.generate(f,c);var d=null;if(typeof b=="undefined"||b==null){d=this.getEncryptedPKCS5PEMFromRSAKey(pkey,g)}else{d=this.getEncryptedPKCS5PEMFromRSAKey(pkey,g,b)}return d},getRSAKeyFromPlainPKCS8PEM:function(b){if(b.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var c=ASN1HEX.pemToHex(b,"PRIVATE KEY");var d=this.getRSAKeyFromPlainPKCS8Hex(c);return d},getRSAKeyFromPlainPKCS8Hex:function(b){var c=new RSAKey();c.readPKCS8PrvKeyHex(b);return c},parseHexOfEncryptedPKCS8:function(i){var b={};var c=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(c.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+c.length}b.ciphertext=ASN1HEX.getHexOfV_AtObj(i,c[1]);var f=ASN1HEX.getPosArrayOfChildren_AtObj(i,c[0]);if(f.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+f.length}if(ASN1HEX.getHexOfV_AtObj(i,f[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(i,f[1]);if(f.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+e.length}var d=ASN1HEX.getPosArrayOfChildren_AtObj(i,e[1]);if(d.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+d.length}if(ASN1HEX.getHexOfV_AtObj(i,d[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}b.encryptionSchemeAlg="TripleDES";b.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(i,d[1]);var l=ASN1HEX.getPosArrayOfChildren_AtObj(i,e[0]);if(l.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+l.length}if(ASN1HEX.getHexOfV_AtObj(i,l[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var g=ASN1HEX.getPosArrayOfChildren_AtObj(i,l[1]);if(g.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+g.length}b.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(i,g[0]);var k=ASN1HEX.getHexOfV_AtObj(i,g[1]);try{b.pbkdf2Iter=parseInt(k,16)}catch(j){throw"malformed format pbkdf2Iter: "+k}return b},getPBKDF2KeyHexFromParam:function(b,g){var c=CryptoJS.enc.Hex.parse(b.pbkdf2Salt);var f=b.pbkdf2Iter;var d=CryptoJS.PBKDF2(g,c,{keySize:192/32,iterations:f});var e=CryptoJS.enc.Hex.stringify(d);return e},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(g,f){var c=ASN1HEX.pemToHex(g,"ENCRYPTED PRIVATE KEY");var e=this.parseHexOfEncryptedPKCS8(c);var k=PKCS5PKEY.getPBKDF2KeyHexFromParam(e,f);var j={};j.ciphertext=CryptoJS.enc.Hex.parse(e.ciphertext);var l=CryptoJS.enc.Hex.parse(k);var b=CryptoJS.enc.Hex.parse(e.encryptionSchemeIV);var i=CryptoJS.TripleDES.decrypt(j,l,{iv:b});var d=CryptoJS.enc.Hex.stringify(i);return d},getRSAKeyFromEncryptedPKCS8PEM:function(d,e){var b=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(d,e);var c=this.getRSAKeyFromPlainPKCS8Hex(b);return c},getKeyFromEncryptedPKCS8PEM:function(d,b){var c=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(d,b);var e=this.getKeyFromPlainPrivatePKCS8Hex(c);return e},parsePlainPrivatePKCS8Hex:function(d){var b={};b.algparam=null;if(d.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(d,0);if(e.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(d.substr(e[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(d,e[1]);if(c.length!=2){throw"malformed PKCS8 private key(code:004)"}if(d.substr(c[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}b.algoid=ASN1HEX.getHexOfV_AtObj(d,c[0]);if(d.substr(c[1],2)=="06"){b.algparam=ASN1HEX.getHexOfV_AtObj(d,c[1])}if(d.substr(e[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}b.keyidx=ASN1HEX.getStartPosOfV_AtObj(d,e[2]);return b},getKeyFromPlainPrivatePKCS8PEM:function(c){var d=ASN1HEX.pemToHex(c,"PRIVATE KEY");var b=this.getKeyFromPlainPrivatePKCS8Hex(d);return b},getKeyFromPlainPrivatePKCS8Hex:function(d){var c=this.parsePlainPrivatePKCS8Hex(d);var b;if(c.algoid=="2a864886f70d010101"){b=new RSAKey()}else{if(c.algoid=="2a8648ce380401"){b=new Ext.crypto.DSA()}else{if(c.algoid=="2a8648ce3d0201"){b=new Ext.crypto.ECDSA()}else{throw"unsupported private key algorithm"}}}b.readPKCS8PrvKeyHex(d);return b},getRSAKeyFromPublicPKCS8PEM:function(c){var b=ASN1HEX.pemToHex(c,"PUBLIC KEY");var d=this.getRSAKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8PEM:function(c){var b=ASN1HEX.pemToHex(c,"PUBLIC KEY");var d=this.getKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8Hex:function(d){var c;var b=ASN1HEX.getVbyList(h,0,[0,0],"06");if(b==="2a864886f70d010101"){c=new RSAKey()}else{if(b==="2a8648ce380401"){c=new Ext.crypto.DSA()}else{if(b==="2a8648ce3d0201"){c=new Ext.crypto.ECDSA()}else{throw"unsupported PKCS#8 public key hex"}}}c.readPKCS8PubKeyHex(h);return c},parsePublicRawRSAKeyHex:function(b){var d={};if(b.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=2){throw"malformed RSA key(code:002)"}if(b.substr(c[0],2)!="02"){throw"malformed RSA key(code:003)"}d.n=ASN1HEX.getHexOfV_AtObj(b,c[0]);if(b.substr(c[1],2)!="02"){throw"malformed RSA key(code:004)"}d.e=ASN1HEX.getHexOfV_AtObj(b,c[1]);return d},parsePrivateRawRSAKeyHexAtObj:function(b,d){var e=d.keyidx;if(b.substr(e,2)!="30"){throw"malformed RSA private key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,e);if(c.length!=9){throw"malformed RSA private key(code:002)"}d.key={};d.key.n=ASN1HEX.getHexOfV_AtObj(b,c[1]);d.key.e=ASN1HEX.getHexOfV_AtObj(b,c[2]);d.key.d=ASN1HEX.getHexOfV_AtObj(b,c[3]);d.key.p=ASN1HEX.getHexOfV_AtObj(b,c[4]);d.key.q=ASN1HEX.getHexOfV_AtObj(b,c[5]);d.key.dp=ASN1HEX.getHexOfV_AtObj(b,c[6]);d.key.dq=ASN1HEX.getHexOfV_AtObj(b,c[7]);d.key.co=ASN1HEX.getHexOfV_AtObj(b,c[8])},parsePrivateRawECKeyHexAtObj:function(b,d){var e=d.keyidx;if(b.substr(e,2)!="30"){throw"malformed ECC private key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,e);if(c.length!=3){throw"malformed ECC private key(code:002)"}if(b.substr(c[1],2)!="04"){throw"malformed ECC private key(code:003)"}d.key=ASN1HEX.getHexOfV_AtObj(b,c[1])},parsePublicPKCS8Hex:function(c){var e={};e.algparam=null;var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=2){throw"outer DERSequence shall have 2 elements: "+d.length}var b=d[0];if(c.substr(b,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var f=ASN1HEX.getPosArrayOfChildren_AtObj(c,b);if(f.length!=2){throw"malformed PKCS8 public key(code:002)"}if(c.substr(f[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}e.algoid=ASN1HEX.getHexOfV_AtObj(c,f[0]);if(c.substr(f[1],2)=="06"){e.algparam=ASN1HEX.getHexOfV_AtObj(c,f[1])}if(c.substr(d[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}e.key=ASN1HEX.getHexOfV_AtObj(c,d[1]).substr(2);return e},getRSAKeyFromPublicPKCS8Hex:function(c){var b=new RSAKey();b.readPKCS8PubKeyHex(c);return b},}}();var KEYUTIL=function(){var w=function(d,b,c){return A(CryptoJS.AES,d,b,c)};var x=function(d,b,c){return A(CryptoJS.TripleDES,d,b,c)};var p=function(d,b,c){return A(CryptoJS.DES,d,b,c)};var A=function(k,e,i,c){var b=CryptoJS.enc.Hex.parse(e);var f=CryptoJS.enc.Hex.parse(i);var d=CryptoJS.enc.Hex.parse(c);var j={};j.key=f;j.iv=d;j.ciphertext=b;var g=k.decrypt(j,f,{iv:d});return CryptoJS.enc.Hex.stringify(g)};var F=function(d,b,c){return s(CryptoJS.AES,d,b,c)};var u=function(d,b,c){return s(CryptoJS.TripleDES,d,b,c)};var E=function(d,b,c){return s(CryptoJS.DES,d,b,c)};var s=function(k,e,i,c){var l=CryptoJS.enc.Hex.parse(e);var f=CryptoJS.enc.Hex.parse(i);var d=CryptoJS.enc.Hex.parse(c);var g=k.encrypt(l,f,{iv:d});var b=CryptoJS.enc.Hex.parse(g.toString());var j=CryptoJS.enc.Base64.stringify(b);return j};var q={"AES-256-CBC":{proc:w,eproc:F,keylen:32,ivlen:16},"AES-192-CBC":{proc:w,eproc:F,keylen:24,ivlen:16},"AES-128-CBC":{proc:w,eproc:F,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:x,eproc:u,keylen:24,ivlen:8},"DES-CBC":{proc:p,eproc:E,keylen:8,ivlen:8}};var y=function(b){return q[b]["proc"]};var B=function(d){var b=CryptoJS.lib.WordArray.random(d);var c=CryptoJS.enc.Hex.stringify(b);return c};var C=function(f){var e={};var b=f.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));if(b){e.cipher=b[1];e.ivsalt=b[2]}var c=f.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));if(c){e.type=c[1]}var g=-1;var d=0;if(f.indexOf("\r\n\r\n")!=-1){g=f.indexOf("\r\n\r\n");d=2}if(f.indexOf("\n\n")!=-1){g=f.indexOf("\n\n");d=1}var i=f.indexOf("-----END");if(g!=-1&&i!=-1){var j=f.substring(g+d*2,i-d);j=j.replace(/\s+/g,"");e.data=j}return e};var r=function(j,m,k){var e=k.substring(0,16);var f=CryptoJS.enc.Hex.parse(e);var i=CryptoJS.enc.Utf8.parse(m);var c=q[j]["keylen"]+q[j]["ivlen"];var l="";var d=null;for(;;){var g=CryptoJS.algo.MD5.create();if(d!=null){g.update(d)}g.update(i);g.update(f);d=g.finalize();l=l+CryptoJS.enc.Hex.stringify(d);if(l.length>=c*2){break}}var b={};b.keyhex=l.substr(0,q[j]["keylen"]*2);b.ivhex=l.substr(q[j]["keylen"]*2,q[j]["ivlen"]*2);return b};var v=function(c,e,j,d){var i=CryptoJS.enc.Base64.parse(c);var b=CryptoJS.enc.Hex.stringify(i);var f=q[e]["proc"];var g=f(b,j,d);return g};var D=function(g,d,f,b){var e=q[d]["eproc"];var c=e(g,f,b);return c};return{version:"1.0.0",getHexFromPEM:function(c,b){return ASN1HEX.pemToHex(c,b)},getDecryptedKeyHexByKeyIV:function(e,b,c,d){var f=y(b);return f(e,c,d)},parsePKCS5PEM:function(b){return C(b)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(c,d,b){return r(c,d,b)},decryptKeyB64:function(c,e,b,d){return v(c,e,b,d)},getDecryptedKeyHex:function(e,f){var c=C(e);var k=c.type;var b=c.cipher;var d=c.ivsalt;var l=c.data;var g=r(b,f,d);var i=g.keyhex;var j=v(l,b,i,d);return j},getRSAKeyFromEncryptedPKCS5PEM:function(e,b){var d=this.getDecryptedKeyHex(e,b);var c=new RSAKey();c.readPrivateKeyFromASN1HexString(d);return c},getEncryptedPKCS5PEMFromPrvKeyHex:function(m,j,e,g,n){var k="";if(typeof g=="undefined"||g==null){g="AES-256-CBC"}if(typeof q[g]=="undefined"){throw"KEYUTIL unsupported algorithm: "+g}if(typeof n=="undefined"||n==null){var f=q[g]["ivlen"];var d=B(f);n=d.toUpperCase()}var i=r(g,e,n);var b=i.keyhex;var l=D(j,g,b,n);var c=l.replace(/(.{64})/g,"$1\r\n");var k="-----BEGIN "+m+" PRIVATE KEY-----\r\n";k+="Proc-Type: 4,ENCRYPTED\r\n";k+="DEK-Info: "+g+","+n+"\r\n";k+="\r\n";k+=c;k+="\r\n-----END "+m+" PRIVATE KEY-----\r\n";return k},getEncryptedPKCS5PEMFromRSAKey:function(o,G,i,k){var H=new Ext.asn1.DERInteger({"int":0});var e=new Ext.asn1.DERInteger({bigint:o.n});var l=new Ext.asn1.DERInteger({"int":o.e});var g=new Ext.asn1.DERInteger({bigint:o.d});var n=new Ext.asn1.DERInteger({bigint:o.p});var f=new Ext.asn1.DERInteger({bigint:o.q});var d=new Ext.asn1.DERInteger({bigint:o.dmp1});var m=new Ext.asn1.DERInteger({bigint:o.dmq1});var j=new Ext.asn1.DERInteger({bigint:o.coeff});var c=new Ext.asn1.DERSequence({array:[H,e,l,g,n,f,d,m,j]});var b=c.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",b,G,i,k)},newEncryptedPKCS5PEM:function(g,f,c,b){if(typeof f=="undefined"||f==null){f=1024}if(typeof c=="undefined"||c==null){c="10001"}var e=new RSAKey();e.generate(f,c);var d=null;if(typeof b=="undefined"||b==null){d=this.getEncryptedPKCS5PEMFromRSAKey(e,g)}else{d=this.getEncryptedPKCS5PEMFromRSAKey(e,g,b)}return d},getRSAKeyFromPlainPKCS8PEM:function(b){if(b.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var c=ASN1HEX.pemToHex(b,"PRIVATE KEY");var d=this.getRSAKeyFromPlainPKCS8Hex(c);return d},getRSAKeyFromPlainPKCS8Hex:function(b){var c=new RSAKey();c.readPKCS8PrvKeyHex(b);return c},parseHexOfEncryptedPKCS8:function(g){var l={};var b=ASN1HEX.getPosArrayOfChildren_AtObj(g,0);if(b.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+b.length}l.ciphertext=ASN1HEX.getHexOfV_AtObj(g,b[1]);var e=ASN1HEX.getPosArrayOfChildren_AtObj(g,b[0]);if(e.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+e.length}if(ASN1HEX.getHexOfV_AtObj(g,e[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(g,e[1]);if(e.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+d.length}var c=ASN1HEX.getPosArrayOfChildren_AtObj(g,d[1]);if(c.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+c.length}if(ASN1HEX.getHexOfV_AtObj(g,c[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}l.encryptionSchemeAlg="TripleDES";l.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(g,c[1]);var k=ASN1HEX.getPosArrayOfChildren_AtObj(g,d[0]);if(k.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+k.length}if(ASN1HEX.getHexOfV_AtObj(g,k[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var f=ASN1HEX.getPosArrayOfChildren_AtObj(g,k[1]);if(f.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+f.length}l.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(g,f[0]);var j=ASN1HEX.getHexOfV_AtObj(g,f[1]);try{l.pbkdf2Iter=parseInt(j,16)}catch(i){throw"malformed format pbkdf2Iter: "+j}return l},getPBKDF2KeyHexFromParam:function(b,g){var c=CryptoJS.enc.Hex.parse(b.pbkdf2Salt);var f=b.pbkdf2Iter;var d=CryptoJS.PBKDF2(g,c,{keySize:192/32,iterations:f});var e=CryptoJS.enc.Hex.stringify(d);return e},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(f,e){var b=ASN1HEX.pemToHex(f,"ENCRYPTED PRIVATE KEY");var d=this.parseHexOfEncryptedPKCS8(b);var j=KEYUTIL.getPBKDF2KeyHexFromParam(d,e);var i={};i.ciphertext=CryptoJS.enc.Hex.parse(d.ciphertext);var k=CryptoJS.enc.Hex.parse(j);var l=CryptoJS.enc.Hex.parse(d.encryptionSchemeIV);var g=CryptoJS.TripleDES.decrypt(i,k,{iv:l});var c=CryptoJS.enc.Hex.stringify(g);return c},getRSAKeyFromEncryptedPKCS8PEM:function(d,e){var b=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(d,e);var c=this.getRSAKeyFromPlainPKCS8Hex(b);return c},getKeyFromEncryptedPKCS8PEM:function(d,b){var c=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(d,b);var e=this.getKeyFromPlainPrivatePKCS8Hex(c);return e},parsePlainPrivatePKCS8Hex:function(d){var b={};b.algparam=null;if(d.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(d,0);if(e.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(d.substr(e[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(d,e[1]);if(c.length!=2){throw"malformed PKCS8 private key(code:004)"}if(d.substr(c[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}b.algoid=ASN1HEX.getHexOfV_AtObj(d,c[0]);if(d.substr(c[1],2)=="06"){b.algparam=ASN1HEX.getHexOfV_AtObj(d,c[1])}if(d.substr(e[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}b.keyidx=ASN1HEX.getStartPosOfV_AtObj(d,e[2]);return b},getKeyFromPlainPrivatePKCS8PEM:function(c){var d=ASN1HEX.pemToHex(c,"PRIVATE KEY");var b=this.getKeyFromPlainPrivatePKCS8Hex(d);return b},getKeyFromPlainPrivatePKCS8Hex:function(d){var c=this.parsePlainPrivatePKCS8Hex(d);var b;if(c.algoid=="2a864886f70d010101"){b=new RSAKey()}else{if(c.algoid=="2a8648ce380401"){b=new Ext.crypto.DSA()}else{if(c.algoid=="2a8648ce3d0201"){b=new Ext.crypto.ECDSA()}else{throw"unsupported private key algorithm"}}}b.readPKCS8PrvKeyHex(d);return b},getRSAKeyFromPublicPKCS8PEM:function(c){var b=ASN1HEX.pemToHex(c,"PUBLIC KEY");var d=this.getRSAKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8PEM:function(c){var b=ASN1HEX.pemToHex(c,"PUBLIC KEY");var d=this.getKeyFromPublicPKCS8Hex(b);return d},getKeyFromPublicPKCS8Hex:function(c){var d;var b=ASN1HEX.getVbyList(c,0,[0,0],"06");if(b==="2a864886f70d010101"){d=new RSAKey()}else{if(b==="2a8648ce380401"){d=new Ext.crypto.DSA()}else{if(b==="2a8648ce3d0201"){d=new Ext.crypto.ECDSA()}else{throw"unsupported PKCS#8 public key hex"}}}d.readPKCS8PubKeyHex(c);return d},parsePublicRawRSAKeyHex:function(b){var d={};if(b.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=2){throw"malformed RSA key(code:002)"}if(b.substr(c[0],2)!="02"){throw"malformed RSA key(code:003)"}d.n=ASN1HEX.getHexOfV_AtObj(b,c[0]);if(b.substr(c[1],2)!="02"){throw"malformed RSA key(code:004)"}d.e=ASN1HEX.getHexOfV_AtObj(b,c[1]);return d},parsePrivateRawRSAKeyHexAtObj:function(f,b){var c=ASN1HEX;var e=c.getHexOfV_AtObj;var d=c.getDecendantIndexByNthList(f,0,[2,0]);var g=c.getPosArrayOfChildren_AtObj(f,d);if(g.length!==9){throw"malformed PKCS#8 plain RSA private key"}b.key={};b.key.n=e(f,g[1]);b.key.e=e(f,g[2]);b.key.d=e(f,g[3]);b.key.p=e(f,g[4]);b.key.q=e(f,g[5]);b.key.dp=e(f,g[6]);b.key.dq=e(f,g[7]);b.key.co=e(f,g[8])},parsePrivateRawECKeyHexAtObj:function(f,b){var c=ASN1HEX;var e=b.keyidx;var d=new Ext.crypto.ECDSA();d.readPKCS8PrvKeyHex(f);b.key=d.prvKeyHex;b.pubkey=d.pubKeyHex},parsePublicPKCS8Hex:function(c){var e={};e.algparam=null;var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=2){throw"outer DERSequence shall have 2 elements: "+d.length}var b=d[0];if(c.substr(b,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var f=ASN1HEX.getPosArrayOfChildren_AtObj(c,b);if(f.length!=2){throw"malformed PKCS8 public key(code:002)"}if(c.substr(f[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}e.algoid=ASN1HEX.getHexOfV_AtObj(c,f[0]);if(c.substr(f[1],2)=="06"){e.algparam=ASN1HEX.getHexOfV_AtObj(c,f[1])}else{if(c.substr(f[1],2)=="30"){e.algparam={};e.algparam.p=ASN1HEX.getVbyList(c,f[1],[0],"02");e.algparam.q=ASN1HEX.getVbyList(c,f[1],[1],"02");e.algparam.g=ASN1HEX.getVbyList(c,f[1],[2],"02")}}if(c.substr(d[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}e.key=ASN1HEX.getHexOfV_AtObj(c,d[1]).substr(2);return e},getRSAKeyFromPublicPKCS8Hex:function(c){var b=new RSAKey();b.readPKCS8PubKeyHex(c);return b},}}();KEYUTIL.getKey=function(Q,R,P){if(typeof RSAKey!="undefined"&&Q instanceof RSAKey){return Q}if(typeof Ext.crypto.ECDSA!="undefined"&&Q instanceof Ext.crypto.ECDSA){return Q}if(typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA){return Q}if(Q.curve!==undefined&&Q.xy!==undefined&&Q.d===undefined){return new Ext.crypto.ECDSA({pub:Q.xy,curve:Q.curve})}if(Q.curve!==undefined&&Q.d!==undefined){return new Ext.crypto.ECDSA({prv:Q.d,curve:Q.curve})}if(Q.kty===undefined&&Q.n!==undefined&&Q.e!==undefined&&Q.d===undefined){var F=new RSAKey();F.setPublic(Q.n,Q.e);return F}if(Q.kty===undefined&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined&&Q.p!==undefined&&Q.q!==undefined&&Q.dp!==undefined&&Q.dq!==undefined&&Q.co!==undefined&&Q.qi===undefined){var F=new RSAKey();F.setPrivateEx(Q.n,Q.e,Q.d,Q.p,Q.q,Q.dp,Q.dq,Q.co);return F}if(Q.kty===undefined&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined&&Q.p===undefined){var F=new RSAKey();F.setPrivate(Q.n,Q.e,Q.d);return F}if(Q.p!==undefined&&Q.q!==undefined&&Q.g!==undefined&&Q.y!==undefined&&Q.x===undefined){var F=new Ext.crypto.DSA();F.setPublic(Q.p,Q.q,Q.g,Q.y);return F}if(Q.p!==undefined&&Q.q!==undefined&&Q.g!==undefined&&Q.y!==undefined&&Q.x!==undefined){var F=new Ext.crypto.DSA();F.setPrivate(Q.p,Q.q,Q.g,Q.y,Q.x);return F}if(Q.kty==="RSA"&&Q.n!==undefined&&Q.e!==undefined&&Q.d===undefined){var F=new RSAKey();F.setPublic(b64utohex(Q.n),b64utohex(Q.e));return F}if(Q.kty==="RSA"&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined&&Q.p!==undefined&&Q.q!==undefined&&Q.dp!==undefined&&Q.dq!==undefined&&Q.qi!==undefined){var F=new RSAKey();F.setPrivateEx(b64utohex(Q.n),b64utohex(Q.e),b64utohex(Q.d),b64utohex(Q.p),b64utohex(Q.q),b64utohex(Q.dp),b64utohex(Q.dq),b64utohex(Q.qi));return F}if(Q.kty==="RSA"&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined){var F=new RSAKey();F.setPrivate(b64utohex(Q.n),b64utohex(Q.e),b64utohex(Q.d));return F}if(Q.kty==="EC"&&Q.crv!==undefined&&Q.x!==undefined&&Q.y!==undefined&&Q.d===undefined){var S=new Ext.crypto.ECDSA({curve:Q.crv});var L=S.ecparams.keylen/4;var y=("0000000000"+b64utohex(Q.x)).slice(-L);var H=("0000000000"+b64utohex(Q.y)).slice(-L);var K="04"+y+H;S.setPublicKeyHex(K);return S}if(Q.kty==="EC"&&Q.crv!==undefined&&Q.x!==undefined&&Q.y!==undefined&&Q.d!==undefined){var S=new Ext.crypto.ECDSA({curve:Q.crv});var L=S.ecparams.keylen/4;var y=("0000000000"+b64utohex(Q.x)).slice(-L);var H=("0000000000"+b64utohex(Q.y)).slice(-L);var K="04"+y+H;var V=("0000000000"+b64utohex(Q.d)).slice(-L);S.setPublicKeyHex(K);S.setPrivateKeyHex(V);return S}if(P==="pkcs5prv"){var E=Q,p=ASN1HEX,I,F;I=p.getPosArrayOfChildren_AtObj(E,0);if(I.length===9){F=new RSAKey();F.readPrivateKeyFromASN1HexString(Q)}else{if(I.length===6){F=new Ext.crypto.DSA();F.readPKCS5PrvKeyHex(E)}else{if(I.length>2&&E.substr(I[1],2)==="04"){F=new Ext.crypto.ECDSA();F.readPKCS5PrvKeyHex(E)}else{throw"unsupported PKCS#1/5 hexadecimal key"}}}return F}if(P==="pkcs8prv"){var F=KEYUTIL.getKeyFromPlainPrivatePKCS8Hex(Q);return F}if(P==="pkcs8pub"){return KEYUTIL.getKeyFromPublicPKCS8Hex(Q)}if(P==="x509pub"){return X509.getPublicKeyFromCertHex(Q)}if(Q.indexOf("-END CERTIFICATE-",0)!=-1||Q.indexOf("-END X509 CERTIFICATE-",0)!=-1||Q.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1){return X509.getPublicKeyFromCertPEM(Q)}if(Q.indexOf("-END PUBLIC KEY-")!=-1){return KEYUTIL.getKeyFromPublicPKCS8PEM(Q)}if(Q.indexOf("-END RSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")==-1){var O=ASN1HEX.pemToHex(Q,"RSA PRIVATE KEY");return KEYUTIL.getKey(O,null,"pkcs5prv")}if(Q.indexOf("-END DSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")==-1){var g=ASN1HEX.pemToHex(Q,"DSA PRIVATE KEY");var q=ASN1HEX.getVbyList(g,0,[1],"02");var x=ASN1HEX.getVbyList(g,0,[2],"02");var G=ASN1HEX.getVbyList(g,0,[3],"02");var N=ASN1HEX.getVbyList(g,0,[4],"02");var M=ASN1HEX.getVbyList(g,0,[5],"02");var F=new Ext.crypto.DSA();F.setPrivate(new BigInteger(q,16),new BigInteger(x,16),new BigInteger(G,16),new BigInteger(N,16),new BigInteger(M,16));return F}if(Q.indexOf("-END PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(Q)}if(Q.indexOf("-END RSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")!=-1){return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(Q,R)}if(Q.indexOf("-END EC PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")!=-1){var g=KEYUTIL.getDecryptedKeyHex(Q,R);var F=ASN1HEX.getVbyList(g,0,[1],"04");var T=ASN1HEX.getVbyList(g,0,[2,0],"06");var J=ASN1HEX.getVbyList(g,0,[3,0],"03").substr(2);var U="";if(Ext.crypto.OID.oidhex2name[T]!==undefined){U=Ext.crypto.OID.oidhex2name[T]}else{throw"undefined OID(hex) in Ext.crypto.OID: "+T}var S=new Ext.crypto.ECDSA({curve:U});S.setPublicKeyHex(J);S.setPrivateKeyHex(F);S.isPublic=false;return S}if(Q.indexOf("-END DSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")!=-1){var g=KEYUTIL.getDecryptedKeyHex(Q,R);var q=ASN1HEX.getVbyList(g,0,[1],"02");var x=ASN1HEX.getVbyList(g,0,[2],"02");var G=ASN1HEX.getVbyList(g,0,[3],"02");var N=ASN1HEX.getVbyList(g,0,[4],"02");var M=ASN1HEX.getVbyList(g,0,[5],"02");var F=new Ext.crypto.DSA();F.setPrivate(new BigInteger(q,16),new BigInteger(x,16),new BigInteger(G,16),new BigInteger(N,16),new BigInteger(M,16));return F}if(Q.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromEncryptedPKCS8PEM(Q,R)}throw"not supported argument"};KEYUTIL.generateKeypair=function(w,u){if(w=="RSA"){var v=u;var o=new RSAKey();o.generate(v,"10001");o.isPrivate=true;o.isPublic=true;var p=new RSAKey();var r=o.n.toString(16);var n=o.e.toString(16);p.setPublic(r,n);p.isPrivate=false;p.isPublic=true;var l={};l.prvKeyObj=o;l.pubKeyObj=p;return l}else{if(w=="EC"){var s=u;var q=new Ext.crypto.ECDSA({curve:s});var m=q.generateKeyPairHex();var o=new Ext.crypto.ECDSA({curve:s});o.setPublicKeyHex(m.ecpubhex);o.setPrivateKeyHex(m.ecprvhex);o.isPrivate=true;o.isPublic=false;var p=new Ext.crypto.ECDSA({curve:s});p.setPublicKeyHex(m.ecpubhex);p.isPrivate=false;p.isPublic=true;var l={};l.prvKeyObj=o;l.pubKeyObj=p;return l}else{throw"unknown algorithm: "+w}}};KEYUTIL.getPEM=function(Q,G,H,K,y){var s=Ext.asn1;var w=Ext.crypto;function B(c){var b=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:c.n}},{"int":c.e},{"int":{bigint:c.d}},{"int":{bigint:c.p}},{"int":{bigint:c.q}},{"int":{bigint:c.dmp1}},{"int":{bigint:c.dmq1}},{"int":{bigint:c.coeff}}]});return b}function A(b){var c=Ext.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:b.prvKeyHex}},{tag:["a0",true,{oid:{name:b.curveName}}]},{tag:["a1",true,{bitstr:{hex:"00"+b.pubKeyHex}}]}]});return c}function x(c){var b=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:c.p}},{"int":{bigint:c.q}},{"int":{bigint:c.g}},{"int":{bigint:c.y}},{"int":{bigint:c.x}}]});return b}if(((typeof RSAKey!="undefined"&&Q instanceof RSAKey)||(typeof w.DSA!="undefined"&&Q instanceof w.DSA)||(typeof w.ECDSA!="undefined"&&Q instanceof w.ECDSA))&&Q.isPublic==true&&(G===undefined||G=="PKCS8PUB")){var F=new Ext.asn1.x509.SubjectPublicKeyInfo(Q);var E=F.getEncodedHex();return s.ASN1Util.getPEMStringFromHex(E,"PUBLIC KEY")}if(G=="PKCS1PRV"&&typeof RSAKey!="undefined"&&Q instanceof RSAKey&&(H===undefined||H==null)&&Q.isPrivate==true){var F=B(Q);var E=F.getEncodedHex();return s.ASN1Util.getPEMStringFromHex(E,"RSA PRIVATE KEY")}if(G=="PKCS1PRV"&&typeof RSAKey!="undefined"&&Q instanceof Ext.crypto.ECDSA&&(H===undefined||H==null)&&Q.isPrivate==true){var L=new Ext.asn1.DERObjectIdentifier({name:Q.curveName});var I=L.getEncodedHex();var M=A(Q);var C=M.getEncodedHex();var D="";D+=s.ASN1Util.getPEMStringFromHex(I,"EC PARAMETERS");D+=s.ASN1Util.getPEMStringFromHex(C,"EC PRIVATE KEY");return D}if(G=="PKCS1PRV"&&typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA&&(H===undefined||H==null)&&Q.isPrivate==true){var F=x(Q);var E=F.getEncodedHex();return s.ASN1Util.getPEMStringFromHex(E,"DSA PRIVATE KEY")}if(G=="PKCS5PRV"&&typeof RSAKey!="undefined"&&Q instanceof RSAKey&&(H!==undefined&&H!=null)&&Q.isPrivate==true){var F=B(Q);var E=F.getEncodedHex();if(K===undefined){K="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",E,H,K)}if(G=="PKCS5PRV"&&typeof Ext.crypto.ECDSA!="undefined"&&Q instanceof Ext.crypto.ECDSA&&(H!==undefined&&H!=null)&&Q.isPrivate==true){var F=A(Q);var E=F.getEncodedHex();if(K===undefined){K="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",E,H,K)}if(G=="PKCS5PRV"&&typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA&&(H!==undefined&&H!=null)&&Q.isPrivate==true){var F=x(Q);var E=F.getEncodedHex();if(K===undefined){K="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",E,H,K)}var J=function(c,d){var e=P(c,d);var b=new Ext.asn1.ASN1Util.newObject({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:e.pbkdf2Salt}},{"int":e.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:e.encryptionSchemeIV}}]}]}]},{octstr:{hex:e.ciphertext}}]});return b.getEncodedHex()};var P=function(e,d){var b=100;var f=CryptoJS.lib.WordArray.random(8);var g="DES-EDE3-CBC";var l=CryptoJS.lib.WordArray.random(8);var k=CryptoJS.PBKDF2(d,f,{keySize:192/32,iterations:b});var j=CryptoJS.enc.Hex.parse(e);var i=CryptoJS.TripleDES.encrypt(j,k,{iv:l})+"";var c={};c.ciphertext=i;c.pbkdf2Salt=CryptoJS.enc.Hex.stringify(f);c.pbkdf2Iter=b;c.encryptionSchemeAlg=g;c.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(l);return c};if(G=="PKCS8PRV"&&typeof RSAKey!="undefined"&&Q instanceof RSAKey&&Q.isPrivate==true){var N=B(Q);var O=N.getEncodedHex();var F=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"rsaEncryption"}},{"null":true}]},{octstr:{hex:O}}]});var E=F.getEncodedHex();if(H===undefined||H==null){return s.ASN1Util.getPEMStringFromHex(E,"PRIVATE KEY")}else{var C=J(E,H);return s.ASN1Util.getPEMStringFromHex(C,"ENCRYPTED PRIVATE KEY")}}if(G=="PKCS8PRV"&&typeof Ext.crypto.ECDSA!="undefined"&&Q instanceof Ext.crypto.ECDSA&&Q.isPrivate==true){var N=new Ext.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:Q.prvKeyHex}},{tag:["a1",true,{bitstr:{hex:"00"+Q.pubKeyHex}}]}]});var O=N.getEncodedHex();var F=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:Q.curveName}}]},{octstr:{hex:O}}]});var E=F.getEncodedHex();if(H===undefined||H==null){return s.ASN1Util.getPEMStringFromHex(E,"PRIVATE KEY")}else{var C=J(E,H);return s.ASN1Util.getPEMStringFromHex(C,"ENCRYPTED PRIVATE KEY")}}if(G=="PKCS8PRV"&&typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA&&Q.isPrivate==true){var N=new Ext.asn1.DERInteger({bigint:Q.x});var O=N.getEncodedHex();var F=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"dsa"}},{seq:[{"int":{bigint:Q.p}},{"int":{bigint:Q.q}},{"int":{bigint:Q.g}}]}]},{octstr:{hex:O}}]});var E=F.getEncodedHex();if(H===undefined||H==null){return s.ASN1Util.getPEMStringFromHex(E,"PRIVATE KEY")}else{var C=J(E,H);return s.ASN1Util.getPEMStringFromHex(C,"ENCRYPTED PRIVATE KEY")}}throw"unsupported object nor format"};KEYUTIL.getKeyFromCSRPEM=function(d){var e=ASN1HEX.pemToHex(d,"CERTIFICATE REQUEST");var f=KEYUTIL.getKeyFromCSRHex(e);return f};KEYUTIL.getKeyFromCSRHex=function(e){var f=KEYUTIL.parseCSRHex(e);var d=KEYUTIL.getKey(f.p8pubkeyhex,null,"pkcs8pub");return d};KEYUTIL.parseCSRHex=function(k){var f={};var i=k;if(i.substr(0,2)!="30"){throw"malformed CSR(code:001)"}var j=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(j.length<1){throw"malformed CSR(code:002)"}if(i.substr(j[0],2)!="30"){throw"malformed CSR(code:003)"}var g=ASN1HEX.getPosArrayOfChildren_AtObj(i,j[0]);if(g.length<3){throw"malformed CSR(code:004)"}f.p8pubkeyhex=ASN1HEX.getHexOfTLV_AtObj(i,g[2]);return f};KEYUTIL.getJWKFromKey=function(e){var g={};if(e instanceof RSAKey&&e.isPrivate){g.kty="RSA";g.n=hextob64u(e.n.toString(16));g.e=hextob64u(e.e.toString(16));g.d=hextob64u(e.d.toString(16));g.p=hextob64u(e.p.toString(16));g.q=hextob64u(e.q.toString(16));g.dp=hextob64u(e.dmp1.toString(16));g.dq=hextob64u(e.dmq1.toString(16));g.qi=hextob64u(e.coeff.toString(16));return g}else{if(e instanceof RSAKey&&e.isPublic){g.kty="RSA";g.n=hextob64u(e.n.toString(16));g.e=hextob64u(e.e.toString(16));return g}else{if(e instanceof Ext.crypto.ECDSA&&e.isPrivate){var i=e.getShortNISTPCurveName();if(i!=="P-256"&&i!=="P-384"){throw"unsupported curve name for JWT: "+i}var f=e.getPublicKeyXYHex();g.kty="EC";g.crv=i;g.x=hextob64u(f.x);g.y=hextob64u(f.y);g.d=hextob64u(e.prvKeyHex);return g}else{if(e instanceof Ext.crypto.ECDSA&&e.isPublic){var i=e.getShortNISTPCurveName();if(i!=="P-256"&&i!=="P-384"){throw"unsupported curve name for JWT: "+i}var f=e.getPublicKeyXYHex();g.kty="EC";g.crv=i;g.x=hextob64u(f.x);g.y=hextob64u(f.y);return g}}}}throw"not supported key object"};RSAKey.pemToBase64=function(c){var d=c;d=d.replace("-----BEGIN RSA PRIVATE KEY-----","");d=d.replace("-----END RSA PRIVATE KEY-----","");d=d.replace(/[ \n]+/g,"");return d};RSAKey.getPosArrayOfChildrenFromHex=function(v){var m=new Array();var r=ASN1HEX.getStartPosOfV_AtObj(v,0);var n=ASN1HEX.getPosOfNextSibling_AtObj(v,r);var x=ASN1HEX.getPosOfNextSibling_AtObj(v,n);var u=ASN1HEX.getPosOfNextSibling_AtObj(v,x);var p=ASN1HEX.getPosOfNextSibling_AtObj(v,u);var q=ASN1HEX.getPosOfNextSibling_AtObj(v,p);var o=ASN1HEX.getPosOfNextSibling_AtObj(v,q);var w=ASN1HEX.getPosOfNextSibling_AtObj(v,o);var s=ASN1HEX.getPosOfNextSibling_AtObj(v,w);m.push(r,n,x,u,p,q,o,w,s);return m};RSAKey.getHexValueArrayOfChildrenFromHex=function(v){var x=RSAKey.getPosArrayOfChildrenFromHex(v);var y=ASN1HEX.getHexOfV_AtObj(v,x[0]);var s=ASN1HEX.getHexOfV_AtObj(v,x[1]);var A=ASN1HEX.getHexOfV_AtObj(v,x[2]);var n=ASN1HEX.getHexOfV_AtObj(v,x[3]);var p=ASN1HEX.getHexOfV_AtObj(v,x[4]);var r=ASN1HEX.getHexOfV_AtObj(v,x[5]);var q=ASN1HEX.getHexOfV_AtObj(v,x[6]);var u=ASN1HEX.getHexOfV_AtObj(v,x[7]);var o=ASN1HEX.getHexOfV_AtObj(v,x[8]);var w=new Array();w.push(y,s,A,n,p,r,q,u,o);return w};RSAKey.prototype.readPrivateKeyFromPEMString=function(j){var g=RSAKey.pemToBase64(j);var f=b64tohex(g);var i=RSAKey.getHexValueArrayOfChildrenFromHex(f);this.setPrivateEx(i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])};RSAKey.prototype.readPrivateKeyFromASN1HexString=function(b){this.readPKCS5PrvKeyHex(b)};RSAKey.prototype.readPKCS5PrvKeyHex=function(e){var d=RSAKey.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(d[1],d[2],d[3],d[4],d[5],d[6],d[7],d[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function(v){var x,s,q,n,A,r,p,y;var o=ASN1HEX;var u=o.getVbyList;if(o.isASN1HEX(v)===false){throw"not ASN.1 hex string"}try{x=u(v,0,[2,0,1],"02");s=u(v,0,[2,0,2],"02");q=u(v,0,[2,0,3],"02");n=u(v,0,[2,0,4],"02");A=u(v,0,[2,0,5],"02");r=u(v,0,[2,0,6],"02");p=u(v,0,[2,0,7],"02");y=u(v,0,[2,0,8],"02")}catch(w){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(x,s,q,n,A,r,p,y)};RSAKey.prototype.readPKCS5PubKeyHex=function(g){if(ASN1HEX.isASN1HEX(g)===false){throw"keyHex is not ASN.1 hex string"}var i=ASN1HEX.getPosArrayOfChildren_AtObj(g,0);if(i.length!==2||g.substr(i[0],2)!=="02"||g.substr(i[1],2)!=="02"){throw"wrong hex for PKCS#5 public key"}var e=ASN1HEX.getHexOfV_AtObj(g,i[0]);var f=ASN1HEX.getHexOfV_AtObj(g,i[1]);this.setPublic(e,f)};RSAKey.prototype.readPKCS8PubKeyHex=function(c){if(ASN1HEX.isASN1HEX(c)===false){throw"not ASN.1 hex string"}if(ASN1HEX.getDecendantHexTLVByNthList(c,0,[0,0])!=="06092a864886f70d010101"){throw"not PKCS8 RSA public key"}var d=ASN1HEX.getDecendantHexTLVByNthList(c,0,[1,0]);this.readPKCS5PubKeyHex(d)};RSAKey.prototype.readCertPubKeyHex=function(d,f){if(f!==5){f=6}if(ASN1HEX.isASN1HEX(d)===false){throw"not ASN.1 hex string"}var e=ASN1HEX.getDecendantHexTLVByNthList(d,0,[0,f]);this.readPKCS8PubKeyHex(e)};var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");function _rsasign_getHexPaddedDigestInfoForString(j,i,g){var f=function(b){return Ext.crypto.Util.hashString(b,g)};var k=f(j);return Ext.crypto.Util.getPaddedDigestInfoHex(k,g,i)}function _zeroPaddingOfSignature(i,j){var k="";var g=j/4-i.length;for(var f=0;f<g;f++){k=k+"0"}return k+i}function _rsasign_signString(e,i){var g=function(b){return Ext.crypto.Util.hashString(b,i)};var f=g(e);return this.signWithMessageHash(f,i)}function _rsasign_signWithMessageHash(k,m){var j=Ext.crypto.Util.getPaddedDigestInfoHex(k,m,this.n.bitLength());var g=parseBigInt(j,16);var l=this.doPrivate(g);var i=l.toString(16);return _zeroPaddingOfSignature(i,this.n.bitLength())}function _rsasign_signStringWithSHA1(b){return _rsasign_signString.call(this,b,"sha1")}function _rsasign_signStringWithSHA256(b){return _rsasign_signString.call(this,b,"sha256")}function pss_mgf1_str(k,g,i){var f="",j=0;while(f.length<g){f+=hextorstr(i(rstrtohex(k+String.fromCharCode.apply(String,[(j&4278190080)>>24,(j&16711680)>>16,(j&65280)>>8,j&255]))));j+=1}return f}function _rsasign_signStringPSS(i,g,j){var k=function(b){return Ext.crypto.Util.hashHex(b,g)};var f=k(rstrtohex(i));if(j===undefined){j=-1}return this.signWithMessageHashPSS(f,g,j)}function _rsasign_signWithMessageHashPSS(w,r,x){var H=hextorstr(w);var B=H.length;var E=this.n.bitLength()-1;var F=Math.ceil(E/8);var G;var u=function(b){return Ext.crypto.Util.hashHex(b,r)};if(x===-1||x===undefined){x=B}else{if(x===-2){x=F-B-2}else{if(x<-2){throw"invalid salt length"}}}if(F<(B+x+2)){throw"data too long"}var C="";if(x>0){C=new Array(x);new SecureRandom().nextBytes(C);C=String.fromCharCode.apply(String,C)}var s=hextorstr(u(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+H+C)));var y=[];for(G=0;G<F-x-B-2;G+=1){y[G]=0}var v=String.fromCharCode.apply(String,y)+"\x01"+C;var A=pss_mgf1_str(s,v.length,u);var i=[];for(G=0;G<v.length;G+=1){i[G]=v.charCodeAt(G)^A.charCodeAt(G)}var D=(65280>>(8*F-E))&255;i[0]&=~D;for(G=0;G<B;G++){i.push(s.charCodeAt(G))}i.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(i)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(g,j,k){var f=new RSAKey();f.setPublic(j,k);var i=f.doPublic(g);return i}function _rsasign_getHexDigestInfoFromSig(g,k,f){var i=_rsasign_getDecryptSignatureBI(g,k,f);var j=i.toString(16).replace(/^1f+00/,"");return j}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(i){for(var j in Ext.crypto.Util.DIGESTINFOHEAD){var k=Ext.crypto.Util.DIGESTINFOHEAD[j];var g=k.length;if(i.substring(0,g)==k){var l=[j,i.substring(g)];return l}}return[]}function _rsasign_verifySignatureWithArgs(o,s,n,k){var p=_rsasign_getHexDigestInfoFromSig(s,n,k);var m=_rsasign_getAlgNameAndHashFromHexDisgestInfo(p);if(m.length==0){return false}var q=m[0];var l=m[1];var u=function(b){return Ext.crypto.Util.hashString(b,q)};var r=u(o);return(l==r)}function _rsasign_verifyHexSignatureForMessage(f,g){var e=parseBigInt(f,16);var i=_rsasign_verifySignatureWithArgs(g,e,this.n.toString(16),this.e.toString(16));return i}function _rsasign_verifyString(o,k){k=k.replace(_RE_HEXDECONLY,"");k=k.replace(/[ \n]+/g,"");var s=parseBigInt(k,16);if(s.bitLength()>this.n.bitLength()){return 0}var l=this.doPublic(s);var p=l.toString(16).replace(/^1f+00/,"");var n=_rsasign_getAlgNameAndHashFromHexDisgestInfo(p);if(n.length==0){return false}var q=n[0];var m=n[1];var u=function(b){return Ext.crypto.Util.hashString(b,q)};var r=u(o);return(m==r)}function _rsasign_verifyWithMessageHash(i,m){m=m.replace(_RE_HEXDECONLY,"");m=m.replace(/[ \n]+/g,"");var o=parseBigInt(m,16);if(o.bitLength()>this.n.bitLength()){return 0}var k=this.doPublic(o);var l=k.toString(16).replace(/^1f+00/,"");var p=_rsasign_getAlgNameAndHashFromHexDisgestInfo(l);if(p.length==0){return false}var n=p[0];var j=p[1];return(j==i)}function _rsasign_verifyStringPSS(m,g,i,j){var k=function(b){return Ext.crypto.Util.hashHex(b,i)};var l=k(rstrtohex(m));if(j===undefined){j=-1}return this.verifyWithMessageHashPSS(l,g,i,j)}function _rsasign_verifyWithMessageHashPSS(G,i,w,J){var y=new BigInteger(i,16);if(y.bitLength()>this.n.bitLength()){return false}var u=function(b){return Ext.crypto.Util.hashHex(b,w)};var D=hextorstr(G);var H=D.length;var C=this.n.bitLength()-1;var A=Math.ceil(C/8);var E;if(J===-1||J===undefined){J=H}else{if(J===-2){J=A-H-2}else{if(J<-2){throw"invalid salt length"}}}if(A<(H+J+2)){throw"data too long"}var L=this.doPublic(y).toByteArray();for(E=0;E<L.length;E+=1){L[E]&=255}while(L.length<A){L.unshift(0)}if(L[A-1]!==188){throw"encoded message does not end in 0xbc"}L=String.fromCharCode.apply(String,L);var B=L.substr(0,A-H-1);var v=L.substr(B.length,H);var I=(65280>>(8*A-C))&255;if((B.charCodeAt(0)&I)!==0){throw"bits beyond keysize not zero"}var F=pss_mgf1_str(v,B.length,u);var x=[];for(E=0;E<B.length;E+=1){x[E]=B.charCodeAt(E)^F.charCodeAt(E)}x[0]&=~I;var K=A-H-J-2;for(E=0;E<K;E+=1){if(x[E]!==0){throw"leftmost octets not zero"}}if(x[K]!==1){throw"0x01 marker not found"}return v===hextorstr(u(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+D+String.fromCharCode.apply(String,x.slice(-J)))))}RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash;RSAKey.prototype.signString=_rsasign_signString;RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.sign=_rsasign_signString;RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS;RSAKey.prototype.signStringPSS=_rsasign_signStringPSS;RSAKey.prototype.signPSS=_rsasign_signStringPSS;RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash;RSAKey.prototype.verifyString=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verify=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS;RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS;RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS;RSAKey.SALT_LEN_RECOVER=-2;function X509(){this.subjectPublicKeyRSA=null;this.subjectPublicKeyRSA_hN=null;this.subjectPublicKeyRSA_hE=null;this.hex=null;this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])};this.getSignatureAlgorithmField=function(){var d=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,2,0]);var e=Ext.asn1.ASN1Util.oidHexToInt(d);var f=Ext.asn1.x509.OID.oid2name(e);return f};this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])};this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))};this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])};this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))};this.getNotBefore=function(){var b=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);b=b.replace(/(..)/g,"%$1");b=decodeURIComponent(b);return b};this.getNotAfter=function(){var b=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);b=b.replace(/(..)/g,"%$1");b=decodeURIComponent(b);return b};this.readCertPEM=function(g){var j=ASN1HEX.pemToHex(g);var i=X509.getPublicKeyHexArrayFromCertHex(j);var f=new RSAKey();f.setPublic(i[0],i[1]);this.subjectPublicKeyRSA=f;this.subjectPublicKeyRSA_hN=i[0];this.subjectPublicKeyRSA_hE=i[1];this.hex=j};this.readCertPEMWithoutRSAInit=function(g){var f=ASN1HEX.pemToHex(g);var e=X509.getPublicKeyHexArrayFromCertHex(f);if(typeof this.subjectPublicKeyRSA.setPublic==="function"){this.subjectPublicKeyRSA.setPublic(e[0],e[1])}this.subjectPublicKeyRSA_hN=e[0];this.subjectPublicKeyRSA_hE=e[1];this.hex=f};this.getInfo=function(){var E="Basic Fields\n";E+="  serial number: "+this.getSerialNumberHex()+"\n";E+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";E+="  issuer: "+this.getIssuerString()+"\n";E+="  notBefore: "+this.getNotBefore()+"\n";E+="  notAfter: "+this.getNotAfter()+"\n";E+="  subject: "+this.getSubjectString()+"\n";E+="  subject public key info: \n";var F=X509.getSubjectPublicKeyInfoPosFromCertHex(this.hex);var q=ASN1HEX.getHexOfTLV_AtObj(this.hex,F);var A=KEYUTIL.getKey(q,null,"pkcs8pub");if(A instanceof RSAKey){E+="    key algorithm: RSA\n";E+="    n="+A.n.toString(16).substr(0,16)+"...\n";E+="    e="+A.e.toString(16)+"\n"}E+="X509v3 Extensions:\n";var i=X509.getV3ExtInfoListOfCertHex(this.hex);for(var u=0;u<i.length;u++){var s=i[u];var x=Ext.asn1.x509.OID.oid2name(s.oid);if(x===""){x=s.oid}var B="";if(s.critical===true){B="CRITICAL"}E+="  "+x+" "+B+":\n";if(x==="basicConstraints"){var C=X509.getExtBasicConstraints(this.hex);if(C.cA===undefined){E+="    {}\n"}else{E+="    cA=true";if(C.pathLen!==undefined){E+=", pathLen="+C.pathLen}E+="\n"}}else{if(x==="keyUsage"){E+="    "+X509.getExtKeyUsageString(this.hex)+"\n"}else{if(x==="subjectKeyIdentifier"){E+="    "+X509.getExtSubjectKeyIdentifier(this.hex)+"\n"}else{if(x==="authorityKeyIdentifier"){var w=X509.getExtAuthorityKeyIdentifier(this.hex);if(w.kid!==undefined){E+="    kid="+w.kid+"\n"}}else{if(x==="extKeyUsage"){var v=X509.getExtExtKeyUsageName(this.hex);E+="    "+v.join(", ")+"\n"}else{if(x==="subjectAltName"){var y=X509.getExtSubjectAltName(this.hex);E+="    "+y.join(", ")+"\n"}else{if(x==="cRLDistributionPoints"){var r=X509.getExtCRLDistributionPointsURI(this.hex);E+="    "+r+"\n"}else{if(x==="authorityInfoAccess"){var D=X509.getExtAIAInfo(this.hex);if(D.ocsp!==undefined){E+="    ocsp: "+D.ocsp.join(",")+"\n"}if(D.caissuer!==undefined){E+="    caissuer: "+D.caissuer.join(",")+"\n"}}}}}}}}}}E+="signature algorithm: "+X509.getSignatureAlgorithmName(this.hex)+"\n";E+="signature: "+X509.getSignatureValueHex(this.hex).substr(0,16)+"...\n";return E}}X509.pemToBase64=function(d){var c=d;c=c.replace("-----BEGIN CERTIFICATE-----","");c=c.replace("-----END CERTIFICATE-----","");c=c.replace(/[ \n]+/g,"");return c};X509.pemToHex=function(b){return ASN1HEX.pemToHex(b)};X509.getSubjectPublicKeyPosFromCertHex=function(i){var j=X509.getSubjectPublicKeyInfoPosFromCertHex(i);if(j==-1){return -1}var g=ASN1HEX.getPosArrayOfChildren_AtObj(i,j);if(g.length!=2){return -1}var k=g[1];if(i.substring(k,k+2)!="03"){return -1}var l=ASN1HEX.getStartPosOfV_AtObj(i,k);if(i.substring(l,l+2)!="00"){return -1}return l+2};X509.getSubjectPublicKeyInfoPosFromCertHex=function(f){var g=ASN1HEX.getStartPosOfV_AtObj(f,0);var e=ASN1HEX.getPosArrayOfChildren_AtObj(f,g);if(e.length<1){return -1}if(f.substring(e[0],e[0]+10)=="a003020102"){if(e.length<6){return -1}return e[6]}else{if(e.length<5){return -1}return e[5]}};X509.getPublicKeyHexArrayFromCertHex=function(i){var j=X509.getSubjectPublicKeyPosFromCertHex(i);var g=ASN1HEX.getPosArrayOfChildren_AtObj(i,j);if(g.length!=2){return[]}var k=ASN1HEX.getHexOfV_AtObj(i,g[0]);var l=ASN1HEX.getHexOfV_AtObj(i,g[1]);if(k!=null&&l!=null){return[k,l]}else{return[]}};X509.getHexTbsCertificateFromCert=function(c){var d=ASN1HEX.getStartPosOfV_AtObj(c,0);return d};X509.getPublicKeyHexArrayFromCertPEM=function(g){var f=ASN1HEX.pemToHex(g);var e=X509.getPublicKeyHexArrayFromCertHex(f);return e};X509.hex2dn=function(i,g){if(g===undefined){g=0}if(i.substr(g,2)!=="30"){throw"malformed DN"}var l=new Array();var k=ASN1HEX.getPosArrayOfChildren_AtObj(i,g);for(var j=0;j<k.length;j++){l.push(X509.hex2rdn(i,k[j]))}l=l.map(function(b){return b.replace("/","\\/")});return"/"+l.join("/")};X509.hex2rdn=function(i,g){if(g===undefined){g=0}if(i.substr(g,2)!=="31"){throw"malformed RDN"}var l=new Array();var k=ASN1HEX.getPosArrayOfChildren_AtObj(i,g);for(var j=0;j<k.length;j++){l.push(X509.hex2attrTypeValue(i,k[j]))}l=l.map(function(b){return b.replace("+","\\+")});return l.join("+")};X509.hex2attrTypeValue=function(m,i){if(i===undefined){i=0}if(m.substr(i,2)!=="30"){throw"malformed attribute type and value"}var o=ASN1HEX.getPosArrayOfChildren_AtObj(m,i);if(o.length!==2||m.substr(o[0],2)!=="06"){"malformed attribute type and value"}var p=ASN1HEX.getHexOfV_AtObj(m,o[0]);var k=Ext.asn1.ASN1Util.oidHexToInt(p);var l=Ext.asn1.x509.OID.oid2atype(k);var j=ASN1HEX.getHexOfV_AtObj(m,o[1]);var n=hextorstr(j);return l+"="+n};X509.getPublicKeyFromCertHex=function(m){var i,k,n;var o=6;var j=ASN1HEX;var l=j.getVbyList;n=j.getDecendantHexTLVByNthList(m,0,[0,0]);if(n!=="a003020102"){o=5}k=l(m,0,[0,o,0,0],"06");if(k==="2a864886f70d010101"){i=new RSAKey()}else{if(k==="2a8648ce380401"){i=new Ext.crypto.DSA()}else{if(k==="2a8648ce3d0201"){i=new Ext.crypto.ECDSA()}else{throw"unsupported public key in X.509 cert"}}}i.readCertPubKeyHex(m,o);return i};X509.getPublicKeyFromCertPEM=function(e){var f=ASN1HEX;var d=f.pemToHex(e);return X509.getPublicKeyFromCertHex(d)};X509.getPublicKeyInfoPropOfCertPEM=function(q){var m={};m.algparam=null;var p=ASN1HEX.pemToHex(q);var r=ASN1HEX.getPosArrayOfChildren_AtObj(p,0);if(r.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(p.substr(r[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var j=ASN1HEX.getPosArrayOfChildren_AtObj(p,r[0]);var o=6;if(p.substr(j[0],2)!=="a0"){o=5}if(j.length<o+1){throw"malformed X.509 certificate PEM (code:003)"}var l=ASN1HEX.getPosArrayOfChildren_AtObj(p,j[o]);if(l.length!=2){throw"malformed X.509 certificate PEM (code:004)"}var n=ASN1HEX.getPosArrayOfChildren_AtObj(p,l[0]);if(n.length!=2){throw"malformed X.509 certificate PEM (code:005)"}m.algoid=ASN1HEX.getHexOfV_AtObj(p,n[0]);if(p.substr(n[1],2)=="06"){m.algparam=ASN1HEX.getHexOfV_AtObj(p,n[1])}else{if(p.substr(n[1],2)=="30"){m.algparam=ASN1HEX.getHexOfTLV_AtObj(p,n[1])}}if(p.substr(l[1],2)!="03"){throw"malformed X.509 certificate PEM (code:006)"}var k=ASN1HEX.getHexOfV_AtObj(p,l[1]);m.keyhex=k.substr(2);return m};X509.getPublicKeyInfoPosOfCertHEX=function(f){var d=ASN1HEX.getPosArrayOfChildren_AtObj(f,0);if(d.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(f.substr(d[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(f,d[0]);if(e.length<7){throw"malformed X.509 certificate PEM (code:003)"}return e[6]};X509.getV3ExtInfoListOfCertHex=function(m){var i=ASN1HEX.getPosArrayOfChildren_AtObj(m,0);if(i.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(m.substr(i[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var l=ASN1HEX.getPosArrayOfChildren_AtObj(m,i[0]);if(l.length<8){throw"malformed X.509 certificate PEM (code:003)"}if(m.substr(l[7],2)!="a3"){throw"malformed X.509 certificate PEM (code:004)"}var k=ASN1HEX.getPosArrayOfChildren_AtObj(m,l[7]);if(k.length!=1){throw"malformed X.509 certificate PEM (code:005)"}if(m.substr(k[0],2)!="30"){throw"malformed X.509 certificate PEM (code:006)"}var j=ASN1HEX.getPosArrayOfChildren_AtObj(m,k[0]);var o=j.length;var p=new Array(o);for(var n=0;n<o;n++){p[n]=X509.getV3ExtItemInfo_AtObj(m,j[n])}return p};X509.getV3ExtItemInfo_AtObj=function(k,j){var l={};l.posTLV=j;var i=ASN1HEX.getPosArrayOfChildren_AtObj(k,j);if(i.length!=2&&i.length!=3){throw"malformed X.509v3 Ext (code:001)"}if(k.substr(i[0],2)!="06"){throw"malformed X.509v3 Ext (code:002)"}var m=ASN1HEX.getHexOfV_AtObj(k,i[0]);l.oid=ASN1HEX.hextooidstr(m);l.critical=false;if(i.length==3){l.critical=true}var n=i[i.length-1];if(k.substr(n,2)!="04"){throw"malformed X.509v3 Ext (code:003)"}l.posV=ASN1HEX.getStartPosOfV_AtObj(k,n);return l};X509.getHexOfTLV_V3ExtValue=function(d,e){var f=X509.getPosOfTLV_V3ExtValue(d,e);if(f==-1){return null}return ASN1HEX.getHexOfTLV_AtObj(d,f)};X509.getHexOfV_V3ExtValue=function(d,e){var f=X509.getPosOfTLV_V3ExtValue(d,e);if(f==-1){return null}return ASN1HEX.getHexOfV_AtObj(d,f)};X509.getPosOfTLV_V3ExtValue=function(j,g){var m=g;if(!g.match(/^[0-9.]+$/)){m=Ext.asn1.x509.OID.name2oid(g)}if(m==""){return -1}var l=X509.getV3ExtInfoListOfCertHex(j);for(var i=0;i<l.length;i++){var k=l[i];if(k.oid==m){return k.posV}}return -1};X509.getExtBasicConstraints=function(e){var i=X509.getHexOfV_V3ExtValue(e,"basicConstraints");if(i===null){return null}if(i===""){return{}}if(i==="0101ff"){return{cA:true}}if(i.substr(0,8)==="0101ff02"){var f=ASN1HEX.getHexOfV_AtObj(i,6);var g=parseInt(f,16);return{cA:true,pathLen:g}}throw"unknown error"};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];X509.getExtKeyUsageBin=function(e){var g=X509.getHexOfV_V3ExtValue(e,"keyUsage");if(g==""){return""}if(g.length%2!=0||g.length<=2){throw"malformed key usage value"}var i=parseInt(g.substr(0,2));var f=parseInt(g.substr(2),16).toString(2);return f.substr(0,f.length-i)};X509.getExtKeyUsageString=function(j){var f=X509.getExtKeyUsageBin(j);var i=new Array();for(var g=0;g<f.length;g++){if(f.substr(g,1)=="1"){i.push(X509.KEYUSAGE_NAME[g])}}return i.join(",")};X509.getExtSubjectKeyIdentifier=function(c){var d=X509.getHexOfV_V3ExtValue(c,"subjectKeyIdentifier");return d};X509.getExtAuthorityKeyIdentifier=function(i){var g={};var j=X509.getHexOfTLV_V3ExtValue(i,"authorityKeyIdentifier");if(j===null){return null}var l=ASN1HEX.getPosArrayOfChildren_AtObj(j,0);for(var k=0;k<l.length;k++){if(j.substr(l[k],2)==="80"){g.kid=ASN1HEX.getHexOfV_AtObj(j,l[k])}}return g};X509.getExtExtKeyUsageName=function(p){var o=new Array();var i=X509.getHexOfTLV_V3ExtValue(p,"extKeyUsage");if(i===null){return null}var n=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);for(var l=0;l<n.length;l++){var q=ASN1HEX.getHexOfV_AtObj(i,n[l]);var r=Ext.asn1.ASN1Util.oidHexToInt(q);var m=Ext.asn1.x509.OID.oid2name(r);o.push(m)}return o};X509.getExtSubjectAltName=function(j){var i=new Array();var k=X509.getHexOfTLV_V3ExtValue(j,"subjectAltName");var n=ASN1HEX.getPosArrayOfChildren_AtObj(k,0);for(var l=0;l<n.length;l++){if(k.substr(n[l],2)==="82"){var m=hextoutf8(ASN1HEX.getHexOfV_AtObj(k,n[l]));i.push(m)}}return i};X509.getExtCRLDistributionPointsURI=function(q){var i=new Array();var u=X509.getHexOfTLV_V3ExtValue(q,"cRLDistributionPoints");var j=ASN1HEX.getPosArrayOfChildren_AtObj(u,0);for(var v=0;v<j.length;v++){var s=ASN1HEX.getHexOfTLV_AtObj(u,j[v]);var B=ASN1HEX.getPosArrayOfChildren_AtObj(s,0);for(var x=0;x<B.length;x++){if(s.substr(B[x],2)==="a0"){var w=ASN1HEX.getHexOfV_AtObj(s,B[x]);if(w.substr(0,2)==="a0"){var A=ASN1HEX.getHexOfV_AtObj(w,0);if(A.substr(0,2)==="86"){var r=ASN1HEX.getHexOfV_AtObj(A,0);var y=hextoutf8(r);i.push(y)}}}}}return i};X509.getExtAIAInfo=function(o){var m={};m.ocsp=[];m.caissuer=[];var n=X509.getPosOfTLV_V3ExtValue(o,"authorityInfoAccess");if(n==-1){return null}if(o.substr(n,2)!="30"){throw"malformed AIA Extn Value"}var r=ASN1HEX.getPosArrayOfChildren_AtObj(o,n);for(var i=0;i<r.length;i++){var l=r[i];var k=ASN1HEX.getPosArrayOfChildren_AtObj(o,l);if(k.length!=2){throw"malformed AccessDescription of AIA Extn"}var q=k[0];var p=k[1];if(ASN1HEX.getHexOfV_AtObj(o,q)=="2b06010505073001"){if(o.substr(p,2)=="86"){m.ocsp.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(o,p)))}}if(ASN1HEX.getHexOfV_AtObj(o,q)=="2b06010505073002"){if(o.substr(p,2)=="86"){m.caissuer.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(o,p)))}}}return m};X509.getSignatureAlgorithmName=function(e){var g=ASN1HEX.getDecendantHexVByNthList(e,0,[1,0]);var i=Ext.asn1.ASN1Util.oidHexToInt(g);var f=Ext.asn1.x509.OID.oid2name(i);return f};X509.getSignatureValueHex=function(c){var d=ASN1HEX.getDecendantHexVByNthList(c,0,[2]);if(d.substr(0,2)!=="00"){throw"can't get signature value"}return d.substr(2)};X509.getSerialNumberHex=function(b){return ASN1HEX.getDecendantHexVByNthList(b,0,[0,1])};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.utils=="undefined"||!Ext.utils){Ext.utils={}}Ext.utils.JWS=function(){var b=Ext.utils.JWS;this.parseJWS=function(r,s){if((this.parsedJWS!==undefined)&&(s||(this.parsedJWS.sigvalH!==undefined))){return}var u=r.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(u==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}var q=u[1];var c=u[2];var p=u[3];var n=q+"."+c;this.parsedJWS={};this.parsedJWS.headB64U=q;this.parsedJWS.payloadB64U=c;this.parsedJWS.sigvalB64U=p;this.parsedJWS.si=n;if(!s){var v=b64utohex(p);var w=parseBigInt(v,16);this.parsedJWS.sigvalH=v;this.parsedJWS.sigvalBI=w}var m=b64utoutf8(q);var o=b64utoutf8(c);this.parsedJWS.headS=m;this.parsedJWS.payloadS=o;if(!b.isSafeJSONString(m,this.parsedJWS,"headP")){throw"malformed JSON string for JWS Head: "+m}}};Ext.utils.JWS.sign=function(s,H,v,x,D){var A=Ext.utils.JWS;var w,G,E;if(typeof H!="string"&&typeof H!="object"){throw"spHeader must be JSON string or object: "+H}if(typeof H=="object"){G=H;w=JSON.stringify(G)}if(typeof H=="string"){w=H;if(!A.isSafeJSONString(w)){throw"JWS Head is not safe JSON string: "+w}G=A.readSafeJSONString(w)}E=v;if(typeof v=="object"){E=JSON.stringify(v)}if((s==""||s==null)&&G.alg!==undefined){s=G.alg}if((s!=""&&s!=null)&&G.alg===undefined){G.alg=s;w=JSON.stringify(G)}if(s!==G.alg){throw"alg and sHeader.alg doesn't match: "+s+"!="+G.alg}var J=null;if(A.jwsalg2sigalg[s]===undefined){throw"unsupported alg name: "+s}else{J=A.jwsalg2sigalg[s]}var B=utf8tob64u(w);var F=utf8tob64u(E);var y=B+"."+F;var I="";if(J.substr(0,4)=="Hmac"){if(x===undefined){throw"mac key shall be specified for HS* alg"}var C=new Ext.crypto.Mac({alg:J,prov:"cryptojs",pass:x});C.updateString(y);I=C.doFinal()}else{if(J.indexOf("withECDSA")!=-1){var u=new Ext.crypto.Signature({alg:J});u.init(x,D);u.updateString(y);hASN1Sig=u.sign();I=Ext.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else{if(J!="none"){var u=new Ext.crypto.Signature({alg:J});u.init(x,D);u.updateString(y);I=u.sign()}}}var r=hextob64u(I);return y+"."+r};Ext.utils.JWS.verify=function(F,u,C){var y=Ext.utils.JWS;var x=F.split(".");var L=x[0];var D=x[1];var N=L+"."+D;var I=b64utohex(x[2]);var v=y.readSafeJSONString(b64utoutf8(x[0]));var A=null;var E=null;if(v.alg===undefined){throw"algorithm not specified in header"}else{A=v.alg;E=A.substr(0,2)}if(C!=null&&Object.prototype.toString.call(C)==="[object Array]"&&C.length>0){var M=":"+C.join(":")+":";if(M.indexOf(":"+A+":")==-1){throw"algorithm '"+A+"' not accepted in the list"}}if(A!="none"&&u===null){throw"key shall be specified to verify."}if(typeof u=="string"&&u.indexOf("-----BEGIN ")!=-1){u=KEYUTIL.getKey(u)}if(E=="RS"||E=="PS"){if(!(u instanceof RSAKey)){throw"key shall be a RSAKey obj for RS* and PS* algs"}}if(E=="ES"){if(!(u instanceof Ext.crypto.ECDSA)){throw"key shall be a ECDSA obj for ES* algs"}}if(A=="none"){}var w=null;if(y.jwsalg2sigalg[v.alg]===undefined){throw"unsupported alg name: "+A}else{w=y.jwsalg2sigalg[A]}if(w=="none"){throw"not supported"}else{if(w.substr(0,4)=="Hmac"){var G=null;if(u===undefined){throw"hexadecimal key shall be specified for HMAC"}var B=new Ext.crypto.Mac({alg:w,pass:u});B.updateString(N);G=B.doFinal();return I==G}else{if(w.indexOf("withECDSA")!=-1){var J=null;try{J=Ext.crypto.ECDSA.concatSigToASN1Sig(I)}catch(H){return false}var K=new Ext.crypto.Signature({alg:w});K.init(u);K.updateString(N);return K.verify(J)}else{var K=new Ext.crypto.Signature({alg:w});K.init(u);K.updateString(N);return K.verify(I)}}}};Ext.utils.JWS.parse=function(j){var n=j.split(".");var i={};var k,l,m;if(n.length!=2&&n.length!=3){throw"malformed sJWS: wrong number of '.' splitted elements"}k=n[0];l=n[1];if(n.length==3){m=n[2]}i.headerObj=Ext.utils.JWS.readSafeJSONString(b64utoutf8(k));i.payloadObj=Ext.utils.JWS.readSafeJSONString(b64utoutf8(l));i.headerPP=JSON.stringify(i.headerObj,null,"  ");if(i.payloadObj==null){i.payloadPP=b64utoutf8(l)}else{i.payloadPP=JSON.stringify(i.payloadObj,null,"  ")}if(m!==undefined){i.sigHex=b64utohex(m)}return i};Ext.utils.JWS.verifyJWT=function(x,s,A){var p=Ext.utils.JWS;var r=x.split(".");var v=r[0];var w=r[1];var o=v+"."+w;var u=b64utohex(r[2]);var n=p.readSafeJSONString(b64utoutf8(v));var y=p.readSafeJSONString(b64utoutf8(w));if(n.alg===undefined){return false}if(A.alg===undefined){throw"acceptField.alg shall be specified"}if(!p.inArray(n.alg,A.alg)){return false}if(y.iss!==undefined&&typeof A.iss==="object"){if(!p.inArray(y.iss,A.iss)){return false}}if(y.sub!==undefined&&typeof A.sub==="object"){if(!p.inArray(y.sub,A.sub)){return false}}if(y.aud!==undefined&&typeof A.aud==="object"){if(typeof y.aud=="string"){if(!p.inArray(y.aud,A.aud)){return false}}else{if(typeof y.aud=="object"){if(!p.includedArray(y.aud,A.aud)){return false}}}}var q=Ext.utils.IntDate.getNow();if(A.verifyAt!==undefined&&typeof A.verifyAt==="number"){q=A.verifyAt}if(A.gracePeriod===undefined||typeof A.gracePeriod!=="number"){A.gracePeriod=0}if(y.exp!==undefined&&typeof y.exp=="number"){if(y.exp+A.gracePeriod<q){return false}}if(y.nbf!==undefined&&typeof y.nbf=="number"){if(q<y.nbf-A.gracePeriod){return false}}if(y.iat!==undefined&&typeof y.iat=="number"){if(q<y.iat-A.gracePeriod){return false}}if(y.jti!==undefined&&A.jti!==undefined){if(y.jti!==A.jti){return false}}if(!Ext.utils.JWS.verify(x,s,A.alg)){return false}return true};Ext.utils.JWS.includedArray=function(g,i){var e=Ext.utils.JWS.inArray;if(g===null){return false}if(typeof g!=="object"){return false}if(typeof g.length!=="number"){return false}for(var f=0;f<g.length;f++){if(!e(g[f],i)){return false}}return true};Ext.utils.JWS.inArray=function(f,e){if(e===null){return false}if(typeof e!=="object"){return false}if(typeof e.length!=="number"){return false}for(var g=0;g<e.length;g++){if(e[g]==f){return true}}return false};Ext.utils.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none",};Ext.utils.JWS.isSafeJSONString=function(k,f,j){var i=null;try{i=jsonParse(k);if(typeof i!="object"){return 0}if(i.constructor===Array){return 0}if(f){f[j]=i}return 1}catch(g){return 0}};Ext.utils.JWS.readSafeJSONString=function(d){var f=null;try{f=jsonParse(d);if(typeof f!="object"){return null}if(f.constructor===Array){return null}return f}catch(e){return null}};Ext.utils.JWS.getEncodedSignatureValueFromJWS=function(c){var d=c.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(d==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}return d[1]};Ext.utils.JWS.getJWKthumbprint=function(j){if(j.kty!=="RSA"&&j.kty!=="EC"&&j.kty!=="oct"){throw"unsupported algorithm for JWK Thumprint"}var g="{";if(j.kty==="RSA"){if(typeof j.n!="string"||typeof j.e!="string"){throw"wrong n and e value for RSA key"}g+='"e":"'+j.e+'",';g+='"kty":"'+j.kty+'",';g+='"n":"'+j.n+'"}'}else{if(j.kty==="EC"){if(typeof j.crv!="string"||typeof j.x!="string"||typeof j.y!="string"){throw"wrong crv, x and y value for EC key"}g+='"crv":"'+j.crv+'",';g+='"kty":"'+j.kty+'",';g+='"x":"'+j.x+'",';g+='"y":"'+j.y+'"}'}else{if(j.kty==="oct"){if(typeof j.k!="string"){throw"wrong k value for oct(symmetric) key"}g+='"kty":"'+j.kty+'",';g+='"k":"'+j.k+'"}'}}}var f=rstrtohex(g);var k=Ext.crypto.Util.hashHex(f,"sha256");var i=hextob64u(k);return i};Ext.utils.IntDate={};Ext.utils.IntDate.get=function(b){if(b=="now"){return Ext.utils.IntDate.getNow()}else{if(b=="now + 1hour"){return Ext.utils.IntDate.getNow()+60*60}else{if(b=="now + 1day"){return Ext.utils.IntDate.getNow()+60*60*24}else{if(b=="now + 1month"){return Ext.utils.IntDate.getNow()+60*60*24*30}else{if(b=="now + 1year"){return Ext.utils.IntDate.getNow()+60*60*24*365}else{if(b.match(/Z$/)){return Ext.utils.IntDate.getZulu(b)}else{if(b.match(/^[0-9]+$/)){return parseInt(b)}}}}}}}throw"unsupported format: "+b};Ext.utils.IntDate.getZulu=function(d){var s=d.match(/(\d+)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z/);if(s){var u=s[1];var m=parseInt(u);if(u.length==4){}else{if(u.length==2){if(50<=m&&m<100){m=1900+m}else{if(0<=m&&m<50){m=2000+m}else{throw"malformed year string for UTCTime"}}}else{throw"malformed year string"}}var o=parseInt(s[2])-1;var l=parseInt(s[3]);var r=parseInt(s[4]);var q=parseInt(s[5]);var p=parseInt(s[6]);var n=new Date(Date.UTC(m,o,l,r,q,p));return ~~(n/1000)}throw"unsupported format: "+d};Ext.utils.IntDate.getNow=function(){var b=~~(new Date()/1000);return b};Ext.utils.IntDate.intDate2UTCString=function(d){var c=new Date(d*1000);return c.toUTCString()};Ext.utils.IntDate.intDate2Zulu=function(l){var p=new Date(l*1000);var o=("0000"+p.getUTCFullYear()).slice(-4);var n=("00"+(p.getUTCMonth()+1)).slice(-2);var k=("00"+p.getUTCDate()).slice(-2);var d=("00"+p.getUTCHours()).slice(-2);var m=("00"+p.getUTCMinutes()).slice(-2);var j=("00"+p.getUTCSeconds()).slice(-2);return o+n+k+d+m+j+"Z"};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.utils=="undefined"||!Ext.utils){Ext.utils={}}Ext.utils.JWSJS=function(){var c=Ext.utils.JWS;var d=Ext.utils.JWS;this.aHeader=[];this.sPayload="";this.aSignature=[];this.init=function(){this.aHeader=[];this.sPayload=undefined;this.aSignature=[]};this.initWithJWS=function(b){this.init();var e=b.split(".");if(e.length!=3){throw"malformed input JWS"}this.aHeader.push(e[0]);this.sPayload=e[1];this.aSignature.push(e[2])};this.addSignature=function(b,r,m,o){if(this.sPayload===undefined||this.sPayload===null){throw"there's no JSON-JS signature to add."}var n=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length){throw"aHeader.length != aSignature.length"}try{var u=Ext.utils.JWS.sign(b,r,this.sPayload,m,o);var p=u.split(".");var e=p[0];var s=p[2];this.aHeader.push(p[0]);this.aSignature.push(p[2])}catch(q){if(this.aHeader.length>n){this.aHeader.pop()}if(this.aSignature.length>n){this.aSignature.pop()}throw"addSignature failed: "+q}};this.addSignatureByHeaderKey=function(e,k){var i=b64utoutf8(this.sPayload);var j=new Ext.utils.JWS();var b=j.generateJWSByP1PrvKey(e,i,k);this.aHeader.push(j.parsedJWS.headB64U);this.aSignature.push(j.parsedJWS.sigvalB64U)};this.addSignatureByHeaderPayloadKey=function(e,i,k){var j=new Ext.utils.JWS();var b=j.generateJWSByP1PrvKey(e,i,k);this.aHeader.push(j.parsedJWS.headB64U);this.sPayload=j.parsedJWS.payloadB64U;this.aSignature.push(j.parsedJWS.sigvalB64U)};this.verifyAll=function(g){if(this.aHeader.length!==g.length||this.aSignature.length!==g.length){return false}for(var i=0;i<g.length;i++){var b=g[i];if(b.length!==2){return false}var e=this.verifyNth(i,b[0],b[1]);if(e===false){return false}}return true};this.verifyNth=function(l,o,p){if(this.aHeader.length<=l||this.aSignature.length<=l){return false}var n=this.aHeader[l];var k=this.aSignature[l];var m=n+"."+this.sPayload+"."+k;var b=false;try{b=d.verify(m,o,p)}catch(e){return false}return b};this.verifyWithCerts=function(q){if(this.aHeader.length!=q.length){throw"num headers does not match with num certs"}if(this.aSignature.length!=q.length){throw"num signatures does not match with num certs"}var v=this.sPayload;var e="";for(var p=0;p<q.length;p++){var i=q[p];var o=this.aHeader[p];var s=this.aSignature[p];var r=o+"."+v+"."+s;var w=new Ext.utils.JWS();try{var u=w.verifyJWSByPemX509Cert(r,i);if(u!=1){e+=(p+1)+"th signature unmatch. "}}catch(b){e+=(p+1)+"th signature fail("+b+"). "}}if(e==""){return 1}else{throw e}};this.readJWSJS=function(b){if(typeof b==="string"){var e=c.readSafeJSONString(b);if(e==null){throw"argument is not safe JSON object string"}this.aHeader=e.headers;this.sPayload=e.payload;this.aSignature=e.signatures}else{try{if(b.headers.length>0){this.aHeader=b.headers}else{throw"malformed header"}if(typeof b.payload==="string"){this.sPayload=b.payload}else{throw"malformed signatures"}if(b.signatures.length>0){this.signatures=b.signatures}else{throw"malformed signatures"}}catch(f){throw"malformed JWS-JS JSON object: "+f}}};this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}};this.isEmpty=function(){if(this.aHeader.length==0){return 1}return 0}};