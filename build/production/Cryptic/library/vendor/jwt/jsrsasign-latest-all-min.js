if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={}}YAHOO.namespace=function(){var i=arguments,j=null,l,d,k;for(l=0;l<i.length;l=l+1){k=(""+i[l]).split(".");j=YAHOO;for(d=(k[0]=="YAHOO")?1:0;d<k.length;d=d+1){j[k[d]]=j[k[d]]||{};j=j[k[d]]}}return j};YAHOO.log=function(f,e,g){var i=YAHOO.widget.Logger;if(i&&i.log){return i.log(f,e,g)}else{return false}};YAHOO.register=function(n,b,i){var o=YAHOO.env.modules,m,p,q,r,l;if(!o[n]){o[n]={versions:[],builds:[]}}m=o[n];p=i.version;q=i.build;r=YAHOO.env.listeners;m.name=n;m.version=p;m.build=q;m.versions.push(p);m.builds.push(q);m.mainClass=b;for(l=0;l<r.length;l=l+1){r[l](m)}if(b){b.VERSION=p;b.BUILD=q}else{YAHOO.log("mainClass is undefined for module "+n,"warn")}};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=function(b){return YAHOO.env.modules[b]||null};YAHOO.env.parseUA=function(m){var l=function(b){var c=0;return parseFloat(b.replace(/\./g,function(){return(c++==1)?"":"."}))},i=navigator,o={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:i&&i.cajaVersion,secure:false,os:null},k=m||(navigator&&navigator.userAgent),p=window&&window.location,j=p&&p.href,n;o.secure=j&&(j.toLowerCase().indexOf("https")===0);if(k){if((/windows|win32/i).test(k)){o.os="windows"}else{if((/macintosh/i).test(k)){o.os="macintosh"}else{if((/rhino/i).test(k)){o.os="rhino"}}}if((/KHTML/).test(k)){o.webkit=1}n=k.match(/AppleWebKit\/([^\s]*)/);if(n&&n[1]){o.webkit=l(n[1]);if(/ Mobile\//.test(k)){o.mobile="Apple";n=k.match(/OS ([^\s]*)/);if(n&&n[1]){n=l(n[1].replace("_","."))}o.ios=n;o.ipad=o.ipod=o.iphone=0;n=k.match(/iPad|iPod|iPhone/);if(n&&n[0]){o[n[0].toLowerCase()]=o.ios}}else{n=k.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/);if(n){o.mobile=n[0]}if(/webOS/.test(k)){o.mobile="WebOS";n=k.match(/webOS\/([^\s]*);/);if(n&&n[1]){o.webos=l(n[1])}}if(/ Android/.test(k)){o.mobile="Android";n=k.match(/Android ([^\s]*);/);if(n&&n[1]){o.android=l(n[1])}}}n=k.match(/Chrome\/([^\s]*)/);if(n&&n[1]){o.chrome=l(n[1])}else{n=k.match(/AdobeAIR\/([^\s]*)/);if(n){o.air=n[0]}}}if(!o.webkit){n=k.match(/Opera[\s\/]([^\s]*)/);if(n&&n[1]){o.opera=l(n[1]);n=k.match(/Version\/([^\s]*)/);if(n&&n[1]){o.opera=l(n[1])}n=k.match(/Opera Mini[^;]*/);if(n){o.mobile=n[0]}}else{n=k.match(/MSIE\s([^;]*)/);if(n&&n[1]){o.ie=l(n[1])}else{n=k.match(/Gecko\/([^\s]*)/);if(n){o.gecko=1;n=k.match(/rv:([^\s\)]*)/);if(n&&n[1]){o.gecko=l(n[1])}}}}}}return o};YAHOO.env.ua=YAHOO.env.parseUA();(function(){YAHOO.namespace("util","widget","example");if("undefined"!==typeof YAHOO_config){var i=YAHOO_config.listener,e=YAHOO.env.listeners,f=true,g;if(i){for(g=0;g<e.length;g++){if(e[g]==i){f=false;break}}if(f){e.push(i)}}}})();YAHOO.lang=YAHOO.lang||{};(function(){var r=YAHOO.lang,n=Object.prototype,l="[object Array]",p="[object Function]",o="[object Object]",m=[],q={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},k=["toString","valueOf"],j={isArray:function(b){return n.toString.apply(b)===l},isBoolean:function(b){return typeof b==="boolean"},isFunction:function(b){return(typeof b==="function")||n.toString.apply(b)===p},isNull:function(b){return b===null},isNumber:function(b){return typeof b==="number"&&isFinite(b)},isObject:function(b){return(b&&(typeof b==="object"||r.isFunction(b)))||false},isString:function(b){return typeof b==="string"},isUndefined:function(b){return typeof b==="undefined"},_IEEnumFix:(YAHOO.env.ua.ie)?function(f,b){var c,d,e;for(c=0;c<k.length;c=c+1){d=k[c];e=b[d];if(r.isFunction(e)&&e!=n[d]){f[d]=e}}}:function(){},escapeHTML:function(b){return b.replace(/[&<>"'\/`]/g,function(c){return q[c]})},extend:function(e,d,f){if(!d||!e){throw new Error("extend failed, please check that all dependencies are included.")}var b=function(){},c;b.prototype=d.prototype;e.prototype=new b();e.prototype.constructor=e;e.superclass=d.prototype;if(d.prototype.constructor==n.constructor){d.prototype.constructor=d}if(f){for(c in f){if(r.hasOwnProperty(f,c)){e.prototype[c]=f[c]}}r._IEEnumFix(e.prototype,f)}},augmentObject:function(d,e){if(!e||!d){throw new Error("Absorb failed, verify dependencies.")}var b=arguments,f,c,g=b[2];if(g&&g!==true){for(f=2;f<b.length;f=f+1){d[b[f]]=e[b[f]]}}else{for(c in e){if(g||!(c in d)){d[c]=e[c]}}r._IEEnumFix(d,e)}return d},augmentProto:function(c,d){if(!d||!c){throw new Error("Augment failed, verify dependencies.")}var b=[c.prototype,d.prototype],e;for(e=2;e<arguments.length;e=e+1){b.push(arguments[e])}r.augmentObject.apply(this,b);return c},dump:function(d,i){var b,s,f=[],e="{...}",c="f(){...}",g=", ",u=" => ";if(!r.isObject(d)){return d+""}else{if(d instanceof Date||("nodeType" in d&&"tagName" in d)){return d}else{if(r.isFunction(d)){return c}}}i=(r.isNumber(i))?i:3;if(r.isArray(d)){f.push("[");for(b=0,s=d.length;b<s;b=b+1){if(r.isObject(d[b])){f.push((i>0)?r.dump(d[b],i-1):e)}else{f.push(d[b])}f.push(g)}if(f.length>1){f.pop()}f.push("]")}else{f.push("{");for(b in d){if(r.hasOwnProperty(d,b)){f.push(b+u);if(r.isObject(d[b])){f.push((i>0)?r.dump(d[b],i-1):e)}else{f.push(d[b])}f.push(g)}}if(f.length>1){f.pop()}f.push("}")}return f.join("")},substitute:function(v,s,e,P){var I,c,J,b,f,H,d=[],M,i=v.length,L="dump",u=" ",K="{",O="}",N,g;for(;;){I=v.lastIndexOf(K,i);if(I<0){break}c=v.indexOf(O,I);if(I+1>c){break}M=v.substring(I+1,c);b=M;H=null;J=b.indexOf(u);if(J>-1){H=b.substring(J+1);b=b.substring(0,J)}f=s[b];if(e){f=e(b,f,H)}if(r.isObject(f)){if(r.isArray(f)){f=r.dump(f,parseInt(H,10))}else{H=H||"";N=H.indexOf(L);if(N>-1){H=H.substring(4)}g=f.toString();if(g===o||N>-1){f=r.dump(f,parseInt(H,10))}else{f=g}}}else{if(!r.isString(f)&&!r.isNumber(f)){f="~-"+d.length+"-~";d[d.length]=M}}v=v.substring(0,I)+f+v.substring(c+1);if(P===false){i=I-1}}for(I=d.length-1;I>=0;I=I-1){v=v.replace(new RegExp("~-"+I+"-~"),"{"+d[I]+"}","g")}return v},trim:function(b){try{return b.replace(/^\s+|\s+$/g,"")}catch(c){return b}},merge:function(){var b={},d=arguments,e=d.length,c;for(c=0;c<e;c=c+1){r.augmentObject(b,d[c],true)}return b},later:function(d,u,c,i,g){d=d||0;u=u||{};var s=c,e=i,f,b;if(r.isString(c)){s=u[c]}if(!s){throw new TypeError("method undefined")}if(!r.isUndefined(i)&&!r.isArray(e)){e=[i]}f=function(){s.apply(u,e||m)};b=(g)?setInterval(f,d):setTimeout(f,d);return{interval:g,cancel:function(){if(this.interval){clearInterval(b)}else{clearTimeout(b)}}}},isValue:function(b){return(r.isObject(b)||r.isString(b)||r.isNumber(b)||r.isBoolean(b))}};r.hasOwnProperty=(n.hasOwnProperty)?function(b,c){return b&&b.hasOwnProperty&&b.hasOwnProperty(c)}:function(b,c){return !r.isUndefined(b[c])&&b.constructor.prototype[c]!==b[c]};j.augmentObject(r,j,true);YAHOO.util.Lang=r;r.augment=r.augmentProto;YAHOO.augment=r.augmentProto;YAHOO.extend=r.extend})();YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});var CryptoJS=CryptoJS||(function(u,r){var x={};var v=x.lib={};var o=v.Base=(function(){function b(){}return{extend:function(c){b.prototype=this;var d=new b();if(c){d.mixIn(c)}if(!d.hasOwnProperty("init")){d.init=function(){d.$super.init.apply(this,arguments)}}d.init.prototype=d;d.$super=this;return d},create:function(){var c=this.extend();c.init.apply(c,arguments);return c},init:function(){},mixIn:function(c){for(var d in c){if(c.hasOwnProperty(d)){this[d]=c[d]}}if(c.hasOwnProperty("toString")){this.toString=c.toString}},clone:function(){return this.init.prototype.extend(this)}}}());var n=v.WordArray=o.extend({init:function(c,b){c=this.words=c||[];if(b!=r){this.sigBytes=b}else{this.sigBytes=c.length*4}},toString:function(b){return(b||B).stringify(this)},concat:function(e){var i=this.words;var b=e.words;var d=this.sigBytes;var f=e.sigBytes;this.clamp();if(d%4){for(var g=0;g<f;g++){var c=(b[g>>>2]>>>(24-(g%4)*8))&255;i[(d+g)>>>2]|=c<<(24-((d+g)%4)*8)}}else{for(var g=0;g<f;g+=4){i[(d+g)>>>2]=b[g>>>2]}}this.sigBytes+=f;return this},clamp:function(){var c=this.words;var b=this.sigBytes;c[b>>>2]&=4294967295<<(32-(b%4)*8);c.length=u.ceil(b/4)},clone:function(){var b=o.clone.call(this);b.words=this.words.slice(0);return b},random:function(c){var d=[];for(var b=0;b<c;b+=4){d.push((u.random()*4294967296)|0)}return new n.init(d,c)}});var y=x.enc={};var B=y.Hex={stringify:function(f){var d=f.words;var g=f.sigBytes;var e=[];for(var b=0;b<g;b++){var c=(d[b>>>2]>>>(24-(b%4)*8))&255;e.push((c>>>4).toString(16));e.push((c&15).toString(16))}return e.join("")},parse:function(d){var b=d.length;var c=[];for(var e=0;e<b;e+=2){c[e>>>3]|=parseInt(d.substr(e,2),16)<<(24-(e%8)*4)}return new n.init(c,b/2)}};var s=y.Latin1={stringify:function(e){var d=e.words;var f=e.sigBytes;var b=[];for(var g=0;g<f;g++){var c=(d[g>>>2]>>>(24-(g%4)*8))&255;b.push(String.fromCharCode(c))}return b.join("")},parse:function(d){var b=d.length;var c=[];for(var e=0;e<b;e++){c[e>>>2]|=(d.charCodeAt(e)&255)<<(24-(e%4)*8)}return new n.init(c,b)}};var w=y.Utf8={stringify:function(b){try{return decodeURIComponent(escape(s.stringify(b)))}catch(c){throw new Error("Malformed UTF-8 data")}},parse:function(b){return s.parse(unescape(encodeURIComponent(b)))}};var p=v.BufferedBlockAlgorithm=o.extend({reset:function(){this._data=new n.init();this._nDataBytes=0},_append:function(b){if(typeof b=="string"){b=w.parse(b)}this._data.concat(b);this._nDataBytes+=b.sigBytes},_process:function(i){var c=this._data;var g=c.words;var f=c.sigBytes;var l=this.blockSize;var j=l*4;var k=f/j;if(i){k=u.ceil(k)}else{k=u.max((k|0)-this._minBufferSize,0)}var m=k*l;var b=u.min(m*4,f);if(m){for(var d=0;d<m;d+=l){this._doProcessBlock(g,d)}var e=g.splice(0,m);c.sigBytes-=b}return new n.init(e,b)},clone:function(){var b=o.clone.call(this);b._data=this._data.clone();return b},_minBufferSize:0});var q=v.Hasher=p.extend({cfg:o.extend(),init:function(b){this.cfg=this.cfg.extend(b);this.reset()},reset:function(){p.reset.call(this);this._doReset()},update:function(b){this._append(b);this._process();return this},finalize:function(b){if(b){this._append(b)}var c=this._doFinalize();return c},blockSize:512/32,_createHelper:function(b){return function(c,d){return new b.init(d).finalize(c)}},_createHmacHelper:function(b){return function(c,d){return new A.HMAC.init(b,d).finalize(c)}}});var A=x.algo={};return x}(Math));(function(c){var j=CryptoJS,d=j.lib,i=d.Base,b=d.WordArray,j=j.x64={};j.Word=i.extend({init:function(f,e){this.high=f;this.low=e}});j.WordArray=i.extend({init:function(f,e){f=this.words=f||[];this.sigBytes=e!=c?e:8*f.length},toX32:function(){for(var f=this.words,e=f.length,g=[],l=0;l<e;l++){var k=f[l];g.push(k.high);g.push(k.low)}return b.create(g,this.sigBytes)},clone:function(){for(var k=i.clone.call(this),g=k.words=this.words.slice(0),e=g.length,f=0;f<e;f++){g[f]=g[f].clone()}return k}})})();CryptoJS.lib.Cipher||function(F){var A=CryptoJS,x=A.lib,C=x.Base,y=x.WordArray,c=x.BufferedBlockAlgorithm,E=A.enc.Base64,o=A.algo.EvpKDF,e=x.Cipher=c.extend({cfg:C.extend(),createEncryptor:function(f,g){return this.create(this._ENC_XFORM_MODE,f,g)},createDecryptor:function(f,g){return this.create(this._DEC_XFORM_MODE,f,g)},init:function(f,j,g){this.cfg=this.cfg.extend(g);this._xformMode=f;this._key=j;this.reset()},reset:function(){c.reset.call(this);this._doReset()},process:function(f){this._append(f);return this._process()},finalize:function(f){f&&this._append(f);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(f){return{encrypt:function(g,k,j){return("string"==typeof k?D:w).encrypt(f,g,k,j)},decrypt:function(g,k,j){return("string"==typeof k?D:w).decrypt(f,g,k,j)}}}});x.StreamCipher=e.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var i=A.mode={},B=function(j,g,f){var l=this._iv;l?this._iv=F:l=this._prevBlock;for(var k=0;k<f;k++){j[g+k]^=l[k]}},b=(x.BlockCipherMode=C.extend({createEncryptor:function(f,g){return this.Encryptor.create(f,g)},createDecryptor:function(f,g){return this.Decryptor.create(f,g)},init:function(f,g){this._cipher=f;this._iv=g}})).extend();b.Encryptor=b.extend({processBlock:function(f,k){var j=this._cipher,g=j.blockSize;B.call(this,f,k,g);j.encryptBlock(f,k);this._prevBlock=f.slice(k,k+g)}});b.Decryptor=b.extend({processBlock:function(j,g){var f=this._cipher,l=f.blockSize,k=j.slice(g,g+l);f.decryptBlock(j,g);B.call(this,j,g,l);this._prevBlock=k}});i=i.CBC=b;b=(A.pad={}).Pkcs7={pad:function(j,g){for(var m=4*g,m=m-j.sigBytes%m,l=m<<24|m<<16|m<<8|m,f=[],k=0;k<m;k+=4){f.push(l)}m=y.create(f,m);j.concat(m)},unpad:function(f){f.sigBytes-=f.words[f.sigBytes-1>>>2]&255}};x.BlockCipher=e.extend({cfg:e.cfg.extend({mode:i,padding:b}),reset:function(){e.reset.call(this);var f=this.cfg,j=f.iv,f=f.mode;if(this._xformMode==this._ENC_XFORM_MODE){var g=f.createEncryptor}else{g=f.createDecryptor,this._minBufferSize=1}this._mode=g.call(f,this,j&&j.words)},_doProcessBlock:function(f,g){this._mode.processBlock(f,g)},_doFinalize:function(){var f=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){f.pad(this._data,this.blockSize);var g=this._process(!0)}else{g=this._process(!0),f.unpad(g)}return g},blockSize:4});var d=x.CipherParams=C.extend({init:function(f){this.mixIn(f)},toString:function(f){return(f||this.formatter).stringify(this)}}),i=(A.format={}).OpenSSL={stringify:function(f){var g=f.ciphertext;f=f.salt;return(f?y.create([1398893684,1701076831]).concat(f).concat(g):g).toString(E)},parse:function(f){f=E.parse(f);var j=f.words;if(1398893684==j[0]&&1701076831==j[1]){var g=y.create(j.slice(2,4));j.splice(0,4);f.sigBytes-=16}return d.create({ciphertext:f,salt:g})}},w=x.SerializableCipher=C.extend({cfg:C.extend({format:i}),encrypt:function(j,g,f,l){l=this.cfg.extend(l);var k=j.createEncryptor(f,l);g=k.finalize(g);k=k.cfg;return d.create({ciphertext:g,key:f,iv:k.iv,algorithm:j,mode:k.mode,padding:k.padding,blockSize:j.blockSize,formatter:l.format})},decrypt:function(f,k,j,g){g=this.cfg.extend(g);k=this._parse(k,g.format);return f.createDecryptor(j,g).finalize(k.ciphertext)},_parse:function(f,g){return"string"==typeof f?g.parse(f,this):f}}),A=(A.kdf={}).OpenSSL={execute:function(f,k,j,g){g||(g=y.random(8));f=o.create({keySize:k+j}).compute(f,g);j=y.create(f.words.slice(k),4*j);f.sigBytes=4*k;return d.create({key:f,iv:j,salt:g})}},D=x.PasswordBasedCipher=w.extend({cfg:w.cfg.extend({kdf:A}),encrypt:function(f,k,j,g){g=this.cfg.extend(g);j=g.kdf.execute(j,f.keySize,f.ivSize);g.iv=j.iv;f=w.encrypt.call(this,f,k,j.key,g);f.mixIn(j);return f},decrypt:function(f,k,j,g){g=this.cfg.extend(g);k=this._parse(k,g.format);j=g.kdf.execute(j,f.keySize,f.ivSize,k.salt);g.iv=j.iv;return w.decrypt.call(this,f,k,j.key,g)}})}();(function(){for(var O=CryptoJS,L=O.lib.BlockCipher,N=O.algo,S=[],d=[],c=[],G=[],p=[],o=[],m=[],e=[],J=[],I=[],T=[],R=0;256>R;R++){T[R]=128>R?R<<1:R<<1^283}for(var P=0,Q=0,R=0;256>R;R++){var U=Q^Q<<1^Q<<2^Q<<3^Q<<4,U=U>>>8^U&255^99;S[P]=U;d[U]=P;var i=T[P],M=T[i],H=T[M],V=257*T[U]^16843008*U;c[P]=V<<24|V>>>8;G[P]=V<<16|V>>>16;p[P]=V<<8|V>>>24;o[P]=V;V=16843009*H^65537*M^257*i^16843008*P;m[U]=V<<24|V>>>8;e[U]=V<<16|V>>>16;J[U]=V<<8|V>>>24;I[U]=V;P?(P=i^T[T[T[H^i]]],Q^=T[T[Q]]):P=Q=1}var K=[0,1,2,4,8,16,32,64,128,27,54],N=N.AES=L.extend({_doReset:function(){for(var b=this._key,k=b.words,g=b.sigBytes/4,b=4*((this._nRounds=g+6)+1),j=this._keySchedule=[],l=0;l<b;l++){if(l<g){j[l]=k[l]}else{var f=j[l-1];l%g?6<g&&4==l%g&&(f=S[f>>>24]<<24|S[f>>>16&255]<<16|S[f>>>8&255]<<8|S[f&255]):(f=f<<8|f>>>24,f=S[f>>>24]<<24|S[f>>>16&255]<<16|S[f>>>8&255]<<8|S[f&255],f^=K[l/g|0]<<24);j[l]=j[l-g]^f}}k=this._invKeySchedule=[];for(g=0;g<b;g++){l=b-g,f=g%4?j[l]:j[l-4],k[g]=4>g||4>=l?f:m[S[f>>>24]]^e[S[f>>>16&255]]^J[S[f>>>8&255]]^I[S[f&255]]}},encryptBlock:function(b,f){this._doCryptBlock(b,f,this._keySchedule,c,G,p,o,S)},decryptBlock:function(b,g){var f=b[g+1];b[g+1]=b[g+3];b[g+3]=f;this._doCryptBlock(b,g,this._invKeySchedule,m,e,J,I,d);f=b[g+1];b[g+1]=b[g+3];b[g+3]=f},_doCryptBlock:function(b,w,g,f,A,v,u,k){for(var j=this._nRounds,r=b[w]^g[0],C=b[w+1]^g[1],n=b[w+2]^g[2],s=b[w+3]^g[3],l=4,x=1;x<j;x++){var B=f[r>>>24]^A[C>>>16&255]^v[n>>>8&255]^u[s&255]^g[l++],y=f[C>>>24]^A[n>>>16&255]^v[s>>>8&255]^u[r&255]^g[l++],q=f[n>>>24]^A[s>>>16&255]^v[r>>>8&255]^u[C&255]^g[l++],s=f[s>>>24]^A[r>>>16&255]^v[C>>>8&255]^u[n&255]^g[l++],r=B,C=y,n=q}B=(k[r>>>24]<<24|k[C>>>16&255]<<16|k[n>>>8&255]<<8|k[s&255])^g[l++];y=(k[C>>>24]<<24|k[n>>>16&255]<<16|k[s>>>8&255]<<8|k[r&255])^g[l++];q=(k[n>>>24]<<24|k[s>>>16&255]<<16|k[r>>>8&255]<<8|k[C&255])^g[l++];s=(k[s>>>24]<<24|k[r>>>16&255]<<16|k[C>>>8&255]<<8|k[n&255])^g[l++];b[w]=B;b[w+1]=y;b[w+2]=q;b[w+3]=s},keySize:8});O.AES=L._createHelper(N)})();(function(){function d(j,g){var e=(this._lBlock>>>j^this._rBlock)&g;this._rBlock^=e;this._lBlock^=e<<j}function c(j,g){var e=(this._rBlock>>>j^this._lBlock)&g;this._lBlock^=e;this._rBlock^=e<<j}var f=CryptoJS,k=f.lib,y=k.WordArray,k=k.BlockCipher,i=f.algo,b=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],u=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],w=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],x=[{"0":8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{"0":1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{"0":260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{"0":2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{"0":128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{"0":268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{"0":1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{"0":134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],o=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],v=i.DES=k.extend({_doReset:function(){for(var n=this._key.words,m=[],e=0;56>e;e++){var g=b[e]-1;m[e]=n[g>>>5]>>>31-g%32&1}n=this._subKeys=[];for(g=0;16>g;g++){for(var l=n[g]=[],j=w[g],e=0;24>e;e++){l[e/6|0]|=m[(u[e]-1+j)%28]<<31-e%6,l[4+(e/6|0)]|=m[28+(u[e+24]-1+j)%28]<<31-e%6}l[0]=l[0]<<1|l[0]>>>31;for(e=1;7>e;e++){l[e]>>>=4*(e-1)+3}l[7]=l[7]<<5|l[7]>>>27}m=this._invSubKeys=[];for(e=0;16>e;e++){m[e]=n[15-e]}},encryptBlock:function(g,e){this._doCryptBlock(g,e,this._subKeys)},decryptBlock:function(g,e){this._doCryptBlock(g,e,this._invSubKeys)},_doCryptBlock:function(n,m,g){this._lBlock=n[m];this._rBlock=n[m+1];d.call(this,4,252645135);d.call(this,16,65535);c.call(this,2,858993459);c.call(this,8,16711935);d.call(this,1,1431655765);for(var e=0;16>e;e++){for(var l=g[e],j=this._lBlock,q=this._rBlock,r=0,p=0;8>p;p++){r|=x[p][((q^l[p])&o[p])>>>0]}this._lBlock=q;this._rBlock=j^r}g=this._lBlock;this._lBlock=this._rBlock;this._rBlock=g;d.call(this,1,1431655765);c.call(this,8,16711935);c.call(this,2,858993459);d.call(this,16,65535);d.call(this,4,252645135);n[m]=this._lBlock;n[m+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});f.DES=k._createHelper(v);i=i.TripleDES=k.extend({_doReset:function(){var e=this._key.words;this._des1=v.createEncryptor(y.create(e.slice(0,2)));this._des2=v.createEncryptor(y.create(e.slice(2,4)));this._des3=v.createEncryptor(y.create(e.slice(4,6)))},encryptBlock:function(g,e){this._des1.encryptBlock(g,e);this._des2.decryptBlock(g,e);this._des3.encryptBlock(g,e)},decryptBlock:function(g,e){this._des3.decryptBlock(g,e);this._des2.encryptBlock(g,e);this._des1.decryptBlock(g,e)},keySize:6,ivSize:2,blockSize:2});f.TripleDES=k._createHelper(i)})();(function(){var b=CryptoJS,c=b.lib.WordArray;b.enc.Base64={stringify:function(e){var i=e.words,k=e.sigBytes,j=this._map;e.clamp();e=[];for(var d=0;d<k;d+=3){for(var m=(i[d>>>2]>>>24-8*(d%4)&255)<<16|(i[d+1>>>2]>>>24-8*((d+1)%4)&255)<<8|i[d+2>>>2]>>>24-8*((d+2)%4)&255,l=0;4>l&&d+0.75*l<k;l++){e.push(j.charAt(m>>>6*(3-l)&63))}}if(i=j.charAt(64)){for(;e.length%4;){e.push(i)}}return e.join("")},parse:function(k){var j=k.length,i=this._map,m=i.charAt(64);m&&(m=k.indexOf(m),-1!=m&&(j=m));for(var m=[],l=0,d=0;d<j;d++){if(d%4){var e=i.indexOf(k.charAt(d-1))<<2*(d%4),n=i.indexOf(k.charAt(d))>>>6-2*(d%4);m[l>>>2]|=(e|n)<<24-8*(l%4);l++}}return c.create(m,l)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(p){function g(r,n,l,u,q,k,s){r=r+(n&l|~n&u)+q+s;return(r<<k|r>>>32-k)+n}function f(r,n,l,u,q,k,s){r=r+(n&u|l&~u)+q+s;return(r<<k|r>>>32-k)+n}function e(u,r,q,l,n,k,s){u=u+(r^q^l)+n+s;return(u<<k|u>>>32-k)+r}function d(u,r,q,l,n,k,s){u=u+(q^(r|~l))+n+s;return(u<<k|u>>>32-k)+r}for(var b=CryptoJS,c=b.lib,m=c.WordArray,o=c.Hasher,c=b.algo,i=[],j=0;64>j;j++){i[j]=4294967296*p.abs(p.sin(j+1))|0}c=c.MD5=o.extend({_doReset:function(){this._hash=new m.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(x,I){for(var E=0;16>E;E++){var F=I+E,v=x[F];x[F]=(v<<8|v>>>24)&16711935|(v<<24|v>>>8)&4278255360}var E=this._hash.words,F=x[I+0],v=x[I+1],u=x[I+2],r=x[I+3],n=x[I+4],k=x[I+5],P=x[I+6],O=x[I+7],N=x[I+8],L=x[I+9],G=x[I+10],H=x[I+11],y=x[I+12],s=x[I+13],q=x[I+14],l=x[I+15],M=E[0],K=E[1],w=E[2],J=E[3],M=g(M,K,w,J,F,7,i[0]),J=g(J,M,K,w,v,12,i[1]),w=g(w,J,M,K,u,17,i[2]),K=g(K,w,J,M,r,22,i[3]),M=g(M,K,w,J,n,7,i[4]),J=g(J,M,K,w,k,12,i[5]),w=g(w,J,M,K,P,17,i[6]),K=g(K,w,J,M,O,22,i[7]),M=g(M,K,w,J,N,7,i[8]),J=g(J,M,K,w,L,12,i[9]),w=g(w,J,M,K,G,17,i[10]),K=g(K,w,J,M,H,22,i[11]),M=g(M,K,w,J,y,7,i[12]),J=g(J,M,K,w,s,12,i[13]),w=g(w,J,M,K,q,17,i[14]),K=g(K,w,J,M,l,22,i[15]),M=f(M,K,w,J,v,5,i[16]),J=f(J,M,K,w,P,9,i[17]),w=f(w,J,M,K,H,14,i[18]),K=f(K,w,J,M,F,20,i[19]),M=f(M,K,w,J,k,5,i[20]),J=f(J,M,K,w,G,9,i[21]),w=f(w,J,M,K,l,14,i[22]),K=f(K,w,J,M,n,20,i[23]),M=f(M,K,w,J,L,5,i[24]),J=f(J,M,K,w,q,9,i[25]),w=f(w,J,M,K,r,14,i[26]),K=f(K,w,J,M,N,20,i[27]),M=f(M,K,w,J,s,5,i[28]),J=f(J,M,K,w,u,9,i[29]),w=f(w,J,M,K,O,14,i[30]),K=f(K,w,J,M,y,20,i[31]),M=e(M,K,w,J,k,4,i[32]),J=e(J,M,K,w,N,11,i[33]),w=e(w,J,M,K,H,16,i[34]),K=e(K,w,J,M,q,23,i[35]),M=e(M,K,w,J,v,4,i[36]),J=e(J,M,K,w,n,11,i[37]),w=e(w,J,M,K,O,16,i[38]),K=e(K,w,J,M,G,23,i[39]),M=e(M,K,w,J,s,4,i[40]),J=e(J,M,K,w,F,11,i[41]),w=e(w,J,M,K,r,16,i[42]),K=e(K,w,J,M,P,23,i[43]),M=e(M,K,w,J,L,4,i[44]),J=e(J,M,K,w,y,11,i[45]),w=e(w,J,M,K,l,16,i[46]),K=e(K,w,J,M,u,23,i[47]),M=d(M,K,w,J,F,6,i[48]),J=d(J,M,K,w,O,10,i[49]),w=d(w,J,M,K,q,15,i[50]),K=d(K,w,J,M,k,21,i[51]),M=d(M,K,w,J,y,6,i[52]),J=d(J,M,K,w,r,10,i[53]),w=d(w,J,M,K,G,15,i[54]),K=d(K,w,J,M,v,21,i[55]),M=d(M,K,w,J,N,6,i[56]),J=d(J,M,K,w,l,10,i[57]),w=d(w,J,M,K,P,15,i[58]),K=d(K,w,J,M,s,21,i[59]),M=d(M,K,w,J,n,6,i[60]),J=d(J,M,K,w,H,10,i[61]),w=d(w,J,M,K,u,15,i[62]),K=d(K,w,J,M,L,21,i[63]);E[0]=E[0]+M|0;E[1]=E[1]+K|0;E[2]=E[2]+w|0;E[3]=E[3]+J|0},_doFinalize:function(){var r=this._data,q=r.words,n=8*this._nDataBytes,k=8*r.sigBytes;q[k>>>5]|=128<<24-k%32;var l=p.floor(n/4294967296);q[(k+64>>>9<<4)+15]=(l<<8|l>>>24)&16711935|(l<<24|l>>>8)&4278255360;q[(k+64>>>9<<4)+14]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360;r.sigBytes=4*(q.length+1);this._process();r=this._hash;q=r.words;for(n=0;4>n;n++){k=q[n],q[n]=(k<<8|k>>>24)&16711935|(k<<24|k>>>8)&4278255360}return r},clone:function(){var k=o.clone.call(this);k._hash=this._hash.clone();return k}});b.MD5=o._createHelper(c);b.HmacMD5=o._createHmacHelper(c)})(Math);(function(){var i=CryptoJS,f=i.lib,e=f.WordArray,g=f.Hasher,c=[],f=i.algo.SHA1=g.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,b){for(var s=this._hash.words,o=s[0],m=s[1],k=s[2],j=s[3],r=s[4],q=0;80>q;q++){if(16>q){c[q]=d[b+q]|0}else{var l=c[q-3]^c[q-8]^c[q-14]^c[q-16];c[q]=l<<1|l>>>31}l=(o<<5|o>>>27)+r+c[q];l=20>q?l+((m&k|~m&j)+1518500249):40>q?l+((m^k^j)+1859775393):60>q?l+((m&k|m&j|k&j)-1894007588):l+((m^k^j)-899497514);r=j;j=k;k=m<<30|m>>>2;m=o;o=l}s[0]=s[0]+o|0;s[1]=s[1]+m|0;s[2]=s[2]+k|0;s[3]=s[3]+j|0;s[4]=s[4]+r|0},_doFinalize:function(){var j=this._data,d=j.words,k=8*this._nDataBytes,b=8*j.sigBytes;d[b>>>5]|=128<<24-b%32;d[(b+64>>>9<<4)+14]=Math.floor(k/4294967296);d[(b+64>>>9<<4)+15]=k;j.sigBytes=4*d.length;this._process();return this._hash},clone:function(){var b=g.clone.call(this);b._hash=this._hash.clone();return b}});i.SHA1=g._createHelper(f);i.HmacSHA1=g._createHmacHelper(f)})();(function(o){for(var i=CryptoJS,f=i.lib,D=f.WordArray,q=f.Hasher,f=i.algo,y=[],C=[],e=function(b){return 4294967296*(b-(b|0))|0},A=2,p=0;64>p;){var x;a:{x=A;for(var c=o.sqrt(x),m=2;m<=c;m++){if(!(x%m)){x=!1;break a}}x=!0}x&&(8>p&&(y[p]=e(o.pow(A,0.5))),C[p]=e(o.pow(A,1/3)),p++);A++}var B=[],f=f.SHA256=q.extend({_doReset:function(){this._hash=new D.init(y.slice(0))},_doProcessBlock:function(b,n){for(var k=this._hash.words,F=k[0],v=k[1],g=k[2],s=k[3],E=k[4],d=k[5],l=k[6],w=k[7],u=0;64>u;u++){if(16>u){B[u]=b[n+u]|0}else{var r=B[u-15],j=B[u-2];B[u]=((r<<25|r>>>7)^(r<<14|r>>>18)^r>>>3)+B[u-7]+((j<<15|j>>>17)^(j<<13|j>>>19)^j>>>10)+B[u-16]}r=w+((E<<26|E>>>6)^(E<<21|E>>>11)^(E<<7|E>>>25))+(E&d^~E&l)+C[u]+B[u];j=((F<<30|F>>>2)^(F<<19|F>>>13)^(F<<10|F>>>22))+(F&v^F&g^v&g);w=l;l=d;d=E;E=s+r|0;s=g;g=v;v=F;F=r+j|0}k[0]=k[0]+F|0;k[1]=k[1]+v|0;k[2]=k[2]+g|0;k[3]=k[3]+s|0;k[4]=k[4]+E|0;k[5]=k[5]+d|0;k[6]=k[6]+l|0;k[7]=k[7]+w|0},_doFinalize:function(){var b=this._data,g=b.words,j=8*this._nDataBytes,d=8*b.sigBytes;g[d>>>5]|=128<<24-d%32;g[(d+64>>>9<<4)+14]=o.floor(j/4294967296);g[(d+64>>>9<<4)+15]=j;b.sigBytes=4*g.length;this._process();return this._hash},clone:function(){var b=q.clone.call(this);b._hash=this._hash.clone();return b}});i.SHA256=q._createHelper(f);i.HmacSHA256=q._createHmacHelper(f)})(Math);(function(){var i=CryptoJS,f=i.lib.WordArray,e=i.algo,g=e.SHA256,e=e.SHA224=g.extend({_doReset:function(){this._hash=new f.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var b=g._doFinalize.call(this);b.sigBytes-=4;return b}});i.SHA224=g._createHelper(e);i.HmacSHA224=g._createHmacHelper(e)})();(function(){function f(){return b.create.apply(b,arguments)}for(var k=CryptoJS,j=k.lib.Hasher,m=k.x64,b=m.Word,l=m.WordArray,m=k.algo,c=[f(1116352408,3609767458),f(1899447441,602891725),f(3049323471,3964484399),f(3921009573,2173295548),f(961987163,4081628472),f(1508970993,3053834265),f(2453635748,2937671579),f(2870763221,3664609560),f(3624381080,2734883394),f(310598401,1164996542),f(607225278,1323610764),f(1426881987,3590304994),f(1925078388,4068182383),f(2162078206,991336113),f(2614888103,633803317),f(3248222580,3479774868),f(3835390401,2666613458),f(4022224774,944711139),f(264347078,2341262773),f(604807628,2007800933),f(770255983,1495990901),f(1249150122,1856431235),f(1555081692,3175218132),f(1996064986,2198950837),f(2554220882,3999719339),f(2821834349,766784016),f(2952996808,2566594879),f(3210313671,3203337956),f(3336571891,1034457026),f(3584528711,2466948901),f(113926993,3758326383),f(338241895,168717936),f(666307205,1188179964),f(773529912,1546045734),f(1294757372,1522805485),f(1396182291,2643833823),f(1695183700,2343527390),f(1986661051,1014477480),f(2177026350,1206759142),f(2456956037,344077627),f(2730485921,1290863460),f(2820302411,3158454273),f(3259730800,3505952657),f(3345764771,106217008),f(3516065817,3606008344),f(3600352804,1432725776),f(4094571909,1467031594),f(275423344,851169720),f(430227734,3100823752),f(506948616,1363258195),f(659060556,3750685593),f(883997877,3785050280),f(958139571,3318307427),f(1322822218,3812723403),f(1537002063,2003034995),f(1747873779,3602036899),f(1955562222,1575990012),f(2024104815,1125592928),f(2227730452,2716904306),f(2361852424,442776044),f(2428436474,593698344),f(2756734187,3733110249),f(3204031479,2999351573),f(3329325298,3815920427),f(3391569614,3928383900),f(3515267271,566280711),f(3940187606,3454069534),f(4118630271,4000239992),f(116418474,1914138554),f(174292421,2731055270),f(289380356,3203993006),f(460393269,320620315),f(685471733,587496836),f(852142971,1086792851),f(1017036298,365543100),f(1126000580,2618297676),f(1288033470,3409855158),f(1501505948,4234509866),f(1607167915,987167468),f(1816402316,1246189591)],i=[],g=0;80>g;g++){i[g]=f()}m=m.SHA512=j.extend({_doReset:function(){this._hash=new l.init([new b.init(1779033703,4089235720),new b.init(3144134277,2227873595),new b.init(1013904242,4271175723),new b.init(2773480762,1595750129),new b.init(1359893119,2917565137),new b.init(2600822924,725511199),new b.init(528734635,4215389547),new b.init(1541459225,327033209)])},_doProcessBlock:function(ay,ax){for(var aH=this._hash.words,aL=aH[0],aJ=aH[1],aR=aH[2],r=aH[3],o=aH[4],aY=aH[5],a0=aH[6],aH=aH[7],aD=aL.high,aC=aL.low,q=aJ.high,ar=aJ.low,a4=aR.high,a9=aR.low,aX=r.high,ba=r.low,aF=o.high,az=o.low,aP=aY.high,aT=aY.low,aA=a0.high,s=a0.low,a8=aH.high,aS=aH.low,av=aD,aO=aC,e=q,at=ar,aB=a4,a6=a9,aN=aX,aQ=ba,aK=aF,aM=az,aG=aP,p=aT,v=aA,a3=s,u=a8,aV=aS,aE=0;80>aE;aE++){var a2=i[aE];if(16>aE){var a5=a2.high=ay[ax+2*aE]|0,a7=a2.low=ay[ax+2*aE+1]|0}else{var a5=i[aE-15],a7=a5.high,n=a5.low,a5=(a7>>>1|n<<31)^(a7>>>8|n<<24)^a7>>>7,n=(n>>>1|a7<<31)^(n>>>8|a7<<24)^(n>>>7|a7<<25),aw=i[aE-2],a7=aw.high,aZ=aw.low,aw=(a7>>>19|aZ<<13)^(a7<<3|aZ>>>29)^a7>>>6,aZ=(aZ>>>19|a7<<13)^(aZ<<3|a7>>>29)^(aZ>>>6|a7<<26),a7=i[aE-7],d=a7.high,a1=i[aE-16],au=a1.high,a1=a1.low,a7=n+a7.low,a5=a5+d+(a7>>>0<n>>>0?1:0),a7=a7+aZ,a5=a5+aw+(a7>>>0<aZ>>>0?1:0),a7=a7+a1,a5=a5+au+(a7>>>0<a1>>>0?1:0);a2.high=a5;a2.low=a7}var d=aK&aG^~aK&v,a1=aM&p^~aM&a3,a2=av&e^av&aB^e&aB,aI=aO&at^aO&a6^at&a6,n=(av>>>28|aO<<4)^(av<<30|aO>>>2)^(av<<25|aO>>>7),aw=(aO>>>28|av<<4)^(aO<<30|av>>>2)^(aO<<25|av>>>7),aZ=c[aE],aW=aZ.high,aU=aZ.low,aZ=aV+((aM>>>14|aK<<18)^(aM>>>18|aK<<14)^(aM<<23|aK>>>9)),au=u+((aK>>>14|aM<<18)^(aK>>>18|aM<<14)^(aK<<23|aM>>>9))+(aZ>>>0<aV>>>0?1:0),aZ=aZ+a1,au=au+d+(aZ>>>0<a1>>>0?1:0),aZ=aZ+aU,au=au+aW+(aZ>>>0<aU>>>0?1:0),aZ=aZ+a7,au=au+a5+(aZ>>>0<a7>>>0?1:0),a7=aw+aI,a2=n+a2+(a7>>>0<aw>>>0?1:0),u=v,aV=a3,v=aG,a3=p,aG=aK,p=aM,aM=aQ+aZ|0,aK=aN+au+(aM>>>0<aQ>>>0?1:0)|0,aN=aB,aQ=a6,aB=e,a6=at,e=av,at=aO,aO=aZ+a7|0,av=au+a2+(aO>>>0<aZ>>>0?1:0)|0}aC=aL.low=aC+aO;aL.high=aD+av+(aC>>>0<aO>>>0?1:0);ar=aJ.low=ar+at;aJ.high=q+e+(ar>>>0<at>>>0?1:0);a9=aR.low=a9+a6;aR.high=a4+aB+(a9>>>0<a6>>>0?1:0);ba=r.low=ba+aQ;r.high=aX+aN+(ba>>>0<aQ>>>0?1:0);az=o.low=az+aM;o.high=aF+aK+(az>>>0<aM>>>0?1:0);aT=aY.low=aT+p;aY.high=aP+aG+(aT>>>0<p>>>0?1:0);s=a0.low=s+a3;a0.high=aA+v+(s>>>0<a3>>>0?1:0);aS=aH.low=aS+aV;aH.high=a8+u+(aS>>>0<aV>>>0?1:0)},_doFinalize:function(){var d=this._data,n=d.words,e=8*this._nDataBytes,o=8*d.sigBytes;n[o>>>5]|=128<<24-o%32;n[(o+128>>>10<<5)+30]=Math.floor(e/4294967296);n[(o+128>>>10<<5)+31]=e;d.sigBytes=4*n.length;this._process();return this._hash.toX32()},clone:function(){var d=j.clone.call(this);d._hash=this._hash.clone();return d},blockSize:32});k.SHA512=j._createHelper(m);k.HmacSHA512=j._createHmacHelper(m)})();(function(){var f=CryptoJS,i=f.x64,g=i.Word,j=i.WordArray,i=f.algo,k=i.SHA512,i=i.SHA384=k.extend({_doReset:function(){this._hash=new j.init([new g.init(3418070365,3238371032),new g.init(1654270250,914150663),new g.init(2438529370,812702999),new g.init(355462360,4144912697),new g.init(1731405415,4290775857),new g.init(2394180231,1750603025),new g.init(3675008525,1694076839),new g.init(1203062813,3204075428)])},_doFinalize:function(){var b=k._doFinalize.call(this);b.sigBytes-=16;return b}});f.SHA384=k._createHelper(i);f.HmacSHA384=k._createHmacHelper(i)})();(function(){var k=CryptoJS,e=k.lib,c=e.WordArray,m=e.Hasher,e=k.algo,i=c.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),g=c.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),f=c.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),b=c.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),l=c.create([0,1518500249,1859775393,2400959708,2840853838]),j=c.create([1352829926,1548603684,1836072691,2053994217,0]),e=e.RIPEMD160=m.extend({_doReset:function(){this._hash=c.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,w){for(var D=0;16>D;D++){var G=w+D,r=u[G];u[G]=(r<<8|r>>>24)&16711935|(r<<24|r>>>8)&4278255360}var G=this._hash.words,r=l.words,A=j.words,p=i.words,n=g.words,o=f.words,y=b.words,I,E,C,H,d,v,q,s,B,x;v=I=G[0];q=E=G[1];s=C=G[2];B=H=G[3];x=d=G[4];for(var F,D=0;80>D;D+=1){F=I+u[w+p[D]]|0,F=16>D?F+((E^C^H)+r[0]):32>D?F+((E&C|~E&H)+r[1]):48>D?F+(((E|~C)^H)+r[2]):64>D?F+((E&H|C&~H)+r[3]):F+((E^(C|~H))+r[4]),F|=0,F=F<<o[D]|F>>>32-o[D],F=F+d|0,I=d,d=H,H=C<<10|C>>>22,C=E,E=F,F=v+u[w+n[D]]|0,F=16>D?F+((q^(s|~B))+A[0]):32>D?F+((q&B|s&~B)+A[1]):48>D?F+(((q|~s)^B)+A[2]):64>D?F+((q&s|~q&B)+A[3]):F+((q^s^B)+A[4]),F|=0,F=F<<y[D]|F>>>32-y[D],F=F+x|0,v=x,x=B,B=s<<10|s>>>22,s=q,q=F}F=G[1]+C+B|0;G[1]=G[2]+H+x|0;G[2]=G[3]+d+v|0;G[3]=G[4]+I+q|0;G[4]=G[0]+E+s|0;G[0]=F},_doFinalize:function(){var o=this._data,p=o.words,n=8*this._nDataBytes,d=8*o.sigBytes;p[d>>>5]|=128<<24-d%32;p[(d+64>>>9<<4)+14]=(n<<8|n>>>24)&16711935|(n<<24|n>>>8)&4278255360;o.sigBytes=4*(p.length+1);this._process();o=this._hash;p=o.words;for(n=0;5>n;n++){d=p[n],p[n]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360}return o},clone:function(){var d=m.clone.call(this);d._hash=this._hash.clone();return d}});k.RIPEMD160=m._createHelper(e);k.HmacRIPEMD160=m._createHmacHelper(e)})(Math);(function(){var b=CryptoJS,d=b.enc.Utf8;b.algo.HMAC=b.lib.Base.extend({init:function(i,e){i=this._hasher=new i.init;"string"==typeof e&&(e=d.parse(e));var c=i.blockSize,o=4*c;e.sigBytes>o&&(e=i.finalize(e));e.clamp();for(var n=this._oKey=e.clone(),m=this._iKey=e.clone(),l=n.words,k=m.words,p=0;p<c;p++){l[p]^=1549556828,k[p]^=909522486}n.sigBytes=m.sigBytes=o;this.reset()},reset:function(){var c=this._hasher;c.reset();c.update(this._iKey)},update:function(c){this._hasher.update(c);return this},finalize:function(c){var e=this._hasher;c=e.finalize(c);e.reset();return e.finalize(this._oKey.clone().concat(c))}})})();(function(){var e=CryptoJS,g=e.lib,c=g.Base,j=g.WordArray,g=e.algo,i=g.HMAC,f=g.PBKDF2=c.extend({cfg:c.extend({keySize:4,hasher:g.SHA1,iterations:1}),init:function(b){this.cfg=this.cfg.extend(b)},compute:function(v,d){for(var y=this.cfg,q=i.create(y.hasher,v),A=j.create(),m=j.create([1]),w=A.words,x=m.words,C=y.keySize,y=y.iterations;w.length<C;){var u=q.update(d).finalize(m);q.reset();for(var B=u.words,b=B.length,o=u,k=1;k<y;k++){o=q.finalize(o);q.reset();for(var n=o.words,l=0;l<b;l++){B[l]^=n[l]}}A.concat(u);x[0]++}A.sigBytes=4*C;return A}});e.PBKDF2=function(b,k,d){return f.create(d).compute(b,k)}})();var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";function hex2b64(g){var i;var f;var c="";for(i=0;i+3<=g.length;i+=3){f=parseInt(g.substring(i,i+3),16);c+=b64map.charAt(f>>6)+b64map.charAt(f&63)}if(i+1==g.length){f=parseInt(g.substring(i,i+1),16);c+=b64map.charAt(f<<2)}else{if(i+2==g.length){f=parseInt(g.substring(i,i+2),16);c+=b64map.charAt(f>>2)+b64map.charAt((f&3)<<4)}}if(b64pad){while((c.length&3)>0){c+=b64pad}}return c}function b64tohex(j){var m="";var k;var g=0;var l;var i;for(k=0;k<j.length;++k){if(j.charAt(k)==b64pad){break}i=b64map.indexOf(j.charAt(k));if(i<0){continue}if(g==0){m+=int2char(i>>2);l=i&3;g=1}else{if(g==1){m+=int2char((l<<2)|(i>>4));l=i&15;g=2}else{if(g==2){m+=int2char(l);m+=int2char(i>>2);l=i&3;g=3}else{m+=int2char((l<<2)|(i>>4));m+=int2char(i&15);g=0}}}}if(g==1){m+=int2char(l<<2)}return m}function b64toBA(f){var g=b64tohex(f);var i;var j=new Array();for(i=0;2*i<g.length;++i){j[i]=parseInt(g.substring(2*i,2*i+2),16)}return j}var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(g,b,c){if(g!=null){if("number"==typeof g){this.fromNumber(g,b,c)}else{if(b==null&&"string"!=typeof g){this.fromString(g,256)}else{this.fromString(g,b)}}}}function nbi(){return new BigInteger(null)}function am1(n,i,l,c,j,k){while(--k>=0){var m=i*this[n++]+l[c]+j;j=Math.floor(m/67108864);l[c++]=m&67108863}return j}function am2(u,l,i,v,m,c){var n=l&32767,x=l>>15;while(--c>=0){var w=this[u]&32767;var j=this[u++]>>15;var s=x*w+j*n;w=n*w+((s&32767)<<15)+i[v]+(m&1073741823);m=(w>>>30)+(s>>>15)+x*j+(m>>>30);i[v++]=w&1073741823}return m}function am3(u,l,i,v,m,c){var n=l&16383,x=l>>14;while(--c>=0){var w=this[u]&16383;var j=this[u++]>>14;var s=x*w+j*n;w=n*w+((s&16383)<<14)+i[v]+m;m=(w>>28)+(s>>14)+x*j;i[v++]=w&268435455}return m}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(b){return BI_RM.charAt(b)}function intAt(f,c){var e=BI_RC[f.charCodeAt(c)];return(e==null)?-1:e}function bnpCopyTo(d){for(var c=this.t-1;c>=0;--c){d[c]=this[c]}d.t=this.t;d.s=this.s}function bnpFromInt(b){this.t=1;this.s=(b<0)?-1:0;if(b>0){this[0]=b}else{if(b<-1){this[0]=b+this.DV}else{this.t=0}}}function nbv(c){var d=nbi();d.fromInt(c);return d}function bnpFromString(m,i){var b;if(i==16){b=4}else{if(i==8){b=3}else{if(i==256){b=8}else{if(i==2){b=1}else{if(i==32){b=5}else{if(i==4){b=2}else{this.fromRadix(m,i);return}}}}}}this.t=0;this.s=0;var l=m.length,k=false,n=0;while(--l>=0){var j=(b==8)?m[l]&255:intAt(m,l);if(j<0){if(m.charAt(l)=="-"){k=true}continue}k=false;if(n==0){this[this.t++]=j}else{if(n+b>this.DB){this[this.t-1]|=(j&((1<<(this.DB-n))-1))<<n;this[this.t++]=(j>>(this.DB-n))}else{this[this.t-1]|=j<<n}}n+=b;if(n>=this.DB){n-=this.DB}}if(b==8&&(m[0]&128)!=0){this.s=-1;if(n>0){this[this.t-1]|=((1<<(this.DB-n))-1)<<n}}this.clamp();if(k){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var b=this.s&this.DM;while(this.t>0&&this[this.t-1]==b){--this.t}}function bnToString(k){if(this.s<0){return"-"+this.negate().toString(k)}var n;if(k==16){n=4}else{if(k==8){n=3}else{if(k==2){n=1}else{if(k==32){n=5}else{if(k==4){n=2}else{return this.toRadix(k)}}}}}var o=(1<<n)-1,m,d=false,p="",b=this.t;var i=this.DB-(b*this.DB)%n;if(b-->0){if(i<this.DB&&(m=this[b]>>i)>0){d=true;p=int2char(m)}while(b>=0){if(i<n){m=(this[b]&((1<<i)-1))<<(n-i);m|=this[--b]>>(i+=this.DB-n)}else{m=(this[b]>>(i-=n))&o;if(i<=0){i+=this.DB;--b}}if(m>0){d=true}if(d){p+=int2char(m)}}}return d?p:"0"}function bnNegate(){var b=nbi();BigInteger.ZERO.subTo(this,b);return b}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(g){var e=this.s-g.s;if(e!=0){return e}var f=this.t;e=f-g.t;if(e!=0){return(this.s<0)?-e:e}while(--f>=0){if((e=this[f]-g[f])!=0){return e}}return 0}function nbits(d){var e=1,f;if((f=d>>>16)!=0){d=f;e+=16}if((f=d>>8)!=0){d=f;e+=8}if((f=d>>4)!=0){d=f;e+=4}if((f=d>>2)!=0){d=f;e+=2}if((f=d>>1)!=0){d=f;e+=1}return e}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(e,f){var d;for(d=this.t-1;d>=0;--d){f[d+e]=this[d]}for(d=e-1;d>=0;--d){f[d]=0}f.t=this.t+e;f.s=this.s}function bnpDRShiftTo(e,f){for(var d=e;d<this.t;++d){f[d-e]=this[d]}f.t=Math.max(this.t-e,0);f.s=this.s}function bnpLShiftTo(p,l){var k=p%this.DB;var n=this.DB-k;var i=(1<<n)-1;var o=Math.floor(p/this.DB),m=(this.s<<k)&this.DM,c;for(c=this.t-1;c>=0;--c){l[c+o+1]=(this[c]>>n)|m;m=(this[c]&i)<<k}for(c=o-1;c>=0;--c){l[c]=0}l[o]=m;l.t=this.t+o+1;l.s=this.s;l.clamp()}function bnpRShiftTo(i,k){k.s=this.s;var n=Math.floor(i/this.DB);if(n>=this.t){k.t=0;return}var m=i%this.DB;var o=this.DB-m;var j=(1<<m)-1;k[0]=this[n]>>m;for(var l=n+1;l<this.t;++l){k[l-n-1]|=(this[l]&j)<<o;k[l-n]=this[l]>>m}if(m>0){k[this.t-n-1]|=(this.s&j)<<o}k.t=this.t-n;k.clamp()}function bnpSubTo(c,k){var l=0,j=0,i=Math.min(c.t,this.t);while(l<i){j+=this[l]-c[l];k[l++]=j&this.DM;j>>=this.DB}if(c.t<this.t){j-=c.s;while(l<this.t){j+=this[l];k[l++]=j&this.DM;j>>=this.DB}j+=this.s}else{j+=this.s;while(l<c.t){j-=c[l];k[l++]=j&this.DM;j>>=this.DB}j-=c.s}k.s=(j<0)?-1:0;if(j<-1){k[l++]=this.DV+j}else{if(j>0){k[l++]=j}}k.t=l;k.clamp()}function bnpMultiplyTo(g,k){var i=this.abs(),j=g.abs();var l=i.t;k.t=l+j.t;while(--l>=0){k[l]=0}for(l=0;l<j.t;++l){k[l+i.t]=i.am(0,j[l],k,l,0,i.t)}k.s=0;k.clamp();if(this.s!=g.s){BigInteger.ZERO.subTo(k,k)}}function bnpSquareTo(g){var c=this.abs();var i=g.t=2*c.t;while(--i>=0){g[i]=0}for(i=0;i<c.t-1;++i){var f=c.am(i,c[i],g,2*i,0,1);if((g[i+c.t]+=c.am(i+1,2*c[i],g,2*i+1,f,c.t-i-1))>=c.DV){g[i+c.t]-=c.DV;g[i+c.t+1]=1}}if(g.t>0){g[g.t-1]+=c.am(i,c[i],g,2*i,0,1)}g.s=0;g.clamp()}function bnpDivRemTo(D,G,H){var j=D.abs();if(j.t<=0){return}var F=this.abs();if(F.t<j.t){if(G!=null){G.fromInt(0)}if(H!=null){this.copyTo(H)}return}if(H==null){H=nbi()}var E=nbi(),M=this.s,I=D.s;var m=this.DB-nbits(j[j.t-1]);if(m>0){j.lShiftTo(m,E);F.lShiftTo(m,H)}else{j.copyTo(E);F.copyTo(H)}var B=E.t;var L=E[B-1];if(L==0){return}var C=L*(1<<this.F1)+((B>1)?E[B-2]>>this.F2:0);var y=this.FV/C,e=(1<<this.F1)/C,i=1<<this.F2;var q=H.t,r=q-B,J=(G==null)?nbi():G;E.dlShiftTo(r,J);if(H.compareTo(J)>=0){H[H.t++]=1;H.subTo(J,H)}BigInteger.ONE.dlShiftTo(B,J);J.subTo(E,E);while(E.t<B){E[E.t++]=0}while(--r>=0){var K=(H[--q]==L)?this.DM:Math.floor(H[q]*y+(H[q-1]+i)*e);if((H[q]+=E.am(0,K,H,r,0,B))<K){E.dlShiftTo(r,J);H.subTo(J,H);while(H[q]<--K){H.subTo(J,H)}}}if(G!=null){H.drShiftTo(B,G);if(M!=I){BigInteger.ZERO.subTo(G,G)}}H.t=B;H.clamp();if(m>0){H.rShiftTo(m,H)}if(M<0){BigInteger.ZERO.subTo(H,H)}}function bnMod(e){var d=nbi();this.abs().divRemTo(e,null,d);if(this.s<0&&d.compareTo(BigInteger.ZERO)>0){e.subTo(d,d)}return d}function Classic(b){this.m=b}function cConvert(b){if(b.s<0||b.compareTo(this.m)>=0){return b.mod(this.m)}else{return b}}function cRevert(b){return b}function cReduce(b){b.divRemTo(this.m,null,b)}function cMulTo(d,e,f){d.multiplyTo(e,f);this.reduce(f)}function cSqrTo(c,d){c.squareTo(d);this.reduce(d)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var c=this[0];if((c&1)==0){return 0}var d=c&3;d=(d*(2-(c&15)*d))&15;d=(d*(2-(c&255)*d))&255;d=(d*(2-(((c&65535)*d)&65535)))&65535;d=(d*(2-c*d%this.DV))%this.DV;return(d>0)?this.DV-d:-d}function Montgomery(b){this.m=b;this.mp=b.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(b.DB-15))-1;this.mt2=2*b.t}function montConvert(c){var d=nbi();c.abs().dlShiftTo(this.m.t,d);d.divRemTo(this.m,null,d);if(c.s<0&&d.compareTo(BigInteger.ZERO)>0){this.m.subTo(d,d)}return d}function montRevert(c){var d=nbi();c.copyTo(d);this.reduce(d);return d}function montReduce(e){while(e.t<=this.mt2){e[e.t++]=0}for(var g=0;g<this.m.t;++g){var i=e[g]&32767;var f=(i*this.mpl+(((i*this.mph+(e[g]>>15)*this.mpl)&this.um)<<15))&e.DM;i=g+this.m.t;e[i]+=this.m.am(0,f,e,g,0,this.m.t);while(e[i]>=e.DV){e[i]-=e.DV;e[++i]++}}e.clamp();e.drShiftTo(this.m.t,e);if(e.compareTo(this.m)>=0){e.subTo(this.m,e)}}function montSqrTo(c,d){c.squareTo(d);this.reduce(d)}function montMulTo(d,e,f){d.multiplyTo(e,f);this.reduce(f)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(m,i){if(m>4294967295||m<1){return BigInteger.ONE}var e=nbi(),g=nbi(),k=i.convert(this),l=nbits(m)-1;k.copyTo(e);while(--l>=0){i.sqrTo(e,g);if((m&(1<<l))>0){i.mulTo(g,k,e)}else{var n=e;e=g;g=n}}return i.revert(e)}function bnModPowInt(f,d){var e;if(f<256||d.isEven()){e=new Classic(d)}else{e=new Montgomery(d)}return this.exp(f,e)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var b=nbi();this.copyTo(b);return b}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(b){return Math.floor(Math.LN2*this.DB/Math.log(b))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(n){if(n==null){n=10}if(this.signum()==0||n<2||n>36){return"0"}var m=this.chunkSize(n);var b=Math.pow(n,m);var o=nbv(b),d=nbi(),k=nbi(),l="";this.divRemTo(o,d,k);while(d.signum()>0){l=(b+k.intValue()).toString(n).substr(1)+l;d.divRemTo(o,d,k)}return k.intValue().toString(n)+l}function bnpFromRadix(o,r){this.fromInt(0);if(r==null){r=10}var d=this.chunkSize(r);var b=Math.pow(r,d),i=false,n=0,p=0;for(var j=0;j<o.length;++j){var q=intAt(o,j);if(q<0){if(o.charAt(j)=="-"&&this.signum()==0){i=true}continue}p=r*p+q;if(++n>=d){this.dMultiply(b);this.dAddOffset(p,0);n=0;p=0}}if(n>0){this.dMultiply(Math.pow(r,n));this.dAddOffset(p,0)}if(i){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(c,i,k){if("number"==typeof i){if(c<2){this.fromInt(1)}else{this.fromNumber(c,k);if(!this.testBit(c-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(c-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(i)){this.dAddOffset(2,0);if(this.bitLength()>c){this.subTo(BigInteger.ONE.shiftLeft(c-1),this)}}}}else{var j=new Array(),b=c&7;j.length=(c>>3)+1;i.nextBytes(j);if(b>0){j[0]&=((1<<b)-1)}else{j[0]=0}this.fromString(j,256)}}function bnToByteArray(){var g=this.t,d=new Array();d[0]=this.s;var k=this.DB-(g*this.DB)%8,j,i=0;if(g-->0){if(k<this.DB&&(j=this[g]>>k)!=(this.s&this.DM)>>k){d[i++]=j|(this.s<<(this.DB-k))}while(g>=0){if(k<8){j=(this[g]&((1<<k)-1))<<(8-k);j|=this[--g]>>(k+=this.DB-8)}else{j=(this[g]>>(k-=8))&255;if(k<=0){k+=this.DB;--g}}if((j&128)!=0){j|=-256}if(i==0&&(this.s&128)!=(j&128)){++i}if(i>0||j!=this.s){d[i++]=j}}}return d}function bnEquals(c){return(this.compareTo(c)==0)}function bnMin(c){return(this.compareTo(c)<0)?this:c}function bnMax(c){return(this.compareTo(c)>0)?this:c}function bnpBitwiseTo(f,i,k){var m,j,l=Math.min(f.t,this.t);for(m=0;m<l;++m){k[m]=i(this[m],f[m])}if(f.t<this.t){j=f.s&this.DM;for(m=l;m<this.t;++m){k[m]=i(this[m],j)}k.t=this.t}else{j=this.s&this.DM;for(m=l;m<f.t;++m){k[m]=i(j,f[m])}k.t=f.t}k.s=i(this.s,f.s);k.clamp()}function op_and(c,d){return c&d}function bnAnd(e){var d=nbi();this.bitwiseTo(e,op_and,d);return d}function op_or(c,d){return c|d}function bnOr(e){var d=nbi();this.bitwiseTo(e,op_or,d);return d}function op_xor(c,d){return c^d}function bnXor(e){var d=nbi();this.bitwiseTo(e,op_xor,d);return d}function op_andnot(c,d){return c&~d}function bnAndNot(e){var d=nbi();this.bitwiseTo(e,op_andnot,d);return d}function bnNot(){var d=nbi();for(var c=0;c<this.t;++c){d[c]=this.DM&~this[c]}d.t=this.t;d.s=~this.s;return d}function bnShiftLeft(d){var c=nbi();if(d<0){this.rShiftTo(-d,c)}else{this.lShiftTo(d,c)}return c}function bnShiftRight(d){var c=nbi();if(d<0){this.lShiftTo(-d,c)}else{this.rShiftTo(d,c)}return c}function lbit(c){if(c==0){return -1}var d=0;if((c&65535)==0){c>>=16;d+=16}if((c&255)==0){c>>=8;d+=8}if((c&15)==0){c>>=4;d+=4}if((c&3)==0){c>>=2;d+=2}if((c&1)==0){++d}return d}function bnGetLowestSetBit(){for(var b=0;b<this.t;++b){if(this[b]!=0){return b*this.DB+lbit(this[b])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(c){var d=0;while(c!=0){c&=c-1;++d}return d}function bnBitCount(){var e=0,d=this.s&this.DM;for(var f=0;f<this.t;++f){e+=cbit(this[f]^d)}return e}function bnTestBit(d){var c=Math.floor(d/this.DB);if(c>=this.t){return(this.s!=0)}return((this[c]&(1<<(d%this.DB)))!=0)}function bnpChangeBit(e,f){var d=BigInteger.ONE.shiftLeft(e);this.bitwiseTo(d,f,d);return d}function bnSetBit(b){return this.changeBit(b,op_or)}function bnClearBit(b){return this.changeBit(b,op_andnot)}function bnFlipBit(b){return this.changeBit(b,op_xor)}function bnpAddTo(c,k){var l=0,j=0,i=Math.min(c.t,this.t);while(l<i){j+=this[l]+c[l];k[l++]=j&this.DM;j>>=this.DB}if(c.t<this.t){j+=c.s;while(l<this.t){j+=this[l];k[l++]=j&this.DM;j>>=this.DB}j+=this.s}else{j+=this.s;while(l<c.t){j+=c[l];k[l++]=j&this.DM;j>>=this.DB}j+=c.s}k.s=(j<0)?-1:0;if(j>0){k[l++]=j}else{if(j<-1){k[l++]=this.DV+j}}k.t=l;k.clamp()}function bnAdd(e){var d=nbi();this.addTo(e,d);return d}function bnSubtract(e){var d=nbi();this.subTo(e,d);return d}function bnMultiply(e){var d=nbi();this.multiplyTo(e,d);return d}function bnSquare(){var b=nbi();this.squareTo(b);return b}function bnDivide(e){var d=nbi();this.divRemTo(e,d,null);return d}function bnRemainder(e){var d=nbi();this.divRemTo(e,null,d);return d}function bnDivideAndRemainder(g){var e=nbi(),f=nbi();this.divRemTo(g,e,f);return new Array(e,f)}function bnpDMultiply(b){this[this.t]=this.am(0,b-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(d,c){if(d==0){return}while(this.t<=c){this[this.t++]=0}this[c]+=d;while(this[c]>=this.DV){this[c]-=this.DV;if(++c>=this.t){this[this.t++]=0}++this[c]}}function NullExp(){}function nNop(b){return b}function nMulTo(d,e,f){d.multiplyTo(e,f)}function nSqrTo(c,d){c.squareTo(d)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(b){return this.exp(b,new NullExp())}function bnpMultiplyLowerTo(i,j,k){var l=Math.min(this.t+i.t,j);k.s=0;k.t=l;while(l>0){k[--l]=0}var g;for(g=k.t-this.t;l<g;++l){k[l+this.t]=this.am(0,i[l],k,l,0,this.t)}for(g=Math.min(i.t,j);l<g;++l){this.am(0,i[l],k,l,0,j-l)}k.clamp()}function bnpMultiplyUpperTo(j,f,g){--f;var i=g.t=this.t+j.t-f;g.s=0;while(--i>=0){g[i]=0}for(i=Math.max(f-this.t,0);i<j.t;++i){g[this.t+i-f]=this.am(f-i,j[i],g,0,0,this.t+i-f)}g.clamp();g.drShiftTo(1,g)}function Barrett(b){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*b.t,this.r2);this.mu=this.r2.divide(b);this.m=b}function barrettConvert(c){if(c.s<0||c.t>2*this.m.t){return c.mod(this.m)}else{if(c.compareTo(this.m)<0){return c}else{var d=nbi();c.copyTo(d);this.reduce(d);return d}}}function barrettRevert(b){return b}function barrettReduce(b){b.drShiftTo(this.m.t-1,this.r2);if(b.t>this.m.t+1){b.t=this.m.t+1;b.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(b.compareTo(this.r2)<0){b.dAddOffset(1,this.m.t+1)}b.subTo(this.r2,b);while(b.compareTo(this.m)>=0){b.subTo(this.m,b)}}function barrettSqrTo(c,d){c.squareTo(d);this.reduce(d)}function barrettMulTo(d,e,f){d.multiplyTo(e,f);this.reduce(f)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(B,g){var D=B.bitLength(),E,m=nbv(1),j;if(D<=0){return m}else{if(D<18){E=1}else{if(D<48){E=3}else{if(D<144){E=4}else{if(D<768){E=5}else{E=6}}}}}if(D<8){j=new Classic(g)}else{if(g.isEven()){j=new Barrett(g)}else{j=new Montgomery(g)}}var F=new Array(),r=3,e=E-1,G=(1<<E)-1;F[1]=j.convert(this);if(E>1){var C=nbi();j.sqrTo(F[1],C);while(r<=G){F[r]=nbi();j.mulTo(C,F[r-2],F[r]);r+=2}}var i=B.t-1,n,w=true,k=nbi(),H;D=nbits(B[i])-1;while(i>=0){if(D>=e){n=(B[i]>>(D-e))&G}else{n=(B[i]&((1<<(D+1))-1))<<(e-D);if(i>0){n|=B[i-1]>>(this.DB+D-e)}}r=E;while((n&1)==0){n>>=1;--r}if((D-=r)<0){D+=this.DB;--i}if(w){F[n].copyTo(m);w=false}else{while(r>1){j.sqrTo(m,k);j.sqrTo(k,m);r-=2}if(r>0){j.sqrTo(m,k)}else{H=m;m=k;k=H}j.mulTo(k,F[n],m)}while(i>=0&&(B[i]&(1<<D))==0){j.sqrTo(m,k);H=m;m=k;k=H;if(--D<0){D=this.DB-1;--i}}}return j.revert(m)}function bnGCD(g){var m=(this.s<0)?this.negate():this.clone();var i=(g.s<0)?g.negate():g.clone();if(m.compareTo(i)<0){var k=m;m=i;i=k}var l=m.getLowestSetBit(),j=i.getLowestSetBit();if(j<0){return m}if(l<j){j=l}if(j>0){m.rShiftTo(j,m);i.rShiftTo(j,i)}while(m.signum()>0){if((l=m.getLowestSetBit())>0){m.rShiftTo(l,m)}if((l=i.getLowestSetBit())>0){i.rShiftTo(l,i)}if(m.compareTo(i)>=0){m.subTo(i,m);m.rShiftTo(1,m)}else{i.subTo(m,i);i.rShiftTo(1,i)}}if(j>0){i.lShiftTo(j,i)}return i}function bnpModInt(f){if(f<=0){return 0}var g=this.DV%f,i=(this.s<0)?f-1:0;if(this.t>0){if(g==0){i=this[0]%f}else{for(var d=this.t-1;d>=0;--d){i=(g*i+this[d])%f}}}return i}function bnModInverse(m){var c=m.isEven();if((this.isEven()&&c)||m.signum()==0){return BigInteger.ZERO}var p=m.clone(),o=this.clone();var d=nbv(1),b=nbv(0),n=nbv(0),q=nbv(1);while(p.signum()!=0){while(p.isEven()){p.rShiftTo(1,p);if(c){if(!d.isEven()||!b.isEven()){d.addTo(this,d);b.subTo(m,b)}d.rShiftTo(1,d)}else{if(!b.isEven()){b.subTo(m,b)}}b.rShiftTo(1,b)}while(o.isEven()){o.rShiftTo(1,o);if(c){if(!n.isEven()||!q.isEven()){n.addTo(this,n);q.subTo(m,q)}n.rShiftTo(1,n)}else{if(!q.isEven()){q.subTo(m,q)}}q.rShiftTo(1,q)}if(p.compareTo(o)>=0){p.subTo(o,p);if(c){d.subTo(n,d)}b.subTo(q,b)}else{o.subTo(p,o);if(c){n.subTo(d,n)}q.subTo(b,q)}}if(o.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(q.compareTo(m)>=0){return q.subtract(m)}if(q.signum()<0){q.addTo(m,q)}else{return q}if(q.signum()<0){return q.add(m)}else{return q}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(j){var k,g=this.abs();if(g.t==1&&g[0]<=lowprimes[lowprimes.length-1]){for(k=0;k<lowprimes.length;++k){if(g[0]==lowprimes[k]){return true}}return false}if(g.isEven()){return false}k=1;while(k<lowprimes.length){var i=lowprimes[k],f=k+1;while(f<lowprimes.length&&i<lplim){i*=lowprimes[f++]}i=g.modInt(i);while(k<f){if(i%lowprimes[k++]==0){return false}}}return g.millerRabin(j)}function bnpMillerRabin(m){var i=this.subtract(BigInteger.ONE);var p=i.getLowestSetBit();if(p<=0){return false}var j=i.shiftRight(p);m=(m+1)>>1;if(m>lowprimes.length){m=lowprimes.length}var o=nbi();for(var n=0;n<m;++n){o.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var k=o.modPow(j,this);if(k.compareTo(BigInteger.ONE)!=0&&k.compareTo(i)!=0){var q=1;while(q++<p&&k.compareTo(i)!=0){k=k.modPowInt(2,this);if(k.compareTo(BigInteger.ONE)==0){return false}}if(k.compareTo(i)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;function Arcfour(){this.i=0;this.j=0;this.S=new Array()}function ARC4init(f){var g,e,i;for(g=0;g<256;++g){this.S[g]=g}e=0;for(g=0;g<256;++g){e=(e+this.S[g]+f[g%f.length])&255;i=this.S[g];this.S[g]=this.S[e];this.S[e]=i}this.i=0;this.j=0}function ARC4next(){var b;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;b=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=b;return this.S[(b+this.S[this.i])&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour()}var rng_psize=256;var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(b){rng_pool[rng_pptr++]^=b&255;rng_pool[rng_pptr++]^=(b>>8)&255;rng_pool[rng_pptr++]^=(b>>16)&255;rng_pool[rng_pptr++]^=(b>>24)&255;if(rng_pptr>=rng_psize){rng_pptr-=rng_psize}}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(rng_pool==null){rng_pool=new Array();rng_pptr=0;var t;if(window.crypto&&window.crypto.getRandomValues){var ua=new Uint8Array(32);window.crypto.getRandomValues(ua);for(t=0;t<32;++t){rng_pool[rng_pptr++]=ua[t]}}if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t){rng_pool[rng_pptr++]=z.charCodeAt(t)&255}}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr){rng_pool[rng_pptr]=0}rng_pptr=0}return rng_state.next()}function rng_get_bytes(d){var c;for(c=0;c<d.length;++c){d[c]=rng_get_byte()}}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function parseBigInt(d,c){return new BigInteger(d,c)}function linebrk(g,f){var e="";var i=0;while(i+f<g.length){e+=g.substring(i,i+f)+"\n";i+=f}return e+g.substring(i,g.length)}function byte2Hex(b){if(b<16){return"0"+b.toString(16)}else{return b.toString(16)}}function pkcs1pad2(n,j){if(j<n.length+11){alert("Message too long for RSA");return null}var l=new Array();var k=n.length-1;while(k>=0&&j>0){var c=n.charCodeAt(k--);if(c<128){l[--j]=c}else{if((c>127)&&(c<2048)){l[--j]=(c&63)|128;l[--j]=(c>>6)|192}else{l[--j]=(c&63)|128;l[--j]=((c>>6)&63)|128;l[--j]=(c>>12)|224}}}l[--j]=0;var m=new SecureRandom();var i=new Array();while(j>2){i[0]=0;while(i[0]==0){m.nextBytes(i)}l[--j]=i[0]}l[--j]=2;l[--j]=0;return new BigInteger(l)}function oaep_mgf1_arr(f,i,j){var g="",k=0;while(g.length<i){g+=j(String.fromCharCode.apply(String,f.concat([(k&4278190080)>>24,(k&16711680)>>16,(k&65280)>>8,k&255])));k+=1}return g}function oaep_pad(F,E,B,x){var A=Ext.crypto.MessageDigest;var v=Ext.crypto.Util;var s=null;if(!B){B="sha1"}if(typeof B==="string"){s=A.getCanonicalAlgName(B);x=A.getHashLength(s);B=function(b){return hextorstr(v.hashString(b,s))}}if(F.length+2*x+2>E){throw"Message too long for RSA"}var y="",C;for(C=0;C<E-F.length-2*x-2;C+=1){y+="\x00"}var n=B("")+y+"\x01"+F;var r=new Array(x);new SecureRandom().nextBytes(r);var i=oaep_mgf1_arr(r,n.length,B);var u=[];for(C=0;C<n.length;C+=1){u[C]=n.charCodeAt(C)^i.charCodeAt(C)}var w=oaep_mgf1_arr(u,r.length,B);var D=[0];for(C=0;C<r.length;C+=1){D[C+1]=r[C]^w.charCodeAt(C)}return new BigInteger(D.concat(u))}function RSAKey(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function RSASetPublic(d,c){this.isPublic=true;this.isPrivate=false;if(typeof d!=="string"){this.n=d;this.e=c}else{if(d!=null&&c!=null&&d.length>0&&c.length>0){this.n=parseBigInt(d,16);this.e=parseInt(c,16)}else{throw"Invalid RSA public key"}}}function RSADoPublic(b){return b.modPowInt(this.e,this.n)}function RSAEncrypt(g){var c=pkcs1pad2(g,(this.n.bitLength()+7)>>3);if(c==null){return null}var f=this.doPublic(c);if(f==null){return null}var i=f.toString(16);if((i.length&1)==0){return i}else{return"0"+i}}function RSAEncryptOAEP(k,l,m){var i=oaep_pad(k,(this.n.bitLength()+7)>>3,l,m);if(i==null){return null}var j=this.doPublic(i);if(j==null){return null}var c=j.toString(16);if((c.length&1)==0){return c}else{return"0"+c}}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";function pkcs1unpad2(l,i){var d=l.toByteArray();var b=0;while(b<d.length&&d[b]==0){++b}if(d.length-b!=i-1||d[b]!=2){return null}++b;while(d[b]!=0){if(++b>=d.length){return null}}var c="";while(++b<d.length){var k=d[b]&255;if(k<128){c+=String.fromCharCode(k)}else{if((k>191)&&(k<224)){c+=String.fromCharCode(((k&31)<<6)|(d[b+1]&63));++b}else{c+=String.fromCharCode(((k&15)<<12)|((d[b+1]&63)<<6)|(d[b+2]&63));b+=2}}}return c}function oaep_mgf1_str(f,i,j){var g="",k=0;while(g.length<i){g+=j(f+String.fromCharCode.apply(String,[(k&4278190080)>>24,(k&16711680)>>16,(k&65280)>>8,k&255]));k+=1}return g}function oaep_unpad(H,d,w,i){var A=Ext.crypto.MessageDigest;var u=Ext.crypto.Util;var B=null;if(!w){w="sha1"}if(typeof w==="string"){B=A.getCanonicalAlgName(w);i=A.getHashLength(B);w=function(b){return hextorstr(u.hashString(b,B))}}H=H.toByteArray();var y;for(y=0;y<H.length;y+=1){H[y]&=255}while(H.length<d){H.unshift(0)}H=String.fromCharCode.apply(String,H);if(H.length<2*i+2){throw"Cipher too short"}var n=H.substr(1,i);var C=H.substr(i+1);var D=oaep_mgf1_str(C,i,w);var x=[],y;for(y=0;y<n.length;y+=1){x[y]=n.charCodeAt(y)^D.charCodeAt(y)}var F=oaep_mgf1_str(String.fromCharCode.apply(String,x),H.length-i,w);var E=[];for(y=0;y<C.length;y+=1){E[y]=C.charCodeAt(y)^F.charCodeAt(y)}E=String.fromCharCode.apply(String,E);if(E.substr(0,i)!==w("")){throw"Hash mismatch"}E=E.substr(i);var G=E.indexOf("\x01");var v=(G!=-1)?E.substr(0,G).lastIndexOf("\x00"):-1;if(v+1!=G){throw"Malformed data"}return E.substr(G+1)}function RSASetPrivate(e,d,f){this.isPrivate=true;if(typeof e!=="string"){this.n=e;this.e=d;this.d=f}else{if(e!=null&&d!=null&&e.length>0&&d.length>0){this.n=parseBigInt(e,16);this.e=parseInt(d,16);this.d=parseBigInt(f,16)}else{alert("Invalid RSA private key")}}}function RSASetPrivateEx(i,m,l,k,j,p,o,n){this.isPrivate=true;this.isPublic=false;if(i==null){throw"RSASetPrivateEx N == null"}if(m==null){throw"RSASetPrivateEx E == null"}if(i.length==0){throw"RSASetPrivateEx N.length == 0"}if(m.length==0){throw"RSASetPrivateEx E.length == 0"}if(i!=null&&m!=null&&i.length>0&&m.length>0){this.n=parseBigInt(i,16);this.e=parseInt(m,16);this.d=parseBigInt(l,16);this.p=parseBigInt(k,16);this.q=parseBigInt(j,16);this.dmp1=parseBigInt(p,16);this.dmq1=parseBigInt(o,16);this.coeff=parseBigInt(n,16)}else{alert("Invalid RSA private key in RSASetPrivateEx")}}function RSAGenerate(m,o){var n=new SecureRandom();var r=m>>1;this.e=parseInt(o,16);var l=new BigInteger(o,16);for(;;){for(;;){this.p=new BigInteger(m-r,1,n);if(this.p.subtract(BigInteger.ONE).gcd(l).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(r,1,n);if(this.q.subtract(BigInteger.ONE).gcd(l).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var p=this.p;this.p=this.q;this.q=p}var q=this.p.subtract(BigInteger.ONE);var k=this.q.subtract(BigInteger.ONE);var j=q.multiply(k);if(j.gcd(l).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=l.modInverse(j);this.dmp1=this.d.mod(q);this.dmq1=this.d.mod(k);this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=true}function RSADoPrivate(d){if(this.p==null||this.q==null){return d.modPow(this.d,this.n)}var e=d.mod(this.p).modPow(this.dmp1,this.p);var f=d.mod(this.q).modPow(this.dmq1,this.q);while(e.compareTo(f)<0){e=e.add(this.p)}return e.subtract(f).multiply(this.coeff).mod(this.p).multiply(this.q).add(f)}function RSADecrypt(f){var e=parseBigInt(f,16);var c=this.doPrivate(e);if(c==null){return null}return pkcs1unpad2(c,(this.n.bitLength()+7)>>3)}function RSADecryptOAEP(k,c,g){var j=parseBigInt(k,16);var i=this.doPrivate(j);if(i==null){return null}return oaep_unpad(i,(this.n.bitLength()+7)>>3,c,g)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;function ECFieldElementFp(d,c){this.x=c;this.q=d}function feFpEquals(b){if(b==this){return true}return(this.q.equals(b.q)&&this.x.equals(b.x))}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(b){return new ECFieldElementFp(this.q,this.x.add(b.toBigInteger()).mod(this.q))}function feFpSubtract(b){return new ECFieldElementFp(this.q,this.x.subtract(b.toBigInteger()).mod(this.q))}function feFpMultiply(b){return new ECFieldElementFp(this.q,this.x.multiply(b.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(b){return new ECFieldElementFp(this.q,this.x.multiply(b.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(g,e,f,i){this.curve=g;this.x=e;this.y=f;if(i==null){this.z=BigInteger.ONE}else{this.z=i}this.zinv=null}function pointFpGetX(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(d){if(d==this){return true}if(this.isInfinity()){return d.isInfinity()}if(d.isInfinity()){return this.isInfinity()}var e,f;e=d.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(d.z)).mod(this.curve.q);if(!e.equals(BigInteger.ZERO)){return false}f=d.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(d.z)).mod(this.curve.q);return f.equals(BigInteger.ZERO)}function pointFpIsInfinity(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(x){if(this.isInfinity()){return x}if(x.isInfinity()){return this}var q=x.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(x.z)).mod(this.curve.q);var u=x.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(x.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(u)){if(BigInteger.ZERO.equals(q)){return this.twice()}return this.curve.getInfinity()}var B=new BigInteger("3");var E=this.x.toBigInteger();var b=this.y.toBigInteger();var C=x.x.toBigInteger();var A=x.y.toBigInteger();var y=u.square();var r=y.multiply(u);var v=E.multiply(y);var w=q.square().multiply(this.z);var D=w.subtract(v.shiftLeft(1)).multiply(x.z).subtract(r).multiply(u).mod(this.curve.q);var F=v.multiply(B).multiply(q).subtract(b.multiply(r)).subtract(w.multiply(q)).multiply(x.z).add(q.multiply(r)).mod(this.curve.q);var s=r.multiply(this.z).multiply(x.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(D),this.curve.fromBigInteger(F),s)}function pointFpTwice(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var r=new BigInteger("3");var l=this.x.toBigInteger();var q=this.y.toBigInteger();var u=q.multiply(this.z);var o=u.multiply(q).mod(this.curve.q);var p=this.curve.a.toBigInteger();var n=l.square().multiply(r);if(!BigInteger.ZERO.equals(p)){n=n.add(this.z.square().multiply(p))}n=n.mod(this.curve.q);var m=n.square().subtract(l.shiftLeft(3).multiply(o)).shiftLeft(1).multiply(u).mod(this.curve.q);var s=n.multiply(r).multiply(l).subtract(o.shiftLeft(1)).shiftLeft(2).multiply(o).subtract(n.square().multiply(n)).mod(this.curve.q);var v=u.square().multiply(u).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(m),this.curve.fromBigInteger(s),v)}function pointFpMultiply(k){if(this.isInfinity()){return this}if(k.signum()==0){return this.curve.getInfinity()}var n=k;var i=n.multiply(new BigInteger("3"));var q=this.negate();var p=this;var o;for(o=i.bitLength()-2;o>0;--o){p=p.twice();var m=i.testBit(o);var e=n.testBit(o);if(m!=e){p=p.add(m?this:q)}}return p}function pointFpMultiplyTwo(g,i,m){var l;if(g.bitLength()>m.bitLength()){l=g.bitLength()-1}else{l=m.bitLength()-1}var j=this.curve.getInfinity();var k=this.add(i);while(l>=0){j=j.twice();if(g.testBit(l)){if(m.testBit(l)){j=j.add(k)}else{j=j.add(this)}}else{if(m.testBit(l)){j=j.add(i)}}--l}return j}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(f,g,b){this.q=f;this.a=this.fromBigInteger(g);this.b=this.fromBigInteger(b);this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(b){if(b==this){return true}return(this.q.equals(b.q)&&this.a.equals(b.a)&&this.b.equals(b.b))}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(b){return new ECFieldElementFp(this.q,b)}function curveFpDecodePointHex(f){switch(parseInt(f.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(f.length-2)/2;var g=f.substr(2,e);var i=f.substr(e+2,e);return new ECPointFp(this,this.fromBigInteger(new BigInteger(g,16)),this.fromBigInteger(new BigInteger(i,16)));default:return null}}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ECPointFp.prototype.getEncoded=function(f){var k=function(c,b){var d=c.toByteArrayUnsigned();if(b<d.length){d=d.slice(d.length-b)}else{while(b>d.length){d.unshift(0)}}return d};var i=this.getX().toBigInteger();var j=this.getY().toBigInteger();var g=k(i,32);if(f){if(j.isEven()){g.unshift(2)}else{g.unshift(3)}}else{g.unshift(4);g=g.concat(k(j,32))}return g};ECPointFp.decodeFrom=function(i,m){var o=m[0];var k=m.length-1;var l=m.slice(1,1+k/2);var j=m.slice(1+k/2,1+k);l.unshift(0);j.unshift(0);var p=new BigInteger(l);var n=new BigInteger(j);return new ECPointFp(i,i.fromBigInteger(p),i.fromBigInteger(n))};ECPointFp.decodeFromHex=function(i,m){var o=m.substr(0,2);var k=m.length-2;var l=m.substr(2,k/2);var j=m.substr(2+k/2,k/2);var p=new BigInteger(l,16);var n=new BigInteger(j,16);return new ECPointFp(i,i.fromBigInteger(p),i.fromBigInteger(n))};ECPointFp.prototype.add2D=function(i){if(this.isInfinity()){return i}if(i.isInfinity()){return this}if(this.x.equals(i.x)){if(this.y.equals(i.y)){return this.twice()}return this.curve.getInfinity()}var k=i.x.subtract(this.x);var m=i.y.subtract(this.y);var j=m.divide(k);var b=j.square().subtract(this.x).subtract(i.x);var l=j.multiply(this.x.subtract(b)).subtract(this.y);return new ECPointFp(this.curve,b,l)};ECPointFp.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var g=this.curve.fromBigInteger(BigInteger.valueOf(2));var j=this.curve.fromBigInteger(BigInteger.valueOf(3));var i=this.x.square().multiply(j).add(this.curve.a).divide(this.y.multiply(g));var f=i.square().subtract(this.x.multiply(g));var k=i.multiply(this.x.subtract(f)).subtract(this.y);return new ECPointFp(this.curve,f,k)};ECPointFp.prototype.multiply2D=function(k){if(this.isInfinity()){return this}if(k.signum()==0){return this.curve.getInfinity()}var n=k;var i=n.multiply(new BigInteger("3"));var q=this.negate();var p=this;var o;for(o=i.bitLength()-2;o>0;--o){p=p.twice();var m=i.testBit(o);var e=n.testBit(o);if(m!=e){p=p.add2D(m?this:q)}}return p};ECPointFp.prototype.isOnCurve=function(){var m=this.getX().toBigInteger();var n=this.getY().toBigInteger();var l=this.curve.getA().toBigInteger();var b=this.curve.getB().toBigInteger();var j=this.curve.getQ();var o=n.multiply(n).mod(j);var k=m.multiply(m).multiply(m).add(l.multiply(m)).add(b).mod(j);return o.equals(k)};ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ECPointFp.prototype.validate=function(){var e=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var d=this.getX().toBigInteger();var f=this.getY().toBigInteger();if(d.compareTo(BigInteger.ONE)<0||d.compareTo(e.subtract(BigInteger.ONE))>0){throw new Error("x coordinate out of bounds")}if(f.compareTo(BigInteger.ONE)<0||f.compareTo(e.subtract(BigInteger.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(e).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var jsonParse=(function(){var v="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";var l='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';var p='(?:"'+l+'*")';var q=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+v+"|"+p+")","g");var n=new RegExp("\\\\(?:([^u])|u(.{4}))","g");var r={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function m(b,d,c){return d?r[d]:String.fromCharCode(parseInt(c,16))}var s=new String("");var w="\\";var o={"{":Object,"[":Array};var u=Object.hasOwnProperty;return function(f,c){var i=f.match(q);var k;var b=i[0];var y=false;if("{"===b){k={}}else{if("["===b){k=[]}else{k=[];y=true}}var e;var x=[k];for(var g=1-y,A=i.length;g<A;++g){b=i[g];var j;switch(b.charCodeAt(0)){default:j=x[0];j[e||j.length]=+(b);e=void 0;break;case 34:b=b.substring(1,b.length-1);if(b.indexOf(w)!==-1){b=b.replace(n,m)}j=x[0];if(!e){if(j instanceof Array){e=j.length}else{e=b||s;break}}j[e]=b;e=void 0;break;case 91:j=x[0];x.unshift(j[e||j.length]=[]);e=void 0;break;case 93:x.shift();break;case 102:j=x[0];j[e||j.length]=false;e=void 0;break;case 110:j=x[0];j[e||j.length]=null;e=void 0;break;case 116:j=x[0];j[e||j.length]=true;e=void 0;break;case 123:j=x[0];x.unshift(j[e||j.length]={});e=void 0;break;case 125:x.shift();break}}if(y){if(x.length!==1){throw new Error()}k=k[0]}else{if(x.length){throw new Error()}}if(c){var d=function(I,C){var B=I[C];if(B&&typeof B==="object"){var E=null;for(var H in B){if(u.call(B,H)&&B!==I){var F=d(B,H);if(F!==void 0){B[H]=F}else{if(!E){E=[]}E.push(H)}}}if(E){for(var G=E.length;--G>=0;){delete B[E[G]]}}}return c.call(I,C,B)};k=d({"":k},"")}return k}})();if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}Ext.asn1.ASN1Util=new function(){this.integerToByteHex=function(c){var d=c.toString(16);if((d.length%2)==1){d="0"+d}return d};this.bigIntToMinTwosComplementsHex=function(k){var m=k.toString(16);if(m.substr(0,1)!="-"){if(m.length%2==1){m="0"+m}else{if(!m.match(/^[0-7]/)){m="00"+m}}}else{var p=m.substr(1);var o=p.length;if(o%2==1){o+=1}else{if(!m.match(/^[0-7]/)){o+=2}}var i="";for(var n=0;n<o;n++){i+="f"}var l=new BigInteger(i,16);var q=l.xor(k).add(BigInteger.ONE);m=q.toString(16).replace(/^-/,"")}return m};this.getPEMStringFromHex=function(e,i){var g=hextob64(e);var f=g.replace(/(.{64})/g,"$1\r\n");f=f.replace(/\r\n$/,"");return"-----BEGIN "+i+"-----\r\n"+f+"\r\n-----END "+i+"-----\r\n"};this.newObject=function(i){var u=Ext.asn1;var x=Object.keys(i);if(x.length!=1){throw"key of param shall be only one."}var q=x[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+q+":")==-1){throw"undefined key: "+q}if(q=="bool"){return new u.DERBoolean(i[q])}if(q=="int"){return new u.DERInteger(i[q])}if(q=="bitstr"){return new u.DERBitString(i[q])}if(q=="octstr"){return new u.DEROctetString(i[q])}if(q=="null"){return new u.DERNull(i[q])}if(q=="oid"){return new u.DERObjectIdentifier(i[q])}if(q=="enum"){return new u.DEREnumerated(i[q])}if(q=="utf8str"){return new u.DERUTF8String(i[q])}if(q=="numstr"){return new u.DERNumericString(i[q])}if(q=="prnstr"){return new u.DERPrintableString(i[q])}if(q=="telstr"){return new u.DERTeletexString(i[q])}if(q=="ia5str"){return new u.DERIA5String(i[q])}if(q=="utctime"){return new u.DERUTCTime(i[q])}if(q=="gentime"){return new u.DERGeneralizedTime(i[q])}if(q=="seq"){var n=i[q];var r=[];for(var v=0;v<n.length;v++){var p=u.ASN1Util.newObject(n[v]);r.push(p)}return new u.DERSequence({array:r})}if(q=="set"){var n=i[q];var r=[];for(var v=0;v<n.length;v++){var p=u.ASN1Util.newObject(n[v]);r.push(p)}return new u.DERSet({array:r})}if(q=="tag"){var w=i[q];if(Object.prototype.toString.call(w)==="[object Array]"&&w.length==3){var s=u.ASN1Util.newObject(w[2]);return new u.DERTaggedObject({tag:w[0],explicit:w[1],obj:s})}else{var o={};if(w.explicit!==undefined){o.explicit=w.explicit}if(w.tag!==undefined){o.tag=w.tag}if(w.obj===undefined){throw"obj shall be specified for 'tag'."}o.obj=u.ASN1Util.newObject(w.obj);return new u.DERTaggedObject(o)}}};this.jsonToASN1HEX=function(d){var c=this.newObject(d);return c.getEncodedHex()}};Ext.asn1.ASN1Util.oidHexToInt=function(u){var l="";var i=parseInt(u.substr(0,2),16);var q=Math.floor(i/40);var r=i%40;var l=q+"."+r;var p="";for(var o=2;o<u.length;o+=2){var n=parseInt(u.substr(o,2),16);var m=("00000000"+n.toString(2)).slice(-8);p=p+m.substr(1,7);if(m.substr(0,1)=="0"){var s=new BigInteger(p,2);l=l+"."+s.toString(10);p=""}}return l};Ext.asn1.ASN1Util.oidIntToHex=function(o){var p=function(c){var b=c.toString(16);if(b.length==1){b="0"+b}return b};var i=function(d){var b="";var j=new BigInteger(d,10);var g=j.toString(2);var r=7-g.length%7;if(r==7){r=0}var e="";for(var c=0;c<r;c++){e+="0"}g=e+g;for(var c=0;c<g.length-1;c+=7){var f=g.substr(c,7);if(c!=g.length-7){f="1"+f}b+=p(parseInt(f,2))}return b};if(!o.match(/^[0-9.]+$/)){throw"malformed oid string: "+o}var n="";var l=o.split(".");var m=parseInt(l[0])*40+parseInt(l[1]);n+=p(m);l.splice(0,2);for(var k=0;k<l.length;k++){n+=i(l[k])}return n};Ext.asn1.ASN1Object=function(){var f=true;var g=null;var k="00";var j="00";var i="";this.getLengthHexFromValue=function(){if(typeof this.hV=="undefined"||this.hV==null){throw"this.hV is null or undefined."}if(this.hV.length%2==1){throw"value hex must be even length: n="+i.length+",v="+this.hV}var c=this.hV.length/2;var d=c.toString(16);if(d.length%2==1){d="0"+d}if(c<128){return d}else{var e=d.length/2;if(e>15){throw"ASN.1 length too long to represent by 8x: n = "+c.toString(16)}var b=128+e;return b.toString(16)+d}};this.getEncodedHex=function(){if(this.hTLV==null||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=false}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""}};Ext.asn1.DERAbstractString=function(e){Ext.asn1.DERAbstractString.superclass.constructor.call(this);var f=null;var d=null;this.getString=function(){return this.s};this.setString=function(b){this.hTLV=null;this.isModified=true;this.s=b;this.hV=stohex(this.s)};this.setStringHex=function(b){this.hTLV=null;this.isModified=true;this.s=null;this.hV=b};this.getFreshValueHex=function(){return this.hV};if(typeof e!="undefined"){if(typeof e=="string"){this.setString(e)}else{if(typeof e.str!="undefined"){this.setString(e.str)}else{if(typeof e.hex!="undefined"){this.setStringHex(e.hex)}}}}};YAHOO.lang.extend(Ext.asn1.DERAbstractString,Ext.asn1.ASN1Object);Ext.asn1.DERAbstractTime=function(e){Ext.asn1.DERAbstractTime.superclass.constructor.call(this);var f=null;var d=null;this.localDateToUTC=function(c){utc=c.getTime()+(c.getTimezoneOffset()*60000);var b=new Date(utc);return b};this.formatDate=function(c,y,x){var D=this.zeroPadding;var E=this.localDateToUTC(c);var b=String(E.getFullYear());if(y=="utc"){b=b.substr(2,2)}var g=D(String(E.getMonth()+1),2);var v=D(String(E.getDate()),2);var C=D(String(E.getHours()),2);var B=D(String(E.getMinutes()),2);var A=D(String(E.getSeconds()),2);var s=b+g+v+C+B+A;if(x===true){var w=E.getMilliseconds();if(w!=0){var u=D(String(w),3);u=u.replace(/[0]+$/,"");s=s+"."+u}}return s+"Z"};this.zeroPadding=function(c,b){if(c.length>=b){return c}return new Array(b-c.length+1).join("0")+c};this.getString=function(){return this.s};this.setString=function(b){this.hTLV=null;this.isModified=true;this.s=b;this.hV=stohex(b)};this.setByDateValue=function(l,g,b,k,c,n){var m=new Date(Date.UTC(l,g-1,b,k,c,n,0));this.setByDate(m)};this.getFreshValueHex=function(){return this.hV}};YAHOO.lang.extend(Ext.asn1.DERAbstractTime,Ext.asn1.ASN1Object);Ext.asn1.DERAbstractStructured=function(d){Ext.asn1.DERAbstractString.superclass.constructor.call(this);var c=null;this.setByASN1ObjectArray=function(b){this.hTLV=null;this.isModified=true;this.asn1Array=b};this.appendASN1Object=function(b){this.hTLV=null;this.isModified=true;this.asn1Array.push(b)};this.asn1Array=new Array();if(typeof d!="undefined"){if(typeof d.array!="undefined"){this.asn1Array=d.array}}};YAHOO.lang.extend(Ext.asn1.DERAbstractStructured,Ext.asn1.ASN1Object);Ext.asn1.DERBoolean=function(){Ext.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";this.hTLV="0101ff"};YAHOO.lang.extend(Ext.asn1.DERBoolean,Ext.asn1.ASN1Object);Ext.asn1.DERInteger=function(b){Ext.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(c){this.hTLV=null;this.isModified=true;this.hV=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(c)};this.setByInteger=function(c){var d=new BigInteger(String(c),10);this.setByBigInteger(d)};this.setValueHex=function(c){this.hV=c};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b.bigint!="undefined"){this.setByBigInteger(b.bigint)}else{if(typeof b["int"]!="undefined"){this.setByInteger(b["int"])}else{if(typeof b=="number"){this.setByInteger(b)}else{if(typeof b.hex!="undefined"){this.setValueHex(b.hex)}}}}}};YAHOO.lang.extend(Ext.asn1.DERInteger,Ext.asn1.ASN1Object);Ext.asn1.DERBitString=function(d){if(d!==undefined&&typeof d.obj!=="undefined"){var c=Ext.asn1.ASN1Util.newObject(d.obj);d.hex="00"+c.getEncodedHex()}Ext.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(b){this.hTLV=null;this.isModified=true;this.hV=b};this.setUnusedBitsAndHexValue=function(b,e){if(b<0||7<b){throw"unused bits shall be from 0 to 7: u = "+b}var f="0"+b;this.hTLV=null;this.isModified=true;this.hV=f+e};this.setByBinaryString=function(m){m=m.replace(/0+$/,"");var e=8-m.length%8;if(e==8){e=0}for(var k=0;k<=e;k++){m+="0"}var i="";for(var k=0;k<m.length-1;k+=8){var l=m.substr(k,8);var b=parseInt(l,2).toString(16);if(b.length==1){b="0"+b}i+=b}this.hTLV=null;this.isModified=true;this.hV="0"+e+i};this.setByBooleanArray=function(e){var f="";for(var b=0;b<e.length;b++){if(e[b]==true){f+="1"}else{f+="0"}}this.setByBinaryString(f)};this.newFalseArray=function(e){var b=new Array(e);for(var f=0;f<e;f++){b[f]=false}return b};this.getFreshValueHex=function(){return this.hV};if(typeof d!="undefined"){if(typeof d=="string"&&d.toLowerCase().match(/^[0-9a-f]+$/)){this.setHexValueIncludingUnusedBits(d)}else{if(typeof d.hex!="undefined"){this.setHexValueIncludingUnusedBits(d.hex)}else{if(typeof d.bin!="undefined"){this.setByBinaryString(d.bin)}else{if(typeof d.array!="undefined"){this.setByBooleanArray(d.array)}}}}}};YAHOO.lang.extend(Ext.asn1.DERBitString,Ext.asn1.ASN1Object);Ext.asn1.DEROctetString=function(d){if(d!==undefined&&typeof d.obj!=="undefined"){var c=Ext.asn1.ASN1Util.newObject(d.obj);d.hex=c.getEncodedHex()}Ext.asn1.DEROctetString.superclass.constructor.call(this,d);this.hT="04"};YAHOO.lang.extend(Ext.asn1.DEROctetString,Ext.asn1.DERAbstractString);Ext.asn1.DERNull=function(){Ext.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};YAHOO.lang.extend(Ext.asn1.DERNull,Ext.asn1.ASN1Object);Ext.asn1.DERObjectIdentifier=function(e){var f=function(b){var c=b.toString(16);if(c.length==1){c="0"+c}return c};var d=function(n){var c="";var o=new BigInteger(n,10);var q=o.toString(2);var b=7-q.length%7;if(b==7){b=0}var g="";for(var i=0;i<b;i++){g+="0"}q=g+q;for(var i=0;i<q.length-1;i+=7){var p=q.substr(i,7);if(i!=q.length-7){p="1"+p}c+=f(parseInt(p,2))}return c};Ext.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(b){this.hTLV=null;this.isModified=true;this.s=null;this.hV=b};this.setValueOidString=function(c){if(!c.match(/^[0-9.]+$/)){throw"malformed oid string: "+c}var b="";var i=c.split(".");var k=parseInt(i[0])*40+parseInt(i[1]);b+=f(k);i.splice(0,2);for(var g=0;g<i.length;g++){b+=d(i[g])}this.hTLV=null;this.isModified=true;this.s=null;this.hV=b};this.setValueName=function(c){var b=Ext.asn1.x509.OID.name2oid(c);if(b!==""){this.setValueOidString(b)}else{throw"DERObjectIdentifier oidName undefined: "+c}};this.getFreshValueHex=function(){return this.hV};if(e!==undefined){if(typeof e==="string"){if(e.match(/^[0-2].[0-9.]+$/)){this.setValueOidString(e)}else{this.setValueName(e)}}else{if(e.oid!==undefined){this.setValueOidString(e.oid)}else{if(e.hex!==undefined){this.setValueHex(e.hex)}else{if(e.name!==undefined){this.setValueName(e.name)}}}}}};YAHOO.lang.extend(Ext.asn1.DERObjectIdentifier,Ext.asn1.ASN1Object);Ext.asn1.DEREnumerated=function(b){Ext.asn1.DEREnumerated.superclass.constructor.call(this);this.hT="0a";this.setByBigInteger=function(c){this.hTLV=null;this.isModified=true;this.hV=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(c)};this.setByInteger=function(c){var d=new BigInteger(String(c),10);this.setByBigInteger(d)};this.setValueHex=function(c){this.hV=c};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b["int"]!="undefined"){this.setByInteger(b["int"])}else{if(typeof b=="number"){this.setByInteger(b)}else{if(typeof b.hex!="undefined"){this.setValueHex(b.hex)}}}}};YAHOO.lang.extend(Ext.asn1.DEREnumerated,Ext.asn1.ASN1Object);Ext.asn1.DERUTF8String=function(b){Ext.asn1.DERUTF8String.superclass.constructor.call(this,b);this.hT="0c"};YAHOO.lang.extend(Ext.asn1.DERUTF8String,Ext.asn1.DERAbstractString);Ext.asn1.DERNumericString=function(b){Ext.asn1.DERNumericString.superclass.constructor.call(this,b);this.hT="12"};YAHOO.lang.extend(Ext.asn1.DERNumericString,Ext.asn1.DERAbstractString);Ext.asn1.DERPrintableString=function(b){Ext.asn1.DERPrintableString.superclass.constructor.call(this,b);this.hT="13"};YAHOO.lang.extend(Ext.asn1.DERPrintableString,Ext.asn1.DERAbstractString);Ext.asn1.DERTeletexString=function(b){Ext.asn1.DERTeletexString.superclass.constructor.call(this,b);this.hT="14"};YAHOO.lang.extend(Ext.asn1.DERTeletexString,Ext.asn1.DERAbstractString);Ext.asn1.DERIA5String=function(b){Ext.asn1.DERIA5String.superclass.constructor.call(this,b);this.hT="16"};YAHOO.lang.extend(Ext.asn1.DERIA5String,Ext.asn1.DERAbstractString);Ext.asn1.DERUTCTime=function(b){Ext.asn1.DERUTCTime.superclass.constructor.call(this,b);this.hT="17";this.setByDate=function(c){this.hTLV=null;this.isModified=true;this.date=c;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(typeof this.date=="undefined"&&typeof this.s=="undefined"){this.date=new Date();this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)}return this.hV};if(b!==undefined){if(b.str!==undefined){this.setString(b.str)}else{if(typeof b=="string"&&b.match(/^[0-9]{12}Z$/)){this.setString(b)}else{if(b.hex!==undefined){this.setStringHex(b.hex)}else{if(b.date!==undefined){this.setByDate(b.date)}}}}}};YAHOO.lang.extend(Ext.asn1.DERUTCTime,Ext.asn1.DERAbstractTime);Ext.asn1.DERGeneralizedTime=function(b){Ext.asn1.DERGeneralizedTime.superclass.constructor.call(this,b);this.hT="18";this.withMillis=false;this.setByDate=function(c){this.hTLV=null;this.isModified=true;this.date=c;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(this.date===undefined&&this.s===undefined){this.date=new Date();this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)}return this.hV};if(b!==undefined){if(b.str!==undefined){this.setString(b.str)}else{if(typeof b=="string"&&b.match(/^[0-9]{14}Z$/)){this.setString(b)}else{if(b.hex!==undefined){this.setStringHex(b.hex)}else{if(b.date!==undefined){this.setByDate(b.date)}}}}if(b.millis===true){this.withMillis=true}}};YAHOO.lang.extend(Ext.asn1.DERGeneralizedTime,Ext.asn1.DERAbstractTime);Ext.asn1.DERSequence=function(b){Ext.asn1.DERSequence.superclass.constructor.call(this,b);this.hT="30";this.getFreshValueHex=function(){var e="";for(var f=0;f<this.asn1Array.length;f++){var c=this.asn1Array[f];e+=c.getEncodedHex()}this.hV=e;return this.hV}};YAHOO.lang.extend(Ext.asn1.DERSequence,Ext.asn1.DERAbstractStructured);Ext.asn1.DERSet=function(b){Ext.asn1.DERSet.superclass.constructor.call(this,b);this.hT="31";this.sortFlag=true;this.getFreshValueHex=function(){var f=new Array();for(var e=0;e<this.asn1Array.length;e++){var c=this.asn1Array[e];f.push(c.getEncodedHex())}if(this.sortFlag==true){f.sort()}this.hV=f.join("");return this.hV};if(typeof b!="undefined"){if(typeof b.sortflag!="undefined"&&b.sortflag==false){this.sortFlag=false}}};YAHOO.lang.extend(Ext.asn1.DERSet,Ext.asn1.DERAbstractStructured);Ext.asn1.DERTaggedObject=function(b){Ext.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=true;this.asn1Object=null;this.setASN1Object=function(f,e,c){this.hT=e;this.isExplicit=f;this.asn1Object=c;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=true}else{this.hV=null;this.hTLV=c.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,e);this.isModified=false}};this.getFreshValueHex=function(){return this.hV};if(typeof b!="undefined"){if(typeof b.tag!="undefined"){this.hT=b.tag}if(typeof b.explicit!="undefined"){this.isExplicit=b.explicit}if(typeof b.obj!="undefined"){this.asn1Object=b.obj;this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};YAHOO.lang.extend(Ext.asn1.DERTaggedObject,Ext.asn1.ASN1Object);var ASN1HEX=new function(){};ASN1HEX.getByteLengthOfL_AtObj=function(f,e){if(f.substring(e+2,e+3)!="8"){return 1}var d=parseInt(f.substring(e+3,e+4));if(d==0){return -1}if(0<d&&d<10){return d+1}return -2};ASN1HEX.getHexOfL_AtObj=function(f,e){var d=ASN1HEX.getByteLengthOfL_AtObj(f,e);if(d<1){return""}return f.substring(e+2,e+2+d*2)};ASN1HEX.getIntOfL_AtObj=function(g,f){var i=ASN1HEX.getHexOfL_AtObj(g,f);if(i==""){return -1}var e;if(parseInt(i.substring(0,1))<8){e=new BigInteger(i,16)}else{e=new BigInteger(i.substring(2),16)}return e.intValue()};ASN1HEX.getStartPosOfV_AtObj=function(f,e){var d=ASN1HEX.getByteLengthOfL_AtObj(f,e);if(d<0){return d}return e+(d+1)*2};ASN1HEX.getHexOfV_AtObj=function(g,f){var i=ASN1HEX.getStartPosOfV_AtObj(g,f);var e=ASN1HEX.getIntOfL_AtObj(g,f);return g.substring(i,i+e*2)};ASN1HEX.getHexOfTLV_AtObj=function(f,j){var g=f.substr(j,2);var k=ASN1HEX.getHexOfL_AtObj(f,j);var i=ASN1HEX.getHexOfV_AtObj(f,j);return g+k+i};ASN1HEX.getPosOfNextSibling_AtObj=function(g,f){var i=ASN1HEX.getStartPosOfV_AtObj(g,f);var e=ASN1HEX.getIntOfL_AtObj(g,f);return i+e*2};ASN1HEX.getPosArrayOfChildren_AtObj=function(q,n){var l=new Array();var o=ASN1HEX.getStartPosOfV_AtObj(q,n);if(q.substr(n,2)=="03"){l.push(o+2)}else{l.push(o)}var m=ASN1HEX.getIntOfL_AtObj(q,n);var p=o;var k=0;while(1){var r=ASN1HEX.getPosOfNextSibling_AtObj(q,p);if(r==null||(r-o>=(m*2))){break}if(k>=200){break}l.push(r);p=r;k++}return l};ASN1HEX.getNthChildIndex_AtObj=function(g,j,f){var i=ASN1HEX.getPosArrayOfChildren_AtObj(g,j);return i[f]};ASN1HEX.getDecendantIndexByNthList=function(k,l,g){if(g.length==0){return l}var j=g.shift();var i=ASN1HEX.getPosArrayOfChildren_AtObj(k,l);return ASN1HEX.getDecendantIndexByNthList(k,i[j],g)};ASN1HEX.getDecendantHexTLVByNthList=function(f,g,i){var e=ASN1HEX.getDecendantIndexByNthList(f,g,i);return ASN1HEX.getHexOfTLV_AtObj(f,e)};ASN1HEX.getDecendantHexVByNthList=function(f,g,i){var e=ASN1HEX.getDecendantIndexByNthList(f,g,i);return ASN1HEX.getHexOfV_AtObj(f,e)};ASN1HEX.getVbyList=function(k,f,g,j){var i=ASN1HEX.getDecendantIndexByNthList(k,f,g);if(i===undefined){throw"can't find nthList object"}if(j!==undefined){if(k.substr(i,2)!=j){throw"checking tag doesn't match: "+k.substr(i,2)+"!="+j}}return ASN1HEX.getHexOfV_AtObj(k,i)};ASN1HEX.hextooidstr=function(w){var s=function(e,d){if(e.length>=d){return e}return new Array(d-e.length+1).join("0")+e};var p=[];var b=w.substr(0,2);var v=parseInt(b,16);p[0]=new String(Math.floor(v/40));p[1]=new String(v%40);var i=w.substr(2);var q=[];for(var u=0;u<i.length/2;u++){q.push(parseInt(i.substr(u*2,2),16))}var r=[];var x="";for(var u=0;u<q.length;u++){if(q[u]&128){x=x+s((q[u]&127).toString(2),7)}else{x=x+s((q[u]&127).toString(2),7);r.push(new String(parseInt(x,2)));x=""}}var c=p.join(".");if(r.length>0){c=c+"."+r.join(".")}return c};ASN1HEX.dump=function(y,M,F,x){var K=y;if(y instanceof Ext.asn1.ASN1Object){K=y.getEncodedHex()}var I=function(c,d){if(c.length<=d*2){return c}else{var b=c.substr(0,d)+"..(total "+c.length/2+"bytes).."+c.substr(c.length-d,d);return b}};if(M===undefined){M={ommit_long_octet:32}}if(F===undefined){F=0}if(x===undefined){x=""}var v=M.ommit_long_octet;if(K.substr(F,2)=="01"){var H=ASN1HEX.getHexOfV_AtObj(K,F);if(H=="00"){return x+"BOOLEAN FALSE\n"}else{return x+"BOOLEAN TRUE\n"}}if(K.substr(F,2)=="02"){var H=ASN1HEX.getHexOfV_AtObj(K,F);return x+"INTEGER "+I(H,v)+"\n"}if(K.substr(F,2)=="03"){var H=ASN1HEX.getHexOfV_AtObj(K,F);return x+"BITSTRING "+I(H,v)+"\n"}if(K.substr(F,2)=="04"){var H=ASN1HEX.getHexOfV_AtObj(K,F);if(ASN1HEX.isASN1HEX(H)){var G=x+"OCTETSTRING, encapsulates\n";G=G+ASN1HEX.dump(H,M,0,x+"  ");return G}else{return x+"OCTETSTRING "+I(H,v)+"\n"}}if(K.substr(F,2)=="05"){return x+"NULL\n"}if(K.substr(F,2)=="06"){var E=ASN1HEX.getHexOfV_AtObj(K,F);var O=Ext.asn1.ASN1Util.oidHexToInt(E);var B=Ext.asn1.x509.OID.oid2name(O);var N=O.replace(/\./g," ");if(B!=""){return x+"ObjectIdentifier "+B+" ("+N+")\n"}else{return x+"ObjectIdentifier ("+N+")\n"}}if(K.substr(F,2)=="0c"){return x+"UTF8String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,F))+"'\n"}if(K.substr(F,2)=="13"){return x+"PrintableString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,F))+"'\n"}if(K.substr(F,2)=="14"){return x+"TeletexString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,F))+"'\n"}if(K.substr(F,2)=="16"){return x+"IA5String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,F))+"'\n"}if(K.substr(F,2)=="17"){return x+"UTCTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,F))+"\n"}if(K.substr(F,2)=="18"){return x+"GeneralizedTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(K,F))+"\n"}if(K.substr(F,2)=="30"){if(K.substr(F,4)=="3000"){return x+"SEQUENCE {}\n"}var G=x+"SEQUENCE\n";var L=ASN1HEX.getPosArrayOfChildren_AtObj(K,F);var J=M;if((L.length==2||L.length==3)&&K.substr(L[0],2)=="06"&&K.substr(L[L.length-1],2)=="04"){var D=ASN1HEX.getHexOfV_AtObj(K,L[0]);var O=Ext.asn1.ASN1Util.oidHexToInt(D);var B=Ext.asn1.x509.OID.oid2name(O);var s=JSON.parse(JSON.stringify(M));s.x509ExtName=B;J=s}for(var C=0;C<L.length;C++){G=G+ASN1HEX.dump(K,J,L[C],x+"  ")}return G}if(K.substr(F,2)=="31"){var G=x+"SET\n";var L=ASN1HEX.getPosArrayOfChildren_AtObj(K,F);for(var C=0;C<L.length;C++){G=G+ASN1HEX.dump(K,M,L[C],x+"  ")}return G}var i=parseInt(K.substr(F,2),16);if((i&128)!=0){var A=i&31;if((i&32)!=0){var G=x+"["+A+"]\n";var L=ASN1HEX.getPosArrayOfChildren_AtObj(K,F);for(var C=0;C<L.length;C++){G=G+ASN1HEX.dump(K,M,L[C],x+"  ")}return G}else{var H=ASN1HEX.getHexOfV_AtObj(K,F);if(H.substr(0,8)=="68747470"){H=hextoutf8(H)}if(M.x509ExtName==="subjectAltName"&&A==2){H=hextoutf8(H)}var G=x+"["+A+"] "+H+"\n";return G}}return x+"UNKNOWN("+K.substr(F,2)+") "+ASN1HEX.getHexOfV_AtObj(K,F)+"\n"};ASN1HEX.isASN1HEX=function(k){if(k.length%2==1){return false}var f=ASN1HEX.getIntOfL_AtObj(k,0);var g=k.substr(0,2);var j=ASN1HEX.getHexOfL_AtObj(k,0);var i=k.length-g.length-j.length;if(i==f*2){return true}return false};ASN1HEX.pemToHex=function(i,f){if(i.indexOf("-----BEGIN ")==-1){throw"can't find PEM header: "+f}if(f!==undefined){i=i.replace("-----BEGIN "+f+"-----","");i=i.replace("-----END "+f+"-----","")}else{i=i.replace(/-----BEGIN [^-]+-----/,"");i=i.replace(/-----END [^-]+-----/,"")}var g=i.replace(/\s+/g,"");var e=b64tohex(g);return e};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.x509=="undefined"||!Ext.asn1.x509){Ext.asn1.x509={}}Ext.asn1.x509.Certificate=function(i){Ext.asn1.x509.Certificate.superclass.constructor.call(this);var m=null;var k=null;var j=null;var n=null;var l=null;var o=null;this.setRsaPrvKeyByPEMandPass=function(e,c){var b=PKCS5PKEY.getDecryptedKeyHex(e,c);var d=new RSAKey();d.readPrivateKeyFromASN1HexString(b);this.prvKey=d};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;sig=new Ext.crypto.Signature({alg:"SHA1withRSA"});sig.init(this.prvKey);sig.updateHex(this.asn1TBSCert.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var b=new Ext.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.setSignatureHex=function(b){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;this.hexSig=b;this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var c=new Ext.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=c.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var d=this.getEncodedHex();var b=CryptoJS.enc.Hex.parse(d);var e=CryptoJS.enc.Base64.stringify(b);var c=e.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN CERTIFICATE-----\r\n"+c+"\r\n-----END CERTIFICATE-----\r\n"};if(typeof i!="undefined"){if(typeof i.tbscertobj!="undefined"){this.asn1TBSCert=i.tbscertobj}if(typeof i.prvkeyobj!="undefined"){this.prvKey=i.prvkeyobj}else{if(typeof i.rsaprvkey!="undefined"){this.prvKey=i.rsaprvkey}else{if((typeof i.rsaprvpem!="undefined")&&(typeof i.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(i.rsaprvpem,i.rsaprvpas)}}}}};YAHOO.lang.extend(Ext.asn1.x509.Certificate,Ext.asn1.ASN1Object);Ext.asn1.x509.TBSCertificate=function(b){Ext.asn1.x509.TBSCertificate.superclass.constructor.call(this);this._initialize=function(){this.asn1Array=new Array();this.asn1Version=new Ext.asn1.DERTaggedObject({obj:new Ext.asn1.DERInteger({"int":2})});this.asn1SerialNumber=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1NotBefore=null;this.asn1NotAfter=null;this.asn1Subject=null;this.asn1SubjPKey=null;this.extensionsArray=new Array()};this.setSerialNumberByParam=function(c){this.asn1SerialNumber=new Ext.asn1.DERInteger(c)};this.setSignatureAlgByParam=function(c){this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier(c)};this.setIssuerByParam=function(c){this.asn1Issuer=new Ext.asn1.x509.X500Name(c)};this.setNotBeforeByParam=function(c){this.asn1NotBefore=new Ext.asn1.x509.Time(c)};this.setNotAfterByParam=function(c){this.asn1NotAfter=new Ext.asn1.x509.Time(c)};this.setSubjectByParam=function(c){this.asn1Subject=new Ext.asn1.x509.X500Name(c)};this.setSubjectPublicKeyByParam=function(c){this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(c)};this.setSubjectPublicKeyByGetKey=function(c){var d=KEYUTIL.getKey(c);this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(d)};this.appendExtension=function(c){this.extensionsArray.push(c)};this.appendExtensionByName=function(c,d){Ext.asn1.x509.Extension.appendByNameToArray(c,d,this.extensionsArray)};this.getEncodedHex=function(){if(this.asn1NotBefore==null||this.asn1NotAfter==null){throw"notBefore and/or notAfter not set"}var g=new Ext.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});this.asn1Array=new Array();this.asn1Array.push(this.asn1Version);this.asn1Array.push(this.asn1SerialNumber);this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(g);this.asn1Array.push(this.asn1Subject);this.asn1Array.push(this.asn1SubjPKey);if(this.extensionsArray.length>0){var f=new Ext.asn1.DERSequence({array:this.extensionsArray});var i=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a3",obj:f});this.asn1Array.push(i)}var c=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=c.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize()};YAHOO.lang.extend(Ext.asn1.x509.TBSCertificate,Ext.asn1.ASN1Object);Ext.asn1.x509.Extension=function(d){Ext.asn1.x509.Extension.superclass.constructor.call(this);var c=null;this.getEncodedHex=function(){var e=new Ext.asn1.DERObjectIdentifier({oid:this.oid});var g=new Ext.asn1.DEROctetString({hex:this.getExtnValueHex()});var i=new Array();i.push(e);if(this.critical){i.push(new Ext.asn1.DERBoolean())}i.push(g);var b=new Ext.asn1.DERSequence({array:i});return b.getEncodedHex()};this.critical=false;if(typeof d!="undefined"){if(typeof d.critical!="undefined"){this.critical=d.critical}}};YAHOO.lang.extend(Ext.asn1.x509.Extension,Ext.asn1.ASN1Object);Ext.asn1.x509.Extension.appendByNameToArray=function(f,i,j){if(f.toLowerCase()=="basicconstraints"){var g=new Ext.asn1.x509.BasicConstraints(i);j.push(g)}else{if(f.toLowerCase()=="keyusage"){var g=new Ext.asn1.x509.KeyUsage(i);j.push(g)}else{if(f.toLowerCase()=="crldistributionpoints"){var g=new Ext.asn1.x509.CRLDistributionPoints(i);j.push(g)}else{if(f.toLowerCase()=="extkeyusage"){var g=new Ext.asn1.x509.ExtKeyUsage(i);j.push(g)}else{if(f.toLowerCase()=="authoritykeyidentifier"){var g=new Ext.asn1.x509.AuthorityKeyIdentifier(i);j.push(g)}else{if(f.toLowerCase()=="authorityinfoaccess"){var g=new Ext.asn1.x509.AuthorityInfoAccess(i);j.push(g)}else{if(f.toLowerCase()=="subjectaltname"){var g=new Ext.asn1.x509.SubjectAltName(i);j.push(g)}else{if(f.toLowerCase()=="issueraltname"){var g=new Ext.asn1.x509.IssuerAltName(i);j.push(g)}else{throw"unsupported extension name: "+f}}}}}}}}};Ext.asn1.x509.KeyUsage=function(b){Ext.asn1.x509.KeyUsage.superclass.constructor.call(this,b);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.15";if(typeof b!="undefined"){if(typeof b.bin!="undefined"){this.asn1ExtnValue=new Ext.asn1.DERBitString(b)}}};YAHOO.lang.extend(Ext.asn1.x509.KeyUsage,Ext.asn1.x509.Extension);Ext.asn1.x509.BasicConstraints=function(e){Ext.asn1.x509.BasicConstraints.superclass.constructor.call(this,e);var d=false;var f=-1;this.getExtnValueHex=function(){var c=new Array();if(this.cA){c.push(new Ext.asn1.DERBoolean())}if(this.pathLen>-1){c.push(new Ext.asn1.DERInteger({"int":this.pathLen}))}var b=new Ext.asn1.DERSequence({array:c});this.asn1ExtnValue=b;return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.19";this.cA=false;this.pathLen=-1;if(typeof e!="undefined"){if(typeof e.cA!="undefined"){this.cA=e.cA}if(typeof e.pathLen!="undefined"){this.pathLen=e.pathLen}}};YAHOO.lang.extend(Ext.asn1.x509.BasicConstraints,Ext.asn1.x509.Extension);Ext.asn1.x509.CRLDistributionPoints=function(b){Ext.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,b);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.setByDPArray=function(c){this.asn1ExtnValue=new Ext.asn1.DERSequence({array:c})};this.setByOneURI=function(c){var i=new Ext.asn1.x509.GeneralNames([{uri:c}]);var f=new Ext.asn1.x509.DistributionPointName(i);var g=new Ext.asn1.x509.DistributionPoint({dpobj:f});this.setByDPArray([g])};this.oid="2.5.29.31";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setByDPArray(b.array)}else{if(typeof b.uri!="undefined"){this.setByOneURI(b.uri)}}}};YAHOO.lang.extend(Ext.asn1.x509.CRLDistributionPoints,Ext.asn1.x509.Extension);Ext.asn1.x509.ExtKeyUsage=function(b){Ext.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,b);this.setPurposeArray=function(f){this.asn1ExtnValue=new Ext.asn1.DERSequence();for(var e=0;e<f.length;e++){var c=new Ext.asn1.DERObjectIdentifier(f[e]);this.asn1ExtnValue.appendASN1Object(c)}};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.37";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setPurposeArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.ExtKeyUsage,Ext.asn1.x509.Extension);Ext.asn1.x509.AuthorityKeyIdentifier=function(b){Ext.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,b);this.asn1KID=null;this.asn1CertIssuer=null;this.asn1CertSN=null;this.getExtnValueHex=function(){var c=new Array();if(this.asn1KID){c.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"80",obj:this.asn1KID}))}if(this.asn1CertIssuer){c.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"a1",obj:this.asn1CertIssuer}))}if(this.asn1CertSN){c.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"82",obj:this.asn1CertSN}))}var d=new Ext.asn1.DERSequence({array:c});this.asn1ExtnValue=d;return this.asn1ExtnValue.getEncodedHex()};this.setKIDByParam=function(c){this.asn1KID=new Ext.asn1.DEROctetString(c)};this.setCertIssuerByParam=function(c){this.asn1CertIssuer=new Ext.asn1.x509.X500Name(c)};this.setCertSNByParam=function(c){this.asn1CertSN=new Ext.asn1.DERInteger(c)};this.oid="2.5.29.35";if(typeof b!="undefined"){if(typeof b.kid!="undefined"){this.setKIDByParam(b.kid)}if(typeof b.issuer!="undefined"){this.setCertIssuerByParam(b.issuer)}if(typeof b.sn!="undefined"){this.setCertSNByParam(b.sn)}}};YAHOO.lang.extend(Ext.asn1.x509.AuthorityKeyIdentifier,Ext.asn1.x509.Extension);Ext.asn1.x509.AuthorityInfoAccess=function(b){Ext.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,b);this.setAccessDescriptionArray=function(m){var j=new Array();for(var i=0;i<m.length;i++){var l=new Ext.asn1.DERObjectIdentifier(m[i].accessMethod);var c=new Ext.asn1.x509.GeneralName(m[i].accessLocation);var k=new Ext.asn1.DERSequence({array:[l,c]});j.push(k)}this.asn1ExtnValue=new Ext.asn1.DERSequence({array:j})};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="1.3.6.1.5.5.7.1.1";if(typeof b!="undefined"){if(typeof b.array!="undefined"){this.setAccessDescriptionArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.AuthorityInfoAccess,Ext.asn1.x509.Extension);Ext.asn1.x509.SubjectAltName=function(b){Ext.asn1.x509.SubjectAltName.superclass.constructor.call(this,b);this.setNameArray=function(c){this.asn1ExtnValue=new Ext.asn1.x509.GeneralNames(c)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.17";if(b!==undefined){if(b.array!==undefined){this.setNameArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.SubjectAltName,Ext.asn1.x509.Extension);Ext.asn1.x509.IssuerAltName=function(b){Ext.asn1.x509.IssuerAltName.superclass.constructor.call(this,b);this.setNameArray=function(c){this.asn1ExtnValue=new Ext.asn1.x509.GeneralNames(c)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.18";if(b!==undefined){if(b.array!==undefined){this.setNameArray(b.array)}}};YAHOO.lang.extend(Ext.asn1.x509.IssuerAltName,Ext.asn1.x509.Extension);Ext.asn1.x509.CRL=function(j){Ext.asn1.x509.CRL.superclass.constructor.call(this);var i=null;var g=null;var k=null;var m=null;var l=null;this.setRsaPrvKeyByPEMandPass=function(e,c){var b=PKCS5PKEY.getDecryptedKeyHex(e,c);var d=new RSAKey();d.readPrivateKeyFromASN1HexString(b);this.rsaPrvKey=d};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg;sig=new Ext.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"});sig.initSign(this.rsaPrvKey);sig.updateHex(this.asn1TBSCertList.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var b=new Ext.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var d=this.getEncodedHex();var b=CryptoJS.enc.Hex.parse(d);var e=CryptoJS.enc.Base64.stringify(b);var c=e.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN X509 CRL-----\r\n"+c+"\r\n-----END X509 CRL-----\r\n"};if(typeof j!="undefined"){if(typeof j.tbsobj!="undefined"){this.asn1TBSCertList=j.tbsobj}if(typeof j.rsaprvkey!="undefined"){this.rsaPrvKey=j.rsaprvkey}if((typeof j.rsaprvpem!="undefined")&&(typeof j.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(j.rsaprvpem,j.rsaprvpas)}}};YAHOO.lang.extend(Ext.asn1.x509.CRL,Ext.asn1.ASN1Object);Ext.asn1.x509.TBSCertList=function(d){Ext.asn1.x509.TBSCertList.superclass.constructor.call(this);var c=null;this.setSignatureAlgByParam=function(b){this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier(b)};this.setIssuerByParam=function(b){this.asn1Issuer=new Ext.asn1.x509.X500Name(b)};this.setThisUpdateByParam=function(b){this.asn1ThisUpdate=new Ext.asn1.x509.Time(b)};this.setNextUpdateByParam=function(b){this.asn1NextUpdate=new Ext.asn1.x509.Time(b)};this.addRevokedCert=function(b,i){var e={};if(b!=undefined&&b!=null){e.sn=b}if(i!=undefined&&i!=null){e.time=i}var g=new Ext.asn1.x509.CRLEntry(e);this.aRevokedCert.push(g)};this.getEncodedHex=function(){this.asn1Array=new Array();if(this.asn1Version!=null){this.asn1Array.push(this.asn1Version)}this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(this.asn1ThisUpdate);if(this.asn1NextUpdate!=null){this.asn1Array.push(this.asn1NextUpdate)}if(this.aRevokedCert.length>0){var b=new Ext.asn1.DERSequence({array:this.aRevokedCert});this.asn1Array.push(b)}var e=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=e.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize=function(){this.asn1Version=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1ThisUpdate=null;this.asn1NextUpdate=null;this.aRevokedCert=new Array()};this._initialize()};YAHOO.lang.extend(Ext.asn1.x509.TBSCertList,Ext.asn1.ASN1Object);Ext.asn1.x509.CRLEntry=function(e){Ext.asn1.x509.CRLEntry.superclass.constructor.call(this);var f=null;var d=null;this.setCertSerial=function(b){this.sn=new Ext.asn1.DERInteger(b)};this.setRevocationDate=function(b){this.time=new Ext.asn1.x509.Time(b)};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:[this.sn,this.time]});this.TLV=b.getEncodedHex();return this.TLV};if(typeof e!="undefined"){if(typeof e.time!="undefined"){this.setRevocationDate(e.time)}if(typeof e.sn!="undefined"){this.setCertSerial(e.sn)}}};YAHOO.lang.extend(Ext.asn1.x509.CRLEntry,Ext.asn1.ASN1Object);Ext.asn1.x509.X500Name=function(d){Ext.asn1.x509.X500Name.superclass.constructor.call(this);this.asn1Array=new Array();this.setByString=function(b){var f=b.split("/");f.shift();for(var e=0;e<f.length;e++){this.asn1Array.push(new Ext.asn1.x509.RDN({str:f[e]}))}};this.setByLdapString=function(b){var e=Ext.asn1.x509.X500Name.ldapToOneline(b);this.setByString(e)};this.setByObject=function(e){for(var b in e){if(e.hasOwnProperty(b)){var f=new Ext.asn1.x509.RDN({str:b+"="+e[b]});this.asn1Array?this.asn1Array.push(f):this.asn1Array=[f]}}};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var b=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=b.getEncodedHex();return this.hTLV};if(d!==undefined){if(d.str!==undefined){this.setByString(d.str)}else{if(d.ldapstr!==undefined){this.setByLdapString(d.ldapstr)}else{if(typeof d==="object"){this.setByObject(d)}}}if(d.certissuer!==undefined){var c=new X509();c.hex=ASN1HEX.pemToHex(d.certissuer);this.hTLV=c.getIssuerHex()}if(d.certsubject!==undefined){var c=new X509();c.hex=ASN1HEX.pemToHex(d.certsubject);this.hTLV=c.getSubjectHex()}}};YAHOO.lang.extend(Ext.asn1.x509.X500Name,Ext.asn1.ASN1Object);Ext.asn1.x509.X500Name.onelineToLDAP=function(e){if(e.substr(0,1)!=="/"){throw"malformed input"}var g="";e=e.substr(1);var f=e.split("/");f.reverse();f=f.map(function(b){return b.replace(/,/,"\\,")});return f.join(",")};Ext.asn1.x509.X500Name.ldapToOneline=function(i){var p=i.split(",");var k=false;var o=[];for(var m=0;p.length>0;m++){var n=p.shift();if(k===true){var q=o.pop();var l=(q+","+n).replace(/\\,/g,",");o.push(l);k=false}else{o.push(n)}if(n.substr(-1,1)==="\\"){k=true}}o=o.map(function(b){return b.replace("/","\\/")});o.reverse();return"/"+o.join("/")};Ext.asn1.x509.RDN=function(b){Ext.asn1.x509.RDN.superclass.constructor.call(this);this.asn1Array=new Array();this.addByString=function(c){this.asn1Array.push(new Ext.asn1.x509.AttributeTypeAndValue({str:c}))};this.addByMultiValuedString=function(c){var f=Ext.asn1.x509.RDN.parseString(c);for(var e=0;e<f.length;e++){this.addByString(f[e])}};this.getEncodedHex=function(){var c=new Ext.asn1.DERSet({array:this.asn1Array});this.TLV=c.getEncodedHex();return this.TLV};if(typeof b!="undefined"){if(typeof b.str!="undefined"){this.addByMultiValuedString(b.str)}}};YAHOO.lang.extend(Ext.asn1.x509.RDN,Ext.asn1.ASN1Object);Ext.asn1.x509.RDN.parseString=function(n){var q=n.split(/\+/);var r=false;var v=[];for(var u=0;q.length>0;u++){var p=q.shift();if(r===true){var o=v.pop();var x=(o+"+"+p).replace(/\\\+/g,"+");v.push(x);r=false}else{v.push(p)}if(p.substr(-1,1)==="\\"){r=true}}var i=false;var w=[];for(var u=0;v.length>0;u++){var p=v.shift();if(i===true){var s=w.pop();if(p.match(/"$/)){var x=(s+"+"+p).replace(/^([^=]+)="(.*)"$/,"$1=$2");w.push(x);i=false}else{w.push(s+"+"+p)}}else{w.push(p)}if(p.match(/^[^=]+="/)){i=true}}return w};Ext.asn1.x509.AttributeTypeAndValue=function(i){Ext.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var f=null;var g=null;var e="utf8";this.setByString=function(c){var b=c.match(/^([^=]+)=(.+)$/);if(b){this.setByAttrTypeAndValueStr(b[1],b[2])}else{throw"malformed attrTypeAndValueStr: "+c}};this.setByAttrTypeAndValueStr=function(c,d){this.typeObj=Ext.asn1.x509.OID.atype2obj(c);var b=e;if(c=="C"){b="prn"}this.valueObj=this.getValueObj(b,d)};this.getValueObj=function(c,b){if(c=="utf8"){return new Ext.asn1.DERUTF8String({str:b})}if(c=="prn"){return new Ext.asn1.DERPrintableString({str:b})}if(c=="tel"){return new Ext.asn1.DERTeletexString({str:b})}if(c=="ia5"){return new Ext.asn1.DERIA5String({str:b})}throw"unsupported directory string type: type="+c+" value="+b};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:[this.typeObj,this.valueObj]});this.TLV=b.getEncodedHex();return this.TLV};if(typeof i!="undefined"){if(typeof i.str!="undefined"){this.setByString(i.str)}}};YAHOO.lang.extend(Ext.asn1.x509.AttributeTypeAndValue,Ext.asn1.ASN1Object);Ext.asn1.x509.SubjectPublicKeyInfo=function(f){Ext.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var i=null;var g=null;var e=null;this.setRSAKey=function(j){if(!RSAKey.prototype.isPrototypeOf(j)){throw"argument is not RSAKey instance"}this.rsaKey=j;var c=new Ext.asn1.DERInteger({bigint:j.n});var d=new Ext.asn1.DERInteger({"int":j.e});var k=new Ext.asn1.DERSequence({array:[c,d]});var b=k.getEncodedHex();this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+b})};this.setRSAPEM=function(s){if(s.match(/-----BEGIN PUBLIC KEY-----/)){var c=s;c=c.replace(/^-----[^-]+-----/,"");c=c.replace(/-----[^-]+-----\s*$/,"");var d=c.replace(/\s+/g,"");var u=CryptoJS.enc.Base64.parse(d);var q=CryptoJS.enc.Hex.stringify(u);var o=RSAKey.getHexValueArrayOfChildrenFromHex(q);var r=o[1];var j=r.substr(2);var b=RSAKey.getHexValueArrayOfChildrenFromHex(j);var p=new RSAKey();p.setPublic(b[0],b[1]);this.setRSAKey(p)}else{throw"key not supported"}};this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null){throw"algId and/or subjPubKey not set"}var b=new Ext.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]});return b};this.getEncodedHex=function(){var b=this.getASN1Object();this.hTLV=b.getEncodedHex();return this.hTLV};this._setRSAKey=function(b){var c=Ext.asn1.ASN1Util.newObject({seq:[{"int":{bigint:b.n}},{"int":{"int":b.e}}]});var d=c.getEncodedHex();this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+d})};this._setEC=function(b){var c=new Ext.asn1.DERObjectIdentifier({name:b.curveName});this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"ecPublicKey",asn1params:c});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+b.pubKeyHex})};this._setDSA=function(b){var d=new Ext.asn1.ASN1Util.newObject({seq:[{"int":{bigint:b.p}},{"int":{bigint:b.q}},{"int":{bigint:b.g}}]});this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"dsa",asn1params:d});var c=new Ext.asn1.DERInteger({bigint:b.y});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+c.getEncodedHex()})};if(typeof f!="undefined"){if(typeof RSAKey!="undefined"&&f instanceof RSAKey){this._setRSAKey(f)}else{if(typeof Ext.crypto.ECDSA!="undefined"&&f instanceof Ext.crypto.ECDSA){this._setEC(f)}else{if(typeof Ext.crypto.DSA!="undefined"&&f instanceof Ext.crypto.DSA){this._setDSA(f)}else{if(typeof f.rsakey!="undefined"){this.setRSAKey(f.rsakey)}else{if(typeof f.rsapem!="undefined"){this.setRSAPEM(f.rsapem)}}}}}}};YAHOO.lang.extend(Ext.asn1.x509.SubjectPublicKeyInfo,Ext.asn1.ASN1Object);Ext.asn1.x509.Time=function(e){Ext.asn1.x509.Time.superclass.constructor.call(this);var f=null;var d=null;this.setTimeParams=function(b){this.timeParams=b};this.getEncodedHex=function(){var b=null;if(this.timeParams!=null){if(this.type=="utc"){b=new Ext.asn1.DERUTCTime(this.timeParams)}else{b=new Ext.asn1.DERGeneralizedTime(this.timeParams)}}else{if(this.type=="utc"){b=new Ext.asn1.DERUTCTime()}else{b=new Ext.asn1.DERGeneralizedTime()}}this.TLV=b.getEncodedHex();return this.TLV};this.type="utc";if(typeof e!="undefined"){if(typeof e.type!="undefined"){this.type=e.type}else{if(typeof e.str!="undefined"){if(e.str.match(/^[0-9]{12}Z$/)){this.type="utc"}if(e.str.match(/^[0-9]{14}Z$/)){this.type="gen"}}}this.timeParams=e}};YAHOO.lang.extend(Ext.asn1.x509.Time,Ext.asn1.ASN1Object);Ext.asn1.x509.AlgorithmIdentifier=function(j){Ext.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);var i=null;var k=null;var g=null;var f=false;this.getEncodedHex=function(){if(this.nameAlg==null&&this.asn1Alg==null){throw"algorithm not specified"}if(this.nameAlg!=null&&this.asn1Alg==null){this.asn1Alg=Ext.asn1.x509.OID.name2obj(this.nameAlg)}var b=[this.asn1Alg];if(!this.paramEmpty){b.push(this.asn1Params)}var c=new Ext.asn1.DERSequence({array:b});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof j!="undefined"){if(typeof j.name!="undefined"){this.nameAlg=j.name}if(typeof j.asn1params!="undefined"){this.asn1Params=j.asn1params}if(typeof j.paramempty!="undefined"){this.paramEmpty=j.paramempty}}if(this.asn1Params==null){this.asn1Params=new Ext.asn1.DERNull()}};YAHOO.lang.extend(Ext.asn1.x509.AlgorithmIdentifier,Ext.asn1.ASN1Object);Ext.asn1.x509.GeneralName=function(f){Ext.asn1.x509.GeneralName.superclass.constructor.call(this);var g=null;var i=null;var e={rfc822:"81",dns:"82",dn:"a4",uri:"86"};this.explicit=false;this.setByParam=function(c){var j=null;var m=null;if(c===undefined){return}if(c.rfc822!==undefined){this.type="rfc822";m=new Ext.asn1.DERIA5String({str:c[this.type]})}if(c.dns!==undefined){this.type="dns";m=new Ext.asn1.DERIA5String({str:c[this.type]})}if(c.uri!==undefined){this.type="uri";m=new Ext.asn1.DERIA5String({str:c[this.type]})}if(c.dn!==undefined){this.type="dn";m=new Ext.asn1.x509.X500Name({str:c.dn})}if(c.ldapdn!==undefined){this.type="dn";m=new Ext.asn1.x509.X500Name({ldapstr:c.ldapdn})}if(c.certissuer!==undefined){this.type="dn";this.explicit=true;var b=c.certissuer;var d=null;if(b.match(/^[0-9A-Fa-f]+$/)){d==b}if(b.indexOf("-----BEGIN ")!=-1){d=ASN1HEX.pemToHex(b)}if(d==null){throw"certissuer param not cert"}var l=new X509();l.hex=d;var n=l.getIssuerHex();m=new Ext.asn1.ASN1Object();m.hTLV=n}if(c.certsubj!==undefined){this.type="dn";this.explicit=true;var b=c.certsubj;var d=null;if(b.match(/^[0-9A-Fa-f]+$/)){d==b}if(b.indexOf("-----BEGIN ")!=-1){d=ASN1HEX.pemToHex(b)}if(d==null){throw"certsubj param not cert"}var l=new X509();l.hex=d;var n=l.getSubjectHex();m=new Ext.asn1.ASN1Object();m.hTLV=n}if(this.type==null){throw"unsupported type in params="+c}this.asn1Obj=new Ext.asn1.DERTaggedObject({explicit:this.explicit,tag:e[this.type],obj:m})};this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()};if(f!==undefined){this.setByParam(f)}};YAHOO.lang.extend(Ext.asn1.x509.GeneralName,Ext.asn1.ASN1Object);Ext.asn1.x509.GeneralNames=function(d){Ext.asn1.x509.GeneralNames.superclass.constructor.call(this);var c=null;this.setByParamArray=function(e){for(var b=0;b<e.length;b++){var f=new Ext.asn1.x509.GeneralName(e[b]);this.asn1Array.push(f)}};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:this.asn1Array});return b.getEncodedHex()};this.asn1Array=new Array();if(typeof d!="undefined"){this.setByParamArray(d)}};YAHOO.lang.extend(Ext.asn1.x509.GeneralNames,Ext.asn1.ASN1Object);Ext.asn1.x509.DistributionPointName=function(g){Ext.asn1.x509.DistributionPointName.superclass.constructor.call(this);var j=null;var f=null;var i=null;var k=null;this.getEncodedHex=function(){if(this.type!="full"){throw"currently type shall be 'full': "+this.type}this.asn1Obj=new Ext.asn1.DERTaggedObject({explicit:false,tag:this.tag,obj:this.asn1V});this.hTLV=this.asn1Obj.getEncodedHex();return this.hTLV};if(typeof g!="undefined"){if(Ext.asn1.x509.GeneralNames.prototype.isPrototypeOf(g)){this.type="full";this.tag="a0";this.asn1V=g}else{throw"This class supports GeneralNames only as argument"}}};YAHOO.lang.extend(Ext.asn1.x509.DistributionPointName,Ext.asn1.ASN1Object);Ext.asn1.x509.DistributionPoint=function(d){Ext.asn1.x509.DistributionPoint.superclass.constructor.call(this);var c=null;this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence();if(this.asn1DP!=null){var e=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:this.asn1DP});b.appendASN1Object(e)}this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof d!="undefined"){if(typeof d.dpobj!="undefined"){this.asn1DP=d.dpobj}}};YAHOO.lang.extend(Ext.asn1.x509.DistributionPoint,Ext.asn1.ASN1Object);Ext.asn1.x509.OID=new function(b){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"};this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",countryName:"2.5.4.6",streetAddress:"2.5.4.9",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14",};this.objCache={};this.name2obj=function(f){if(typeof this.objCache[f]!="undefined"){return this.objCache[f]}if(typeof this.name2oidList[f]=="undefined"){throw"Name of ObjectIdentifier not defined: "+f}var e=this.name2oidList[f];var c=new Ext.asn1.DERObjectIdentifier({oid:e});this.objCache[f]=c;return c};this.atype2obj=function(f){if(typeof this.objCache[f]!="undefined"){return this.objCache[f]}if(typeof this.atype2oidList[f]=="undefined"){throw"AttributeType name undefined: "+f}var e=this.atype2oidList[f];var c=new Ext.asn1.DERObjectIdentifier({oid:e});this.objCache[f]=c;return c}};Ext.asn1.x509.OID.oid2name=function(f){var e=Ext.asn1.x509.OID.name2oidList;for(var d in e){if(e[d]==f){return d}}return""};Ext.asn1.x509.OID.oid2atype=function(f){var e=Ext.asn1.x509.OID.atype2oidList;for(var d in e){if(e[d]==f){return d}}return f};Ext.asn1.x509.OID.name2oid=function(c){var d=Ext.asn1.x509.OID.name2oidList;if(d[c]===undefined){return""}return d[c]};Ext.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=function(w){var x=null;var m=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(w.n);var v=Ext.asn1.ASN1Util.integerToByteHex(w.e);var r=new Ext.asn1.DERInteger({hex:m});var y=new Ext.asn1.DERInteger({hex:v});var s=new Ext.asn1.DERSequence({array:[r,y]});var p=s.getEncodedHex();var o=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});var q=new Ext.asn1.DERBitString({hex:"00"+p});var u=new Ext.asn1.DERSequence({array:[o,q]});var n=u.getEncodedHex();var x=Ext.asn1.ASN1Util.getPEMStringFromHex(n,"PUBLIC KEY");return x}};Ext.asn1.x509.X509Util.newCertPEM=function(j){var g=Ext.asn1.x509;var k=new g.TBSCertificate();if(j.serial!==undefined){k.setSerialNumberByParam(j.serial)}else{throw"serial number undefined."}if(typeof j.sigalg.name=="string"){k.setSignatureAlgByParam(j.sigalg)}else{throw"unproper signature algorithm name"}if(j.issuer!==undefined){k.setIssuerByParam(j.issuer)}else{throw"issuer name undefined."}if(j.notbefore!==undefined){k.setNotBeforeByParam(j.notbefore)}else{throw"notbefore undefined."}if(j.notafter!==undefined){k.setNotAfterByParam(j.notafter)}else{throw"notafter undefined."}if(j.subject!==undefined){k.setSubjectByParam(j.subject)}else{throw"subject name undefined."}if(j.sbjpubkey!==undefined){k.setSubjectPublicKeyByGetKey(j.sbjpubkey)}else{throw"subject public key undefined."}if(j.ext!==undefined&&j.ext.length!==undefined){for(var m=0;m<j.ext.length;m++){for(key in j.ext[m]){k.appendExtensionByName(key,j.ext[m][key])}}}if(j.cakey===undefined&&j.sighex===undefined){throw"param cakey and sighex undefined."}var l=null;var i=null;if(j.cakey){l=KEYUTIL.getKey.apply(null,j.cakey);i=new g.Certificate({tbscertobj:k,prvkeyobj:l});i.sign()}if(j.sighex){i=new g.Certificate({tbscertobj:k});i.setSignatureHex(j.sighex)}return i.getPEMString()};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.cms=="undefined"||!Ext.asn1.cms){Ext.asn1.cms={}}Ext.asn1.cms.Attribute=function(d){Ext.asn1.cms.Attribute.superclass.constructor.call(this);var c=[];this.getEncodedHex=function(){var e,g,b;e=new Ext.asn1.DERObjectIdentifier({oid:this.attrTypeOid});g=new Ext.asn1.DERSet({array:this.valueList});try{g.getEncodedHex()}catch(i){throw"fail valueSet.getEncodedHex in Attribute(1)/"+i}b=new Ext.asn1.DERSequence({array:[e,g]});try{this.hTLV=b.getEncodedHex()}catch(i){throw"failed seq.getEncodedHex in Attribute(2)/"+i}return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.Attribute,Ext.asn1.ASN1Object);Ext.asn1.cms.ContentType=function(d){Ext.asn1.cms.ContentType.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.3";var c=null;if(typeof d!="undefined"){var c=new Ext.asn1.DERObjectIdentifier(d);this.valueList=[c]}};YAHOO.lang.extend(Ext.asn1.cms.ContentType,Ext.asn1.cms.Attribute);Ext.asn1.cms.MessageDigest=function(j){Ext.asn1.cms.MessageDigest.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.4";if(typeof j!="undefined"){if(j.eciObj instanceof Ext.asn1.cms.EncapsulatedContentInfo&&typeof j.hashAlg=="string"){var g=j.eciObj.eContentValueHex;var i=j.hashAlg;var f=Ext.crypto.Util.hashHex(g,i);var k=new Ext.asn1.DEROctetString({hex:f});k.getEncodedHex();this.valueList=[k]}else{var k=new Ext.asn1.DEROctetString(j);k.getEncodedHex();this.valueList=[k]}}};YAHOO.lang.extend(Ext.asn1.cms.MessageDigest,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningTime=function(e){Ext.asn1.cms.SigningTime.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.5";if(typeof e!="undefined"){var d=new Ext.asn1.x509.Time(e);try{d.getEncodedHex()}catch(f){throw"SigningTime.getEncodedHex() failed/"+f}this.valueList=[d]}};YAHOO.lang.extend(Ext.asn1.cms.SigningTime,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningCertificate=function(f){Ext.asn1.cms.SigningCertificate.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.12";var e=Ext.asn1;var g=Ext.asn1.cms;var i=Ext.crypto;this.setCerts=function(j){var p=[];for(var q=0;q<j.length;q++){var s=ASN1HEX.pemToHex(j[q]);var b=i.Util.hashHex(s,"sha1");var d=new e.DEROctetString({hex:b});d.getEncodedHex();var o=new g.IssuerAndSerialNumber({cert:j[q]});o.getEncodedHex();var c=new e.DERSequence({array:[d,o]});c.getEncodedHex();p.push(c)}var r=new e.DERSequence({array:p});r.getEncodedHex();this.valueList=[r]};if(typeof f!="undefined"){if(typeof f.array=="object"){this.setCerts(f.array)}}};YAHOO.lang.extend(Ext.asn1.cms.SigningCertificate,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningCertificateV2=function(k){Ext.asn1.cms.SigningCertificateV2.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.47";var m=Ext.asn1;var j=Ext.asn1.x509;var g=Ext.asn1.cms;var l=Ext.crypto;this.setCerts=function(f,b){var s=[];for(var u=0;u<f.length;u++){var w=ASN1HEX.pemToHex(f[u]);var c=[];if(b!="sha256"){c.push(new j.AlgorithmIdentifier({name:b}))}var d=l.Util.hashHex(w,b);var e=new m.DEROctetString({hex:d});e.getEncodedHex();c.push(e);var x=new g.IssuerAndSerialNumber({cert:f[u]});x.getEncodedHex();c.push(x);var n=new m.DERSequence({array:c});n.getEncodedHex();s.push(n)}var v=new m.DERSequence({array:s});v.getEncodedHex();this.valueList=[v]};if(typeof k!="undefined"){if(typeof k.array=="object"){var i="sha256";if(typeof k.hashAlg=="string"){i=k.hashAlg}this.setCerts(k.array,i)}}};YAHOO.lang.extend(Ext.asn1.cms.SigningCertificateV2,Ext.asn1.cms.Attribute);Ext.asn1.cms.IssuerAndSerialNumber=function(f){Ext.asn1.cms.IssuerAndSerialNumber.superclass.constructor.call(this);var j=null;var g=null;var i=Ext.asn1;var k=i.x509;this.setByCertPEM=function(b){var d=ASN1HEX.pemToHex(b);var e=new X509();e.hex=d;var l=e.getIssuerHex();this.dIssuer=new k.X500Name();this.dIssuer.hTLV=l;var c=e.getSerialNumberHex();this.dSerial=new i.DERInteger({hex:c})};this.getEncodedHex=function(){var b=new Ext.asn1.DERSequence({array:[this.dIssuer,this.dSerial]});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f=="string"&&f.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(f)}if(f.issuer&&f.serial){if(f.issuer instanceof Ext.asn1.x509.X500Name){this.dIssuer=f.issuer}else{this.dIssuer=new Ext.asn1.x509.X500Name(f.issuer)}if(f.serial instanceof Ext.asn1.DERInteger){this.dSerial=f.serial}else{this.dSerial=new Ext.asn1.DERInteger(f.serial)}}if(typeof f.cert=="string"){this.setByCertPEM(f.cert)}}};YAHOO.lang.extend(Ext.asn1.cms.IssuerAndSerialNumber,Ext.asn1.ASN1Object);Ext.asn1.cms.AttributeList=function(b){Ext.asn1.cms.AttributeList.superclass.constructor.call(this);this.list=new Array();this.sortFlag=true;this.add=function(c){if(c instanceof Ext.asn1.cms.Attribute){this.list.push(c)}};this.length=function(){return this.list.length};this.clear=function(){this.list=new Array();this.hTLV=null;this.hV=null};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var c=new Ext.asn1.DERSet({array:this.list,sortflag:this.sortFlag});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof b!="undefined"){if(typeof b.sortflag!="undefined"&&b.sortflag==false){this.sortFlag=false}}};YAHOO.lang.extend(Ext.asn1.cms.AttributeList,Ext.asn1.ASN1Object);Ext.asn1.cms.SignerInfo=function(g){Ext.asn1.cms.SignerInfo.superclass.constructor.call(this);var e=Ext.asn1;var i=Ext.asn1.cms;var f=Ext.asn1.x509;this.dCMSVersion=new e.DERInteger({"int":1});this.dSignerIdentifier=null;this.dDigestAlgorithm=null;this.dSignedAttrs=new i.AttributeList();this.dSigAlg=null;this.dSig=null;this.dUnsignedAttrs=new i.AttributeList();this.setSignerIdentifier=function(c){if(typeof c=="string"&&c.indexOf("CERTIFICATE")!=-1&&c.indexOf("BEGIN")!=-1&&c.indexOf("END")!=-1){var b=c;this.dSignerIdentifier=new i.IssuerAndSerialNumber({cert:c})}};this.setForContentAndHash=function(b){if(typeof b!="undefined"){if(b.eciObj instanceof Ext.asn1.cms.EncapsulatedContentInfo){this.dSignedAttrs.add(new i.ContentType({oid:"1.2.840.113549.1.7.1"}));this.dSignedAttrs.add(new i.MessageDigest({eciObj:b.eciObj,hashAlg:b.hashAlg}))}if(typeof b.sdObj!="undefined"&&b.sdObj instanceof Ext.asn1.cms.SignedData){if(b.sdObj.digestAlgNameList.join(":").indexOf(b.hashAlg)==-1){b.sdObj.digestAlgNameList.push(b.hashAlg)}}if(typeof b.hashAlg=="string"){this.dDigestAlgorithm=new f.AlgorithmIdentifier({name:b.hashAlg})}}};this.sign=function(b,l){this.dSigAlg=new f.AlgorithmIdentifier({name:l});var k=this.dSignedAttrs.getEncodedHex();var c=KEYUTIL.getKey(b);var d=new Ext.crypto.Signature({alg:l});d.init(c);d.updateHex(k);var j=d.sign();this.dSig=new e.DEROctetString({hex:j})};this.addUnsigned=function(b){this.hTLV=null;this.dUnsignedAttrs.hTLV=null;this.dUnsignedAttrs.add(b)};this.getEncodedHex=function(){if(this.dSignedAttrs instanceof Ext.asn1.cms.AttributeList&&this.dSignedAttrs.length()==0){throw"SignedAttrs length = 0 (empty)"}var b=new e.DERTaggedObject({obj:this.dSignedAttrs,tag:"a0",explicit:false});var c=null;if(this.dUnsignedAttrs.length()>0){c=new e.DERTaggedObject({obj:this.dUnsignedAttrs,tag:"a1",explicit:false})}var d=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,b,this.dSigAlg,this.dSig,];if(c!=null){d.push(c)}var j=new e.DERSequence({array:d});this.hTLV=j.getEncodedHex();return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.SignerInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.EncapsulatedContentInfo=function(g){Ext.asn1.cms.EncapsulatedContentInfo.superclass.constructor.call(this);var e=Ext.asn1;var i=Ext.asn1.cms;var f=Ext.asn1.x509;this.dEContentType=new e.DERObjectIdentifier({name:"data"});this.dEContent=null;this.isDetached=false;this.eContentValueHex=null;this.setContentType=function(b){if(b.match(/^[0-2][.][0-9.]+$/)){this.dEContentType=new e.DERObjectIdentifier({oid:b})}else{this.dEContentType=new e.DERObjectIdentifier({name:b})}};this.setContentValue=function(b){if(typeof b!="undefined"){if(typeof b.hex=="string"){this.eContentValueHex=b.hex}else{if(typeof b.str=="string"){this.eContentValueHex=utf8tohex(b.str)}}}};this.setContentValueHex=function(b){this.eContentValueHex=b};this.setContentValueStr=function(b){this.eContentValueHex=utf8tohex(b)};this.getEncodedHex=function(){if(typeof this.eContentValueHex!="string"){throw"eContentValue not yet set"}var c=new e.DEROctetString({hex:this.eContentValueHex});this.dEContent=new e.DERTaggedObject({obj:c,tag:"a0",explicit:true});var b=[this.dEContentType];if(!this.isDetached){b.push(this.dEContent)}var d=new e.DERSequence({array:b});this.hTLV=d.getEncodedHex();return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.EncapsulatedContentInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.ContentInfo=function(g){Ext.asn1.cms.ContentInfo.superclass.constructor.call(this);var e=Ext.asn1;var i=Ext.asn1.cms;var f=Ext.asn1.x509;this.dContentType=null;this.dContent=null;this.setContentType=function(b){if(typeof b=="string"){this.dContentType=f.OID.name2obj(b)}};this.getEncodedHex=function(){var c=new e.DERTaggedObject({obj:this.dContent,tag:"a0",explicit:true});var b=new e.DERSequence({array:[this.dContentType,c]});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof g!="undefined"){if(g.type){this.setContentType(g.type)}if(g.obj&&g.obj instanceof e.ASN1Object){this.dContent=g.obj}}};YAHOO.lang.extend(Ext.asn1.cms.ContentInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.SignedData=function(g){Ext.asn1.cms.SignedData.superclass.constructor.call(this);var e=Ext.asn1;var i=Ext.asn1.cms;var f=Ext.asn1.x509;this.dCMSVersion=new e.DERInteger({"int":1});this.dDigestAlgs=null;this.digestAlgNameList=[];this.dEncapContentInfo=new i.EncapsulatedContentInfo();this.dCerts=null;this.certificateList=[];this.crlList=[];this.signerInfoList=[new i.SignerInfo()];this.addCertificatesByPEM=function(b){var d=ASN1HEX.pemToHex(b);var c=new e.ASN1Object();c.hTLV=d;this.certificateList.push(c)};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}if(this.dDigestAlgs==null){var c=[];for(var o=0;o<this.digestAlgNameList.length;o++){var b=this.digestAlgNameList[o];var n=new f.AlgorithmIdentifier({name:b});c.push(n)}this.dDigestAlgs=new e.DERSet({array:c})}var p=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(this.dCerts==null){if(this.certificateList.length>0){var q=new e.DERSet({array:this.certificateList});this.dCerts=new e.DERTaggedObject({obj:q,tag:"a0",explicit:false})}}if(this.dCerts!=null){p.push(this.dCerts)}var j=new e.DERSet({array:this.signerInfoList});p.push(j);var d=new e.DERSequence({array:p});this.hTLV=d.getEncodedHex();return this.hTLV};this.getContentInfo=function(){this.getEncodedHex();var b=new i.ContentInfo({type:"signed-data",obj:this});return b};this.getContentInfoEncodedHex=function(){var b=this.getContentInfo();var c=b.getEncodedHex();return c};this.getPEM=function(){var b=this.getContentInfoEncodedHex();var c=e.ASN1Util.getPEMStringFromHex(b,"CMS");return c}};YAHOO.lang.extend(Ext.asn1.cms.SignedData,Ext.asn1.ASN1Object);Ext.asn1.cms.CMSUtil=new function(){};Ext.asn1.cms.CMSUtil.newSignedData=function(n){var p=Ext.asn1.cms;var q=Ext.asn1.cades;var r=new p.SignedData();r.dEncapContentInfo.setContentValue(n.content);if(typeof n.certs=="object"){for(var m=0;m<n.certs.length;m++){r.addCertificatesByPEM(n.certs[m])}}r.signerInfoList=[];for(var m=0;m<n.signerInfos.length;m++){var k=n.signerInfos[m];var l=new p.SignerInfo();l.setSignerIdentifier(k.signerCert);l.setForContentAndHash({sdObj:r,eciObj:r.dEncapContentInfo,hashAlg:k.hashAlg});for(attrName in k.sAttr){var o=k.sAttr[attrName];if(attrName=="SigningTime"){var i=new p.SigningTime(o);l.dSignedAttrs.add(i)}if(attrName=="SigningCertificate"){var i=new p.SigningCertificate(o);l.dSignedAttrs.add(i)}if(attrName=="SigningCertificateV2"){var i=new p.SigningCertificateV2(o);l.dSignedAttrs.add(i)}if(attrName=="SignaturePolicyIdentifier"){var i=new q.SignaturePolicyIdentifier(o);l.dSignedAttrs.add(i)}}l.sign(k.signerPrvKey,k.sigAlg);r.signerInfoList.push(l)}return r};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.tsp=="undefined"||!Ext.asn1.tsp){Ext.asn1.tsp={}}Ext.asn1.tsp.Accuracy=function(d){Ext.asn1.tsp.Accuracy.superclass.constructor.call(this);var c=Ext.asn1;this.seconds=null;this.millis=null;this.micros=null;this.getEncodedHex=function(){var m=null;var n=null;var j=null;var k=[];if(this.seconds!=null){m=new c.DERInteger({"int":this.seconds});k.push(m)}if(this.millis!=null){var l=new c.DERInteger({"int":this.millis});n=new c.DERTaggedObject({obj:l,tag:"80",explicit:false});k.push(n)}if(this.micros!=null){var b=new c.DERInteger({"int":this.micros});j=new c.DERTaggedObject({obj:b,tag:"81",explicit:false});k.push(j)}var e=new c.DERSequence({array:k});this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof d!="undefined"){if(typeof d.seconds=="number"){this.seconds=d.seconds}if(typeof d.millis=="number"){this.millis=d.millis}if(typeof d.micros=="number"){this.micros=d.micros}}};YAHOO.lang.extend(Ext.asn1.tsp.Accuracy,Ext.asn1.ASN1Object);Ext.asn1.tsp.MessageImprint=function(f){Ext.asn1.tsp.MessageImprint.superclass.constructor.call(this);var d=Ext.asn1;var e=Ext.asn1.x509;this.dHashAlg=null;this.dHashValue=null;this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var b=new d.DERSequence({array:[this.dHashAlg,this.dHashValue]});return b.getEncodedHex()};if(typeof f!="undefined"){if(typeof f.hashAlg=="string"){this.dHashAlg=new e.AlgorithmIdentifier({name:f.hashAlg})}if(typeof f.hashValue=="string"){this.dHashValue=new d.DEROctetString({hex:f.hashValue})}}};YAHOO.lang.extend(Ext.asn1.tsp.MessageImprint,Ext.asn1.ASN1Object);Ext.asn1.tsp.TimeStampReq=function(e){Ext.asn1.tsp.TimeStampReq.superclass.constructor.call(this);var d=Ext.asn1;var f=Ext.asn1.tsp;this.dVersion=new d.DERInteger({"int":1});this.dMessageImprint=null;this.dPolicy=null;this.dNonce=null;this.certReq=true;this.setMessageImprint=function(b){if(b instanceof Ext.asn1.tsp.MessageImprint){this.dMessageImprint=b;return}if(typeof b=="object"){this.dMessageImprint=new f.MessageImprint(b)}};this.getEncodedHex=function(){if(this.dMessageImprint==null){throw"messageImprint shall be specified"}var b=[this.dVersion,this.dMessageImprint];if(this.dPolicy!=null){b.push(this.dPolicy)}if(this.dNonce!=null){b.push(this.dNonce)}if(this.certReq){b.push(new d.DERBoolean())}var c=new d.DERSequence({array:b});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.mi=="object"){this.setMessageImprint(e.mi)}if(typeof e.policy=="object"){this.dPolicy=new d.DERObjectIdentifier(e.policy)}if(typeof e.nonce=="object"){this.dNonce=new d.DERInteger(e.nonce)}if(typeof e.certreq=="boolean"){this.certReq=e.certreq}}};YAHOO.lang.extend(Ext.asn1.tsp.TimeStampReq,Ext.asn1.ASN1Object);Ext.asn1.tsp.TSTInfo=function(g){Ext.asn1.tsp.TSTInfo.superclass.constructor.call(this);var e=Ext.asn1;var f=Ext.asn1.x509;var i=Ext.asn1.tsp;this.dVersion=new e.DERInteger({"int":1});this.dPolicy=null;this.dMessageImprint=null;this.dSerialNumber=null;this.dGenTime=null;this.dAccuracy=null;this.dOrdering=null;this.dNonce=null;this.dTsa=null;this.getEncodedHex=function(){var b=[this.dVersion];if(this.dPolicy==null){throw"policy shall be specified."}b.push(this.dPolicy);if(this.dMessageImprint==null){throw"messageImprint shall be specified."}b.push(this.dMessageImprint);if(this.dSerialNumber==null){throw"serialNumber shall be specified."}b.push(this.dSerialNumber);if(this.dGenTime==null){throw"genTime shall be specified."}b.push(this.dGenTime);if(this.dAccuracy!=null){b.push(this.dAccuracy)}if(this.dOrdering!=null){b.push(this.dOrdering)}if(this.dNonce!=null){b.push(this.dNonce)}if(this.dTsa!=null){b.push(this.dTsa)}var c=new e.DERSequence({array:b});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof g!="undefined"){if(typeof g.policy=="string"){if(!g.policy.match(/^[0-9.]+$/)){throw"policy shall be oid like 0.1.4.134"}this.dPolicy=new e.DERObjectIdentifier({oid:g.policy})}if(typeof g.messageImprint!="undefined"){this.dMessageImprint=new i.MessageImprint(g.messageImprint)}if(typeof g.serialNumber!="undefined"){this.dSerialNumber=new e.DERInteger(g.serialNumber)}if(typeof g.genTime!="undefined"){this.dGenTime=new e.DERGeneralizedTime(g.genTime)}if(typeof g.accuracy!="undefind"){this.dAccuracy=new i.Accuracy(g.accuracy)}if(typeof g.ordering!="undefined"&&g.ordering==true){this.dOrdering=new e.DERBoolean()}if(typeof g.nonce!="undefined"){this.dNonce=new e.DERInteger(g.nonce)}if(typeof g.tsa!="undefined"){this.dTsa=new f.X500Name(g.tsa)}}};YAHOO.lang.extend(Ext.asn1.tsp.TSTInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.TimeStampResp=function(e){Ext.asn1.tsp.TimeStampResp.superclass.constructor.call(this);var d=Ext.asn1;var f=Ext.asn1.tsp;this.dStatus=null;this.dTST=null;this.getEncodedHex=function(){if(this.dStatus==null){throw"status shall be specified"}var b=[this.dStatus];if(this.dTST!=null){b.push(this.dTST)}var c=new d.DERSequence({array:b});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.status=="object"){this.dStatus=new f.PKIStatusInfo(e.status)}if(typeof e.tst!="undefined"&&e.tst instanceof Ext.asn1.ASN1Object){this.dTST=e.tst.getContentInfo()}}};YAHOO.lang.extend(Ext.asn1.tsp.TimeStampResp,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatusInfo=function(e){Ext.asn1.tsp.PKIStatusInfo.superclass.constructor.call(this);var d=Ext.asn1;var f=Ext.asn1.tsp;this.dStatus=null;this.dStatusString=null;this.dFailureInfo=null;this.getEncodedHex=function(){if(this.dStatus==null){throw"status shall be specified"}var b=[this.dStatus];if(this.dStatusString!=null){b.push(this.dStatusString)}if(this.dFailureInfo!=null){b.push(this.dFailureInfo)}var c=new d.DERSequence({array:b});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.status=="object"){this.dStatus=new f.PKIStatus(e.status)}if(typeof e.statstr=="object"){this.dStatusString=new f.PKIFreeText({array:e.statstr})}if(typeof e.failinfo=="object"){this.dFailureInfo=new f.PKIFailureInfo(e.failinfo)}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIStatusInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatus=function(j){Ext.asn1.tsp.PKIStatus.superclass.constructor.call(this);var i=Ext.asn1;var g=Ext.asn1.tsp;var k=null;this.getEncodedHex=function(){this.hTLV=this.dStatus.getEncodedHex();return this.hTLV};if(typeof j!="undefined"){if(typeof j.name!="undefined"){var f=g.PKIStatus.valueList;if(typeof f[j.name]=="undefined"){throw"name undefined: "+j.name}this.dStatus=new i.DERInteger({"int":f[j.name]})}else{this.dStatus=new i.DERInteger(j)}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIStatus,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};Ext.asn1.tsp.PKIFreeText=function(d){Ext.asn1.tsp.PKIFreeText.superclass.constructor.call(this);var c=Ext.asn1;this.textList=[];this.getEncodedHex=function(){var b=[];for(var e=0;e<this.textList.length;e++){b.push(new c.DERUTF8String({str:this.textList[e]}))}var f=new c.DERSequence({array:b});this.hTLV=f.getEncodedHex();return this.hTLV};if(typeof d!="undefined"){if(typeof d.array=="object"){this.textList=d.array}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIFreeText,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIFailureInfo=function(f){Ext.asn1.tsp.PKIFailureInfo.superclass.constructor.call(this);var e=Ext.asn1;var i=Ext.asn1.tsp;this.value=null;this.getEncodedHex=function(){if(this.value==null){throw"value shall be specified"}var b=new Number(this.value).toString(2);var c=new e.DERBitString();c.setByBinaryString(b);this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f.name=="string"){var g=i.PKIFailureInfo.valueList;if(typeof g[f.name]=="undefined"){throw"name undefined: "+f.name}this.value=g[f.name]}else{if(typeof f["int"]=="number"){this.value=f["int"]}}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIFailureInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};Ext.asn1.tsp.AbstractTSAAdapter=function(b){this.getTSTHex=function(c,d){throw"not implemented yet"}};Ext.asn1.tsp.SimpleTSAAdapter=function(b){Ext.asn1.tsp.SimpleTSAAdapter.superclass.constructor.call(this);this.params=null;this.serial=0;this.getTSTHex=function(g,c){var j=Ext.crypto.Util.hashHex(g,c);this.params.tstInfo.messageImprint={hashAlg:c,hashValue:j};this.params.tstInfo.serialNumber={"int":this.serial++};var k=Math.floor(Math.random()*1000000000);this.params.tstInfo.nonce={"int":k};var i=Ext.asn1.tsp.TSPUtil.newTimeStampToken(this.params);return i.getContentInfoEncodedHex()};if(typeof b!="undefined"){this.params=b}};YAHOO.lang.extend(Ext.asn1.tsp.SimpleTSAAdapter,Ext.asn1.tsp.AbstractTSAAdapter);Ext.asn1.tsp.FixedTSAAdapter=function(b){Ext.asn1.tsp.FixedTSAAdapter.superclass.constructor.call(this);this.params=null;this.getTSTHex=function(g,i){var f=Ext.crypto.Util.hashHex(g,i);this.params.tstInfo.messageImprint={hashAlg:i,hashValue:f};var c=Ext.asn1.tsp.TSPUtil.newTimeStampToken(this.params);return c.getContentInfoEncodedHex()};if(typeof b!="undefined"){this.params=b}};YAHOO.lang.extend(Ext.asn1.tsp.FixedTSAAdapter,Ext.asn1.tsp.AbstractTSAAdapter);Ext.asn1.tsp.TSPUtil=new function(){};Ext.asn1.tsp.TSPUtil.newTimeStampToken=function(m){var o=Ext.asn1.cms;var n=Ext.asn1.tsp;var q=new o.SignedData();var i=new n.TSTInfo(m.tstInfo);var r=i.getEncodedHex();q.dEncapContentInfo.setContentValue({hex:r});q.dEncapContentInfo.setContentType("tstinfo");if(typeof m.certs=="object"){for(var l=0;l<m.certs.length;l++){q.addCertificatesByPEM(m.certs[l])}}var k=q.signerInfoList[0];k.setSignerIdentifier(m.signerCert);k.setForContentAndHash({sdObj:q,eciObj:q.dEncapContentInfo,hashAlg:m.hashAlg});var p=new o.SigningCertificate({array:[m.signerCert]});k.dSignedAttrs.add(p);k.sign(m.signerPrvKey,m.sigAlg);return q};Ext.asn1.tsp.TSPUtil.parseTimeStampReq=function(m){var i={};i.certreq=false;var p=ASN1HEX.getPosArrayOfChildren_AtObj(m,0);if(p.length<2){throw"TimeStampReq must have at least 2 items"}var l=ASN1HEX.getHexOfTLV_AtObj(m,p[1]);i.mi=Ext.asn1.tsp.TSPUtil.parseMessageImprint(l);for(var k=2;k<p.length;k++){var j=p[k];var o=m.substr(j,2);if(o=="06"){var n=ASN1HEX.getHexOfV_AtObj(m,j);i.policy=ASN1HEX.hextooidstr(n)}if(o=="02"){i.nonce=ASN1HEX.getHexOfV_AtObj(m,j)}if(o=="01"){i.certreq=true}}return i};Ext.asn1.tsp.TSPUtil.parseMessageImprint=function(l){var p={};if(l.substr(0,2)!="30"){throw"head of messageImprint hex shall be '30'"}var n=ASN1HEX.getPosArrayOfChildren_AtObj(l,0);var o=ASN1HEX.getDecendantIndexByNthList(l,0,[0,0]);var k=ASN1HEX.getHexOfV_AtObj(l,o);var j=ASN1HEX.hextooidstr(k);var q=Ext.asn1.x509.OID.oid2name(j);if(q==""){throw"hashAlg name undefined: "+j}var m=q;var r=ASN1HEX.getDecendantIndexByNthList(l,0,[1]);p.hashAlg=m;p.hashValue=ASN1HEX.getHexOfV_AtObj(l,r);return p};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.cades=="undefined"||!Ext.asn1.cades){Ext.asn1.cades={}}Ext.asn1.cades.SignaturePolicyIdentifier=function(k){Ext.asn1.cades.SignaturePolicyIdentifier.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.15";var m=Ext.asn1;var g=Ext.asn1.cades;if(typeof k!="undefined"){if(typeof k.oid=="string"&&typeof k.hash=="object"){var j=new m.DERObjectIdentifier({oid:k.oid});var i=new g.OtherHashAlgAndValue(k.hash);var l=new m.DERSequence({array:[j,i]});this.valueList=[l]}}};YAHOO.lang.extend(Ext.asn1.cades.SignaturePolicyIdentifier,Ext.asn1.cms.Attribute);Ext.asn1.cades.OtherHashAlgAndValue=function(f){Ext.asn1.cades.OtherHashAlgAndValue.superclass.constructor.call(this);var d=Ext.asn1;var e=Ext.asn1.x509;this.dAlg=null;this.dHash=null;this.getEncodedHex=function(){var b=new d.DERSequence({array:[this.dAlg,this.dHash]});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f.alg=="string"&&typeof f.hash=="string"){this.dAlg=new e.AlgorithmIdentifier({name:f.alg});this.dHash=new d.DEROctetString({hex:f.hash})}}};YAHOO.lang.extend(Ext.asn1.cades.OtherHashAlgAndValue,Ext.asn1.ASN1Object);Ext.asn1.cades.SignatureTimeStamp=function(e){Ext.asn1.cades.SignatureTimeStamp.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.14";this.tstHex=null;var d=Ext.asn1;if(typeof e!="undefined"){if(typeof e.res!="undefined"){if(typeof e.res=="string"&&e.res.match(/^[0-9A-Fa-f]+$/)){}else{if(e.res instanceof Ext.asn1.ASN1Object){}else{throw"res param shall be ASN1Object or hex string"}}}if(typeof e.tst!="undefined"){if(typeof e.tst=="string"&&e.tst.match(/^[0-9A-Fa-f]+$/)){var f=new d.ASN1Object();this.tstHex=e.tst;f.hTLV=this.tstHex;f.getEncodedHex();this.valueList=[f]}else{if(e.tst instanceof Ext.asn1.ASN1Object){}else{throw"tst param shall be ASN1Object or hex string"}}}}};YAHOO.lang.extend(Ext.asn1.cades.SignatureTimeStamp,Ext.asn1.cms.Attribute);Ext.asn1.cades.CompleteCertificateRefs=function(e){Ext.asn1.cades.CompleteCertificateRefs.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.21";var d=Ext.asn1;var f=Ext.asn1.cades;this.setByArray=function(b){this.valueList=[];for(var g=0;g<b.length;g++){var c=new f.OtherCertID(b[g]);this.valueList.push(c)}};if(typeof e!="undefined"){if(typeof e=="object"&&typeof e.length=="number"){this.setByArray(e)}}};YAHOO.lang.extend(Ext.asn1.cades.CompleteCertificateRefs,Ext.asn1.cms.Attribute);Ext.asn1.cades.OtherCertID=function(f){Ext.asn1.cades.OtherCertID.superclass.constructor.call(this);var e=Ext.asn1;var g=Ext.asn1.cms;var i=Ext.asn1.cades;this.hasIssuerSerial=true;this.dOtherCertHash=null;this.dIssuerSerial=null;this.setByCertPEM=function(b){this.dOtherCertHash=new i.OtherHash(b);if(this.hasIssuerSerial){this.dIssuerSerial=new g.IssuerAndSerialNumber(b)}};this.getEncodedHex=function(){if(this.hTLV!=null){return this.hTLV}if(this.dOtherCertHash==null){throw"otherCertHash not set"}var b=[this.dOtherCertHash];if(this.dIssuerSerial!=null){b.push(this.dIssuerSerial)}var c=new e.DERSequence({array:b});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof f!="undefined"){if(typeof f=="string"&&f.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(f)}if(typeof f=="object"){if(f.hasis===false){this.hasIssuerSerial=false}if(typeof f.cert=="string"){this.setByCertPEM(f.cert)}}}};YAHOO.lang.extend(Ext.asn1.cades.OtherCertID,Ext.asn1.ASN1Object);Ext.asn1.cades.OtherHash=function(e){Ext.asn1.cades.OtherHash.superclass.constructor.call(this);var d=Ext.asn1;var f=Ext.asn1.cades;this.alg="sha256";this.dOtherHash=null;this.setByCertPEM=function(b){if(b.indexOf("-----BEGIN ")==-1){throw"certPEM not to seem PEM format"}var g=ASN1HEX.pemToHex(b);var c=Ext.crypto.Util.hashHex(g,this.alg);this.dOtherHash=new f.OtherHashAlgAndValue({alg:this.alg,hash:c})};this.getEncodedHex=function(){if(this.dOtherHash==null){throw"OtherHash not set"}return this.dOtherHash.getEncodedHex()};if(typeof e!="undefined"){if(typeof e=="string"){if(e.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(e)}else{if(e.match(/^[0-9A-Fa-f]+$/)){this.dOtherHash=new d.DEROctetString({hex:e})}else{throw"unsupported string value for params"}}}else{if(typeof e=="object"){if(typeof e.cert=="string"){if(typeof e.alg=="string"){this.alg=e.alg}this.setByCertPEM(e.cert)}else{this.dOtherHash=new f.OtherHashAlgAndValue(e)}}}}};YAHOO.lang.extend(Ext.asn1.cades.OtherHash,Ext.asn1.ASN1Object);Ext.asn1.cades.CAdESUtil=new function(){};Ext.asn1.cades.CAdESUtil.addSigTS=function(e,f,d){};Ext.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(A){var I=Ext.asn1;var C=Ext.asn1.cms;var E=Ext.asn1.cades.CAdESUtil;var y={};if(ASN1HEX.getDecendantHexTLVByNthList(A,0,[0])!="06092a864886f70d010702"){throw"hex is not CMS SignedData"}var x=ASN1HEX.getDecendantIndexByNthList(A,0,[1,0]);var v=ASN1HEX.getPosArrayOfChildren_AtObj(A,x);if(v.length<4){throw"num of SignedData elem shall be 4 at least"}var J=v.shift();y.version=ASN1HEX.getHexOfTLV_AtObj(A,J);var G=v.shift();y.algs=ASN1HEX.getHexOfTLV_AtObj(A,G);var r=v.shift();y.encapcontent=ASN1HEX.getHexOfTLV_AtObj(A,r);y.certs=null;y.revs=null;y.si=[];var F=v.shift();if(A.substr(F,2)=="a0"){y.certs=ASN1HEX.getHexOfTLV_AtObj(A,F);F=v.shift()}if(A.substr(F,2)=="a1"){y.revs=ASN1HEX.getHexOfTLV_AtObj(A,F);F=v.shift()}var H=F;if(A.substr(H,2)!="31"){throw"Can't find signerInfos"}var u=ASN1HEX.getPosArrayOfChildren_AtObj(A,H);for(var w=0;w<u.length;w++){var i=u[w];var D=E.parseSignerInfoForAddingUnsigned(A,i,w);y.si[w]=D}var B=null;y.obj=new C.SignedData();B=new I.ASN1Object();B.hTLV=y.version;y.obj.dCMSVersion=B;B=new I.ASN1Object();B.hTLV=y.algs;y.obj.dDigestAlgs=B;B=new I.ASN1Object();B.hTLV=y.encapcontent;y.obj.dEncapContentInfo=B;B=new I.ASN1Object();B.hTLV=y.certs;y.obj.dCerts=B;y.obj.signerInfoList=[];for(var w=0;w<y.si.length;w++){y.obj.signerInfoList.push(y.si[w].obj)}return y};Ext.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(s,A,B){var v=Ext.asn1;var x=Ext.asn1.cms;var y={};var r=ASN1HEX.getPosArrayOfChildren_AtObj(s,A);if(r.length!=6){throw"not supported items for SignerInfo (!=6)"}var q=r.shift();y.version=ASN1HEX.getHexOfTLV_AtObj(s,q);var u=r.shift();y.si=ASN1HEX.getHexOfTLV_AtObj(s,u);var C=r.shift();y.digalg=ASN1HEX.getHexOfTLV_AtObj(s,C);var D=r.shift();y.sattrs=ASN1HEX.getHexOfTLV_AtObj(s,D);var o=r.shift();y.sigalg=ASN1HEX.getHexOfTLV_AtObj(s,o);var w=r.shift();y.sig=ASN1HEX.getHexOfTLV_AtObj(s,w);y.sigval=ASN1HEX.getHexOfV_AtObj(s,w);var p=null;y.obj=new x.SignerInfo();p=new v.ASN1Object();p.hTLV=y.version;y.obj.dCMSVersion=p;p=new v.ASN1Object();p.hTLV=y.si;y.obj.dSignerIdentifier=p;p=new v.ASN1Object();p.hTLV=y.digalg;y.obj.dDigestAlgorithm=p;p=new v.ASN1Object();p.hTLV=y.sattrs;y.obj.dSignedAttrs=p;p=new v.ASN1Object();p.hTLV=y.sigalg;y.obj.dSigAlg=p;p=new v.ASN1Object();p.hTLV=y.sig;y.obj.dSig=p;y.obj.dUnsignedAttrs=new x.AttributeList();return y};if(typeof Ext.asn1.csr=="undefined"||!Ext.asn1.csr){Ext.asn1.csr={}}Ext.asn1.csr.CertificationRequest=function(j){Ext.asn1.csr.CertificationRequest.superclass.constructor.call(this);var m=null;var g=null;var k=null;var l=null;var i=null;this.sign=function(c,d){if(this.prvKey==null){this.prvKey=d}this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier({name:c});sig=new Ext.crypto.Signature({alg:c});sig.initSign(this.prvKey);sig.updateHex(this.asn1CSRInfo.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var b=new Ext.asn1.DERSequence({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=b.getEncodedHex();this.isModified=false};this.getPEMString=function(){var b=Ext.asn1.ASN1Util.getPEMStringFromHex(this.getEncodedHex(),"CERTIFICATE REQUEST");return b};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};if(typeof j!="undefined"){if(typeof j.csrinfo!="undefined"){this.asn1CSRInfo=j.csrinfo}}};YAHOO.lang.extend(Ext.asn1.csr.CertificationRequest,Ext.asn1.ASN1Object);Ext.asn1.csr.CertificationRequestInfo=function(b){Ext.asn1.csr.CertificationRequestInfo.superclass.constructor.call(this);this._initialize=function(){this.asn1Array=new Array();this.asn1Version=new Ext.asn1.DERInteger({"int":0});this.asn1Subject=null;this.asn1SubjPKey=null;this.extensionsArray=new Array()};this.setSubjectByParam=function(c){this.asn1Subject=new Ext.asn1.x509.X500Name(c)};this.setSubjectPublicKeyByGetKey=function(c){var d=KEYUTIL.getKey(c);this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(d)};this.appendExtensionByName=function(c,d){Ext.asn1.x509.Extension.appendByNameToArray(c,d,this.extensionsArray)};this.getEncodedHex=function(){this.asn1Array=new Array();this.asn1Array.push(this.asn1Version);this.asn1Array.push(this.asn1Subject);this.asn1Array.push(this.asn1SubjPKey);if(this.extensionsArray.length>0){var j=new Ext.asn1.DERSequence({array:this.extensionsArray});var k=new Ext.asn1.DERSet({array:[j]});var g=new Ext.asn1.DERSequence({array:[new Ext.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.9.14"}),k]});var c=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:g});this.asn1Array.push(c)}else{var c=new Ext.asn1.DERTaggedObject({explicit:false,tag:"a0",obj:new Ext.asn1.DERNull()});this.asn1Array.push(c)}var i=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=i.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize()};YAHOO.lang.extend(Ext.asn1.csr.CertificationRequestInfo,Ext.asn1.ASN1Object);Ext.asn1.csr.CSRUtil=new function(){};Ext.asn1.csr.CSRUtil.newCSRPEM=function(i){var k=Ext.asn1.csr;if(i.subject===undefined){throw"parameter subject undefined"}if(i.sbjpubkey===undefined){throw"parameter sbjpubkey undefined"}if(i.sigalg===undefined){throw"parameter sigalg undefined"}if(i.sbjprvkey===undefined){throw"parameter sbjpubkey undefined"}var m=new k.CertificationRequestInfo();m.setSubjectByParam(i.subject);m.setSubjectPublicKeyByGetKey(i.sbjpubkey);if(i.ext!==undefined&&i.ext.length!==undefined){for(var n=0;n<i.ext.length;n++){for(key in i.ext[n]){m.appendExtensionByName(key,i.ext[n][key])}}}var l=new k.CertificationRequest({csrinfo:m});var o=KEYUTIL.getKey(i.sbjprvkey);l.sign(i.sigalg,o);var j=l.getPEMString();return j};Ext.asn1.csr.CSRUtil.getInfo=function(f){var d={};d.subject={};d.pubkey={};if(f.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1){throw"argument is not PEM file"}var e=ASN1HEX.pemToHex(f,"CERTIFICATE REQUEST");d.subject.hex=ASN1HEX.getDecendantHexTLVByNthList(e,0,[0,1]);d.subject.name=X509.hex2dn(d.subject.hex);d.pubkey.hex=ASN1HEX.getDecendantHexTLVByNthList(e,0,[0,2]);d.pubkey.obj=KEYUTIL.getKey(d.pubkey.hex,null,"pkcs8pub");return d};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.ocsp=="undefined"||!Ext.asn1.ocsp){Ext.asn1.ocsp={}}Ext.asn1.ocsp.DEFAULT_HASH="sha1";Ext.asn1.ocsp.CertID=function(f){Ext.asn1.ocsp.CertID.superclass.constructor.call(this);var i=Ext.asn1;var j=Ext.asn1.x509;this.dHashAlg=null;this.dIssuerNameHash=null;this.dIssuerKeyHash=null;this.dSerialNumber=null;this.setByValue=function(c,d,b,e){if(e===undefined){e=Ext.asn1.ocsp.DEFAULT_HASH}this.dHashAlg=new j.AlgorithmIdentifier({name:e});this.dIssuerNameHash=new i.DEROctetString({hex:c});this.dIssuerKeyHash=new i.DEROctetString({hex:d});this.dSerialNumber=new i.DERInteger({hex:b})};this.setByCert=function(e,r,p){if(p===undefined){p=Ext.asn1.ocsp.DEFAULT_HASH}var b=new X509();b.readCertPEM(r);var d=new X509();d.readCertPEM(e);var c=X509.getPublicKeyInfoPropOfCertPEM(e);var l=c.keyhex;var u=b.getSerialNumberHex();var s=Ext.crypto.Util.hashHex(d.getSubjectHex(),p);var q=Ext.crypto.Util.hashHex(l,p);this.setByValue(s,q,u,p);this.hoge=b.getSerialNumberHex()};this.getEncodedHex=function(){if(this.dHashAlg===null&&this.dIssuerNameHash===null&&this.dIssuerKeyHash===null&&this.dSerialNumber===null){throw"not yet set values"}var b=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber];var c=new i.DERSequence({array:b});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof f!=="undefined"){var g=f;if(typeof g.issuerCert!=="undefined"&&typeof g.subjectCert!=="undefined"){var k=Ext.asn1.ocsp.DEFAULT_HASH;if(typeof g.alg==="undefined"){k=undefined}this.setByCert(g.issuerCert,g.subjectCert,k)}else{if(typeof g.namehash!=="undefined"&&typeof g.keyhash!=="undefined"&&typeof g.serial!=="undefined"){var k=Ext.asn1.ocsp.DEFAULT_HASH;if(typeof g.alg==="undefined"){k=undefined}this.setByValue(g.namehash,g.keyhash,g.serial,k)}else{throw"invalid constructor arguments"}}}};YAHOO.lang.extend(Ext.asn1.ocsp.CertID,Ext.asn1.ASN1Object);Ext.asn1.ocsp.Request=function(d){Ext.asn1.ocsp.Request.superclass.constructor.call(this);this.dReqCert=null;this.dExt=null;this.getEncodedHex=function(){var b=[];if(this.dReqCert===null){throw"reqCert not set"}b.push(this.dReqCert);var e=new Ext.asn1.DERSequence({array:b});this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof d!=="undefined"){var c=new Ext.asn1.ocsp.CertID(d);this.dReqCert=c}};YAHOO.lang.extend(Ext.asn1.ocsp.Request,Ext.asn1.ASN1Object);Ext.asn1.ocsp.TBSRequest=function(b){Ext.asn1.ocsp.TBSRequest.superclass.constructor.call(this);this.version=0;this.dRequestorName=null;this.dRequestList=[];this.dRequestExt=null;this.setRequestListByParam=function(f){var i=[];for(var g=0;g<f.length;g++){var c=new Ext.asn1.ocsp.Request(f[0]);i.push(c)}this.dRequestList=i};this.getEncodedHex=function(){var f=[];if(this.version!==0){throw"not supported version: "+this.version}if(this.dRequestorName!==null){throw"requestorName not supported"}var c=new Ext.asn1.DERSequence({array:this.dRequestList});f.push(c);if(this.dRequestExt!==null){throw"requestExtensions not supported"}var e=new Ext.asn1.DERSequence({array:f});this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof b!=="undefined"){if(typeof b.reqList!=="undefined"){this.setRequestListByParam(b.reqList)}}};YAHOO.lang.extend(Ext.asn1.ocsp.TBSRequest,Ext.asn1.ASN1Object);Ext.asn1.ocsp.OCSPRequest=function(d){Ext.asn1.ocsp.OCSPRequest.superclass.constructor.call(this);this.dTbsRequest=null;this.dOptionalSignature=null;this.getEncodedHex=function(){var b=[];if(this.dTbsRequest!==null){b.push(this.dTbsRequest)}else{throw"tbsRequest not set"}if(this.dOptionalSignature!==null){throw"optionalSignature not supported"}var e=new Ext.asn1.DERSequence({array:b});this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof d!=="undefined"){if(typeof d.reqList!=="undefined"){var c=new Ext.asn1.ocsp.TBSRequest(d);this.dTbsRequest=c}}};YAHOO.lang.extend(Ext.asn1.ocsp.OCSPRequest,Ext.asn1.ASN1Object);Ext.asn1.ocsp.OCSPUtil={};Ext.asn1.ocsp.OCSPUtil.getRequestHex=function(i,g,j){if(j===undefined){j=Ext.asn1.ocsp.DEFAULT_HASH}var k={alg:j,issuerCert:i,subjectCert:g};var f=new Ext.asn1.ocsp.OCSPRequest({reqList:[k]});return f.getEncodedHex()};Ext.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(m){var k={};try{var i=ASN1HEX.getVbyList(m,0,[0],"0a");k.responseStatus=parseInt(i,16)}catch(n){}if(k.responseStatus!==0){return k}try{var o=ASN1HEX.getDecendantIndexByNthList(m,0,[1,0,1,0,0,2,0,1]);if(m.substr(o,2)==="80"){k.certStatus="good"}else{if(m.substr(o,2)==="a1"){k.certStatus="revoked";k.revocationTime=hextoutf8(ASN1HEX.getDecendantHexVByNthList(m,o,[0]))}else{if(m.substr(o,2)==="82"){k.certStatus="unknown"}}}}catch(n){}try{var j=ASN1HEX.getDecendantIndexByNthList(m,0,[1,0,1,0,0,2,0,2]);k.thisUpdate=hextoutf8(ASN1HEX.getHexOfV_AtObj(m,j))}catch(n){}try{var l=ASN1HEX.getDecendantIndexByNthList(m,0,[1,0,1,0,0,2,0,3]);if(m.substr(l,2)==="a0"){k.nextUpdate=hextoutf8(ASN1HEX.getDecendantHexVByNthList(m,l,[0]))}}catch(n){}return k};var Ext;if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.lang=="undefined"||!Ext.lang){Ext.lang={}}Ext.lang.String=function(){};function Base64x(){}function stoBA(e){var g=new Array();for(var f=0;f<e.length;f++){g[f]=e.charCodeAt(f)}return g}function BAtos(g){var e="";for(var f=0;f<g.length;f++){e=e+String.fromCharCode(g[f])}return e}function BAtohex(j){var f="";for(var g=0;g<j.length;g++){var i=j[g].toString(16);if(i.length==1){i="0"+i}f=f+i}return f}function stohex(b){return BAtohex(stoBA(b))}function stob64(b){return hex2b64(stohex(b))}function stob64u(b){return b64tob64u(hex2b64(stohex(b)))}function b64utos(b){return BAtos(b64toBA(b64utob64(b)))}function b64tob64u(b){b=b.replace(/\=/g,"");b=b.replace(/\+/g,"-");b=b.replace(/\//g,"_");return b}function b64utob64(b){if(b.length%4==2){b=b+"=="}else{if(b.length%4==3){b=b+"="}}b=b.replace(/-/g,"+");b=b.replace(/_/g,"/");return b}function hextob64u(b){if(b.length%2==1){b="0"+b}return b64tob64u(hex2b64(b))}function b64utohex(b){return b64tohex(b64utob64(b))}var utf8tob64u,b64utoutf8;if(typeof Buffer==="function"){utf8tob64u=function(b){return b64tob64u(new Buffer(b,"utf8").toString("base64"))};b64utoutf8=function(b){return new Buffer(b64utob64(b),"base64").toString("utf8")}}else{utf8tob64u=function(b){return hextob64u(uricmptohex(encodeURIComponentAll(b)))};b64utoutf8=function(b){return decodeURIComponent(hextouricmp(b64utohex(b)))}}function utf8tob64(b){return hex2b64(uricmptohex(encodeURIComponentAll(b)))}function b64toutf8(b){return decodeURIComponent(hextouricmp(b64tohex(b)))}function utf8tohex(b){return uricmptohex(encodeURIComponentAll(b))}function hextoutf8(b){return decodeURIComponent(hextouricmp(b))}function hextorstr(e){var f="";for(var d=0;d<e.length-1;d+=2){f+=String.fromCharCode(parseInt(e.substr(d,2),16))}return f}function rstrtohex(e){var d="";for(var f=0;f<e.length;f++){d+=("0"+e.charCodeAt(f).toString(16)).slice(-2)}return d}function hextob64(b){return hex2b64(b)}function hextob64nl(f){var d=hextob64(f);var e=d.replace(/(.{64})/g,"$1\r\n");e=e.replace(/\r\n$/,"");return e}function b64nltohex(f){var d=f.replace(/[^0-9A-Za-z\/+=]*/g,"");var e=b64tohex(d);return e}function hextoArrayBuffer(f){if(f.length%2!=0){throw"input is not even length"}if(f.match(/^[0-9A-Fa-f]+$/)==null){throw"input is not hexadecimal"}var i=new ArrayBuffer(f.length/2);var e=new DataView(i);for(var g=0;g<f.length/2;g++){e.setUint8(g,parseInt(f.substr(g*2,2),16))}return i}function ArrayBuffertohex(i){var f="";var e=new DataView(i);for(var g=0;g<i.byteLength;g++){f+=("00"+e.getUint8(g).toString(16)).slice(-2)}return f}function uricmptohex(b){return b.replace(/%/g,"")}function hextouricmp(b){return b.replace(/(..)/g,"%$1")}function encodeURIComponentAll(e){var f=encodeURIComponent(e);var i="";for(var g=0;g<f.length;g++){if(f[g]=="%"){i=i+f.substr(g,3);g=g+2}else{i=i+"%"+stohex(f[g])}}return i}function newline_toUnix(b){b=b.replace(/\r\n/mg,"\n");return b}function newline_toDos(b){b=b.replace(/\r\n/mg,"\n");b=b.replace(/\n/mg,"\r\n");return b}Ext.lang.String.isInteger=function(b){if(b.match(/^[0-9]+$/)){return true}else{if(b.match(/^-[0-9]+$/)){return true}else{return false}}};Ext.lang.String.isHex=function(b){if(b.length%2==0&&(b.match(/^[0-9a-f]+$/)||b.match(/^[0-9A-F]+$/))){return true}else{return false}};Ext.lang.String.isBase64=function(b){b=b.replace(/\s+/g,"");if(b.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&b.length%4==0){return true}else{return false}};Ext.lang.String.isBase64URL=function(b){if(b.match(/[+/=]/)){return false}b=b64utob64(b);return Ext.lang.String.isBase64(b)};Ext.lang.String.isIntegerArray=function(b){b=b.replace(/\s+/g,"");if(b.match(/^\[[0-9,]+\]$/)){return true}else{return false}};function intarystrtohex(f){f=f.replace(/^\s*\[\s*/,"");f=f.replace(/\s*\]\s*$/,"");f=f.replace(/\s*/g,"");try{var e=f.split(/,/).map(function(b,g,j){var c=parseInt(b);if(c<0||255<c){throw"integer not in range 0-255"}var i=("00"+c.toString(16)).slice(-2);return i}).join("");return e}catch(d){throw"malformed integer array string: "+d}}var strdiffidx=function(g,e){var f=g.length;if(g.length>e.length){f=e.length}for(var i=0;i<f;i++){if(g.charCodeAt(i)!=e.charCodeAt(i)){return i}}if(g.length!=e.length){return f}return -1};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414",};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa",};this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160};this.getDigestInfoHex=function(c,d){if(typeof this.DIGESTINFOHEAD[d]=="undefined"){throw"alg not supported in Util.DIGESTINFOHEAD: "+d}return this.DIGESTINFOHEAD[d]+c};this.getPaddedDigestInfoHex=function(m,u,p){var s=this.getDigestInfoHex(m,u);var v=p/4;if(s.length+22>v){throw"key is too short for SigAlg: keylen="+p+","+u}var i="0001";var n="00"+s;var r="";var w=v-i.length-n.length;for(var o=0;o<w;o+=2){r+="ff"}var q=i+r+n;return q};this.hashString=function(d,e){var f=new Ext.crypto.MessageDigest({alg:e});return f.digestString(d)};this.hashHex=function(f,e){var d=new Ext.crypto.MessageDigest({alg:e});return d.digestHex(f)};this.sha1=function(c){var d=new Ext.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return d.digestString(c)};this.sha256=function(c){var d=new Ext.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return d.digestString(c)};this.sha256Hex=function(c){var d=new Ext.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return d.digestHex(c)};this.sha512=function(c){var d=new Ext.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return d.digestString(c)};this.sha512Hex=function(c){var d=new Ext.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return d.digestHex(c)}};Ext.crypto.Util.md5=function(c){var d=new Ext.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return d.digestString(c)};Ext.crypto.Util.ripemd160=function(c){var d=new Ext.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return d.digestString(c)};Ext.crypto.Util.SECURERANDOMGEN=new SecureRandom();Ext.crypto.Util.getRandomHexOfNbytes=function(d){var c=new Array(d);Ext.crypto.Util.SECURERANDOMGEN.nextBytes(c);return BAtohex(c)};Ext.crypto.Util.getRandomBigIntegerOfNbytes=function(b){return new BigInteger(Ext.crypto.Util.getRandomHexOfNbytes(b),16)};Ext.crypto.Util.getRandomHexOfNbits=function(f){var g=f%8;var e=(f-g)/8;var i=new Array(e+1);Ext.crypto.Util.SECURERANDOMGEN.nextBytes(i);i[0]=(((255<<g)&255)^255)&i[0];return BAtohex(i)};Ext.crypto.Util.getRandomBigIntegerOfNbits=function(b){return new BigInteger(Ext.crypto.Util.getRandomHexOfNbits(b),16)};Ext.crypto.Util.getRandomBigIntegerZeroToMax=function(f){var d=f.bitLength();while(1){var e=Ext.crypto.Util.getRandomBigIntegerOfNbits(d);if(f.compareTo(e)!=-1){return e}}};Ext.crypto.Util.getRandomBigIntegerMinToMax=function(j,g){var f=j.compareTo(g);if(f==1){throw"biMin is greater than biMax"}if(f==0){return j}var i=g.subtract(j);var k=Ext.crypto.Util.getRandomBigIntegerZeroToMax(i);return k.add(j)};Ext.crypto.MessageDigest=function(g){var i=null;var e=null;var f=null;this.setAlgAndProvider=function(c,d){c=Ext.crypto.MessageDigest.getCanonicalAlgName(c);if(c!==null&&d===undefined){d=Ext.crypto.Util.DEFAULTPROVIDER[c]}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(c)!=-1&&d=="cryptojs"){try{this.md=Ext.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[c].create()}catch(b){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+b}this.updateString=function(j){this.md.update(j)};this.updateHex=function(k){var j=CryptoJS.enc.Hex.parse(k);this.md.update(j)};this.digest=function(){var j=this.md.finalize();return j.toString(CryptoJS.enc.Hex)};this.digestString=function(j){this.updateString(j);return this.digest()};this.digestHex=function(j){this.updateHex(j);return this.digest()}}if(":sha256:".indexOf(c)!=-1&&d=="sjcl"){try{this.md=new sjcl.hash.sha256()}catch(b){throw"setAlgAndProvider hash alg set fail alg="+c+"/"+b}this.updateString=function(j){this.md.update(j)};this.updateHex=function(j){var k=sjcl.codec.hex.toBits(j);this.md.update(k)};this.digest=function(){var j=this.md.finalize();return sjcl.codec.hex.fromBits(j)};this.digestString=function(j){this.updateString(j);return this.digest()};this.digestHex=function(j){this.updateHex(j);return this.digest()}}};this.updateString=function(b){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.updateHex=function(b){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestString=function(b){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestHex=function(b){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};if(g!==undefined){if(g.alg!==undefined){this.algName=g.alg;if(g.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};Ext.crypto.MessageDigest.getCanonicalAlgName=function(b){if(typeof b==="string"){b=b.toLowerCase();b=b.replace(/-/,"")}return b};Ext.crypto.MessageDigest.getHashLength=function(e){var f=Ext.crypto.MessageDigest;var d=f.getCanonicalAlgName(e);if(f.HASHLENGTH[d]===undefined){throw"not supported algorithm: "+e}return f.HASHLENGTH[d]};Ext.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};Ext.crypto.Mac=function(m){var j=null;var g=null;var i=null;var k=null;var l=null;this.setAlgAndProvider=function(f,c){f=f.toLowerCase();if(f==null){f="hmacsha1"}f=f.toLowerCase();if(f.substr(0,4)!="hmac"){throw"setAlgAndProvider unsupported HMAC alg: "+f}if(c===undefined){c=Ext.crypto.Util.DEFAULTPROVIDER[f]}this.algProv=f+"/"+c;var e=f.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(e)!=-1&&c=="cryptojs"){try{var b=Ext.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[e];this.mac=CryptoJS.algo.HMAC.create(b,this.pass)}catch(d){throw"setAlgAndProvider hash alg set fail hashAlg="+e+"/"+d}this.updateString=function(n){this.mac.update(n)};this.updateHex=function(n){var o=CryptoJS.enc.Hex.parse(n);this.mac.update(o)};this.doFinal=function(){var n=this.mac.finalize();return n.toString(CryptoJS.enc.Hex)};this.doFinalString=function(n){this.updateString(n);return this.doFinal()};this.doFinalHex=function(n){this.updateHex(n);return this.doFinal()}}};this.updateString=function(b){throw"updateString(str) not supported for this alg/prov: "+this.algProv};this.updateHex=function(b){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv};this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv};this.doFinalString=function(b){throw"digestString(str) not supported for this alg/prov: "+this.algProv};this.doFinalHex=function(b){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv};this.setPassword=function(c){if(typeof c=="string"){var b=c;if(c.length%2==1||!c.match(/^[0-9A-Fa-f]+$/)){b=rstrtohex(c)}this.pass=CryptoJS.enc.Hex.parse(b);return}if(typeof c!="object"){throw"Ext.crypto.Mac unsupported password type: "+c}var b=null;if(c.hex!==undefined){if(c.hex.length%2!=0||!c.hex.match(/^[0-9A-Fa-f]+$/)){throw"Mac: wrong hex password: "+c.hex}b=c.hex}if(c.utf8!==undefined){b=utf8tohex(c.utf8)}if(c.rstr!==undefined){b=rstrtohex(c.rstr)}if(c.b64!==undefined){b=b64tohex(c.b64)}if(c.b64u!==undefined){b=b64utohex(c.b64u)}if(b==null){throw"Ext.crypto.Mac unsupported password type: "+c}this.pass=CryptoJS.enc.Hex.parse(b)};if(m!==undefined){if(m.pass!==undefined){this.setPassword(m.pass)}if(m.alg!==undefined){this.algName=m.alg;if(m.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};Ext.crypto.Signature=function(G){var F=null;var A=null;var u=null;var w=null;var B=null;var E=null;var H=null;var D=null;var C=null;var y=null;var K=-1;var I=null;var v=null;var L=null;var x=null;var s=null;this._setAlgNames=function(){var b=this.algName.match(/^(.+)with(.+)$/);if(b){this.mdAlgName=b[1].toLowerCase();this.pubkeyAlgName=b[2].toLowerCase()}};this._zeroPaddingOfSignature=function(f,b){var c="";var e=b/4-f.length;for(var d=0;d<e;d++){c=c+"0"}return c+f};this.setAlgAndProvider=function(c,d){this._setAlgNames();if(d!="cryptojs/jsrsa"){throw"provider not supported: "+d}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new Ext.crypto.MessageDigest({alg:this.mdAlgName})}catch(b){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+b}this.init=function(g,i){var f=null;try{if(i===undefined){f=KEYUTIL.getKey(g)}else{f=KEYUTIL.getKey(g,i)}}catch(e){throw"init failed:"+e}if(f.isPrivate===true){this.prvKey=f;this.state="SIGN"}else{if(f.isPublic===true){this.pubKey=f;this.state="VERIFY"}else{throw"init failed.:"+f}}};this.initSign=function(e){if(typeof e.ecprvhex=="string"&&typeof e.eccurvename=="string"){this.ecprvhex=e.ecprvhex;this.eccurvename=e.eccurvename}else{this.prvKey=e}this.state="SIGN"};this.initVerifyByPublicKey=function(e){if(typeof e.ecpubhex=="string"&&typeof e.eccurvename=="string"){this.ecpubhex=e.ecpubhex;this.eccurvename=e.eccurvename}else{if(e instanceof Ext.crypto.ECDSA){this.pubKey=e}else{if(e instanceof RSAKey){this.pubKey=e}}}this.state="VERIFY"};this.initVerifyByCertificatePEM=function(f){var e=new X509();e.readCertPEM(f);this.pubKey=e.subjectPublicKeyRSA;this.state="VERIFY"};this.updateString=function(e){this.md.updateString(e)};this.updateHex=function(e){this.md.updateHex(e)};this.sign=function(){this.sHashHex=this.md.digest();if(typeof this.ecprvhex!="undefined"&&typeof this.eccurvename!="undefined"){var e=new Ext.crypto.ECDSA({curve:this.eccurvename});this.hSign=e.signHex(this.sHashHex,this.ecprvhex)}else{if(this.prvKey instanceof RSAKey&&this.pubkeyAlgName=="rsaandmgf1"){this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen)}else{if(this.prvKey instanceof RSAKey&&this.pubkeyAlgName=="rsa"){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName)}else{if(this.prvKey instanceof Ext.crypto.ECDSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{if(this.prvKey instanceof Ext.crypto.DSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}return this.hSign};this.signString=function(e){this.updateString(e);return this.sign()};this.signHex=function(e){this.updateHex(e);return this.sign()};this.verify=function(f){this.sHashHex=this.md.digest();if(typeof this.ecpubhex!="undefined"&&typeof this.eccurvename!="undefined"){var e=new Ext.crypto.ECDSA({curve:this.eccurvename});return e.verifyHex(this.sHashHex,f,this.ecpubhex)}else{if(this.pubKey instanceof RSAKey&&this.pubkeyAlgName=="rsaandmgf1"){return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,f,this.mdAlgName,this.pssSaltLen)}else{if(this.pubKey instanceof RSAKey&&this.pubkeyAlgName=="rsa"){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{if(this.pubKey instanceof Ext.crypto.ECDSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{if(this.pubKey instanceof Ext.crypto.DSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,f)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}}}};this.init=function(b,c){throw"init(key, pass) not supported for this alg:prov="+this.algProvName};this.initVerifyByPublicKey=function(b){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName};this.initVerifyByCertificatePEM=function(b){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName};this.initSign=function(b){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName};this.updateString=function(b){throw"updateString(str) not supported for this alg:prov="+this.algProvName};this.updateHex=function(b){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName};this.signString=function(b){throw"digestString(str) not supported for this alg:prov="+this.algProvName};this.signHex=function(b){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName};this.verify=function(b){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName};this.initParams=G;if(G!==undefined){if(G.alg!==undefined){this.algName=G.alg;if(G.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}else{this.provName=G.prov}this.algProvName=this.algName+":"+this.provName;this.setAlgAndProvider(this.algName,this.provName);this._setAlgNames()}if(G.psssaltlen!==undefined){this.pssSaltLen=G.psssaltlen}if(G.prvkeypem!==undefined){if(G.prvkeypas!==undefined){throw"both prvkeypem and prvkeypas parameters not supported"}else{try{var F=new RSAKey();F.readPrivateKeyFromPEMString(G.prvkeypem);this.initSign(F)}catch(J){throw"fatal error to load pem private key: "+J}}}}};Ext.crypto.Cipher=function(b){};Ext.crypto.Cipher.encrypt=function(k,j,l){if(j instanceof RSAKey&&j.isPublic){var g=Ext.crypto.Cipher.getAlgByKeyAndName(j,l);if(g==="RSA"){return j.encrypt(k)}if(g==="RSAOAEP"){return j.encryptOAEP(k,"sha1")}var i=g.match(/^RSAOAEP(\d+)$/);if(i!==null){return j.encryptOAEP(k,"sha"+i[1])}throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+l}else{throw"Cipher.encrypt: unsupported key or algorithm"}};Ext.crypto.Cipher.decrypt=function(k,j,l){if(j instanceof RSAKey&&j.isPrivate){var g=Ext.crypto.Cipher.getAlgByKeyAndName(j,l);if(g==="RSA"){return j.decrypt(k)}if(g==="RSAOAEP"){return j.decryptOAEP(k,"sha1")}var i=g.match(/^RSAOAEP(\d+)$/);if(i!==null){return j.decryptOAEP(k,"sha"+i[1])}throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+l}else{throw"Cipher.decrypt: unsupported key or algorithm"}};Ext.crypto.Cipher.getAlgByKeyAndName=function(d,c){if(d instanceof RSAKey){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(c)!=-1){return c}if(c===null||c===undefined){return"RSA"}throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+c}throw"getAlgByKeyAndName: not supported algorithm name: "+c};Ext.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA",}};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.ECDSA=function(i){var m="secp256r1";var o=null;var l=null;var p=null;var n=new SecureRandom();var k=null;this.type="EC";this.isPrivate=false;this.isPublic=false;function j(f,b,q,d){var g=Math.max(b.bitLength(),d.bitLength());var r=f.add2D(q);var c=f.curve.getInfinity();for(var e=g-1;e>=0;--e){c=c.twice2D();c.z=BigInteger.ONE;if(b.testBit(e)){if(d.testBit(e)){c=c.add2D(r)}else{c=c.add2D(f)}}else{if(d.testBit(e)){c=c.add2D(q)}}}return c}this.getBigRandom=function(b){return new BigInteger(b.bitLength(),n).mod(b.subtract(BigInteger.ONE)).add(BigInteger.ONE)};this.setNamedCurve=function(b){this.ecparams=Ext.crypto.ECParameterDB.getByName(b);this.prvKeyHex=null;this.pubKeyHex=null;this.curveName=b};this.setPrivateKeyHex=function(b){this.isPrivate=true;this.prvKeyHex=b};this.setPublicKeyHex=function(b){this.isPublic=true;this.pubKeyHex=b};this.getPublicKeyXYHex=function(){var c=this.pubKeyHex;if(c.substr(0,2)!=="04"){throw"this method supports uncompressed format(04) only"}var d=this.ecparams.keylen/4;if(c.length!==2+d*2){throw"malformed public key hex length"}var b={};b.x=c.substr(2,d);b.y=c.substr(2+d);return b};this.getShortNISTPCurveName=function(){var b=this.curveName;if(b==="secp256r1"||b==="NIST P-256"||b==="P-256"||b==="prime256v1"){return"P-256"}if(b==="secp384r1"||b==="NIST P-384"||b==="P-384"){return"P-384"}return null};this.generateKeyPairHex=function(){var u=this.ecparams.n;var q=this.getBigRandom(u);var s=this.ecparams.G.multiply(q);var e=s.getX().toBigInteger();var g=s.getY().toBigInteger();var c=this.ecparams.keylen/4;var r=("0000000000"+q.toString(16)).slice(-c);var d=("0000000000"+e.toString(16)).slice(-c);var f=("0000000000"+g.toString(16)).slice(-c);var b="04"+d+f;this.setPrivateKeyHex(r);this.setPublicKeyHex(b);return{ecprvhex:r,ecpubhex:b}};this.signWithMessageHash=function(b){return this.signHex(b,this.prvKeyHex)};this.signHex=function(e,q){var b=new BigInteger(q,16);var g=this.ecparams.n;var c=new BigInteger(e,16);do{var f=this.getBigRandom(g);var w=this.ecparams.G;var d=w.multiply(f);var r=d.getX().toBigInteger().mod(g)}while(r.compareTo(BigInteger.ZERO)<=0);var s=f.modInverse(g).multiply(c.add(b.multiply(r))).mod(g);return Ext.crypto.ECDSA.biRSSigToASN1Sig(r,s)};this.sign=function(f,w){var c=w;var q=this.ecparams.n;var d=BigInteger.fromByteArrayUnsigned(f);do{var g=this.getBigRandom(q);var b=this.ecparams.G;var e=b.multiply(g);var r=e.getX().toBigInteger().mod(q)}while(r.compareTo(BigInteger.ZERO)<=0);var s=g.modInverse(q).multiply(d.add(c.multiply(r))).mod(q);return this.serializeSig(r,s)};this.verifyWithMessageHash=function(c,b){return this.verifyHex(c,b,this.pubKeyHex)};this.verifyHex=function(f,b,c){var q,g;var d=Ext.crypto.ECDSA.parseSigHex(b);q=d.r;g=d.s;var r;r=ECPointFp.decodeFromHex(this.ecparams.curve,c);var e=new BigInteger(f,16);return this.verifyRaw(e,q,g,r)};this.verify=function(b,c,f){var g,d;if(Bitcoin.Util.isArray(c)){var e=this.parseSig(c);g=e.r;d=e.s}else{if("object"===typeof c&&c.r&&c.s){g=c.r;d=c.s}else{throw"Invalid value for signature"}}var q;if(f instanceof ECPointFp){q=f}else{if(Bitcoin.Util.isArray(f)){q=ECPointFp.decodeFrom(this.ecparams.curve,f)}else{throw"Invalid format for pubkey value, must be byte array or ECPointFp"}}var r=BigInteger.fromByteArrayUnsigned(b);return this.verifyRaw(r,g,d,q)};this.verifyRaw=function(f,d,v,g){var q=this.ecparams.n;var x=this.ecparams.G;if(d.compareTo(BigInteger.ONE)<0||d.compareTo(q)>=0){return false}if(v.compareTo(BigInteger.ONE)<0||v.compareTo(q)>=0){return false}var e=v.modInverse(q);var r=f.multiply(e).mod(q);var s=d.multiply(e).mod(q);var b=x.multiply(r).add(g.multiply(s));var c=b.getX().toBigInteger().mod(q);return c.equals(d)};this.serializeSig=function(c,d){var b=c.toByteArraySigned();var e=d.toByteArraySigned();var f=[];f.push(2);f.push(b.length);f=f.concat(b);f.push(2);f.push(e.length);f=f.concat(e);f.unshift(f.length);f.unshift(48);return f};this.parseSig=function(c){var d;if(c[0]!=48){throw new Error("Signature not a valid DERSequence")}d=2;if(c[d]!=2){throw new Error("First element in signature must be a DERInteger")}var e=c.slice(d+2,d+2+c[d+1]);d+=2+c[d+1];if(c[d]!=2){throw new Error("Second element in signature must be a DERInteger")}var b=c.slice(d+2,d+2+c[d+1]);d+=2+c[d+1];var f=BigInteger.fromByteArrayUnsigned(e);var g=BigInteger.fromByteArrayUnsigned(b);return{r:f,s:g}};this.parseSigCompact=function(f){if(f.length!==65){throw"Signature has the wrong length"}var d=f[0]-27;if(d<0||d>7){throw"Invalid signature type"}var e=this.ecparams.n;var b=BigInteger.fromByteArrayUnsigned(f.slice(1,33)).mod(e);var c=BigInteger.fromByteArrayUnsigned(f.slice(33,65)).mod(e);return{r:b,s:c,i:d}};this.readPKCS5PrvKeyHex=function(f){var b=ASN1HEX;var q=Ext.crypto.ECDSA.getName;var d=b.getVbyList;if(b.isASN1HEX(f)===false){throw"not ASN.1 hex string"}var c,g,e;try{c=d(f,0,[2,0],"06");g=d(f,0,[1],"04");try{e=d(f,0,[3,0],"03").substr(2)}catch(r){}}catch(r){throw"malformed PKCS#1/5 plain ECC private key"}this.curveName=q(c);if(this.curveName===undefined){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(e);this.setPrivateKeyHex(g);this.isPublic=false};this.readPKCS8PrvKeyHex=function(q){var c=ASN1HEX;var b=Ext.crypto.ECDSA.getName;var f=c.getVbyList;if(c.isASN1HEX(q)===false){throw"not ASN.1 hex string"}var s,d,g,r;try{s=f(q,0,[1,0],"06");d=f(q,0,[1,1],"06");g=f(q,0,[2,0,1],"04");try{r=f(q,0,[2,0,2,0],"03").substr(2)}catch(e){}}catch(e){throw"malformed PKCS#8 plain ECC private key"}this.curveName=b(d);if(this.curveName===undefined){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(r);this.setPrivateKeyHex(g);this.isPublic=false};this.readPKCS8PubKeyHex=function(f){var b=ASN1HEX;var q=Ext.crypto.ECDSA.getName;var d=b.getVbyList;if(b.isASN1HEX(f)===false){throw"not ASN.1 hex string"}var g,c,e;try{g=d(f,0,[0,0],"06");c=d(f,0,[0,1],"06");e=d(f,0,[1],"03").substr(2)}catch(r){throw"malformed PKCS#8 ECC public key"}this.curveName=q(c);if(this.curveName===null){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(e)};this.readCertPubKeyHex=function(f,b){if(b!==5){b=6}var g=ASN1HEX;var q=Ext.crypto.ECDSA.getName;var c=g.getVbyList;if(g.isASN1HEX(f)===false){throw"not ASN.1 hex string"}var d,e;try{d=c(f,0,[0,b,0,1],"06");e=c(f,0,[0,b,1],"03").substr(2)}catch(r){throw"malformed X.509 certificate ECC public key"}this.curveName=q(d);if(this.curveName===null){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(e)};if(i!==undefined){if(i.curve!==undefined){this.curveName=i.curve}}if(this.curveName===undefined){this.curveName=m}this.setNamedCurve(this.curveName);if(i!==undefined){if(i.prv!==undefined){this.setPrivateKeyHex(i.prv)}if(i.pub!==undefined){this.setPublicKeyHex(i.pub)}}};Ext.crypto.ECDSA.parseSigHex=function(e){var i=Ext.crypto.ECDSA.parseSigHexInHexRS(e);var f=new BigInteger(i.r,16);var g=new BigInteger(i.s,16);return{r:f,s:g}};Ext.crypto.ECDSA.parseSigHexInHexRS=function(l){if(l.substr(0,2)!="30"){throw"signature is not a ASN.1 sequence"}var m=ASN1HEX.getPosArrayOfChildren_AtObj(l,0);if(m.length!=2){throw"number of signature ASN.1 sequence elements seem wrong"}var n=m[0];var i=m[1];if(l.substr(n,2)!="02"){throw"1st item of sequene of signature is not ASN.1 integer"}if(l.substr(i,2)!="02"){throw"2nd item of sequene of signature is not ASN.1 integer"}var j=ASN1HEX.getHexOfV_AtObj(l,n);var k=ASN1HEX.getHexOfV_AtObj(l,i);return{r:j,s:k}};Ext.crypto.ECDSA.asn1SigToConcatSig=function(g){var f=Ext.crypto.ECDSA.parseSigHexInHexRS(g);var i=f.r;var e=f.s;if(i.substr(0,2)=="00"&&(((i.length/2)*8)%(16*8))==8){i=i.substr(2)}if(e.substr(0,2)=="00"&&(((e.length/2)*8)%(16*8))==8){e=e.substr(2)}if((((i.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig r length error"}if((((e.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig s length error"}return i+e};Ext.crypto.ECDSA.concatSigToASN1Sig=function(d){if((((d.length/2)*8)%(16*8))!=0){throw"unknown ECDSA concatinated r-s sig  length error"}var e=d.substr(0,d.length/2);var f=d.substr(d.length/2);return Ext.crypto.ECDSA.hexRSSigToASN1Sig(e,f)};Ext.crypto.ECDSA.hexRSSigToASN1Sig=function(i,e){var f=new BigInteger(i,16);var g=new BigInteger(e,16);return Ext.crypto.ECDSA.biRSSigToASN1Sig(f,g)};Ext.crypto.ECDSA.biRSSigToASN1Sig=function(j,f){var g=new Ext.asn1.DERInteger({bigint:j});var i=new Ext.asn1.DERInteger({bigint:f});var k=new Ext.asn1.DERSequence({array:[g,i]});return k.getEncodedHex()};Ext.crypto.ECDSA.getName=function(b){if(b==="2a8648ce3d030107"){return"secp256r1"}if(b==="2b8104000a"){return"secp256k1"}if(b==="2b81040022"){return"secp384r1"}if("|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(b)!==-1){return"secp256r1"}if("|secp256k1|".indexOf(b)!==-1){return"secp256k1"}if("|secp384r1|NIST P-384|P-384|".indexOf(b)!==-1){return"secp384r1"}return null};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.ECParameterDB=new function(){var f={};var e={};function d(b){return new BigInteger(b,16)}this.getByName=function(c){var b=c;if(typeof e[b]!="undefined"){b=e[c]}if(typeof f[b]!="undefined"){return f[b]}throw"unregistered EC curve name: "+b};this.regist=function(D,I,E,L,H,N,K,M,J,i,O,g){f[D]={};var p=d(E);var b=d(L);var c=d(H);var n=d(N);var F=d(K);var B=new ECCurveFp(p,b,c);var C=B.decodePointHex("04"+M+J);f[D]["name"]=D;f[D]["keylen"]=I;f[D]["curve"]=B;f[D]["G"]=C;f[D]["n"]=n;f[D]["h"]=F;f[D]["oid"]=O;f[D]["info"]=g;for(var G=0;G<i.length;G++){e[i[G]]=D}}};Ext.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");Ext.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");Ext.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");Ext.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);Ext.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);Ext.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);Ext.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);Ext.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);Ext.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);Ext.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.DSA=function(){this.p=null;this.q=null;this.g=null;this.y=null;this.x=null;this.type="DSA";this.isPrivate=false;this.isPublic=false;this.setPrivate=function(k,f,g,j,i){this.isPrivate=true;this.p=k;this.q=f;this.g=g;this.y=j;this.x=i};this.setPrivateHex=function(q,s,o,l,k){var r,u,p,n,m;r=new BigInteger(q,16);u=new BigInteger(s,16);p=new BigInteger(o,16);if(typeof l==="string"&&l.length>1){n=new BigInteger(l,16)}else{n=null}m=new BigInteger(k,16);this.setPrivate(r,u,p,n,m)};this.setPublic=function(g,i,e,f){this.isPublic=true;this.p=g;this.q=i;this.g=e;this.y=f;this.x=null};this.setPublicHex=function(i,m,l,o){var k,p,n,j;k=new BigInteger(i,16);p=new BigInteger(m,16);n=new BigInteger(l,16);j=new BigInteger(o,16);this.setPublic(k,p,n,j)};this.signWithMessageHash=function(o){var p=this.p;var q=this.q;var g=this.g;var x=this.y;var w=this.x;var k=Ext.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),q.subtract(BigInteger.ONE));var v=o.substr(0,q.bitLength()/4);var y=new BigInteger(v,16);var r=(g.modPow(k,p)).mod(q);var s=(k.modInverse(q).multiply(y.add(w.multiply(r)))).mod(q);var u=Ext.asn1.ASN1Util.jsonToASN1HEX({seq:[{"int":{bigint:r}},{"int":{bigint:s}}]});return u};this.verifyWithMessageHash=function(C,q){var s=this.p;var x=this.q;var A=this.g;var y=this.y;var r=this.parseASN1Signature(q);var u=r[0];var E=r[1];var g=C.substr(0,x.bitLength()/4);var B=new BigInteger(g,16);if(BigInteger.ZERO.compareTo(u)>0||u.compareTo(x)>0){throw"invalid DSA signature"}if(BigInteger.ZERO.compareTo(E)>0||E.compareTo(x)>0){throw"invalid DSA signature"}var v=E.modInverse(x);var D=B.multiply(v).mod(x);var p=u.multiply(v).mod(x);var w=A.modPow(D,s).multiply(y.modPow(p,s)).mod(s).mod(x);return w.compareTo(u)==0};this.parseASN1Signature=function(e){try{var f=new BigInteger(ASN1HEX.getVbyList(e,0,[0],"02"),16);var g=new BigInteger(ASN1HEX.getVbyList(e,0,[1],"02"),16);return[f,g]}catch(i){throw"malformed ASN.1 DSA signature"}};this.readPKCS5PrvKeyHex=function(q){var r,s,n,m,l;var k=ASN1HEX;var p=k.getVbyList;if(k.isASN1HEX(q)===false){throw"not ASN.1 hex string"}try{r=p(q,0,[1],"02");s=p(q,0,[2],"02");n=p(q,0,[3],"02");m=p(q,0,[4],"02");l=p(q,0,[5],"02")}catch(o){console.log("EXCEPTION:"+o);throw"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(r,s,n,m,l)};this.readPKCS8PrvKeyHex=function(m){var o,p,j,q;var k=ASN1HEX;var n=k.getVbyList;if(k.isASN1HEX(m)===false){throw"not ASN.1 hex string"}try{o=n(m,0,[1,1,0],"02");p=n(m,0,[1,1,1],"02");j=n(m,0,[1,1,2],"02");q=n(m,0,[2,0],"02")}catch(l){console.log("EXCEPTION:"+l);throw"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(o,p,j,null,q)};this.readPKCS8PubKeyHex=function(m){var o,p,j,q;var k=ASN1HEX;var n=k.getVbyList;if(k.isASN1HEX(m)===false){throw"not ASN.1 hex string"}try{o=n(m,0,[0,1,0],"02");p=n(m,0,[0,1,1],"02");j=n(m,0,[0,1,2],"02");q=n(m,0,[1,0],"02")}catch(l){console.log("EXCEPTION:"+l);throw"malformed PKCS#8 DSA public key"}this.setPublicHex(o,p,j,q)};this.readCertPubKeyHex=function(q,n){if(n!==5){n=6}var r,s,m,l;var k=ASN1HEX;var p=k.getVbyList;if(k.isASN1HEX(q)===false){throw"not ASN.1 hex string"}try{r=p(q,0,[0,n,0,1,0],"02");s=p(q,0,[0,n,0,1,1],"02");m=p(q,0,[0,n,0,1,2],"02");l=p(q,0,[0,n,1,0],"02")}catch(o){console.log("EXCEPTION:"+o);throw"malformed X.509 certificate DSA public key"}this.setPublicHex(r,s,m,l)}};var PKCS5PKEY=function(){var q=function(b,c,d){return v(CryptoJS.AES,b,c,d)};var s=function(b,c,d){return v(CryptoJS.TripleDES,b,c,d)};var v=function(k,e,i,c){var b=CryptoJS.enc.Hex.parse(e);var f=CryptoJS.enc.Hex.parse(i);var d=CryptoJS.enc.Hex.parse(c);var j={};j.key=f;j.iv=d;j.ciphertext=b;var g=k.decrypt(j,f,{iv:d});return CryptoJS.enc.Hex.stringify(g)};var C=function(b,c,d){return r(CryptoJS.AES,b,c,d)};var B=function(b,c,d){return r(CryptoJS.TripleDES,b,c,d)};var r=function(m,g,k,c){var b=CryptoJS.enc.Hex.parse(g);var i=CryptoJS.enc.Hex.parse(k);var d=CryptoJS.enc.Hex.parse(c);var f={};var e=m.encrypt(b,i,{iv:d});var l=CryptoJS.enc.Hex.parse(e.toString());var j=CryptoJS.enc.Base64.stringify(l);return j};var A={"AES-256-CBC":{proc:q,eproc:C,keylen:32,ivlen:16},"AES-192-CBC":{proc:q,eproc:C,keylen:24,ivlen:16},"AES-128-CBC":{proc:q,eproc:C,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:s,eproc:B,keylen:24,ivlen:8}};var w=function(b){return A[b]["proc"]};var o=function(b){var c=CryptoJS.lib.WordArray.random(b);var d=CryptoJS.enc.Hex.stringify(c);return d};var x=function(j){var i={};var e=j.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));if(e){i.cipher=e[1];i.ivsalt=e[2]}var f=j.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));if(f){i.type=f[1]}var b=-1;var g=0;if(j.indexOf("\r\n\r\n")!=-1){b=j.indexOf("\r\n\r\n");g=2}if(j.indexOf("\n\n")!=-1){b=j.indexOf("\n\n");g=1}var c=j.indexOf("-----END");if(b!=-1&&c!=-1){var d=j.substring(b+g*2,c-g);d=d.replace(/\s+/g,"");i.data=d}return i};var p=function(d,i,f){var l=f.substring(0,16);var b=CryptoJS.enc.Hex.parse(l);var c=CryptoJS.enc.Utf8.parse(i);var m=A[d]["keylen"]+A[d]["ivlen"];var k="";var g=null;for(;;){var j=CryptoJS.algo.MD5.create();if(g!=null){j.update(g)}j.update(c);j.update(b);g=j.finalize();k=k+CryptoJS.enc.Hex.stringify(g);if(k.length>=m*2){break}}var e={};e.keyhex=k.substr(0,A[d]["keylen"]*2);e.ivhex=k.substr(A[d]["keylen"]*2,A[d]["ivlen"]*2);return e};var y=function(f,i,d,g){var c=CryptoJS.enc.Base64.parse(f);var e=CryptoJS.enc.Hex.stringify(c);var j=A[i]["proc"];var b=j(e,d,g);return b};var u=function(b,e,g,c){var f=A[e]["eproc"];var d=f(b,g,c);return d};return{version:"1.0.5",getHexFromPEM:function(b,c){return ASN1HEX.pemToHex(b,c)},getDecryptedKeyHexByKeyIV:function(d,f,b,c){var e=w(f);return e(d,b,c)},parsePKCS5PEM:function(b){return x(b)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(d,b,c){return p(d,b,c)},decryptKeyB64:function(b,d,e,c){return y(b,d,e,c)},getDecryptedKeyHex:function(k,l){var i=x(k);var e=i.type;var g=i.cipher;var j=i.ivsalt;var f=i.data;var b=p(g,l,j);var c=b.keyhex;var d=y(f,g,c,j);return d},getRSAKeyFromEncryptedPKCS5PEM:function(d,e){var c=this.getDecryptedKeyHex(d,e);var b=new RSAKey();b.readPrivateKeyFromASN1HexString(c);return b},getEncryptedPKCS5PEMFromPrvKeyHex:function(c,g,m,d){if(typeof m=="undefined"||m==null){m="AES-256-CBC"}if(typeof A[m]=="undefined"){throw"PKCS5PKEY unsupported algorithm: "+m}if(typeof d=="undefined"||d==null){var k=A[m]["ivlen"];var l=o(k);d=l.toUpperCase()}var i=p(m,g,d);var j=i.keyhex;var f=u(c,m,j,d);var e=f.replace(/(.{64})/g,"$1\r\n");var b="-----BEGIN RSA PRIVATE KEY-----\r\n";b+="Proc-Type: 4,ENCRYPTED\r\n";b+="DEK-Info: "+m+","+d+"\r\n";b+="\r\n";b+=e;b+="\r\n-----END RSA PRIVATE KEY-----\r\n";return b},getEncryptedPKCS5PEMFromRSAKey:function(G,f,k,n){var m=new Ext.asn1.DERInteger({"int":0});var d=new Ext.asn1.DERInteger({bigint:G.n});var b=new Ext.asn1.DERInteger({"int":G.e});var F=new Ext.asn1.DERInteger({bigint:G.d});var l=new Ext.asn1.DERInteger({bigint:G.p});var i=new Ext.asn1.DERInteger({bigint:G.q});var g=new Ext.asn1.DERInteger({bigint:G.dmp1});var c=new Ext.asn1.DERInteger({bigint:G.dmq1});var j=new Ext.asn1.DERInteger({bigint:G.coeff});var e=new Ext.asn1.DERSequence({array:[m,d,b,F,l,i,g,c,j]});var D=e.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex(D,f,k,n)},newEncryptedPKCS5PEM:function(b,g,d,c){if(typeof g=="undefined"||g==null){g=1024}if(typeof d=="undefined"||d==null){d="10001"}var f=new RSAKey();f.generate(g,d);var e=null;if(typeof c=="undefined"||c==null){e=this.getEncryptedPKCS5PEMFromRSAKey(pkey,b)}else{e=this.getEncryptedPKCS5PEMFromRSAKey(pkey,b,c)}return e},getRSAKeyFromPlainPKCS8PEM:function(c){if(c.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var d=ASN1HEX.pemToHex(c,"PRIVATE KEY");var b=this.getRSAKeyFromPlainPKCS8Hex(d);return b},getRSAKeyFromPlainPKCS8Hex:function(c){var b=new RSAKey();b.readPKCS8PrvKeyHex(c);return b},parseHexOfEncryptedPKCS8:function(b){var f={};var g=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(g.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+g.length}f.ciphertext=ASN1HEX.getHexOfV_AtObj(b,g[1]);var k=ASN1HEX.getPosArrayOfChildren_AtObj(b,g[0]);if(k.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+k.length}if(ASN1HEX.getHexOfV_AtObj(b,k[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var j=ASN1HEX.getPosArrayOfChildren_AtObj(b,k[1]);if(k.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+j.length}var i=ASN1HEX.getPosArrayOfChildren_AtObj(b,j[1]);if(i.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+i.length}if(ASN1HEX.getHexOfV_AtObj(b,i[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}f.encryptionSchemeAlg="TripleDES";f.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(b,i[1]);var e=ASN1HEX.getPosArrayOfChildren_AtObj(b,j[0]);if(e.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+e.length}if(ASN1HEX.getHexOfV_AtObj(b,e[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var l=ASN1HEX.getPosArrayOfChildren_AtObj(b,e[1]);if(l.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+l.length}f.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(b,l[0]);var d=ASN1HEX.getHexOfV_AtObj(b,l[1]);try{f.pbkdf2Iter=parseInt(d,16)}catch(c){throw"malformed format pbkdf2Iter: "+d}return f},getPBKDF2KeyHexFromParam:function(c,b){var d=CryptoJS.enc.Hex.parse(c.pbkdf2Salt);var g=c.pbkdf2Iter;var e=CryptoJS.PBKDF2(b,d,{keySize:192/32,iterations:g});var f=CryptoJS.enc.Hex.stringify(e);return f},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(l,k){var g=ASN1HEX.pemToHex(l,"ENCRYPTED PRIVATE KEY");var j=this.parseHexOfEncryptedPKCS8(g);var d=PKCS5PKEY.getPBKDF2KeyHexFromParam(j,k);var c={};c.ciphertext=CryptoJS.enc.Hex.parse(j.ciphertext);var e=CryptoJS.enc.Hex.parse(d);var f=CryptoJS.enc.Hex.parse(j.encryptionSchemeIV);var b=CryptoJS.TripleDES.decrypt(c,e,{iv:f});var i=CryptoJS.enc.Hex.stringify(b);return i},getRSAKeyFromEncryptedPKCS8PEM:function(c,d){var e=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(c,d);var b=this.getRSAKeyFromPlainPKCS8Hex(e);return b},getKeyFromEncryptedPKCS8PEM:function(c,e){var b=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(c,e);var d=this.getKeyFromPlainPrivatePKCS8Hex(b);return d},parsePlainPrivatePKCS8Hex:function(c){var e={};e.algparam=null;if(c.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(c.substr(d[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var b=ASN1HEX.getPosArrayOfChildren_AtObj(c,d[1]);if(b.length!=2){throw"malformed PKCS8 private key(code:004)"}if(c.substr(b[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}e.algoid=ASN1HEX.getHexOfV_AtObj(c,b[0]);if(c.substr(b[1],2)=="06"){e.algparam=ASN1HEX.getHexOfV_AtObj(c,b[1])}if(c.substr(d[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}e.keyidx=ASN1HEX.getStartPosOfV_AtObj(c,d[2]);return e},getKeyFromPlainPrivatePKCS8PEM:function(d){var b=ASN1HEX.pemToHex(d,"PRIVATE KEY");var c=this.getKeyFromPlainPrivatePKCS8Hex(b);return c},getKeyFromPlainPrivatePKCS8Hex:function(b){var d=this.parsePlainPrivatePKCS8Hex(b);var c;if(d.algoid=="2a864886f70d010101"){c=new RSAKey()}else{if(d.algoid=="2a8648ce380401"){c=new Ext.crypto.DSA()}else{if(d.algoid=="2a8648ce3d0201"){c=new Ext.crypto.ECDSA()}else{throw"unsupported private key algorithm"}}}c.readPKCS8PrvKeyHex(b);return c},getRSAKeyFromPublicPKCS8PEM:function(d){var c=ASN1HEX.pemToHex(d,"PUBLIC KEY");var b=this.getRSAKeyFromPublicPKCS8Hex(c);return b},getKeyFromPublicPKCS8PEM:function(d){var c=ASN1HEX.pemToHex(d,"PUBLIC KEY");var b=this.getKeyFromPublicPKCS8Hex(c);return b},getKeyFromPublicPKCS8Hex:function(b){var d;var c=ASN1HEX.getVbyList(h,0,[0,0],"06");if(c==="2a864886f70d010101"){d=new RSAKey()}else{if(c==="2a8648ce380401"){d=new Ext.crypto.DSA()}else{if(c==="2a8648ce3d0201"){d=new Ext.crypto.ECDSA()}else{throw"unsupported PKCS#8 public key hex"}}}d.readPKCS8PubKeyHex(h);return d},parsePublicRawRSAKeyHex:function(c){var b={};if(c.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=2){throw"malformed RSA key(code:002)"}if(c.substr(d[0],2)!="02"){throw"malformed RSA key(code:003)"}b.n=ASN1HEX.getHexOfV_AtObj(c,d[0]);if(c.substr(d[1],2)!="02"){throw"malformed RSA key(code:004)"}b.e=ASN1HEX.getHexOfV_AtObj(c,d[1]);return b},parsePrivateRawRSAKeyHexAtObj:function(e,c){var d=c.keyidx;if(e.substr(d,2)!="30"){throw"malformed RSA private key(code:001)"}var b=ASN1HEX.getPosArrayOfChildren_AtObj(e,d);if(b.length!=9){throw"malformed RSA private key(code:002)"}c.key={};c.key.n=ASN1HEX.getHexOfV_AtObj(e,b[1]);c.key.e=ASN1HEX.getHexOfV_AtObj(e,b[2]);c.key.d=ASN1HEX.getHexOfV_AtObj(e,b[3]);c.key.p=ASN1HEX.getHexOfV_AtObj(e,b[4]);c.key.q=ASN1HEX.getHexOfV_AtObj(e,b[5]);c.key.dp=ASN1HEX.getHexOfV_AtObj(e,b[6]);c.key.dq=ASN1HEX.getHexOfV_AtObj(e,b[7]);c.key.co=ASN1HEX.getHexOfV_AtObj(e,b[8])},parsePrivateRawECKeyHexAtObj:function(e,c){var d=c.keyidx;if(e.substr(d,2)!="30"){throw"malformed ECC private key(code:001)"}var b=ASN1HEX.getPosArrayOfChildren_AtObj(e,d);if(b.length!=3){throw"malformed ECC private key(code:002)"}if(e.substr(b[1],2)!="04"){throw"malformed ECC private key(code:003)"}c.key=ASN1HEX.getHexOfV_AtObj(e,b[1])},parsePublicPKCS8Hex:function(b){var d={};d.algparam=null;var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=2){throw"outer DERSequence shall have 2 elements: "+c.length}var f=c[0];if(b.substr(f,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(b,f);if(e.length!=2){throw"malformed PKCS8 public key(code:002)"}if(b.substr(e[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}d.algoid=ASN1HEX.getHexOfV_AtObj(b,e[0]);if(b.substr(e[1],2)=="06"){d.algparam=ASN1HEX.getHexOfV_AtObj(b,e[1])}if(b.substr(c[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}d.key=ASN1HEX.getHexOfV_AtObj(b,c[1]).substr(2);return d},getRSAKeyFromPublicPKCS8Hex:function(b){var c=new RSAKey();c.readPKCS8PubKeyHex(b);return c},}}();var KEYUTIL=function(){var w=function(b,c,d){return q(CryptoJS.AES,b,c,d)};var x=function(b,c,d){return q(CryptoJS.TripleDES,b,c,d)};var F=function(b,c,d){return q(CryptoJS.DES,b,c,d)};var q=function(g,b,e,j){var i=CryptoJS.enc.Hex.parse(b);var c=CryptoJS.enc.Hex.parse(e);var k=CryptoJS.enc.Hex.parse(j);var f={};f.key=c;f.iv=k;f.ciphertext=i;var d=g.decrypt(f,c,{iv:k});return CryptoJS.enc.Hex.stringify(d)};var E=function(b,c,d){return v(CryptoJS.AES,b,c,d)};var u=function(b,c,d){return v(CryptoJS.TripleDES,b,c,d)};var s=function(b,c,d){return v(CryptoJS.DES,b,c,d)};var v=function(c,i,l,f){var d=CryptoJS.enc.Hex.parse(i);var j=CryptoJS.enc.Hex.parse(l);var g=CryptoJS.enc.Hex.parse(f);var k=c.encrypt(d,j,{iv:g});var e=CryptoJS.enc.Hex.parse(k.toString());var b=CryptoJS.enc.Base64.stringify(e);return b};var p={"AES-256-CBC":{proc:w,eproc:E,keylen:32,ivlen:16},"AES-192-CBC":{proc:w,eproc:E,keylen:24,ivlen:16},"AES-128-CBC":{proc:w,eproc:E,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:x,eproc:u,keylen:24,ivlen:8},"DES-CBC":{proc:F,eproc:s,keylen:8,ivlen:8}};var y=function(b){return p[b]["proc"]};var A=function(b){var c=CryptoJS.lib.WordArray.random(b);var d=CryptoJS.enc.Hex.stringify(c);return d};var B=function(j){var i={};var e=j.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));if(e){i.cipher=e[1];i.ivsalt=e[2]}var f=j.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));if(f){i.type=f[1]}var b=-1;var g=0;if(j.indexOf("\r\n\r\n")!=-1){b=j.indexOf("\r\n\r\n");g=2}if(j.indexOf("\n\n")!=-1){b=j.indexOf("\n\n");g=1}var c=j.indexOf("-----END");if(b!=-1&&c!=-1){var d=j.substring(b+g*2,c-g);d=d.replace(/\s+/g,"");i.data=d}return i};var C=function(e,i,b){var l=b.substring(0,16);var m=CryptoJS.enc.Hex.parse(l);var c=CryptoJS.enc.Utf8.parse(i);var j=p[e]["keylen"]+p[e]["ivlen"];var f="";var g=null;for(;;){var k=CryptoJS.algo.MD5.create();if(g!=null){k.update(g)}k.update(c);k.update(m);g=k.finalize();f=f+CryptoJS.enc.Hex.stringify(g);if(f.length>=j*2){break}}var d={};d.keyhex=f.substr(0,p[e]["keylen"]*2);d.ivhex=f.substr(p[e]["keylen"]*2,p[e]["ivlen"]*2);return d};var r=function(f,i,d,g){var c=CryptoJS.enc.Base64.parse(f);var e=CryptoJS.enc.Hex.stringify(c);var j=p[i]["proc"];var b=j(e,d,g);return b};var D=function(b,e,g,c){var f=p[e]["eproc"];var d=f(b,g,c);return d};return{version:"1.0.0",getHexFromPEM:function(b,c){return ASN1HEX.pemToHex(b,c)},getDecryptedKeyHexByKeyIV:function(d,f,b,c){var e=y(f);return e(d,b,c)},parsePKCS5PEM:function(b){return B(b)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(d,b,c){return C(d,b,c)},decryptKeyB64:function(b,d,e,c){return r(b,d,e,c)},getDecryptedKeyHex:function(i,j){var f=B(i);var c=f.type;var e=f.cipher;var g=f.ivsalt;var d=f.data;var k=C(e,j,g);var l=k.keyhex;var b=r(d,e,l,g);return b},getRSAKeyFromEncryptedPKCS5PEM:function(d,e){var c=this.getDecryptedKeyHex(d,e);var b=new RSAKey();b.readPrivateKeyFromASN1HexString(c);return b},getEncryptedPKCS5PEMFromPrvKeyHex:function(g,d,i,n,j){var f="";if(typeof n=="undefined"||n==null){n="AES-256-CBC"}if(typeof p[n]=="undefined"){throw"KEYUTIL unsupported algorithm: "+n}if(typeof j=="undefined"||j==null){var m=p[n]["ivlen"];var k=A(m);j=k.toUpperCase()}var l=C(n,i,j);var c=l.keyhex;var b=D(d,n,c,j);var e=b.replace(/(.{64})/g,"$1\r\n");var f="-----BEGIN "+g+" PRIVATE KEY-----\r\n";f+="Proc-Type: 4,ENCRYPTED\r\n";f+="DEK-Info: "+n+","+j+"\r\n";f+="\r\n";f+=e;f+="\r\n-----END "+g+" PRIVATE KEY-----\r\n";return f},getEncryptedPKCS5PEMFromRSAKey:function(G,H,i,k){var l=new Ext.asn1.DERInteger({"int":0});var n=new Ext.asn1.DERInteger({bigint:G.n});var j=new Ext.asn1.DERInteger({"int":G.e});var g=new Ext.asn1.DERInteger({bigint:G.d});var e=new Ext.asn1.DERInteger({bigint:G.p});var f=new Ext.asn1.DERInteger({bigint:G.q});var o=new Ext.asn1.DERInteger({bigint:G.dmp1});var c=new Ext.asn1.DERInteger({bigint:G.dmq1});var m=new Ext.asn1.DERInteger({bigint:G.coeff});var d=new Ext.asn1.DERSequence({array:[l,n,j,g,e,f,o,c,m]});var b=d.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",b,H,i,k)},newEncryptedPKCS5PEM:function(b,g,d,c){if(typeof g=="undefined"||g==null){g=1024}if(typeof d=="undefined"||d==null){d="10001"}var f=new RSAKey();f.generate(g,d);var e=null;if(typeof c=="undefined"||c==null){e=this.getEncryptedPKCS5PEMFromRSAKey(f,b)}else{e=this.getEncryptedPKCS5PEMFromRSAKey(f,b,c)}return e},getRSAKeyFromPlainPKCS8PEM:function(c){if(c.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var d=ASN1HEX.pemToHex(c,"PRIVATE KEY");var b=this.getRSAKeyFromPlainPKCS8Hex(d);return b},getRSAKeyFromPlainPKCS8Hex:function(c){var b=new RSAKey();b.readPKCS8PrvKeyHex(c);return b},parseHexOfEncryptedPKCS8:function(k){var d={};var e=ASN1HEX.getPosArrayOfChildren_AtObj(k,0);if(e.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+e.length}d.ciphertext=ASN1HEX.getHexOfV_AtObj(k,e[1]);var i=ASN1HEX.getPosArrayOfChildren_AtObj(k,e[0]);if(i.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+i.length}if(ASN1HEX.getHexOfV_AtObj(k,i[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var g=ASN1HEX.getPosArrayOfChildren_AtObj(k,i[1]);if(i.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+g.length}var f=ASN1HEX.getPosArrayOfChildren_AtObj(k,g[1]);if(f.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+f.length}if(ASN1HEX.getHexOfV_AtObj(k,f[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}d.encryptionSchemeAlg="TripleDES";d.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(k,f[1]);var c=ASN1HEX.getPosArrayOfChildren_AtObj(k,g[0]);if(c.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+c.length}if(ASN1HEX.getHexOfV_AtObj(k,c[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var j=ASN1HEX.getPosArrayOfChildren_AtObj(k,c[1]);if(j.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+j.length}d.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(k,j[0]);var b=ASN1HEX.getHexOfV_AtObj(k,j[1]);try{d.pbkdf2Iter=parseInt(b,16)}catch(l){throw"malformed format pbkdf2Iter: "+b}return d},getPBKDF2KeyHexFromParam:function(c,b){var d=CryptoJS.enc.Hex.parse(c.pbkdf2Salt);var g=c.pbkdf2Iter;var e=CryptoJS.PBKDF2(b,d,{keySize:192/32,iterations:g});var f=CryptoJS.enc.Hex.stringify(e);return f},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(j,i){var e=ASN1HEX.pemToHex(j,"ENCRYPTED PRIVATE KEY");var g=this.parseHexOfEncryptedPKCS8(e);var b=KEYUTIL.getPBKDF2KeyHexFromParam(g,i);var l={};l.ciphertext=CryptoJS.enc.Hex.parse(g.ciphertext);var c=CryptoJS.enc.Hex.parse(b);var d=CryptoJS.enc.Hex.parse(g.encryptionSchemeIV);var k=CryptoJS.TripleDES.decrypt(l,c,{iv:d});var f=CryptoJS.enc.Hex.stringify(k);return f},getRSAKeyFromEncryptedPKCS8PEM:function(c,d){var e=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(c,d);var b=this.getRSAKeyFromPlainPKCS8Hex(e);return b},getKeyFromEncryptedPKCS8PEM:function(c,e){var b=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(c,e);var d=this.getKeyFromPlainPrivatePKCS8Hex(b);return d},parsePlainPrivatePKCS8Hex:function(c){var e={};e.algparam=null;if(c.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(c.substr(d[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var b=ASN1HEX.getPosArrayOfChildren_AtObj(c,d[1]);if(b.length!=2){throw"malformed PKCS8 private key(code:004)"}if(c.substr(b[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}e.algoid=ASN1HEX.getHexOfV_AtObj(c,b[0]);if(c.substr(b[1],2)=="06"){e.algparam=ASN1HEX.getHexOfV_AtObj(c,b[1])}if(c.substr(d[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}e.keyidx=ASN1HEX.getStartPosOfV_AtObj(c,d[2]);return e},getKeyFromPlainPrivatePKCS8PEM:function(d){var b=ASN1HEX.pemToHex(d,"PRIVATE KEY");var c=this.getKeyFromPlainPrivatePKCS8Hex(b);return c},getKeyFromPlainPrivatePKCS8Hex:function(b){var d=this.parsePlainPrivatePKCS8Hex(b);var c;if(d.algoid=="2a864886f70d010101"){c=new RSAKey()}else{if(d.algoid=="2a8648ce380401"){c=new Ext.crypto.DSA()}else{if(d.algoid=="2a8648ce3d0201"){c=new Ext.crypto.ECDSA()}else{throw"unsupported private key algorithm"}}}c.readPKCS8PrvKeyHex(b);return c},getRSAKeyFromPublicPKCS8PEM:function(d){var c=ASN1HEX.pemToHex(d,"PUBLIC KEY");var b=this.getRSAKeyFromPublicPKCS8Hex(c);return b},getKeyFromPublicPKCS8PEM:function(d){var c=ASN1HEX.pemToHex(d,"PUBLIC KEY");var b=this.getKeyFromPublicPKCS8Hex(c);return b},getKeyFromPublicPKCS8Hex:function(d){var b;var c=ASN1HEX.getVbyList(d,0,[0,0],"06");if(c==="2a864886f70d010101"){b=new RSAKey()}else{if(c==="2a8648ce380401"){b=new Ext.crypto.DSA()}else{if(c==="2a8648ce3d0201"){b=new Ext.crypto.ECDSA()}else{throw"unsupported PKCS#8 public key hex"}}}b.readPKCS8PubKeyHex(d);return b},parsePublicRawRSAKeyHex:function(c){var b={};if(c.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(d.length!=2){throw"malformed RSA key(code:002)"}if(c.substr(d[0],2)!="02"){throw"malformed RSA key(code:003)"}b.n=ASN1HEX.getHexOfV_AtObj(c,d[0]);if(c.substr(d[1],2)!="02"){throw"malformed RSA key(code:004)"}b.e=ASN1HEX.getHexOfV_AtObj(c,d[1]);return b},parsePrivateRawRSAKeyHexAtObj:function(g,c){var d=ASN1HEX;var f=d.getHexOfV_AtObj;var e=d.getDecendantIndexByNthList(g,0,[2,0]);var b=d.getPosArrayOfChildren_AtObj(g,e);if(b.length!==9){throw"malformed PKCS#8 plain RSA private key"}c.key={};c.key.n=f(g,b[1]);c.key.e=f(g,b[2]);c.key.d=f(g,b[3]);c.key.p=f(g,b[4]);c.key.q=f(g,b[5]);c.key.dp=f(g,b[6]);c.key.dq=f(g,b[7]);c.key.co=f(g,b[8])},parsePrivateRawECKeyHexAtObj:function(e,f){var b=ASN1HEX;var d=f.keyidx;var c=new Ext.crypto.ECDSA();c.readPKCS8PrvKeyHex(e);f.key=c.prvKeyHex;f.pubkey=c.pubKeyHex},parsePublicPKCS8Hex:function(b){var d={};d.algparam=null;var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(c.length!=2){throw"outer DERSequence shall have 2 elements: "+c.length}var f=c[0];if(b.substr(f,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(b,f);if(e.length!=2){throw"malformed PKCS8 public key(code:002)"}if(b.substr(e[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}d.algoid=ASN1HEX.getHexOfV_AtObj(b,e[0]);if(b.substr(e[1],2)=="06"){d.algparam=ASN1HEX.getHexOfV_AtObj(b,e[1])}else{if(b.substr(e[1],2)=="30"){d.algparam={};d.algparam.p=ASN1HEX.getVbyList(b,e[1],[0],"02");d.algparam.q=ASN1HEX.getVbyList(b,e[1],[1],"02");d.algparam.g=ASN1HEX.getVbyList(b,e[1],[2],"02")}}if(b.substr(c[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}d.key=ASN1HEX.getHexOfV_AtObj(b,c[1]).substr(2);return d},getRSAKeyFromPublicPKCS8Hex:function(b){var c=new RSAKey();c.readPKCS8PubKeyHex(b);return c},}}();KEYUTIL.getKey=function(Q,R,P){if(typeof RSAKey!="undefined"&&Q instanceof RSAKey){return Q}if(typeof Ext.crypto.ECDSA!="undefined"&&Q instanceof Ext.crypto.ECDSA){return Q}if(typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA){return Q}if(Q.curve!==undefined&&Q.xy!==undefined&&Q.d===undefined){return new Ext.crypto.ECDSA({pub:Q.xy,curve:Q.curve})}if(Q.curve!==undefined&&Q.d!==undefined){return new Ext.crypto.ECDSA({prv:Q.d,curve:Q.curve})}if(Q.kty===undefined&&Q.n!==undefined&&Q.e!==undefined&&Q.d===undefined){var q=new RSAKey();q.setPublic(Q.n,Q.e);return q}if(Q.kty===undefined&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined&&Q.p!==undefined&&Q.q!==undefined&&Q.dp!==undefined&&Q.dq!==undefined&&Q.co!==undefined&&Q.qi===undefined){var q=new RSAKey();q.setPrivateEx(Q.n,Q.e,Q.d,Q.p,Q.q,Q.dp,Q.dq,Q.co);return q}if(Q.kty===undefined&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined&&Q.p===undefined){var q=new RSAKey();q.setPrivate(Q.n,Q.e,Q.d);return q}if(Q.p!==undefined&&Q.q!==undefined&&Q.g!==undefined&&Q.y!==undefined&&Q.x===undefined){var q=new Ext.crypto.DSA();q.setPublic(Q.p,Q.q,Q.g,Q.y);return q}if(Q.p!==undefined&&Q.q!==undefined&&Q.g!==undefined&&Q.y!==undefined&&Q.x!==undefined){var q=new Ext.crypto.DSA();q.setPrivate(Q.p,Q.q,Q.g,Q.y,Q.x);return q}if(Q.kty==="RSA"&&Q.n!==undefined&&Q.e!==undefined&&Q.d===undefined){var q=new RSAKey();q.setPublic(b64utohex(Q.n),b64utohex(Q.e));return q}if(Q.kty==="RSA"&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined&&Q.p!==undefined&&Q.q!==undefined&&Q.dp!==undefined&&Q.dq!==undefined&&Q.qi!==undefined){var q=new RSAKey();q.setPrivateEx(b64utohex(Q.n),b64utohex(Q.e),b64utohex(Q.d),b64utohex(Q.p),b64utohex(Q.q),b64utohex(Q.dp),b64utohex(Q.dq),b64utohex(Q.qi));return q}if(Q.kty==="RSA"&&Q.n!==undefined&&Q.e!==undefined&&Q.d!==undefined){var q=new RSAKey();q.setPrivate(b64utohex(Q.n),b64utohex(Q.e),b64utohex(Q.d));return q}if(Q.kty==="EC"&&Q.crv!==undefined&&Q.x!==undefined&&Q.y!==undefined&&Q.d===undefined){var S=new Ext.crypto.ECDSA({curve:Q.crv});var L=S.ecparams.keylen/4;var I=("0000000000"+b64utohex(Q.x)).slice(-L);var E=("0000000000"+b64utohex(Q.y)).slice(-L);var K="04"+I+E;S.setPublicKeyHex(K);return S}if(Q.kty==="EC"&&Q.crv!==undefined&&Q.x!==undefined&&Q.y!==undefined&&Q.d!==undefined){var S=new Ext.crypto.ECDSA({curve:Q.crv});var L=S.ecparams.keylen/4;var I=("0000000000"+b64utohex(Q.x)).slice(-L);var E=("0000000000"+b64utohex(Q.y)).slice(-L);var K="04"+I+E;var V=("0000000000"+b64utohex(Q.d)).slice(-L);S.setPublicKeyHex(K);S.setPrivateKeyHex(V);return S}if(P==="pkcs5prv"){var y=Q,p=ASN1HEX,F,q;F=p.getPosArrayOfChildren_AtObj(y,0);if(F.length===9){q=new RSAKey();q.readPrivateKeyFromASN1HexString(Q)}else{if(F.length===6){q=new Ext.crypto.DSA();q.readPKCS5PrvKeyHex(y)}else{if(F.length>2&&y.substr(F[1],2)==="04"){q=new Ext.crypto.ECDSA();q.readPKCS5PrvKeyHex(y)}else{throw"unsupported PKCS#1/5 hexadecimal key"}}}return q}if(P==="pkcs8prv"){var q=KEYUTIL.getKeyFromPlainPrivatePKCS8Hex(Q);return q}if(P==="pkcs8pub"){return KEYUTIL.getKeyFromPublicPKCS8Hex(Q)}if(P==="x509pub"){return X509.getPublicKeyFromCertHex(Q)}if(Q.indexOf("-END CERTIFICATE-",0)!=-1||Q.indexOf("-END X509 CERTIFICATE-",0)!=-1||Q.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1){return X509.getPublicKeyFromCertPEM(Q)}if(Q.indexOf("-END PUBLIC KEY-")!=-1){return KEYUTIL.getKeyFromPublicPKCS8PEM(Q)}if(Q.indexOf("-END RSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")==-1){var O=ASN1HEX.pemToHex(Q,"RSA PRIVATE KEY");return KEYUTIL.getKey(O,null,"pkcs5prv")}if(Q.indexOf("-END DSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")==-1){var g=ASN1HEX.pemToHex(Q,"DSA PRIVATE KEY");var H=ASN1HEX.getVbyList(g,0,[1],"02");var x=ASN1HEX.getVbyList(g,0,[2],"02");var J=ASN1HEX.getVbyList(g,0,[3],"02");var N=ASN1HEX.getVbyList(g,0,[4],"02");var M=ASN1HEX.getVbyList(g,0,[5],"02");var q=new Ext.crypto.DSA();q.setPrivate(new BigInteger(H,16),new BigInteger(x,16),new BigInteger(J,16),new BigInteger(N,16),new BigInteger(M,16));return q}if(Q.indexOf("-END PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(Q)}if(Q.indexOf("-END RSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")!=-1){return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(Q,R)}if(Q.indexOf("-END EC PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")!=-1){var g=KEYUTIL.getDecryptedKeyHex(Q,R);var q=ASN1HEX.getVbyList(g,0,[1],"04");var T=ASN1HEX.getVbyList(g,0,[2,0],"06");var G=ASN1HEX.getVbyList(g,0,[3,0],"03").substr(2);var U="";if(Ext.crypto.OID.oidhex2name[T]!==undefined){U=Ext.crypto.OID.oidhex2name[T]}else{throw"undefined OID(hex) in Ext.crypto.OID: "+T}var S=new Ext.crypto.ECDSA({curve:U});S.setPublicKeyHex(G);S.setPrivateKeyHex(q);S.isPublic=false;return S}if(Q.indexOf("-END DSA PRIVATE KEY-")!=-1&&Q.indexOf("4,ENCRYPTED")!=-1){var g=KEYUTIL.getDecryptedKeyHex(Q,R);var H=ASN1HEX.getVbyList(g,0,[1],"02");var x=ASN1HEX.getVbyList(g,0,[2],"02");var J=ASN1HEX.getVbyList(g,0,[3],"02");var N=ASN1HEX.getVbyList(g,0,[4],"02");var M=ASN1HEX.getVbyList(g,0,[5],"02");var q=new Ext.crypto.DSA();q.setPrivate(new BigInteger(H,16),new BigInteger(x,16),new BigInteger(J,16),new BigInteger(N,16),new BigInteger(M,16));return q}if(Q.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromEncryptedPKCS8PEM(Q,R)}throw"not supported argument"};KEYUTIL.generateKeypair=function(u,s){if(u=="RSA"){var l=s;var m=new RSAKey();m.generate(l,"10001");m.isPrivate=true;m.isPublic=true;var r=new RSAKey();var v=m.n.toString(16);var p=m.e.toString(16);r.setPublic(v,p);r.isPrivate=false;r.isPublic=true;var n={};n.prvKeyObj=m;n.pubKeyObj=r;return n}else{if(u=="EC"){var q=s;var o=new Ext.crypto.ECDSA({curve:q});var w=o.generateKeyPairHex();var m=new Ext.crypto.ECDSA({curve:q});m.setPublicKeyHex(w.ecpubhex);m.setPrivateKeyHex(w.ecprvhex);m.isPrivate=true;m.isPublic=false;var r=new Ext.crypto.ECDSA({curve:q});r.setPublicKeyHex(w.ecpubhex);r.isPrivate=false;r.isPublic=true;var n={};n.prvKeyObj=m;n.pubKeyObj=r;return n}else{throw"unknown algorithm: "+u}}};KEYUTIL.getPEM=function(Q,F,D,K,x){var A=Ext.asn1;var B=Ext.crypto;function E(b){var c=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:b.n}},{"int":b.e},{"int":{bigint:b.d}},{"int":{bigint:b.p}},{"int":{bigint:b.q}},{"int":{bigint:b.dmp1}},{"int":{bigint:b.dmq1}},{"int":{bigint:b.coeff}}]});return c}function s(c){var b=Ext.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:c.prvKeyHex}},{tag:["a0",true,{oid:{name:c.curveName}}]},{tag:["a1",true,{bitstr:{hex:"00"+c.pubKeyHex}}]}]});return b}function H(b){var c=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:b.p}},{"int":{bigint:b.q}},{"int":{bigint:b.g}},{"int":{bigint:b.y}},{"int":{bigint:b.x}}]});return c}if(((typeof RSAKey!="undefined"&&Q instanceof RSAKey)||(typeof B.DSA!="undefined"&&Q instanceof B.DSA)||(typeof B.ECDSA!="undefined"&&Q instanceof B.ECDSA))&&Q.isPublic==true&&(F===undefined||F=="PKCS8PUB")){var y=new Ext.asn1.x509.SubjectPublicKeyInfo(Q);var w=y.getEncodedHex();return A.ASN1Util.getPEMStringFromHex(w,"PUBLIC KEY")}if(F=="PKCS1PRV"&&typeof RSAKey!="undefined"&&Q instanceof RSAKey&&(D===undefined||D==null)&&Q.isPrivate==true){var y=E(Q);var w=y.getEncodedHex();return A.ASN1Util.getPEMStringFromHex(w,"RSA PRIVATE KEY")}if(F=="PKCS1PRV"&&typeof RSAKey!="undefined"&&Q instanceof Ext.crypto.ECDSA&&(D===undefined||D==null)&&Q.isPrivate==true){var L=new Ext.asn1.DERObjectIdentifier({name:Q.curveName});var G=L.getEncodedHex();var M=s(Q);var I=M.getEncodedHex();var C="";C+=A.ASN1Util.getPEMStringFromHex(G,"EC PARAMETERS");C+=A.ASN1Util.getPEMStringFromHex(I,"EC PRIVATE KEY");return C}if(F=="PKCS1PRV"&&typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA&&(D===undefined||D==null)&&Q.isPrivate==true){var y=H(Q);var w=y.getEncodedHex();return A.ASN1Util.getPEMStringFromHex(w,"DSA PRIVATE KEY")}if(F=="PKCS5PRV"&&typeof RSAKey!="undefined"&&Q instanceof RSAKey&&(D!==undefined&&D!=null)&&Q.isPrivate==true){var y=E(Q);var w=y.getEncodedHex();if(K===undefined){K="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",w,D,K)}if(F=="PKCS5PRV"&&typeof Ext.crypto.ECDSA!="undefined"&&Q instanceof Ext.crypto.ECDSA&&(D!==undefined&&D!=null)&&Q.isPrivate==true){var y=s(Q);var w=y.getEncodedHex();if(K===undefined){K="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",w,D,K)}if(F=="PKCS5PRV"&&typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA&&(D!==undefined&&D!=null)&&Q.isPrivate==true){var y=H(Q);var w=y.getEncodedHex();if(K===undefined){K="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",w,D,K)}var J=function(e,b){var c=P(e,b);var d=new Ext.asn1.ASN1Util.newObject({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:c.pbkdf2Salt}},{"int":c.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:c.encryptionSchemeIV}}]}]}]},{octstr:{hex:c.ciphertext}}]});return d.getEncodedHex()};var P=function(g,f){var d=100;var i=CryptoJS.lib.WordArray.random(8);var j="DES-EDE3-CBC";var l=CryptoJS.lib.WordArray.random(8);var c=CryptoJS.PBKDF2(f,i,{keySize:192/32,iterations:d});var b=CryptoJS.enc.Hex.parse(g);var k=CryptoJS.TripleDES.encrypt(b,c,{iv:l})+"";var e={};e.ciphertext=k;e.pbkdf2Salt=CryptoJS.enc.Hex.stringify(i);e.pbkdf2Iter=d;e.encryptionSchemeAlg=j;e.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(l);return e};if(F=="PKCS8PRV"&&typeof RSAKey!="undefined"&&Q instanceof RSAKey&&Q.isPrivate==true){var N=E(Q);var O=N.getEncodedHex();var y=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"rsaEncryption"}},{"null":true}]},{octstr:{hex:O}}]});var w=y.getEncodedHex();if(D===undefined||D==null){return A.ASN1Util.getPEMStringFromHex(w,"PRIVATE KEY")}else{var I=J(w,D);return A.ASN1Util.getPEMStringFromHex(I,"ENCRYPTED PRIVATE KEY")}}if(F=="PKCS8PRV"&&typeof Ext.crypto.ECDSA!="undefined"&&Q instanceof Ext.crypto.ECDSA&&Q.isPrivate==true){var N=new Ext.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:Q.prvKeyHex}},{tag:["a1",true,{bitstr:{hex:"00"+Q.pubKeyHex}}]}]});var O=N.getEncodedHex();var y=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:Q.curveName}}]},{octstr:{hex:O}}]});var w=y.getEncodedHex();if(D===undefined||D==null){return A.ASN1Util.getPEMStringFromHex(w,"PRIVATE KEY")}else{var I=J(w,D);return A.ASN1Util.getPEMStringFromHex(I,"ENCRYPTED PRIVATE KEY")}}if(F=="PKCS8PRV"&&typeof Ext.crypto.DSA!="undefined"&&Q instanceof Ext.crypto.DSA&&Q.isPrivate==true){var N=new Ext.asn1.DERInteger({bigint:Q.x});var O=N.getEncodedHex();var y=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"dsa"}},{seq:[{"int":{bigint:Q.p}},{"int":{bigint:Q.q}},{"int":{bigint:Q.g}}]}]},{octstr:{hex:O}}]});var w=y.getEncodedHex();if(D===undefined||D==null){return A.ASN1Util.getPEMStringFromHex(w,"PRIVATE KEY")}else{var I=J(w,D);return A.ASN1Util.getPEMStringFromHex(I,"ENCRYPTED PRIVATE KEY")}}throw"unsupported object nor format"};KEYUTIL.getKeyFromCSRPEM=function(f){var d=ASN1HEX.pemToHex(f,"CERTIFICATE REQUEST");var e=KEYUTIL.getKeyFromCSRHex(d);return e};KEYUTIL.getKeyFromCSRHex=function(d){var e=KEYUTIL.parseCSRHex(d);var f=KEYUTIL.getKey(e.p8pubkeyhex,null,"pkcs8pub");return f};KEYUTIL.parseCSRHex=function(f){var g={};var j=f;if(j.substr(0,2)!="30"){throw"malformed CSR(code:001)"}var k=ASN1HEX.getPosArrayOfChildren_AtObj(j,0);if(k.length<1){throw"malformed CSR(code:002)"}if(j.substr(k[0],2)!="30"){throw"malformed CSR(code:003)"}var i=ASN1HEX.getPosArrayOfChildren_AtObj(j,k[0]);if(i.length<3){throw"malformed CSR(code:004)"}g.p8pubkeyhex=ASN1HEX.getHexOfTLV_AtObj(j,i[2]);return g};KEYUTIL.getJWKFromKey=function(f){var i={};if(f instanceof RSAKey&&f.isPrivate){i.kty="RSA";i.n=hextob64u(f.n.toString(16));i.e=hextob64u(f.e.toString(16));i.d=hextob64u(f.d.toString(16));i.p=hextob64u(f.p.toString(16));i.q=hextob64u(f.q.toString(16));i.dp=hextob64u(f.dmp1.toString(16));i.dq=hextob64u(f.dmq1.toString(16));i.qi=hextob64u(f.coeff.toString(16));return i}else{if(f instanceof RSAKey&&f.isPublic){i.kty="RSA";i.n=hextob64u(f.n.toString(16));i.e=hextob64u(f.e.toString(16));return i}else{if(f instanceof Ext.crypto.ECDSA&&f.isPrivate){var e=f.getShortNISTPCurveName();if(e!=="P-256"&&e!=="P-384"){throw"unsupported curve name for JWT: "+e}var g=f.getPublicKeyXYHex();i.kty="EC";i.crv=e;i.x=hextob64u(g.x);i.y=hextob64u(g.y);i.d=hextob64u(f.prvKeyHex);return i}else{if(f instanceof Ext.crypto.ECDSA&&f.isPublic){var e=f.getShortNISTPCurveName();if(e!=="P-256"&&e!=="P-384"){throw"unsupported curve name for JWT: "+e}var g=f.getPublicKeyXYHex();i.kty="EC";i.crv=e;i.x=hextob64u(g.x);i.y=hextob64u(g.y);return i}}}}throw"not supported key object"};RSAKey.pemToBase64=function(d){var c=d;c=c.replace("-----BEGIN RSA PRIVATE KEY-----","");c=c.replace("-----END RSA PRIVATE KEY-----","");c=c.replace(/[ \n]+/g,"");return c};RSAKey.getPosArrayOfChildrenFromHex=function(u){var x=new Array();var q=ASN1HEX.getStartPosOfV_AtObj(u,0);var m=ASN1HEX.getPosOfNextSibling_AtObj(u,q);var v=ASN1HEX.getPosOfNextSibling_AtObj(u,m);var r=ASN1HEX.getPosOfNextSibling_AtObj(u,v);var n=ASN1HEX.getPosOfNextSibling_AtObj(u,r);var p=ASN1HEX.getPosOfNextSibling_AtObj(u,n);var w=ASN1HEX.getPosOfNextSibling_AtObj(u,p);var s=ASN1HEX.getPosOfNextSibling_AtObj(u,w);var o=ASN1HEX.getPosOfNextSibling_AtObj(u,s);x.push(q,m,v,r,n,p,w,s,o);return x};RSAKey.getHexValueArrayOfChildrenFromHex=function(p){var r=RSAKey.getPosArrayOfChildrenFromHex(p);var n=ASN1HEX.getHexOfV_AtObj(p,r[0]);var u=ASN1HEX.getHexOfV_AtObj(p,r[1]);var v=ASN1HEX.getHexOfV_AtObj(p,r[2]);var o=ASN1HEX.getHexOfV_AtObj(p,r[3]);var x=ASN1HEX.getHexOfV_AtObj(p,r[4]);var A=ASN1HEX.getHexOfV_AtObj(p,r[5]);var s=ASN1HEX.getHexOfV_AtObj(p,r[6]);var w=ASN1HEX.getHexOfV_AtObj(p,r[7]);var q=ASN1HEX.getHexOfV_AtObj(p,r[8]);var y=new Array();y.push(n,u,v,o,x,A,s,w,q);return y};RSAKey.prototype.readPrivateKeyFromPEMString=function(f){var i=RSAKey.pemToBase64(f);var g=b64tohex(i);var j=RSAKey.getHexValueArrayOfChildrenFromHex(g);this.setPrivateEx(j[1],j[2],j[3],j[4],j[5],j[6],j[7],j[8])};RSAKey.prototype.readPrivateKeyFromASN1HexString=function(b){this.readPKCS5PrvKeyHex(b)};RSAKey.prototype.readPKCS5PrvKeyHex=function(d){var e=RSAKey.getHexValueArrayOfChildrenFromHex(d);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function(p){var r,u,s,o,v,A,n,x;var q=ASN1HEX;var w=q.getVbyList;if(q.isASN1HEX(p)===false){throw"not ASN.1 hex string"}try{r=w(p,0,[2,0,1],"02");u=w(p,0,[2,0,2],"02");s=w(p,0,[2,0,3],"02");o=w(p,0,[2,0,4],"02");v=w(p,0,[2,0,5],"02");A=w(p,0,[2,0,6],"02");n=w(p,0,[2,0,7],"02");x=w(p,0,[2,0,8],"02")}catch(y){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(r,u,s,o,v,A,n,x)};RSAKey.prototype.readPKCS5PubKeyHex=function(i){if(ASN1HEX.isASN1HEX(i)===false){throw"keyHex is not ASN.1 hex string"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(e.length!==2||i.substr(e[0],2)!=="02"||i.substr(e[1],2)!=="02"){throw"wrong hex for PKCS#5 public key"}var f=ASN1HEX.getHexOfV_AtObj(i,e[0]);var g=ASN1HEX.getHexOfV_AtObj(i,e[1]);this.setPublic(f,g)};RSAKey.prototype.readPKCS8PubKeyHex=function(d){if(ASN1HEX.isASN1HEX(d)===false){throw"not ASN.1 hex string"}if(ASN1HEX.getDecendantHexTLVByNthList(d,0,[0,0])!=="06092a864886f70d010101"){throw"not PKCS8 RSA public key"}var c=ASN1HEX.getDecendantHexTLVByNthList(d,0,[1,0]);this.readPKCS5PubKeyHex(c)};RSAKey.prototype.readCertPubKeyHex=function(f,e){if(e!==5){e=6}if(ASN1HEX.isASN1HEX(f)===false){throw"not ASN.1 hex string"}var d=ASN1HEX.getDecendantHexTLVByNthList(f,0,[0,e]);this.readPKCS8PubKeyHex(d)};var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");function _rsasign_getHexPaddedDigestInfoForString(k,j,i){var g=function(b){return Ext.crypto.Util.hashString(b,i)};var f=g(k);return Ext.crypto.Util.getPaddedDigestInfoHex(f,i,j)}function _zeroPaddingOfSignature(j,k){var f="";var i=k/4-j.length;for(var g=0;g<i;g++){f=f+"0"}return f+j}function _rsasign_signString(f,e){var i=function(b){return Ext.crypto.Util.hashString(b,e)};var g=i(f);return this.signWithMessageHash(g,e)}function _rsasign_signWithMessageHash(k,g){var j=Ext.crypto.Util.getPaddedDigestInfoHex(k,g,this.n.bitLength());var m=parseBigInt(j,16);var l=this.doPrivate(m);var i=l.toString(16);return _zeroPaddingOfSignature(i,this.n.bitLength())}function _rsasign_signStringWithSHA1(b){return _rsasign_signString.call(this,b,"sha1")}function _rsasign_signStringWithSHA256(b){return _rsasign_signString.call(this,b,"sha256")}function pss_mgf1_str(f,i,j){var g="",k=0;while(g.length<i){g+=hextorstr(j(rstrtohex(f+String.fromCharCode.apply(String,[(k&4278190080)>>24,(k&16711680)>>16,(k&65280)>>8,k&255]))));k+=1}return g}function _rsasign_signStringPSS(j,i,k){var f=function(b){return Ext.crypto.Util.hashHex(b,i)};var g=f(rstrtohex(j));if(k===undefined){k=-1}return this.signWithMessageHashPSS(g,i,k)}function _rsasign_signWithMessageHashPSS(w,G,x){var E=hextorstr(w);var A=E.length;var r=this.n.bitLength()-1;var D=Math.ceil(r/8);var s;var H=function(b){return Ext.crypto.Util.hashHex(b,G)};if(x===-1||x===undefined){x=A}else{if(x===-2){x=D-A-2}else{if(x<-2){throw"invalid salt length"}}}if(D<(A+x+2)){throw"data too long"}var B="";if(x>0){B=new Array(x);new SecureRandom().nextBytes(B);B=String.fromCharCode.apply(String,B)}var u=hextorstr(H(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+E+B)));var y=[];for(s=0;s<D-x-A-2;s+=1){y[s]=0}var v=String.fromCharCode.apply(String,y)+"\x01"+B;var i=pss_mgf1_str(u,v.length,H);var F=[];for(s=0;s<v.length;s+=1){F[s]=v.charCodeAt(s)^i.charCodeAt(s)}var C=(65280>>(8*D-r))&255;F[0]&=~C;for(s=0;s<A;s++){F.push(u.charCodeAt(s))}F.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(F)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(i,k,f){var g=new RSAKey();g.setPublic(k,f);var j=g.doPublic(i);return j}function _rsasign_getHexDigestInfoFromSig(i,f,g){var j=_rsasign_getDecryptSignatureBI(i,f,g);var k=j.toString(16).replace(/^1f+00/,"");return k}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(j){for(var k in Ext.crypto.Util.DIGESTINFOHEAD){var l=Ext.crypto.Util.DIGESTINFOHEAD[k];var i=l.length;if(j.substring(0,i)==l){var g=[k,j.substring(i)];return g}}return[]}function _rsasign_verifySignatureWithArgs(o,s,n,k){var p=_rsasign_getHexDigestInfoFromSig(s,n,k);var m=_rsasign_getAlgNameAndHashFromHexDisgestInfo(p);if(m.length==0){return false}var q=m[0];var l=m[1];var u=function(b){return Ext.crypto.Util.hashString(b,q)};var r=u(o);return(l==r)}function _rsasign_verifyHexSignatureForMessage(g,i){var f=parseBigInt(g,16);var e=_rsasign_verifySignatureWithArgs(i,f,this.n.toString(16),this.e.toString(16));return e}function _rsasign_verifyString(o,k){k=k.replace(_RE_HEXDECONLY,"");k=k.replace(/[ \n]+/g,"");var s=parseBigInt(k,16);if(s.bitLength()>this.n.bitLength()){return 0}var l=this.doPublic(s);var p=l.toString(16).replace(/^1f+00/,"");var n=_rsasign_getAlgNameAndHashFromHexDisgestInfo(p);if(n.length==0){return false}var q=n[0];var m=n[1];var u=function(b){return Ext.crypto.Util.hashString(b,q)};var r=u(o);return(m==r)}function _rsasign_verifyWithMessageHash(m,i){i=i.replace(_RE_HEXDECONLY,"");i=i.replace(/[ \n]+/g,"");var l=parseBigInt(i,16);if(l.bitLength()>this.n.bitLength()){return 0}var o=this.doPublic(l);var p=o.toString(16).replace(/^1f+00/,"");var k=_rsasign_getAlgNameAndHashFromHexDisgestInfo(p);if(k.length==0){return false}var j=k[0];var n=k[1];return(n==m)}function _rsasign_verifyStringPSS(g,m,i,j){var k=function(b){return Ext.crypto.Util.hashHex(b,i)};var l=k(rstrtohex(g));if(j===undefined){j=-1}return this.verifyWithMessageHashPSS(l,m,i,j)}function _rsasign_verifyWithMessageHashPSS(x,i,C,J){var E=new BigInteger(i,16);if(E.bitLength()>this.n.bitLength()){return false}var A=function(b){return Ext.crypto.Util.hashHex(b,C)};var G=hextorstr(x);var I=G.length;var v=this.n.bitLength()-1;var u=Math.ceil(v/8);var w;if(J===-1||J===undefined){J=I}else{if(J===-2){J=u-I-2}else{if(J<-2){throw"invalid salt length"}}}if(u<(I+J+2)){throw"data too long"}var L=this.doPublic(E).toByteArray();for(w=0;w<L.length;w+=1){L[w]&=255}while(L.length<u){L.unshift(0)}if(L[u-1]!==188){throw"encoded message does not end in 0xbc"}L=String.fromCharCode.apply(String,L);var F=L.substr(0,u-I-1);var B=L.substr(F.length,I);var y=(65280>>(8*u-v))&255;if((F.charCodeAt(0)&y)!==0){throw"bits beyond keysize not zero"}var H=pss_mgf1_str(B,F.length,A);var D=[];for(w=0;w<F.length;w+=1){D[w]=F.charCodeAt(w)^H.charCodeAt(w)}D[0]&=~y;var K=u-I-J-2;for(w=0;w<K;w+=1){if(D[w]!==0){throw"leftmost octets not zero"}}if(D[K]!==1){throw"0x01 marker not found"}return B===hextorstr(A(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+G+String.fromCharCode.apply(String,D.slice(-J)))))}RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash;RSAKey.prototype.signString=_rsasign_signString;RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.sign=_rsasign_signString;RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS;RSAKey.prototype.signStringPSS=_rsasign_signStringPSS;RSAKey.prototype.signPSS=_rsasign_signStringPSS;RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash;RSAKey.prototype.verifyString=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verify=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS;RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS;RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS;RSAKey.SALT_LEN_RECOVER=-2;function X509(){this.subjectPublicKeyRSA=null;this.subjectPublicKeyRSA_hN=null;this.subjectPublicKeyRSA_hE=null;this.hex=null;this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])};this.getSignatureAlgorithmField=function(){var f=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,2,0]);var d=Ext.asn1.ASN1Util.oidHexToInt(f);var e=Ext.asn1.x509.OID.oid2name(d);return e};this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])};this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))};this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])};this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))};this.getNotBefore=function(){var b=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);b=b.replace(/(..)/g,"%$1");b=decodeURIComponent(b);return b};this.getNotAfter=function(){var b=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);b=b.replace(/(..)/g,"%$1");b=decodeURIComponent(b);return b};this.readCertPEM=function(i){var f=ASN1HEX.pemToHex(i);var j=X509.getPublicKeyHexArrayFromCertHex(f);var g=new RSAKey();g.setPublic(j[0],j[1]);this.subjectPublicKeyRSA=g;this.subjectPublicKeyRSA_hN=j[0];this.subjectPublicKeyRSA_hE=j[1];this.hex=f};this.readCertPEMWithoutRSAInit=function(f){var e=ASN1HEX.pemToHex(f);var g=X509.getPublicKeyHexArrayFromCertHex(e);if(typeof this.subjectPublicKeyRSA.setPublic==="function"){this.subjectPublicKeyRSA.setPublic(g[0],g[1])}this.subjectPublicKeyRSA_hN=g[0];this.subjectPublicKeyRSA_hE=g[1];this.hex=e};this.getInfo=function(){var i="Basic Fields\n";i+="  serial number: "+this.getSerialNumberHex()+"\n";i+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";i+="  issuer: "+this.getIssuerString()+"\n";i+="  notBefore: "+this.getNotBefore()+"\n";i+="  notAfter: "+this.getNotAfter()+"\n";i+="  subject: "+this.getSubjectString()+"\n";i+="  subject public key info: \n";var w=X509.getSubjectPublicKeyInfoPosFromCertHex(this.hex);var A=ASN1HEX.getHexOfTLV_AtObj(this.hex,w);var x=KEYUTIL.getKey(A,null,"pkcs8pub");if(x instanceof RSAKey){i+="    key algorithm: RSA\n";i+="    n="+x.n.toString(16).substr(0,16)+"...\n";i+="    e="+x.e.toString(16)+"\n"}i+="X509v3 Extensions:\n";var E=X509.getV3ExtInfoListOfCertHex(this.hex);for(var y=0;y<E.length;y++){var F=E[y];var u=Ext.asn1.x509.OID.oid2name(F.oid);if(u===""){u=F.oid}var B="";if(F.critical===true){B="CRITICAL"}i+="  "+u+" "+B+":\n";if(u==="basicConstraints"){var q=X509.getExtBasicConstraints(this.hex);if(q.cA===undefined){i+="    {}\n"}else{i+="    cA=true";if(q.pathLen!==undefined){i+=", pathLen="+q.pathLen}i+="\n"}}else{if(u==="keyUsage"){i+="    "+X509.getExtKeyUsageString(this.hex)+"\n"}else{if(u==="subjectKeyIdentifier"){i+="    "+X509.getExtSubjectKeyIdentifier(this.hex)+"\n"}else{if(u==="authorityKeyIdentifier"){var s=X509.getExtAuthorityKeyIdentifier(this.hex);if(s.kid!==undefined){i+="    kid="+s.kid+"\n"}}else{if(u==="extKeyUsage"){var r=X509.getExtExtKeyUsageName(this.hex);i+="    "+r.join(", ")+"\n"}else{if(u==="subjectAltName"){var v=X509.getExtSubjectAltName(this.hex);i+="    "+v.join(", ")+"\n"}else{if(u==="cRLDistributionPoints"){var C=X509.getExtCRLDistributionPointsURI(this.hex);i+="    "+C+"\n"}else{if(u==="authorityInfoAccess"){var D=X509.getExtAIAInfo(this.hex);if(D.ocsp!==undefined){i+="    ocsp: "+D.ocsp.join(",")+"\n"}if(D.caissuer!==undefined){i+="    caissuer: "+D.caissuer.join(",")+"\n"}}}}}}}}}}i+="signature algorithm: "+X509.getSignatureAlgorithmName(this.hex)+"\n";i+="signature: "+X509.getSignatureValueHex(this.hex).substr(0,16)+"...\n";return i}}X509.pemToBase64=function(c){var d=c;d=d.replace("-----BEGIN CERTIFICATE-----","");d=d.replace("-----END CERTIFICATE-----","");d=d.replace(/[ \n]+/g,"");return d};X509.pemToHex=function(b){return ASN1HEX.pemToHex(b)};X509.getSubjectPublicKeyPosFromCertHex=function(j){var k=X509.getSubjectPublicKeyInfoPosFromCertHex(j);if(k==-1){return -1}var i=ASN1HEX.getPosArrayOfChildren_AtObj(j,k);if(i.length!=2){return -1}var l=i[1];if(j.substring(l,l+2)!="03"){return -1}var g=ASN1HEX.getStartPosOfV_AtObj(j,l);if(j.substring(g,g+2)!="00"){return -1}return g+2};X509.getSubjectPublicKeyInfoPosFromCertHex=function(e){var f=ASN1HEX.getStartPosOfV_AtObj(e,0);var g=ASN1HEX.getPosArrayOfChildren_AtObj(e,f);if(g.length<1){return -1}if(e.substring(g[0],g[0]+10)=="a003020102"){if(g.length<6){return -1}return g[6]}else{if(g.length<5){return -1}return g[5]}};X509.getPublicKeyHexArrayFromCertHex=function(j){var k=X509.getSubjectPublicKeyPosFromCertHex(j);var i=ASN1HEX.getPosArrayOfChildren_AtObj(j,k);if(i.length!=2){return[]}var l=ASN1HEX.getHexOfV_AtObj(j,i[0]);var g=ASN1HEX.getHexOfV_AtObj(j,i[1]);if(l!=null&&g!=null){return[l,g]}else{return[]}};X509.getHexTbsCertificateFromCert=function(d){var c=ASN1HEX.getStartPosOfV_AtObj(d,0);return c};X509.getPublicKeyHexArrayFromCertPEM=function(f){var e=ASN1HEX.pemToHex(f);var g=X509.getPublicKeyHexArrayFromCertHex(e);return g};X509.hex2dn=function(j,i){if(i===undefined){i=0}if(j.substr(i,2)!=="30"){throw"malformed DN"}var g=new Array();var l=ASN1HEX.getPosArrayOfChildren_AtObj(j,i);for(var k=0;k<l.length;k++){g.push(X509.hex2rdn(j,l[k]))}g=g.map(function(b){return b.replace("/","\\/")});return"/"+g.join("/")};X509.hex2rdn=function(j,i){if(i===undefined){i=0}if(j.substr(i,2)!=="31"){throw"malformed RDN"}var g=new Array();var l=ASN1HEX.getPosArrayOfChildren_AtObj(j,i);for(var k=0;k<l.length;k++){g.push(X509.hex2attrTypeValue(j,l[k]))}g=g.map(function(b){return b.replace("+","\\+")});return g.join("+")};X509.hex2attrTypeValue=function(i,m){if(m===undefined){m=0}if(i.substr(m,2)!=="30"){throw"malformed attribute type and value"}var l=ASN1HEX.getPosArrayOfChildren_AtObj(i,m);if(l.length!==2||i.substr(l[0],2)!=="06"){"malformed attribute type and value"}var k=ASN1HEX.getHexOfV_AtObj(i,l[0]);var o=Ext.asn1.ASN1Util.oidHexToInt(k);var p=Ext.asn1.x509.OID.oid2atype(o);var n=ASN1HEX.getHexOfV_AtObj(i,l[1]);var j=hextorstr(n);return p+"="+j};X509.getPublicKeyFromCertHex=function(i){var k,n,m;var l=6;var o=ASN1HEX;var j=o.getVbyList;m=o.getDecendantHexTLVByNthList(i,0,[0,0]);if(m!=="a003020102"){l=5}n=j(i,0,[0,l,0,0],"06");if(n==="2a864886f70d010101"){k=new RSAKey()}else{if(n==="2a8648ce380401"){k=new Ext.crypto.DSA()}else{if(n==="2a8648ce3d0201"){k=new Ext.crypto.ECDSA()}else{throw"unsupported public key in X.509 cert"}}}k.readCertPubKeyHex(i,l);return k};X509.getPublicKeyFromCertPEM=function(d){var e=ASN1HEX;var f=e.pemToHex(d);return X509.getPublicKeyFromCertHex(f)};X509.getPublicKeyInfoPropOfCertPEM=function(j){var o={};o.algparam=null;var r=ASN1HEX.pemToHex(j);var k=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(k.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(r.substr(k[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var l=ASN1HEX.getPosArrayOfChildren_AtObj(r,k[0]);var q=6;if(r.substr(l[0],2)!=="a0"){q=5}if(l.length<q+1){throw"malformed X.509 certificate PEM (code:003)"}var n=ASN1HEX.getPosArrayOfChildren_AtObj(r,l[q]);if(n.length!=2){throw"malformed X.509 certificate PEM (code:004)"}var p=ASN1HEX.getPosArrayOfChildren_AtObj(r,n[0]);if(p.length!=2){throw"malformed X.509 certificate PEM (code:005)"}o.algoid=ASN1HEX.getHexOfV_AtObj(r,p[0]);if(r.substr(p[1],2)=="06"){o.algparam=ASN1HEX.getHexOfV_AtObj(r,p[1])}else{if(r.substr(p[1],2)=="30"){o.algparam=ASN1HEX.getHexOfTLV_AtObj(r,p[1])}}if(r.substr(n[1],2)!="03"){throw"malformed X.509 certificate PEM (code:006)"}var m=ASN1HEX.getHexOfV_AtObj(r,n[1]);o.keyhex=m.substr(2);return o};X509.getPublicKeyInfoPosOfCertHEX=function(e){var f=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);if(f.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(e.substr(f[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(e,f[0]);if(d.length<7){throw"malformed X.509 certificate PEM (code:003)"}return d[6]};X509.getV3ExtInfoListOfCertHex=function(i){var m=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);if(m.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(i.substr(m[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var p=ASN1HEX.getPosArrayOfChildren_AtObj(i,m[0]);if(p.length<8){throw"malformed X.509 certificate PEM (code:003)"}if(i.substr(p[7],2)!="a3"){throw"malformed X.509 certificate PEM (code:004)"}var o=ASN1HEX.getPosArrayOfChildren_AtObj(i,p[7]);if(o.length!=1){throw"malformed X.509 certificate PEM (code:005)"}if(i.substr(o[0],2)!="30"){throw"malformed X.509 certificate PEM (code:006)"}var n=ASN1HEX.getPosArrayOfChildren_AtObj(i,o[0]);var l=n.length;var k=new Array(l);for(var j=0;j<l;j++){k[j]=X509.getV3ExtItemInfo_AtObj(i,n[j])}return k};X509.getV3ExtItemInfo_AtObj=function(i,n){var j={};j.posTLV=n;var m=ASN1HEX.getPosArrayOfChildren_AtObj(i,n);if(m.length!=2&&m.length!=3){throw"malformed X.509v3 Ext (code:001)"}if(i.substr(m[0],2)!="06"){throw"malformed X.509v3 Ext (code:002)"}var k=ASN1HEX.getHexOfV_AtObj(i,m[0]);j.oid=ASN1HEX.hextooidstr(k);j.critical=false;if(m.length==3){j.critical=true}var l=m[m.length-1];if(i.substr(l,2)!="04"){throw"malformed X.509v3 Ext (code:003)"}j.posV=ASN1HEX.getStartPosOfV_AtObj(i,l);return j};X509.getHexOfTLV_V3ExtValue=function(f,d){var e=X509.getPosOfTLV_V3ExtValue(f,d);if(e==-1){return null}return ASN1HEX.getHexOfTLV_AtObj(f,e)};X509.getHexOfV_V3ExtValue=function(f,d){var e=X509.getPosOfTLV_V3ExtValue(f,d);if(e==-1){return null}return ASN1HEX.getHexOfV_AtObj(f,e)};X509.getPosOfTLV_V3ExtValue=function(j,m){var g=m;if(!m.match(/^[0-9.]+$/)){g=Ext.asn1.x509.OID.name2oid(m)}if(g==""){return -1}var l=X509.getV3ExtInfoListOfCertHex(j);for(var i=0;i<l.length;i++){var k=l[i];if(k.oid==g){return k.posV}}return -1};X509.getExtBasicConstraints=function(f){var e=X509.getHexOfV_V3ExtValue(f,"basicConstraints");if(e===null){return null}if(e===""){return{}}if(e==="0101ff"){return{cA:true}}if(e.substr(0,8)==="0101ff02"){var g=ASN1HEX.getHexOfV_AtObj(e,6);var i=parseInt(g,16);return{cA:true,pathLen:i}}throw"unknown error"};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];X509.getExtKeyUsageBin=function(f){var i=X509.getHexOfV_V3ExtValue(f,"keyUsage");if(i==""){return""}if(i.length%2!=0||i.length<=2){throw"malformed key usage value"}var e=parseInt(i.substr(0,2));var g=parseInt(i.substr(2),16).toString(2);return g.substr(0,g.length-e)};X509.getExtKeyUsageString=function(f){var g=X509.getExtKeyUsageBin(f);var j=new Array();for(var i=0;i<g.length;i++){if(g.substr(i,1)=="1"){j.push(X509.KEYUSAGE_NAME[i])}}return j.join(",")};X509.getExtSubjectKeyIdentifier=function(d){var c=X509.getHexOfV_V3ExtValue(d,"subjectKeyIdentifier");return c};X509.getExtAuthorityKeyIdentifier=function(j){var i={};var k=X509.getHexOfTLV_V3ExtValue(j,"authorityKeyIdentifier");if(k===null){return null}var g=ASN1HEX.getPosArrayOfChildren_AtObj(k,0);for(var l=0;l<g.length;l++){if(k.substr(g[l],2)==="80"){i.kid=ASN1HEX.getHexOfV_AtObj(k,g[l])}}return i};X509.getExtExtKeyUsageName=function(n){var m=new Array();var q=X509.getHexOfTLV_V3ExtValue(n,"extKeyUsage");if(q===null){return null}var l=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);for(var r=0;r<l.length;r++){var o=ASN1HEX.getHexOfV_AtObj(q,l[r]);var p=Ext.asn1.ASN1Util.oidHexToInt(o);var i=Ext.asn1.x509.OID.oid2name(p);m.push(i)}return m};X509.getExtSubjectAltName=function(n){var m=new Array();var i=X509.getHexOfTLV_V3ExtValue(n,"subjectAltName");var l=ASN1HEX.getPosArrayOfChildren_AtObj(i,0);for(var j=0;j<l.length;j++){if(i.substr(l[j],2)==="82"){var k=hextoutf8(ASN1HEX.getHexOfV_AtObj(i,l[j]));m.push(k)}}return m};X509.getExtCRLDistributionPointsURI=function(v){var s=new Array();var y=X509.getHexOfTLV_V3ExtValue(v,"cRLDistributionPoints");var u=ASN1HEX.getPosArrayOfChildren_AtObj(y,0);for(var i=0;i<u.length;i++){var x=ASN1HEX.getHexOfTLV_AtObj(y,u[i]);var r=ASN1HEX.getPosArrayOfChildren_AtObj(x,0);for(var A=0;A<r.length;A++){if(x.substr(r[A],2)==="a0"){var j=ASN1HEX.getHexOfV_AtObj(x,r[A]);if(j.substr(0,2)==="a0"){var q=ASN1HEX.getHexOfV_AtObj(j,0);if(q.substr(0,2)==="86"){var w=ASN1HEX.getHexOfV_AtObj(q,0);var B=hextoutf8(w);s.push(B)}}}}}return s};X509.getExtAIAInfo=function(q){var o={};o.ocsp=[];o.caissuer=[];var p=X509.getPosOfTLV_V3ExtValue(q,"authorityInfoAccess");if(p==-1){return null}if(q.substr(p,2)!="30"){throw"malformed AIA Extn Value"}var k=ASN1HEX.getPosArrayOfChildren_AtObj(q,p);for(var l=0;l<k.length;l++){var n=k[l];var m=ASN1HEX.getPosArrayOfChildren_AtObj(q,n);if(m.length!=2){throw"malformed AccessDescription of AIA Extn"}var i=m[0];var r=m[1];if(ASN1HEX.getHexOfV_AtObj(q,i)=="2b06010505073001"){if(q.substr(r,2)=="86"){o.ocsp.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(q,r)))}}if(ASN1HEX.getHexOfV_AtObj(q,i)=="2b06010505073002"){if(q.substr(r,2)=="86"){o.caissuer.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(q,r)))}}}return o};X509.getSignatureAlgorithmName=function(f){var i=ASN1HEX.getDecendantHexVByNthList(f,0,[1,0]);var e=Ext.asn1.ASN1Util.oidHexToInt(i);var g=Ext.asn1.x509.OID.oid2name(e);return g};X509.getSignatureValueHex=function(d){var c=ASN1HEX.getDecendantHexVByNthList(d,0,[2]);if(c.substr(0,2)!=="00"){throw"can't get signature value"}return c.substr(2)};X509.getSerialNumberHex=function(b){return ASN1HEX.getDecendantHexVByNthList(b,0,[0,1])};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.utils=="undefined"||!Ext.utils){Ext.utils={}}Ext.utils.JWS=function(){var b=Ext.utils.JWS;this.parseJWS=function(v,q){if((this.parsedJWS!==undefined)&&(q||(this.parsedJWS.sigvalH!==undefined))){return}var s=v.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(s==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}var o=s[1];var n=s[2];var r=s[3];var p=o+"."+n;this.parsedJWS={};this.parsedJWS.headB64U=o;this.parsedJWS.payloadB64U=n;this.parsedJWS.sigvalB64U=r;this.parsedJWS.si=p;if(!q){var c=b64utohex(r);var u=parseBigInt(c,16);this.parsedJWS.sigvalH=c;this.parsedJWS.sigvalBI=u}var w=b64utoutf8(o);var m=b64utoutf8(n);this.parsedJWS.headS=w;this.parsedJWS.payloadS=m;if(!b.isSafeJSONString(w,this.parsedJWS,"headP")){throw"malformed JSON string for JWS Head: "+w}}};Ext.utils.JWS.sign=function(w,x,v,D,s){var G=Ext.utils.JWS;var A,H,B;if(typeof x!="string"&&typeof x!="object"){throw"spHeader must be JSON string or object: "+x}if(typeof x=="object"){H=x;A=JSON.stringify(H)}if(typeof x=="string"){A=x;if(!G.isSafeJSONString(A)){throw"JWS Head is not safe JSON string: "+A}H=G.readSafeJSONString(A)}B=v;if(typeof v=="object"){B=JSON.stringify(v)}if((w==""||w==null)&&H.alg!==undefined){w=H.alg}if((w!=""&&w!=null)&&H.alg===undefined){H.alg=w;A=JSON.stringify(H)}if(w!==H.alg){throw"alg and sHeader.alg doesn't match: "+w+"!="+H.alg}var r=null;if(G.jwsalg2sigalg[w]===undefined){throw"unsupported alg name: "+w}else{r=G.jwsalg2sigalg[w]}var J=utf8tob64u(A);var E=utf8tob64u(B);var C=J+"."+E;var y="";if(r.substr(0,4)=="Hmac"){if(D===undefined){throw"mac key shall be specified for HS* alg"}var F=new Ext.crypto.Mac({alg:r,prov:"cryptojs",pass:D});F.updateString(C);y=F.doFinal()}else{if(r.indexOf("withECDSA")!=-1){var u=new Ext.crypto.Signature({alg:r});u.init(D,s);u.updateString(C);hASN1Sig=u.sign();y=Ext.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else{if(r!="none"){var u=new Ext.crypto.Signature({alg:r});u.init(D,s);u.updateString(C);y=u.sign()}}}var I=hextob64u(y);return C+"."+I};Ext.utils.JWS.verify=function(H,A,v){var E=Ext.utils.JWS;var D=H.split(".");var L=D[0];var G=D[1];var N=L+"."+G;var y=b64utohex(D[2]);var B=E.readSafeJSONString(b64utoutf8(D[0]));var u=null;var w=null;if(B.alg===undefined){throw"algorithm not specified in header"}else{u=B.alg;w=u.substr(0,2)}if(v!=null&&Object.prototype.toString.call(v)==="[object Array]"&&v.length>0){var M=":"+v.join(":")+":";if(M.indexOf(":"+u+":")==-1){throw"algorithm '"+u+"' not accepted in the list"}}if(u!="none"&&A===null){throw"key shall be specified to verify."}if(typeof A=="string"&&A.indexOf("-----BEGIN ")!=-1){A=KEYUTIL.getKey(A)}if(w=="RS"||w=="PS"){if(!(A instanceof RSAKey)){throw"key shall be a RSAKey obj for RS* and PS* algs"}}if(w=="ES"){if(!(A instanceof Ext.crypto.ECDSA)){throw"key shall be a ECDSA obj for ES* algs"}}if(u=="none"){}var C=null;if(E.jwsalg2sigalg[B.alg]===undefined){throw"unsupported alg name: "+u}else{C=E.jwsalg2sigalg[u]}if(C=="none"){throw"not supported"}else{if(C.substr(0,4)=="Hmac"){var I=null;if(A===undefined){throw"hexadecimal key shall be specified for HMAC"}var F=new Ext.crypto.Mac({alg:C,pass:A});F.updateString(N);I=F.doFinal();return y==I}else{if(C.indexOf("withECDSA")!=-1){var J=null;try{J=Ext.crypto.ECDSA.concatSigToASN1Sig(y)}catch(x){return false}var K=new Ext.crypto.Signature({alg:C});K.init(A);K.updateString(N);return K.verify(J)}else{var K=new Ext.crypto.Signature({alg:C});K.init(A);K.updateString(N);return K.verify(y)}}}};Ext.utils.JWS.parse=function(n){var l=n.split(".");var m={};var i,j,k;if(l.length!=2&&l.length!=3){throw"malformed sJWS: wrong number of '.' splitted elements"}i=l[0];j=l[1];if(l.length==3){k=l[2]}m.headerObj=Ext.utils.JWS.readSafeJSONString(b64utoutf8(i));m.payloadObj=Ext.utils.JWS.readSafeJSONString(b64utoutf8(j));m.headerPP=JSON.stringify(m.headerObj,null,"  ");if(m.payloadObj==null){m.payloadPP=b64utoutf8(j)}else{m.payloadPP=JSON.stringify(m.payloadObj,null,"  ")}if(k!==undefined){m.sigHex=b64utohex(k)}return m};Ext.utils.JWS.verifyJWT=function(r,u,v){var x=Ext.utils.JWS;var A=r.split(".");var p=A[0];var y=A[1];var q=p+"."+y;var w=b64utohex(A[2]);var o=x.readSafeJSONString(b64utoutf8(p));var n=x.readSafeJSONString(b64utoutf8(y));if(o.alg===undefined){return false}if(v.alg===undefined){throw"acceptField.alg shall be specified"}if(!x.inArray(o.alg,v.alg)){return false}if(n.iss!==undefined&&typeof v.iss==="object"){if(!x.inArray(n.iss,v.iss)){return false}}if(n.sub!==undefined&&typeof v.sub==="object"){if(!x.inArray(n.sub,v.sub)){return false}}if(n.aud!==undefined&&typeof v.aud==="object"){if(typeof n.aud=="string"){if(!x.inArray(n.aud,v.aud)){return false}}else{if(typeof n.aud=="object"){if(!x.includedArray(n.aud,v.aud)){return false}}}}var s=Ext.utils.IntDate.getNow();if(v.verifyAt!==undefined&&typeof v.verifyAt==="number"){s=v.verifyAt}if(v.gracePeriod===undefined||typeof v.gracePeriod!=="number"){v.gracePeriod=0}if(n.exp!==undefined&&typeof n.exp=="number"){if(n.exp+v.gracePeriod<s){return false}}if(n.nbf!==undefined&&typeof n.nbf=="number"){if(s<n.nbf-v.gracePeriod){return false}}if(n.iat!==undefined&&typeof n.iat=="number"){if(s<n.iat-v.gracePeriod){return false}}if(n.jti!==undefined&&v.jti!==undefined){if(n.jti!==v.jti){return false}}if(!Ext.utils.JWS.verify(r,u,v.alg)){return false}return true};Ext.utils.JWS.includedArray=function(i,e){var f=Ext.utils.JWS.inArray;if(i===null){return false}if(typeof i!=="object"){return false}if(typeof i.length!=="number"){return false}for(var g=0;g<i.length;g++){if(!f(i[g],e)){return false}}return true};Ext.utils.JWS.inArray=function(e,g){if(g===null){return false}if(typeof g!=="object"){return false}if(typeof g.length!=="number"){return false}for(var f=0;f<g.length;f++){if(g[f]==e){return true}}return false};Ext.utils.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none",};Ext.utils.JWS.isSafeJSONString=function(f,g,k){var j=null;try{j=jsonParse(f);if(typeof j!="object"){return 0}if(j.constructor===Array){return 0}if(g){g[k]=j}return 1}catch(i){return 0}};Ext.utils.JWS.readSafeJSONString=function(f){var e=null;try{e=jsonParse(f);if(typeof e!="object"){return null}if(e.constructor===Array){return null}return e}catch(d){return null}};Ext.utils.JWS.getEncodedSignatureValueFromJWS=function(d){var c=d.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(c==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}return c[1]};Ext.utils.JWS.getJWKthumbprint=function(k){if(k.kty!=="RSA"&&k.kty!=="EC"&&k.kty!=="oct"){throw"unsupported algorithm for JWK Thumprint"}var i="{";if(k.kty==="RSA"){if(typeof k.n!="string"||typeof k.e!="string"){throw"wrong n and e value for RSA key"}i+='"e":"'+k.e+'",';i+='"kty":"'+k.kty+'",';i+='"n":"'+k.n+'"}'}else{if(k.kty==="EC"){if(typeof k.crv!="string"||typeof k.x!="string"||typeof k.y!="string"){throw"wrong crv, x and y value for EC key"}i+='"crv":"'+k.crv+'",';i+='"kty":"'+k.kty+'",';i+='"x":"'+k.x+'",';i+='"y":"'+k.y+'"}'}else{if(k.kty==="oct"){if(typeof k.k!="string"){throw"wrong k value for oct(symmetric) key"}i+='"kty":"'+k.kty+'",';i+='"k":"'+k.k+'"}'}}}var g=rstrtohex(i);var f=Ext.crypto.Util.hashHex(g,"sha256");var j=hextob64u(f);return j};Ext.utils.IntDate={};Ext.utils.IntDate.get=function(b){if(b=="now"){return Ext.utils.IntDate.getNow()}else{if(b=="now + 1hour"){return Ext.utils.IntDate.getNow()+60*60}else{if(b=="now + 1day"){return Ext.utils.IntDate.getNow()+60*60*24}else{if(b=="now + 1month"){return Ext.utils.IntDate.getNow()+60*60*24*30}else{if(b=="now + 1year"){return Ext.utils.IntDate.getNow()+60*60*24*365}else{if(b.match(/Z$/)){return Ext.utils.IntDate.getZulu(b)}else{if(b.match(/^[0-9]+$/)){return parseInt(b)}}}}}}}throw"unsupported format: "+b};Ext.utils.IntDate.getZulu=function(d){var s=d.match(/(\d+)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z/);if(s){var u=s[1];var m=parseInt(u);if(u.length==4){}else{if(u.length==2){if(50<=m&&m<100){m=1900+m}else{if(0<=m&&m<50){m=2000+m}else{throw"malformed year string for UTCTime"}}}else{throw"malformed year string"}}var o=parseInt(s[2])-1;var l=parseInt(s[3]);var r=parseInt(s[4]);var q=parseInt(s[5]);var p=parseInt(s[6]);var n=new Date(Date.UTC(m,o,l,r,q,p));return ~~(n/1000)}throw"unsupported format: "+d};Ext.utils.IntDate.getNow=function(){var b=~~(new Date()/1000);return b};Ext.utils.IntDate.intDate2UTCString=function(c){var d=new Date(c*1000);return d.toUTCString()};Ext.utils.IntDate.intDate2Zulu=function(p){var l=new Date(p*1000);var k=("0000"+l.getUTCFullYear()).slice(-4);var o=("00"+(l.getUTCMonth()+1)).slice(-2);var n=("00"+l.getUTCDate()).slice(-2);var m=("00"+l.getUTCHours()).slice(-2);var j=("00"+l.getUTCMinutes()).slice(-2);var d=("00"+l.getUTCSeconds()).slice(-2);return k+o+n+m+j+d+"Z"};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.utils=="undefined"||!Ext.utils){Ext.utils={}}Ext.utils.JWSJS=function(){var d=Ext.utils.JWS;var c=Ext.utils.JWS;this.aHeader=[];this.sPayload="";this.aSignature=[];this.init=function(){this.aHeader=[];this.sPayload=undefined;this.aSignature=[]};this.initWithJWS=function(e){this.init();var b=e.split(".");if(b.length!=3){throw"malformed input JWS"}this.aHeader.push(b[0]);this.sPayload=b[1];this.aSignature.push(b[2])};this.addSignature=function(b,r,m,o){if(this.sPayload===undefined||this.sPayload===null){throw"there's no JSON-JS signature to add."}var n=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length){throw"aHeader.length != aSignature.length"}try{var u=Ext.utils.JWS.sign(b,r,this.sPayload,m,o);var p=u.split(".");var e=p[0];var s=p[2];this.aHeader.push(p[0]);this.aSignature.push(p[2])}catch(q){if(this.aHeader.length>n){this.aHeader.pop()}if(this.aSignature.length>n){this.aSignature.pop()}throw"addSignature failed: "+q}};this.addSignatureByHeaderKey=function(b,j){var e=b64utoutf8(this.sPayload);var i=new Ext.utils.JWS();var k=i.generateJWSByP1PrvKey(b,e,j);this.aHeader.push(i.parsedJWS.headB64U);this.aSignature.push(i.parsedJWS.sigvalB64U)};this.addSignatureByHeaderPayloadKey=function(b,e,j){var i=new Ext.utils.JWS();var k=i.generateJWSByP1PrvKey(b,e,j);this.aHeader.push(i.parsedJWS.headB64U);this.sPayload=i.parsedJWS.payloadB64U;this.aSignature.push(i.parsedJWS.sigvalB64U)};this.verifyAll=function(e){if(this.aHeader.length!==e.length||this.aSignature.length!==e.length){return false}for(var g=0;g<e.length;g++){var i=e[g];if(i.length!==2){return false}var b=this.verifyNth(g,i[0],i[1]);if(b===false){return false}}return true};this.verifyNth=function(n,m,b){if(this.aHeader.length<=n||this.aSignature.length<=n){return false}var l=this.aHeader[n];var k=this.aSignature[n];var o=l+"."+this.sPayload+"."+k;var p=false;try{p=c.verify(o,m,b)}catch(e){return false}return p};this.verifyWithCerts=function(b){if(this.aHeader.length!=b.length){throw"num headers does not match with num certs"}if(this.aSignature.length!=b.length){throw"num signatures does not match with num certs"}var p=this.sPayload;var s="";for(var w=0;w<b.length;w++){var u=b[w];var v=this.aHeader[w];var i=this.aSignature[w];var e=v+"."+p+"."+i;var q=new Ext.utils.JWS();try{var o=q.verifyJWSByPemX509Cert(e,u);if(o!=1){s+=(w+1)+"th signature unmatch. "}}catch(r){s+=(w+1)+"th signature fail("+r+"). "}}if(s==""){return 1}else{throw s}};this.readJWSJS=function(e){if(typeof e==="string"){var f=d.readSafeJSONString(e);if(f==null){throw"argument is not safe JSON object string"}this.aHeader=f.headers;this.sPayload=f.payload;this.aSignature=f.signatures}else{try{if(e.headers.length>0){this.aHeader=e.headers}else{throw"malformed header"}if(typeof e.payload==="string"){this.sPayload=e.payload}else{throw"malformed signatures"}if(e.signatures.length>0){this.signatures=e.signatures}else{throw"malformed signatures"}}catch(b){throw"malformed JWS-JS JSON object: "+b}}};this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}};this.isEmpty=function(){if(this.aHeader.length==0){return 1}return 0}};