if(typeof YAHOO=="undefined"||!YAHOO){var YAHOO={}}YAHOO.namespace=function(){var b=arguments,g=null,e,c,f;for(e=0;e<b.length;e=e+1){f=(""+b[e]).split(".");g=YAHOO;for(c=(f[0]=="YAHOO")?1:0;c<f.length;c=c+1){g[f[c]]=g[f[c]]||{};g=g[f[c]]}}return g};YAHOO.log=function(j,b,d){var c=YAHOO.widget.Logger;if(c&&c.log){return c.log(j,b,d)}else{return false}};YAHOO.register=function(j,c,u){var g=YAHOO.env.modules,k,f,e,d,s;if(!g[j]){g[j]={versions:[],builds:[]}}k=g[j];f=u.version;e=u.build;d=YAHOO.env.listeners;k.name=j;k.version=f;k.build=e;k.versions.push(f);k.builds.push(e);k.mainClass=c;for(s=0;s<d.length;s=s+1){d[s](k)}if(c){c.VERSION=f;c.BUILD=e}else{YAHOO.log("mainClass is undefined for module "+j,"warn")}};YAHOO.env=YAHOO.env||{modules:[],listeners:[]};YAHOO.env.getVersion=function(c){return YAHOO.env.modules[c]||null};YAHOO.env.parseUA=function(f){var q=function(j){var i=0;return parseFloat(j.replace(/\./g,function(){return(i++==1)?"":"."}))},b=navigator,d={ie:0,opera:0,gecko:0,webkit:0,chrome:0,mobile:null,air:0,ipad:0,iphone:0,ipod:0,ios:null,android:0,webos:0,caja:b&&b.cajaVersion,secure:false,os:null},g=f||(navigator&&navigator.userAgent),c=window&&window.location,r=c&&c.href,e;d.secure=r&&(r.toLowerCase().indexOf("https")===0);if(g){if((/windows|win32/i).test(g)){d.os="windows"}else{if((/macintosh/i).test(g)){d.os="macintosh"}else{if((/rhino/i).test(g)){d.os="rhino"}}}if((/KHTML/).test(g)){d.webkit=1}e=g.match(/AppleWebKit\/([^\s]*)/);if(e&&e[1]){d.webkit=q(e[1]);if(/ Mobile\//.test(g)){d.mobile="Apple";e=g.match(/OS ([^\s]*)/);if(e&&e[1]){e=q(e[1].replace("_","."))}d.ios=e;d.ipad=d.ipod=d.iphone=0;e=g.match(/iPad|iPod|iPhone/);if(e&&e[0]){d[e[0].toLowerCase()]=d.ios}}else{e=g.match(/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/);if(e){d.mobile=e[0]}if(/webOS/.test(g)){d.mobile="WebOS";e=g.match(/webOS\/([^\s]*);/);if(e&&e[1]){d.webos=q(e[1])}}if(/ Android/.test(g)){d.mobile="Android";e=g.match(/Android ([^\s]*);/);if(e&&e[1]){d.android=q(e[1])}}}e=g.match(/Chrome\/([^\s]*)/);if(e&&e[1]){d.chrome=q(e[1])}else{e=g.match(/AdobeAIR\/([^\s]*)/);if(e){d.air=e[0]}}}if(!d.webkit){e=g.match(/Opera[\s\/]([^\s]*)/);if(e&&e[1]){d.opera=q(e[1]);e=g.match(/Version\/([^\s]*)/);if(e&&e[1]){d.opera=q(e[1])}e=g.match(/Opera Mini[^;]*/);if(e){d.mobile=e[0]}}else{e=g.match(/MSIE\s([^;]*)/);if(e&&e[1]){d.ie=q(e[1])}else{e=g.match(/Gecko\/([^\s]*)/);if(e){d.gecko=1;e=g.match(/rv:([^\s\)]*)/);if(e&&e[1]){d.gecko=q(e[1])}}}}}}return d};YAHOO.env.ua=YAHOO.env.parseUA();(function(){YAHOO.namespace("util","widget","example");if("undefined"!==typeof YAHOO_config){var c=YAHOO_config.listener,b=YAHOO.env.listeners,j=true,d;if(c){for(d=0;d<b.length;d++){if(b[d]==c){j=false;break}}if(j){b.push(c)}}}})();YAHOO.lang=YAHOO.lang||{};(function(){var c=YAHOO.lang,g=Object.prototype,s="[object Array]",e="[object Function]",f="[object Object]",i=[],d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;","`":"&#x60;"},u=["toString","valueOf"],b={isArray:function(j){return g.toString.apply(j)===s},isBoolean:function(j){return typeof j==="boolean"},isFunction:function(j){return(typeof j==="function")||g.toString.apply(j)===e},isNull:function(j){return j===null},isNumber:function(j){return typeof j==="number"&&isFinite(j)},isObject:function(j){return(j&&(typeof j==="object"||c.isFunction(j)))||false},isString:function(j){return typeof j==="string"},isUndefined:function(j){return typeof j==="undefined"},_IEEnumFix:(YAHOO.env.ua.ie)?function(l,k){var j,n,m;for(j=0;j<u.length;j=j+1){n=u[j];m=k[n];if(c.isFunction(m)&&m!=g[n]){l[n]=m}}}:function(){},escapeHTML:function(j){return j.replace(/[&<>"'\/`]/g,function(k){return d[k]})},extend:function(m,n,l){if(!n||!m){throw new Error("extend failed, please check that all dependencies are included.")}var k=function(){},j;k.prototype=n.prototype;m.prototype=new k();m.prototype.constructor=m;m.superclass=n.prototype;if(n.prototype.constructor==g.constructor){n.prototype.constructor=n}if(l){for(j in l){if(c.hasOwnProperty(l,j)){m.prototype[j]=l[j]}}c._IEEnumFix(m.prototype,l)}},augmentObject:function(k,j){if(!j||!k){throw new Error("Absorb failed, verify dependencies.")}var m=arguments,o,l,n=m[2];if(n&&n!==true){for(o=2;o<m.length;o=o+1){k[m[o]]=j[m[o]]}}else{for(l in j){if(n||!(l in k)){k[l]=j[l]}}c._IEEnumFix(k,j)}return k},augmentProto:function(l,k){if(!k||!l){throw new Error("Augment failed, verify dependencies.")}var m=[l.prototype,k.prototype],j;for(j=2;j<arguments.length;j=j+1){m.push(arguments[j])}c.augmentObject.apply(this,m);return l},dump:function(m,r){var o,q,k=[],l="{...}",n="f(){...}",j=", ",p=" => ";if(!c.isObject(m)){return m+""}else{if(m instanceof Date||("nodeType" in m&&"tagName" in m)){return m}else{if(c.isFunction(m)){return n}}}r=(c.isNumber(r))?r:3;if(c.isArray(m)){k.push("[");for(o=0,q=m.length;o<q;o=o+1){if(c.isObject(m[o])){k.push((r>0)?c.dump(m[o],r-1):l)}else{k.push(m[o])}k.push(j)}if(k.length>1){k.pop()}k.push("]")}else{k.push("{");for(o in m){if(c.hasOwnProperty(m,o)){k.push(o+p);if(c.isObject(m[o])){k.push((r>0)?c.dump(m[o],r-1):l)}else{k.push(m[o])}k.push(j)}}if(k.length>1){k.pop()}k.push("}")}return k.join("")},substitute:function(B,r,F,j){var y,A,p,x,q,G,w=[],m,C=B.length,n="dump",D=" ",o="{",k="}",l,E;for(;;){y=B.lastIndexOf(o,C);if(y<0){break}A=B.indexOf(k,y);if(y+1>A){break}m=B.substring(y+1,A);x=m;G=null;p=x.indexOf(D);if(p>-1){G=x.substring(p+1);x=x.substring(0,p)}q=r[x];if(F){q=F(x,q,G)}if(c.isObject(q)){if(c.isArray(q)){q=c.dump(q,parseInt(G,10))}else{G=G||"";l=G.indexOf(n);if(l>-1){G=G.substring(4)}E=q.toString();if(E===f||l>-1){q=c.dump(q,parseInt(G,10))}else{q=E}}}else{if(!c.isString(q)&&!c.isNumber(q)){q="~-"+w.length+"-~";w[w.length]=m}}B=B.substring(0,y)+q+B.substring(A+1);if(j===false){C=y-1}}for(y=w.length-1;y>=0;y=y-1){B=B.replace(new RegExp("~-"+y+"-~"),"{"+w[y]+"}","g")}return B},trim:function(k){try{return k.replace(/^\s+|\s+$/g,"")}catch(j){return k}},merge:function(){var m={},k=arguments,j=k.length,l;for(l=0;l<j;l=l+1){c.augmentObject(m,k[l],true)}return m},later:function(m,p,n,r,j){m=m||0;p=p||{};var q=n,l=r,k,o;if(c.isString(n)){q=p[n]}if(!q){throw new TypeError("method undefined")}if(!c.isUndefined(r)&&!c.isArray(l)){l=[r]}k=function(){q.apply(p,l||i)};o=(j)?setInterval(k,m):setTimeout(k,m);return{interval:j,cancel:function(){if(this.interval){clearInterval(o)}else{clearTimeout(o)}}}},isValue:function(j){return(c.isObject(j)||c.isString(j)||c.isNumber(j)||c.isBoolean(j))}};c.hasOwnProperty=(g.hasOwnProperty)?function(k,j){return k&&k.hasOwnProperty&&k.hasOwnProperty(j)}:function(k,j){return !c.isUndefined(k[j])&&k.constructor.prototype[j]!==k[j]};b.augmentObject(c,b,true);YAHOO.util.Lang=c;c.augment=c.augmentProto;YAHOO.augment=c.augmentProto;YAHOO.extend=c.extend})();YAHOO.register("yahoo",YAHOO,{version:"2.9.0",build:"2800"});var CryptoJS=CryptoJS||(function(e,b){var k={};var m=k.lib={};var g=m.Base=(function(){function n(){}return{extend:function(p){n.prototype=this;var o=new n();if(p){o.mixIn(p)}if(!o.hasOwnProperty("init")){o.init=function(){o.$super.init.apply(this,arguments)}}o.init.prototype=o;o.$super=this;return o},create:function(){var o=this.extend();o.init.apply(o,arguments);return o},init:function(){},mixIn:function(p){for(var o in p){if(p.hasOwnProperty(o)){this[o]=p[o]}}if(p.hasOwnProperty("toString")){this.toString=p.toString}},clone:function(){return this.init.prototype.extend(this)}}}());var i=m.WordArray=g.extend({init:function(n,o){n=this.words=n||[];if(o!=b){this.sigBytes=o}else{this.sigBytes=n.length*4}},toString:function(n){return(n||d).stringify(this)},concat:function(u){var q=this.words;var p=u.words;var n=this.sigBytes;var s=u.sigBytes;this.clamp();if(n%4){for(var r=0;r<s;r++){var o=(p[r>>>2]>>>(24-(r%4)*8))&255;q[(n+r)>>>2]|=o<<(24-((n+r)%4)*8)}}else{for(var r=0;r<s;r+=4){q[(n+r)>>>2]=p[r>>>2]}}this.sigBytes+=s;return this},clamp:function(){var n=this.words;var o=this.sigBytes;n[o>>>2]&=4294967295<<(32-(o%4)*8);n.length=e.ceil(o/4)},clone:function(){var n=g.clone.call(this);n.words=this.words.slice(0);return n},random:function(o){var n=[];for(var p=0;p<o;p+=4){n.push((e.random()*4294967296)|0)}return new i.init(n,o)}});var j=k.enc={};var d=j.Hex={stringify:function(o){var q=o.words;var n=o.sigBytes;var p=[];for(var s=0;s<n;s++){var r=(q[s>>>2]>>>(24-(s%4)*8))&255;p.push((r>>>4).toString(16));p.push((r&15).toString(16))}return p.join("")},parse:function(o){var q=o.length;var p=[];for(var n=0;n<q;n+=2){p[n>>>3]|=parseInt(o.substr(n,2),16)<<(24-(n%8)*4)}return new i.init(p,q/2)}};var C=j.Latin1={stringify:function(p){var q=p.words;var o=p.sigBytes;var s=[];for(var n=0;n<o;n++){var r=(q[n>>>2]>>>(24-(n%4)*8))&255;s.push(String.fromCharCode(r))}return s.join("")},parse:function(o){var q=o.length;var p=[];for(var n=0;n<q;n++){p[n>>>2]|=(o.charCodeAt(n)&255)<<(24-(n%4)*8)}return new i.init(p,q)}};var D=j.Utf8={stringify:function(o){try{return decodeURIComponent(escape(C.stringify(o)))}catch(n){throw new Error("Malformed UTF-8 data")}},parse:function(n){return C.parse(unescape(encodeURIComponent(n)))}};var f=m.BufferedBlockAlgorithm=g.extend({reset:function(){this._data=new i.init();this._nDataBytes=0},_append:function(n){if(typeof n=="string"){n=D.parse(n)}this._data.concat(n);this._nDataBytes+=n.sigBytes},_process:function(y){var r=this._data;var n=r.words;var o=r.sigBytes;var v=this.blockSize;var x=v*4;var w=o/x;if(y){w=e.ceil(w)}else{w=e.max((w|0)-this._minBufferSize,0)}var u=w*v;var s=e.min(u*4,o);if(u){for(var q=0;q<u;q+=v){this._doProcessBlock(n,q)}var p=n.splice(0,u);r.sigBytes-=s}return new i.init(p,s)},clone:function(){var n=g.clone.call(this);n._data=this._data.clone();return n},_minBufferSize:0});var l=m.Hasher=f.extend({cfg:g.extend(),init:function(n){this.cfg=this.cfg.extend(n);this.reset()},reset:function(){f.reset.call(this);this._doReset()},update:function(n){this._append(n);this._process();return this},finalize:function(o){if(o){this._append(o)}var n=this._doFinalize();return n},blockSize:512/32,_createHelper:function(n){return function(p,o){return new n.init(o).finalize(p)}},_createHmacHelper:function(n){return function(p,o){return new c.HMAC.init(n,o).finalize(p)}}});var c=k.algo={};return k}(Math));(function(g){var l=CryptoJS,f=l.lib,e=f.Base,k=f.WordArray,l=l.x64={};l.Word=e.extend({init:function(c,b){this.high=c;this.low=b}});l.WordArray=e.extend({init:function(c,b){c=this.words=c||[];this.sigBytes=b!=g?b:8*c.length},toX32:function(){for(var b=this.words,c=b.length,j=[],d=0;d<c;d++){var i=b[d];j.push(i.high);j.push(i.low)}return k.create(j,this.sigBytes)},clone:function(){for(var c=e.clone.call(this),d=c.words=this.words.slice(0),b=d.length,i=0;i<b;i++){d[i]=d[i].clone()}return c}})})();CryptoJS.lib.Cipher||function(g){var G=CryptoJS,u=G.lib,H=u.Base,v=u.WordArray,q=u.BufferedBlockAlgorithm,s=G.enc.Base64,l=G.algo.EvpKDF,n=u.Cipher=q.extend({cfg:H.extend(),createEncryptor:function(b,c){return this.create(this._ENC_XFORM_MODE,b,c)},createDecryptor:function(b,c){return this.create(this._DEC_XFORM_MODE,b,c)},init:function(b,c,d){this.cfg=this.cfg.extend(d);this._xformMode=b;this._key=c;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(b){this._append(b);return this._process()},finalize:function(b){b&&this._append(b);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(e,c,d){return("string"==typeof c?j:f).encrypt(b,e,c,d)},decrypt:function(e,c,d){return("string"==typeof c?j:f).decrypt(b,e,c,d)}}}});u.StreamCipher=n.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var m=G.mode={},k=function(i,b,c){var d=this._iv;d?this._iv=g:d=this._prevBlock;for(var e=0;e<c;e++){i[b+e]^=d[e]}},r=(u.BlockCipherMode=H.extend({createEncryptor:function(b,c){return this.Encryptor.create(b,c)},createDecryptor:function(b,c){return this.Decryptor.create(b,c)},init:function(b,c){this._cipher=b;this._iv=c}})).extend();r.Encryptor=r.extend({processBlock:function(b,c){var d=this._cipher,e=d.blockSize;k.call(this,b,c,e);d.encryptBlock(b,c);this._prevBlock=b.slice(c,c+e)}});r.Decryptor=r.extend({processBlock:function(i,b){var c=this._cipher,d=c.blockSize,e=i.slice(b,b+d);c.decryptBlock(i,b);k.call(this,i,b,d);this._prevBlock=e}});m=m.CBC=r;r=(G.pad={}).Pkcs7={pad:function(e,i){for(var c=4*i,c=c-e.sigBytes%c,o=c<<24|c<<16|c<<8|c,b=[],d=0;d<c;d+=4){b.push(o)}c=v.create(b,c);e.concat(c)},unpad:function(b){b.sigBytes-=b.words[b.sigBytes-1>>>2]&255}};u.BlockCipher=n.extend({cfg:n.cfg.extend({mode:m,padding:r}),reset:function(){n.reset.call(this);var b=this.cfg,c=b.iv,b=b.mode;if(this._xformMode==this._ENC_XFORM_MODE){var d=b.createEncryptor}else{d=b.createDecryptor,this._minBufferSize=1}this._mode=d.call(b,this,c&&c.words)},_doProcessBlock:function(b,c){this._mode.processBlock(b,c)},_doFinalize:function(){var b=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){b.pad(this._data,this.blockSize);var c=this._process(!0)}else{c=this._process(!0),b.unpad(c)}return c},blockSize:4});var p=u.CipherParams=H.extend({init:function(b){this.mixIn(b)},toString:function(b){return(b||this.formatter).stringify(this)}}),m=(G.format={}).OpenSSL={stringify:function(b){var c=b.ciphertext;b=b.salt;return(b?v.create([1398893684,1701076831]).concat(b).concat(c):c).toString(s)},parse:function(b){b=s.parse(b);var c=b.words;if(1398893684==c[0]&&1701076831==c[1]){var d=v.create(c.slice(2,4));c.splice(0,4);b.sigBytes-=16}return p.create({ciphertext:b,salt:d})}},f=u.SerializableCipher=H.extend({cfg:H.extend({format:m}),encrypt:function(i,b,c,d){d=this.cfg.extend(d);var e=i.createEncryptor(c,d);b=e.finalize(b);e=e.cfg;return p.create({ciphertext:b,key:c,iv:e.iv,algorithm:i,mode:e.mode,padding:e.padding,blockSize:i.blockSize,formatter:d.format})},decrypt:function(b,c,d,e){e=this.cfg.extend(e);c=this._parse(c,e.format);return b.createDecryptor(d,e).finalize(c.ciphertext)},_parse:function(b,c){return"string"==typeof b?c.parse(b,this):b}}),G=(G.kdf={}).OpenSSL={execute:function(b,c,d,e){e||(e=v.random(8));b=l.create({keySize:c+d}).compute(b,e);d=v.create(b.words.slice(c),4*d);b.sigBytes=4*c;return p.create({key:b,iv:d,salt:e})}},j=u.PasswordBasedCipher=f.extend({cfg:f.cfg.extend({kdf:G}),encrypt:function(b,c,d,e){e=this.cfg.extend(e);d=e.kdf.execute(d,b.keySize,b.ivSize);e.iv=d.iv;b=f.encrypt.call(this,b,c,d.key,e);b.mixIn(d);return b},decrypt:function(b,c,d,e){e=this.cfg.extend(e);c=this._parse(c,e.format);d=e.kdf.execute(d,b.keySize,b.ivSize,c.salt);e.iv=d.iv;return f.decrypt.call(this,b,c,d.key,e)}})}();(function(){for(var A=CryptoJS,r=A.lib.BlockCipher,q=A.algo,j=[],W=[],X=[],u=[],F=[],v=[],w=[],y=[],D=[],s=[],g=[],k=0;256>k;k++){g[k]=128>k?k<<1:k<<1^283}for(var n=0,l=0,k=0;256>k;k++){var f=l^l<<1^l<<2^l<<3^l<<4,f=f>>>8^f&255^99;j[n]=f;W[f]=n;var x=g[n],B=g[x],E=g[B],b=257*g[f]^16843008*f;X[n]=b<<24|b>>>8;u[n]=b<<16|b>>>16;F[n]=b<<8|b>>>24;v[n]=b;b=16843009*E^65537*B^257*x^16843008*n;w[f]=b<<24|b>>>8;y[f]=b<<16|b>>>16;D[f]=b<<8|b>>>24;s[f]=b;n?(n=x^g[g[g[E^x]]],l^=g[g[l]]):n=l=1}var C=[0,1,2,4,8,16,32,64,128,27,54],q=q.AES=r.extend({_doReset:function(){for(var m=this._key,d=m.words,e=m.sigBytes/4,m=4*((this._nRounds=e+6)+1),o=this._keySchedule=[],c=0;c<m;c++){if(c<e){o[c]=d[c]}else{var i=o[c-1];c%e?6<e&&4==c%e&&(i=j[i>>>24]<<24|j[i>>>16&255]<<16|j[i>>>8&255]<<8|j[i&255]):(i=i<<8|i>>>24,i=j[i>>>24]<<24|j[i>>>16&255]<<16|j[i>>>8&255]<<8|j[i&255],i^=C[c/e|0]<<24);o[c]=o[c-e]^i}}d=this._invKeySchedule=[];for(e=0;e<m;e++){c=m-e,i=e%4?o[c]:o[c-4],d[e]=4>e||4>=c?i:w[j[i>>>24]]^y[j[i>>>16&255]]^D[j[i>>>8&255]]^s[j[i&255]]}},encryptBlock:function(d,c){this._doCryptBlock(d,c,this._keySchedule,X,u,F,v,j)},decryptBlock:function(e,c){var d=e[c+1];e[c+1]=e[c+3];e[c+3]=d;this._doCryptBlock(e,c,this._invKeySchedule,w,y,D,s,W);d=e[c+1];e[c+1]=e[c+3];e[c+3]=d},_doCryptBlock:function(Q,o,O,P,e,p,G,M){for(var N=this._nRounds,I=Q[o]^O[0],c=Q[o+1]^O[1],K=Q[o+2]^O[2],H=Q[o+3]^O[3],L=4,m=1;m<N;m++){var d=P[I>>>24]^e[c>>>16&255]^p[K>>>8&255]^G[H&255]^O[L++],i=P[c>>>24]^e[K>>>16&255]^p[H>>>8&255]^G[I&255]^O[L++],J=P[K>>>24]^e[H>>>16&255]^p[I>>>8&255]^G[c&255]^O[L++],H=P[H>>>24]^e[I>>>16&255]^p[c>>>8&255]^G[K&255]^O[L++],I=d,c=i,K=J}d=(M[I>>>24]<<24|M[c>>>16&255]<<16|M[K>>>8&255]<<8|M[H&255])^O[L++];i=(M[c>>>24]<<24|M[K>>>16&255]<<16|M[H>>>8&255]<<8|M[I&255])^O[L++];J=(M[K>>>24]<<24|M[H>>>16&255]<<16|M[I>>>8&255]<<8|M[c&255])^O[L++];H=(M[H>>>24]<<24|M[I>>>16&255]<<16|M[c>>>8&255]<<8|M[K&255])^O[L++];Q[o]=d;Q[o+1]=i;Q[o+2]=J;Q[o+3]=H},keySize:8});A.AES=r._createHelper(q)})();(function(){function B(c,d){var b=(this._lBlock>>>c^this._rBlock)&d;this._rBlock^=b;this._lBlock^=b<<c}function q(c,d){var b=(this._rBlock>>>c^this._lBlock)&d;this._lBlock^=b;this._rBlock^=b<<c}var p=CryptoJS,n=p.lib,s=n.WordArray,n=n.BlockCipher,A=p.algo,r=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],l=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],g=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],e=[{"0":8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{"0":1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{"0":260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{"0":2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{"0":128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{"0":268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{"0":1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{"0":134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],m=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],j=A.DES=n.extend({_doReset:function(){for(var c=this._key.words,d=[],b=0;56>b;b++){var k=r[b]-1;d[b]=c[k>>>5]>>>31-k%32&1}c=this._subKeys=[];for(k=0;16>k;k++){for(var f=c[k]=[],i=g[k],b=0;24>b;b++){f[b/6|0]|=d[(l[b]-1+i)%28]<<31-b%6,f[4+(b/6|0)]|=d[28+(l[b+24]-1+i)%28]<<31-b%6}f[0]=f[0]<<1|f[0]>>>31;for(b=1;7>b;b++){f[b]>>>=4*(b-1)+3}f[7]=f[7]<<5|f[7]>>>27}d=this._invSubKeys=[];for(b=0;16>b;b++){d[b]=c[15-b]}},encryptBlock:function(c,b){this._doCryptBlock(c,b,this._subKeys)},decryptBlock:function(c,b){this._doCryptBlock(c,b,this._invSubKeys)},_doCryptBlock:function(i,k,v){this._lBlock=i[k];this._rBlock=i[k+1];B.call(this,4,252645135);B.call(this,16,65535);q.call(this,2,858993459);q.call(this,8,16711935);B.call(this,1,1431655765);for(var b=0;16>b;b++){for(var o=v[b],u=this._lBlock,d=this._rBlock,c=0,f=0;8>f;f++){c|=e[f][((d^o[f])&m[f])>>>0]}this._lBlock=d;this._rBlock=u^c}v=this._lBlock;this._lBlock=this._rBlock;this._rBlock=v;B.call(this,1,1431655765);q.call(this,8,16711935);q.call(this,2,858993459);B.call(this,16,65535);B.call(this,4,252645135);i[k]=this._lBlock;i[k+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});p.DES=n._createHelper(j);A=A.TripleDES=n.extend({_doReset:function(){var b=this._key.words;this._des1=j.createEncryptor(s.create(b.slice(0,2)));this._des2=j.createEncryptor(s.create(b.slice(2,4)));this._des3=j.createEncryptor(s.create(b.slice(4,6)))},encryptBlock:function(c,b){this._des1.encryptBlock(c,b);this._des2.decryptBlock(c,b);this._des3.encryptBlock(c,b)},decryptBlock:function(c,b){this._des3.decryptBlock(c,b);this._des2.encryptBlock(c,b);this._des1.decryptBlock(c,b)},keySize:6,ivSize:2,blockSize:2});p.TripleDES=n._createHelper(A)})();(function(){var e=CryptoJS,d=e.lib.WordArray;e.enc.Base64={stringify:function(g){var f=g.words,o=g.sigBytes,p=this._map;g.clamp();g=[];for(var b=0;b<o;b+=3){for(var n=(f[b>>>2]>>>24-8*(b%4)&255)<<16|(f[b+1>>>2]>>>24-8*((b+1)%4)&255)<<8|f[b+2>>>2]>>>24-8*((b+2)%4)&255,c=0;4>c&&b+0.75*c<o;c++){g.push(p.charAt(n>>>6*(3-c)&63))}}if(f=p.charAt(64)){for(;g.length%4;){g.push(f)}}return g.join("")},parse:function(f){var q=f.length,g=this._map,o=g.charAt(64);o&&(o=f.indexOf(o),-1!=o&&(q=o));for(var o=[],b=0,p=0;p<q;p++){if(p%4){var r=g.indexOf(f.charAt(p-1))<<2*(p%4),c=g.indexOf(f.charAt(p))>>>6-2*(p%4);o[b>>>2]|=(r|c)<<24-8*(b%4);b++}}return d.create(o,b)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}})();(function(u){function k(i,c,d,f,b,e,g){i=i+(c&d|~c&f)+b+g;return(i<<e|i>>>32-e)+c}function l(i,c,d,f,b,e,g){i=i+(c&f|d&~f)+b+g;return(i<<e|i>>>32-e)+c}function n(f,i,b,d,c,e,g){f=f+(i^b^d)+c+g;return(f<<e|f>>>32-e)+i}function q(f,i,b,d,c,e,g){f=f+(b^(i|~d))+c+g;return(f<<e|f>>>32-e)+i}for(var s=CryptoJS,r=s.lib,w=r.WordArray,v=r.Hasher,r=s.algo,y=[],x=0;64>x;x++){y[x]=4294967296*u.abs(u.sin(x+1))|0}r=r.MD5=v.extend({_doReset:function(){this._hash=new w.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(A,C){for(var m=0;16>m;m++){var B=C+m,j=A[B];A[B]=(j<<8|j>>>24)&16711935|(j<<24|j>>>8)&4278255360}var m=this._hash.words,B=A[C+0],j=A[C+1],p=A[C+2],T=A[C+3],V=A[C+4],X=A[C+5],b=A[C+6],c=A[C+7],d=A[C+8],f=A[C+9],R=A[C+10],o=A[C+11],Q=A[C+12],S=A[C+13],U=A[C+14],W=A[C+15],e=m[0],g=m[1],D=m[2],i=m[3],e=k(e,g,D,i,B,7,y[0]),i=k(i,e,g,D,j,12,y[1]),D=k(D,i,e,g,p,17,y[2]),g=k(g,D,i,e,T,22,y[3]),e=k(e,g,D,i,V,7,y[4]),i=k(i,e,g,D,X,12,y[5]),D=k(D,i,e,g,b,17,y[6]),g=k(g,D,i,e,c,22,y[7]),e=k(e,g,D,i,d,7,y[8]),i=k(i,e,g,D,f,12,y[9]),D=k(D,i,e,g,R,17,y[10]),g=k(g,D,i,e,o,22,y[11]),e=k(e,g,D,i,Q,7,y[12]),i=k(i,e,g,D,S,12,y[13]),D=k(D,i,e,g,U,17,y[14]),g=k(g,D,i,e,W,22,y[15]),e=l(e,g,D,i,j,5,y[16]),i=l(i,e,g,D,b,9,y[17]),D=l(D,i,e,g,o,14,y[18]),g=l(g,D,i,e,B,20,y[19]),e=l(e,g,D,i,X,5,y[20]),i=l(i,e,g,D,R,9,y[21]),D=l(D,i,e,g,W,14,y[22]),g=l(g,D,i,e,V,20,y[23]),e=l(e,g,D,i,f,5,y[24]),i=l(i,e,g,D,U,9,y[25]),D=l(D,i,e,g,T,14,y[26]),g=l(g,D,i,e,d,20,y[27]),e=l(e,g,D,i,S,5,y[28]),i=l(i,e,g,D,p,9,y[29]),D=l(D,i,e,g,c,14,y[30]),g=l(g,D,i,e,Q,20,y[31]),e=n(e,g,D,i,X,4,y[32]),i=n(i,e,g,D,d,11,y[33]),D=n(D,i,e,g,o,16,y[34]),g=n(g,D,i,e,U,23,y[35]),e=n(e,g,D,i,j,4,y[36]),i=n(i,e,g,D,V,11,y[37]),D=n(D,i,e,g,c,16,y[38]),g=n(g,D,i,e,R,23,y[39]),e=n(e,g,D,i,S,4,y[40]),i=n(i,e,g,D,B,11,y[41]),D=n(D,i,e,g,T,16,y[42]),g=n(g,D,i,e,b,23,y[43]),e=n(e,g,D,i,f,4,y[44]),i=n(i,e,g,D,Q,11,y[45]),D=n(D,i,e,g,W,16,y[46]),g=n(g,D,i,e,p,23,y[47]),e=q(e,g,D,i,B,6,y[48]),i=q(i,e,g,D,c,10,y[49]),D=q(D,i,e,g,U,15,y[50]),g=q(g,D,i,e,X,21,y[51]),e=q(e,g,D,i,Q,6,y[52]),i=q(i,e,g,D,T,10,y[53]),D=q(D,i,e,g,R,15,y[54]),g=q(g,D,i,e,j,21,y[55]),e=q(e,g,D,i,d,6,y[56]),i=q(i,e,g,D,W,10,y[57]),D=q(D,i,e,g,b,15,y[58]),g=q(g,D,i,e,S,21,y[59]),e=q(e,g,D,i,V,6,y[60]),i=q(i,e,g,D,o,10,y[61]),D=q(D,i,e,g,p,15,y[62]),g=q(g,D,i,e,f,21,y[63]);m[0]=m[0]+e|0;m[1]=m[1]+g|0;m[2]=m[2]+D|0;m[3]=m[3]+i|0},_doFinalize:function(){var b=this._data,c=b.words,d=8*this._nDataBytes,f=8*b.sigBytes;c[f>>>5]|=128<<24-f%32;var e=u.floor(d/4294967296);c[(f+64>>>9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;c[(f+64>>>9<<4)+14]=(d<<8|d>>>24)&16711935|(d<<24|d>>>8)&4278255360;b.sigBytes=4*(c.length+1);this._process();b=this._hash;c=b.words;for(d=0;4>d;d++){f=c[d],c[d]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}return b},clone:function(){var b=v.clone.call(this);b._hash=this._hash.clone();return b}});s.MD5=v._createHelper(r);s.HmacMD5=v._createHmacHelper(r)})(Math);(function(){var j=CryptoJS,l=j.lib,b=l.WordArray,k=l.Hasher,d=[],l=j.algo.SHA1=k.extend({_doReset:function(){this._hash=new b.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(g,i){for(var n=this._hash.words,v=n[0],w=n[1],e=n[2],f=n[3],p=n[4],u=0;80>u;u++){if(16>u){d[u]=g[i+u]|0}else{var c=d[u-3]^d[u-8]^d[u-14]^d[u-16];d[u]=c<<1|c>>>31}c=(v<<5|v>>>27)+p+d[u];c=20>u?c+((w&e|~w&f)+1518500249):40>u?c+((w^e^f)+1859775393):60>u?c+((w&e|w&f|e&f)-1894007588):c+((w^e^f)-899497514);p=f;f=e;e=w<<30|w>>>2;w=v;v=c}n[0]=n[0]+v|0;n[1]=n[1]+w|0;n[2]=n[2]+e|0;n[3]=n[3]+f|0;n[4]=n[4]+p|0},_doFinalize:function(){var e=this._data,f=e.words,c=8*this._nDataBytes,g=8*e.sigBytes;f[g>>>5]|=128<<24-g%32;f[(g+64>>>9<<4)+14]=Math.floor(c/4294967296);f[(g+64>>>9<<4)+15]=c;e.sigBytes=4*f.length;this._process();return this._hash},clone:function(){var c=k.clone.call(this);c._hash=this._hash.clone();return c}});j.SHA1=k._createHelper(l);j.HmacSHA1=k._createHmacHelper(l)})();(function(l){for(var s=CryptoJS,g=s.lib,k=g.WordArray,n=g.Hasher,g=s.algo,E=[],v=[],b=function(c){return 4294967296*(c-(c|0))|0},u=2,d=0;64>d;){var w;a:{w=u;for(var r=l.sqrt(w),j=2;j<=r;j++){if(!(w%j)){w=!1;break a}}w=!0}w&&(8>d&&(E[d]=b(l.pow(u,0.5))),v[d]=b(l.pow(u,1/3)),d++);u++}var F=[],g=g.SHA256=n.extend({_doReset:function(){this._hash=new k.init(E.slice(0))},_doProcessBlock:function(D,o){for(var p=this._hash.words,C=p[0],e=p[1],q=p[2],i=p[3],y=p[4],x=p[5],A=p[6],c=p[7],f=0;64>f;f++){if(16>f){F[f]=D[o+f]|0}else{var m=F[f-15],B=F[f-2];F[f]=((m<<25|m>>>7)^(m<<14|m>>>18)^m>>>3)+F[f-7]+((B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10)+F[f-16]}m=c+((y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25))+(y&x^~y&A)+v[f]+F[f];B=((C<<30|C>>>2)^(C<<19|C>>>13)^(C<<10|C>>>22))+(C&e^C&q^e&q);c=A;A=x;x=y;y=i+m|0;i=q;q=e;e=C;C=m+B|0}p[0]=p[0]+C|0;p[1]=p[1]+e|0;p[2]=p[2]+q|0;p[3]=p[3]+i|0;p[4]=p[4]+y|0;p[5]=p[5]+x|0;p[6]=p[6]+A|0;p[7]=p[7]+c|0},_doFinalize:function(){var i=this._data,e=i.words,c=8*this._nDataBytes,f=8*i.sigBytes;e[f>>>5]|=128<<24-f%32;e[(f+64>>>9<<4)+14]=l.floor(c/4294967296);e[(f+64>>>9<<4)+15]=c;i.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var c=n.clone.call(this);c._hash=this._hash.clone();return c}});s.SHA256=n._createHelper(g);s.HmacSHA256=n._createHmacHelper(g)})(Math);(function(){var c=CryptoJS,j=c.lib.WordArray,b=c.algo,d=b.SHA256,b=b.SHA224=d.extend({_doReset:function(){this._hash=new j.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=d._doFinalize.call(this);e.sigBytes-=4;return e}});c.SHA224=d._createHelper(b);c.HmacSHA224=d._createHmacHelper(b)})();(function(){function s(){return d.create.apply(d,arguments)}for(var o=CryptoJS,p=o.lib.Hasher,e=o.x64,d=e.Word,n=e.WordArray,e=o.algo,u=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],q=[],r=0;80>r;r++){q[r]=s()}e=e.SHA512=p.extend({_doReset:function(){this._hash=new n.init([new d.init(1779033703,4089235720),new d.init(3144134277,2227873595),new d.init(1013904242,4271175723),new d.init(2773480762,1595750129),new d.init(1359893119,2917565137),new d.init(2600822924,725511199),new d.init(528734635,4215389547),new d.init(1541459225,327033209)])},_doProcessBlock:function(H,al){for(var M=this._hash.words,G=M[0],J=M[1],D=M[2],ab=M[3],b=M[4],k=M[5],af=M[6],M=M[7],K=G.high,aq=G.low,U=J.high,ao=J.low,f=D.high,c=D.low,T=ab.high,O=ab.low,an=b.high,I=b.low,E=k.high,C=k.low,am=af.high,S=af.low,V=M.high,ad=M.low,W=K,ae=aq,Y=U,P=ao,L=f,i=c,F=T,x=O,ah=an,aj=I,X=E,Q=C,l=am,aa=S,ag=V,w=ad,ak=0;80>ak;ak++){var Z=q[ak];if(16>ak){var m=Z.high=H[al+2*ak]|0,R=Z.low=H[al+2*ak+1]|0}else{var m=q[ak-15],R=m.high,ac=m.low,m=(R>>>1|ac<<31)^(R>>>8|ac<<24)^R>>>7,ac=(ac>>>1|R<<31)^(ac>>>8|R<<24)^(ac>>>7|R<<25),j=q[ak-2],R=j.high,g=j.low,j=(R>>>19|g<<13)^(R<<3|g>>>29)^R>>>6,g=(g>>>19|R<<13)^(g<<3|R>>>29)^(g>>>6|R<<26),R=q[ak-7],A=R.high,ai=q[ak-16],y=ai.high,ai=ai.low,R=ac+R.low,m=m+A+(R>>>0<ac>>>0?1:0),R=R+g,m=m+j+(R>>>0<g>>>0?1:0),R=R+ai,m=m+y+(R>>>0<ai>>>0?1:0);Z.high=m;Z.low=R}var A=ah&X^~ah&l,ai=aj&Q^~aj&aa,Z=W&Y^W&L^Y&L,ap=ae&P^ae&i^P&i,ac=(W>>>28|ae<<4)^(W<<30|ae>>>2)^(W<<25|ae>>>7),j=(ae>>>28|W<<4)^(ae<<30|W>>>2)^(ae<<25|W>>>7),g=u[ak],N=g.high,B=g.low,g=w+((aj>>>14|ah<<18)^(aj>>>18|ah<<14)^(aj<<23|ah>>>9)),y=ag+((ah>>>14|aj<<18)^(ah>>>18|aj<<14)^(ah<<23|aj>>>9))+(g>>>0<w>>>0?1:0),g=g+ai,y=y+A+(g>>>0<ai>>>0?1:0),g=g+B,y=y+N+(g>>>0<B>>>0?1:0),g=g+R,y=y+m+(g>>>0<R>>>0?1:0),R=j+ap,Z=ac+Z+(R>>>0<j>>>0?1:0),ag=l,w=aa,l=X,aa=Q,X=ah,Q=aj,aj=x+g|0,ah=F+y+(aj>>>0<x>>>0?1:0)|0,F=L,x=i,L=Y,i=P,Y=W,P=ae,ae=g+R|0,W=y+Z+(ae>>>0<g>>>0?1:0)|0}aq=G.low=aq+ae;G.high=K+W+(aq>>>0<ae>>>0?1:0);ao=J.low=ao+P;J.high=U+Y+(ao>>>0<P>>>0?1:0);c=D.low=c+i;D.high=f+L+(c>>>0<i>>>0?1:0);O=ab.low=O+x;ab.high=T+F+(O>>>0<x>>>0?1:0);I=b.low=I+aj;b.high=an+ah+(I>>>0<aj>>>0?1:0);C=k.low=C+Q;k.high=E+X+(C>>>0<Q>>>0?1:0);S=af.low=S+aa;af.high=am+l+(S>>>0<aa>>>0?1:0);ad=M.low=ad+w;M.high=V+ag+(ad>>>0<w>>>0?1:0)},_doFinalize:function(){var b=this._data,f=b.words,g=8*this._nDataBytes,c=8*b.sigBytes;f[c>>>5]|=128<<24-c%32;f[(c+128>>>10<<5)+30]=Math.floor(g/4294967296);f[(c+128>>>10<<5)+31]=g;b.sigBytes=4*f.length;this._process();return this._hash.toX32()},clone:function(){var b=p.clone.call(this);b._hash=this._hash.clone();return b},blockSize:32});o.SHA512=p._createHelper(e);o.HmacSHA512=p._createHmacHelper(e)})();(function(){var c=CryptoJS,l=c.x64,b=l.Word,e=l.WordArray,l=c.algo,d=l.SHA512,l=l.SHA384=d.extend({_doReset:function(){this._hash=new e.init([new b.init(3418070365,3238371032),new b.init(1654270250,914150663),new b.init(2438529370,812702999),new b.init(355462360,4144912697),new b.init(1731405415,4290775857),new b.init(2394180231,1750603025),new b.init(3675008525,1694076839),new b.init(1203062813,3204075428)])},_doFinalize:function(){var f=d._doFinalize.call(this);f.sigBytes-=16;return f}});c.SHA384=d._createHelper(l);c.HmacSHA384=d._createHmacHelper(l)})();(function(){var q=CryptoJS,w=q.lib,d=w.WordArray,o=w.Hasher,w=q.algo,s=d.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=d.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),v=d.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),n=d.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),p=d.create([0,1518500249,1859775393,2400959708,2840853838]),r=d.create([1352829926,1548603684,1836072691,2053994217,0]),w=w.RIPEMD160=o.extend({_doReset:function(){this._hash=d.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(M,g){for(var K=0;16>K;K++){var e=g+K,O=M[e];M[e]=(O<<8|O>>>24)&16711935|(O<<24|O>>>8)&4278255360}var e=this._hash.words,O=p.words,l=r.words,Q=s.words,S=u.words,R=v.words,J=n.words,b,m,j,i,T,L,P,k,f,N;L=b=e[0];P=m=e[1];k=j=e[2];f=i=e[3];N=T=e[4];for(var c,K=0;80>K;K+=1){c=b+M[g+Q[K]]|0,c=16>K?c+((m^j^i)+O[0]):32>K?c+((m&j|~m&i)+O[1]):48>K?c+(((m|~j)^i)+O[2]):64>K?c+((m&i|j&~i)+O[3]):c+((m^(j|~i))+O[4]),c|=0,c=c<<R[K]|c>>>32-R[K],c=c+T|0,b=T,T=i,i=j<<10|j>>>22,j=m,m=c,c=L+M[g+S[K]]|0,c=16>K?c+((P^(k|~f))+l[0]):32>K?c+((P&f|k&~f)+l[1]):48>K?c+(((P|~k)^f)+l[2]):64>K?c+((P&k|~P&f)+l[3]):c+((P^k^f)+l[4]),c|=0,c=c<<J[K]|c>>>32-J[K],c=c+N|0,L=N,N=f,f=k<<10|k>>>22,k=P,P=c}c=e[1]+j+f|0;e[1]=e[2]+i+N|0;e[2]=e[3]+T+L|0;e[3]=e[4]+b+P|0;e[4]=e[0]+m+k|0;e[0]=c},_doFinalize:function(){var e=this._data,c=e.words,f=8*this._nDataBytes,b=8*e.sigBytes;c[b>>>5]|=128<<24-b%32;c[(b+64>>>9<<4)+14]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;e.sigBytes=4*(c.length+1);this._process();e=this._hash;c=e.words;for(f=0;5>f;f++){b=c[f],c[f]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360}return e},clone:function(){var b=o.clone.call(this);b._hash=this._hash.clone();return b}});q.RIPEMD160=o._createHelper(w);q.HmacRIPEMD160=o._createHmacHelper(w)})(Math);(function(){var e=CryptoJS,c=e.enc.Utf8;e.algo.HMAC=e.lib.Base.extend({init:function(s,u){s=this._hasher=new s.init;"string"==typeof u&&(u=c.parse(u));var b=s.blockSize,f=4*b;u.sigBytes>f&&(u=s.finalize(u));u.clamp();for(var g=this._oKey=u.clone(),j=this._iKey=u.clone(),q=g.words,r=j.words,d=0;d<b;d++){q[d]^=1549556828,r[d]^=909522486}g.sigBytes=j.sigBytes=f;this.reset()},reset:function(){var b=this._hasher;b.reset();b.update(this._iKey)},update:function(b){this._hasher.update(b);return this},finalize:function(b){var d=this._hasher;b=d.finalize(b);d.reset();return d.finalize(this._oKey.clone().concat(b))}})})();(function(){var m=CryptoJS,k=m.lib,b=k.Base,n=k.WordArray,k=m.algo,d=k.HMAC,l=k.PBKDF2=b.extend({cfg:b.extend({keySize:4,hasher:k.SHA1,iterations:1}),init:function(c){this.cfg=this.cfg.extend(c)},compute:function(p,D){for(var J=this.cfg,e=d.create(J.hasher,p),I=n.create(),H=n.create([1]),s=I.words,c=H.words,F=J.keySize,J=J.iterations;s.length<F;){var i=e.update(D).finalize(H);e.reset();for(var G=i.words,r=G.length,E=i,j=1;j<J;j++){E=e.finalize(E);e.reset();for(var f=E.words,g=0;g<r;g++){G[g]^=f[g]}}I.concat(i);c[0]++}I.sigBytes=4*F;return I}});m.PBKDF2=function(f,c,e){return l.create(e).compute(f,c)}})();var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";function hex2b64(e){var d;var j;var b="";for(d=0;d+3<=e.length;d+=3){j=parseInt(e.substring(d,d+3),16);b+=b64map.charAt(j>>6)+b64map.charAt(j&63)}if(d+1==e.length){j=parseInt(e.substring(d,d+1),16);b+=b64map.charAt(j<<2)}else{if(d+2==e.length){j=parseInt(e.substring(d,d+2),16);b+=b64map.charAt(j>>2)+b64map.charAt((j&3)<<4)}}if(b64pad){while((b.length&3)>0){b+=b64pad}}return b}function b64tohex(e){var n="";var d;var b=0;var c;var f;for(d=0;d<e.length;++d){if(e.charAt(d)==b64pad){break}f=b64map.indexOf(e.charAt(d));if(f<0){continue}if(b==0){n+=int2char(f>>2);c=f&3;b=1}else{if(b==1){n+=int2char((c<<2)|(f>>4));c=f&15;b=2}else{if(b==2){n+=int2char(c);n+=int2char(f>>2);c=f&3;b=3}else{n+=int2char((c<<2)|(f>>4));n+=int2char(f&15);b=0}}}}if(b==1){n+=int2char(c<<2)}return n}function b64toBA(b){var e=b64tohex(b);var d;var c=new Array();for(d=0;2*d<e.length;++d){c[d]=parseInt(e.substring(2*d,2*d+2),16)}return c}var dbits;var canary=244837814094590;var j_lm=((canary&16777215)==15715070);function BigInteger(d,f,e){if(d!=null){if("number"==typeof d){this.fromNumber(d,f,e)}else{if(f==null&&"string"!=typeof d){this.fromString(d,256)}else{this.fromString(d,f)}}}}function nbi(){return new BigInteger(null)}function am1(d,g,p,b,f,e){while(--e>=0){var o=g*this[d++]+p[b]+f;f=Math.floor(o/67108864);p[b++]=o&67108863}return f}function am2(e,o,q,d,k,r){var g=o&32767,b=o>>15;while(--r>=0){var y=this[e]&32767;var p=this[e++]>>15;var f=b*y+p*g;y=g*y+((f&32767)<<15)+q[d]+(k&1073741823);k=(y>>>30)+(f>>>15)+b*p+(k>>>30);q[d++]=y&1073741823}return k}function am3(e,o,q,d,k,r){var g=o&16383,b=o>>14;while(--r>=0){var y=this[e]&16383;var p=this[e++]>>14;var f=b*y+p*g;y=g*y+((f&16383)<<14)+q[d]+k;k=(y>>28)+(f>>14)+b*p;q[d++]=y&268435455}return k}if(j_lm&&(navigator.appName=="Microsoft Internet Explorer")){BigInteger.prototype.am=am2;dbits=30}else{if(j_lm&&(navigator.appName!="Netscape")){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=((1<<dbits)-1);BigInteger.prototype.DV=(1<<dbits);var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array();var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv){BI_RC[rr++]=vv}rr="a".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}rr="A".charCodeAt(0);for(vv=10;vv<36;++vv){BI_RC[rr++]=vv}function int2char(c){return BI_RM.charAt(c)}function intAt(d,b){var g=BI_RC[d.charCodeAt(b)];return(g==null)?-1:g}function bnpCopyTo(e){for(var b=this.t-1;b>=0;--b){e[b]=this[b]}e.t=this.t;e.s=this.s}function bnpFromInt(c){this.t=1;this.s=(c<0)?-1:0;if(c>0){this[0]=c}else{if(c<-1){this[0]=c+this.DV}else{this.t=0}}}function nbv(b){var e=nbi();e.fromInt(b);return e}function bnpFromString(d,f){var g;if(f==16){g=4}else{if(f==8){g=3}else{if(f==256){g=8}else{if(f==2){g=1}else{if(f==32){g=5}else{if(f==4){g=2}else{this.fromRadix(d,f);return}}}}}}this.t=0;this.s=0;var o=d.length,e=false,c=0;while(--o>=0){var p=(g==8)?d[o]&255:intAt(d,o);if(p<0){if(d.charAt(o)=="-"){e=true}continue}e=false;if(c==0){this[this.t++]=p}else{if(c+g>this.DB){this[this.t-1]|=(p&((1<<(this.DB-c))-1))<<c;this[this.t++]=(p>>(this.DB-c))}else{this[this.t-1]|=p<<c}}c+=g;if(c>=this.DB){c-=this.DB}}if(g==8&&(d[0]&128)!=0){this.s=-1;if(c>0){this[this.t-1]|=((1<<(this.DB-c))-1)<<c}}this.clamp();if(e){BigInteger.ZERO.subTo(this,this)}}function bnpClamp(){var c=this.s&this.DM;while(this.t>0&&this[this.t-1]==c){--this.t}}function bnToString(r){if(this.s<0){return"-"+this.negate().toString(r)}var f;if(r==16){f=4}else{if(r==8){f=3}else{if(r==2){f=1}else{if(r==32){f=5}else{if(r==4){f=2}else{return this.toRadix(r)}}}}}var e=(1<<f)-1,q,j=false,c="",l=this.t;var g=this.DB-(l*this.DB)%f;if(l-->0){if(g<this.DB&&(q=this[l]>>g)>0){j=true;c=int2char(q)}while(l>=0){if(g<f){q=(this[l]&((1<<g)-1))<<(f-g);q|=this[--l]>>(g+=this.DB-f)}else{q=(this[l]>>(g-=f))&e;if(g<=0){g+=this.DB;--l}}if(q>0){j=true}if(j){c+=int2char(q)}}}return j?c:"0"}function bnNegate(){var c=nbi();BigInteger.ZERO.subTo(this,c);return c}function bnAbs(){return(this.s<0)?this.negate():this}function bnCompareTo(c){var b=this.s-c.s;if(b!=0){return b}var d=this.t;b=d-c.t;if(b!=0){return(this.s<0)?-b:b}while(--d>=0){if((b=this[d]-c[d])!=0){return b}}return 0}function nbits(b){var g=1,c;if((c=b>>>16)!=0){b=c;g+=16}if((c=b>>8)!=0){b=c;g+=8}if((c=b>>4)!=0){b=c;g+=4}if((c=b>>2)!=0){b=c;g+=2}if((c=b>>1)!=0){b=c;g+=1}return g}function bnBitLength(){if(this.t<=0){return 0}return this.DB*(this.t-1)+nbits(this[this.t-1]^(this.s&this.DM))}function bnpDLShiftTo(g,c){var b;for(b=this.t-1;b>=0;--b){c[b+g]=this[b]}for(b=g-1;b>=0;--b){c[b]=0}c.t=this.t+g;c.s=this.s}function bnpDRShiftTo(g,c){for(var b=g;b<this.t;++b){c[b-g]=this[b]}c.t=Math.max(this.t-g,0);c.s=this.s}function bnpLShiftTo(d,g){var r=d%this.DB;var f=this.DB-r;var j=(1<<f)-1;var e=Math.floor(d/this.DB),q=(this.s<<r)&this.DM,b;for(b=this.t-1;b>=0;--b){g[b+e+1]=(this[b]>>f)|q;q=(this[b]&j)<<r}for(b=e-1;b>=0;--b){g[b]=0}g[e]=q;g.t=this.t+e+1;g.s=this.s;g.clamp()}function bnpRShiftTo(b,f){f.s=this.s;var d=Math.floor(b/this.DB);if(d>=this.t){f.t=0;return}var p=b%this.DB;var c=this.DB-p;var g=(1<<p)-1;f[0]=this[d]>>p;for(var e=d+1;e<this.t;++e){f[e-d-1]|=(this[e]&g)<<c;f[e-d]=this[e]>>p}if(p>0){f[this.t-d-1]|=(this.s&g)<<c}f.t=this.t-d;f.clamp()}function bnpSubTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]-d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g-=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g-=d[e];f[e++]=g&this.DM;g>>=this.DB}g-=d.s}f.s=(g<0)?-1:0;if(g<-1){f[e++]=this.DV+g}else{if(g>0){f[e++]=g}}f.t=e;f.clamp()}function bnpMultiplyTo(c,e){var b=this.abs(),f=c.abs();var d=b.t;e.t=d+f.t;while(--d>=0){e[d]=0}for(d=0;d<f.t;++d){e[d+b.t]=b.am(0,f[d],e,d,0,b.t)}e.s=0;e.clamp();if(this.s!=c.s){BigInteger.ZERO.subTo(e,e)}}function bnpSquareTo(e){var b=this.abs();var d=e.t=2*b.t;while(--d>=0){e[d]=0}for(d=0;d<b.t-1;++d){var j=b.am(d,b[d],e,2*d,0,1);if((e[d+b.t]+=b.am(d+1,2*b[d],e,2*d+1,j,b.t-d-1))>=b.DV){e[d+b.t]-=b.DV;e[d+b.t+1]=1}}if(e.t>0){e[e.t-1]+=b.am(d,b[d],e,2*d,0,1)}e.s=0;e.clamp()}function bnpDivRemTo(w,o,n){var N=w.abs();if(N.t<=0){return}var p=this.abs();if(p.t<N.t){if(o!=null){o.fromInt(0)}if(n!=null){this.copyTo(n)}return}if(n==null){n=nbi()}var s=nbi(),b=this.s,l=w.s;var u=this.DB-nbits(N[N.t-1]);if(u>0){N.lShiftTo(u,s);p.lShiftTo(u,n)}else{N.copyTo(s);p.copyTo(n)}var x=s.t;var c=s[x-1];if(c==0){return}var g=c*(1<<this.F1)+((x>1)?s[x-2]>>this.F2:0);var k=this.FV/g,P=(1<<this.F1)/g,O=1<<this.F2;var A=n.t,v=A-x,f=(o==null)?nbi():o;s.dlShiftTo(v,f);if(n.compareTo(f)>=0){n[n.t++]=1;n.subTo(f,n)}BigInteger.ONE.dlShiftTo(x,f);f.subTo(s,s);while(s.t<x){s[s.t++]=0}while(--v>=0){var d=(n[--A]==c)?this.DM:Math.floor(n[A]*k+(n[A-1]+O)*P);if((n[A]+=s.am(0,d,n,v,0,x))<d){s.dlShiftTo(v,f);n.subTo(f,n);while(n[A]<--d){n.subTo(f,n)}}}if(o!=null){n.drShiftTo(x,o);if(b!=l){BigInteger.ZERO.subTo(o,o)}}n.t=x;n.clamp();if(u>0){n.rShiftTo(u,n)}if(b<0){BigInteger.ZERO.subTo(n,n)}}function bnMod(c){var b=nbi();this.abs().divRemTo(c,null,b);if(this.s<0&&b.compareTo(BigInteger.ZERO)>0){c.subTo(b,b)}return b}function Classic(c){this.m=c}function cConvert(c){if(c.s<0||c.compareTo(this.m)>=0){return c.mod(this.m)}else{return c}}function cRevert(c){return c}function cReduce(c){c.divRemTo(this.m,null,c)}function cMulTo(b,g,c){b.multiplyTo(g,c);this.reduce(c)}function cSqrTo(b,e){b.squareTo(e);this.reduce(e)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1){return 0}var b=this[0];if((b&1)==0){return 0}var e=b&3;e=(e*(2-(b&15)*e))&15;e=(e*(2-(b&255)*e))&255;e=(e*(2-(((b&65535)*e)&65535)))&65535;e=(e*(2-b*e%this.DV))%this.DV;return(e>0)?this.DV-e:-e}function Montgomery(c){this.m=c;this.mp=c.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(c.DB-15))-1;this.mt2=2*c.t}function montConvert(b){var e=nbi();b.abs().dlShiftTo(this.m.t,e);e.divRemTo(this.m,null,e);if(b.s<0&&e.compareTo(BigInteger.ZERO)>0){this.m.subTo(e,e)}return e}function montRevert(b){var e=nbi();b.copyTo(e);this.reduce(e);return e}function montReduce(b){while(b.t<=this.mt2){b[b.t++]=0}for(var d=0;d<this.m.t;++d){var c=b[d]&32767;var j=(c*this.mpl+(((c*this.mph+(b[d]>>15)*this.mpl)&this.um)<<15))&b.DM;c=d+this.m.t;b[c]+=this.m.am(0,j,b,d,0,this.m.t);while(b[c]>=b.DV){b[c]-=b.DV;b[++c]++}}b.clamp();b.drShiftTo(this.m.t,b);if(b.compareTo(this.m)>=0){b.subTo(this.m,b)}}function montSqrTo(b,e){b.squareTo(e);this.reduce(e)}function montMulTo(b,g,c){b.multiplyTo(g,c);this.reduce(c)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return((this.t>0)?(this[0]&1):this.s)==0}function bnpExp(o,f){if(o>4294967295||o<1){return BigInteger.ONE}var b=nbi(),j=nbi(),p=f.convert(this),d=nbits(o)-1;p.copyTo(b);while(--d>=0){f.sqrTo(b,j);if((o&(1<<d))>0){f.mulTo(j,p,b)}else{var c=b;b=j;j=c}}return f.revert(b)}function bnModPowInt(c,b){var g;if(c<256||b.isEven()){g=new Classic(b)}else{g=new Montgomery(b)}return this.exp(c,g)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var c=nbi();this.copyTo(c);return c}function bnIntValue(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function bnByteValue(){return(this.t==0)?this.s:(this[0]<<24)>>24}function bnShortValue(){return(this.t==0)?this.s:(this[0]<<16)>>16}function bnpChunkSize(c){return Math.floor(Math.LN2*this.DB/Math.log(c))}function bnSigNum(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function bnpToRadix(p){if(p==null){p=10}if(this.signum()==0||p<2||p>36){return"0"}var e=this.chunkSize(p);var j=Math.pow(p,e);var c=nbv(j),i=nbi(),g=nbi(),f="";this.divRemTo(c,i,g);while(i.signum()>0){f=(j+g.intValue()).toString(p).substr(1)+f;i.divRemTo(c,i,g)}return g.intValue().toString(p)+f}function bnpFromRadix(k,e){this.fromInt(0);if(e==null){e=10}var u=this.chunkSize(e);var c=Math.pow(e,u),s=false,l=0,g=0;for(var m=0;m<k.length;++m){var f=intAt(k,m);if(f<0){if(k.charAt(m)=="-"&&this.signum()==0){s=true}continue}g=e*g+f;if(++l>=u){this.dMultiply(c);this.dAddOffset(g,0);l=0;g=0}}if(l>0){this.dMultiply(Math.pow(e,l));this.dAddOffset(g,0)}if(s){BigInteger.ZERO.subTo(this,this)}}function bnpFromNumber(f,e,l){if("number"==typeof e){if(f<2){this.fromInt(1)}else{this.fromNumber(f,l);if(!this.testBit(f-1)){this.bitwiseTo(BigInteger.ONE.shiftLeft(f-1),op_or,this)}if(this.isEven()){this.dAddOffset(1,0)}while(!this.isProbablePrime(e)){this.dAddOffset(2,0);if(this.bitLength()>f){this.subTo(BigInteger.ONE.shiftLeft(f-1),this)}}}}else{var d=new Array(),g=f&7;d.length=(f>>3)+1;e.nextBytes(d);if(g>0){d[0]&=((1<<g)-1)}else{d[0]=0}this.fromString(d,256)}}function bnToByteArray(){var b=this.t,c=new Array();c[0]=this.s;var e=this.DB-(b*this.DB)%8,f,l=0;if(b-->0){if(e<this.DB&&(f=this[b]>>e)!=(this.s&this.DM)>>e){c[l++]=f|(this.s<<(this.DB-e))}while(b>=0){if(e<8){f=(this[b]&((1<<e)-1))<<(8-e);f|=this[--b]>>(e+=this.DB-8)}else{f=(this[b]>>(e-=8))&255;if(e<=0){e+=this.DB;--b}}if((f&128)!=0){f|=-256}if(l==0&&(this.s&128)!=(f&128)){++l}if(l>0||f!=this.s){c[l++]=f}}}return c}function bnEquals(b){return(this.compareTo(b)==0)}function bnMin(b){return(this.compareTo(b)<0)?this:b}function bnMax(b){return(this.compareTo(b)>0)?this:b}function bnpBitwiseTo(b,g,d){var n,e,c=Math.min(b.t,this.t);for(n=0;n<c;++n){d[n]=g(this[n],b[n])}if(b.t<this.t){e=b.s&this.DM;for(n=c;n<this.t;++n){d[n]=g(this[n],e)}d.t=this.t}else{e=this.s&this.DM;for(n=c;n<b.t;++n){d[n]=g(e,b[n])}d.t=b.t}d.s=g(this.s,b.s);d.clamp()}function op_and(b,e){return b&e}function bnAnd(c){var b=nbi();this.bitwiseTo(c,op_and,b);return b}function op_or(b,e){return b|e}function bnOr(c){var b=nbi();this.bitwiseTo(c,op_or,b);return b}function op_xor(b,e){return b^e}function bnXor(c){var b=nbi();this.bitwiseTo(c,op_xor,b);return b}function op_andnot(b,e){return b&~e}function bnAndNot(c){var b=nbi();this.bitwiseTo(c,op_andnot,b);return b}function bnNot(){var e=nbi();for(var b=0;b<this.t;++b){e[b]=this.DM&~this[b]}e.t=this.t;e.s=~this.s;return e}function bnShiftLeft(e){var b=nbi();if(e<0){this.rShiftTo(-e,b)}else{this.lShiftTo(e,b)}return b}function bnShiftRight(e){var b=nbi();if(e<0){this.lShiftTo(-e,b)}else{this.rShiftTo(e,b)}return b}function lbit(b){if(b==0){return -1}var e=0;if((b&65535)==0){b>>=16;e+=16}if((b&255)==0){b>>=8;e+=8}if((b&15)==0){b>>=4;e+=4}if((b&3)==0){b>>=2;e+=2}if((b&1)==0){++e}return e}function bnGetLowestSetBit(){for(var c=0;c<this.t;++c){if(this[c]!=0){return c*this.DB+lbit(this[c])}}if(this.s<0){return this.t*this.DB}return -1}function cbit(b){var e=0;while(b!=0){b&=b-1;++e}return e}function bnBitCount(){var g=0,b=this.s&this.DM;for(var c=0;c<this.t;++c){g+=cbit(this[c]^b)}return g}function bnTestBit(e){var b=Math.floor(e/this.DB);if(b>=this.t){return(this.s!=0)}return((this[b]&(1<<(e%this.DB)))!=0)}function bnpChangeBit(g,c){var b=BigInteger.ONE.shiftLeft(g);this.bitwiseTo(b,c,b);return b}function bnSetBit(c){return this.changeBit(c,op_or)}function bnClearBit(c){return this.changeBit(c,op_andnot)}function bnFlipBit(c){return this.changeBit(c,op_xor)}function bnpAddTo(d,f){var e=0,g=0,b=Math.min(d.t,this.t);while(e<b){g+=this[e]+d[e];f[e++]=g&this.DM;g>>=this.DB}if(d.t<this.t){g+=d.s;while(e<this.t){g+=this[e];f[e++]=g&this.DM;g>>=this.DB}g+=this.s}else{g+=this.s;while(e<d.t){g+=d[e];f[e++]=g&this.DM;g>>=this.DB}g+=d.s}f.s=(g<0)?-1:0;if(g>0){f[e++]=g}else{if(g<-1){f[e++]=this.DV+g}}f.t=e;f.clamp()}function bnAdd(c){var b=nbi();this.addTo(c,b);return b}function bnSubtract(c){var b=nbi();this.subTo(c,b);return b}function bnMultiply(c){var b=nbi();this.multiplyTo(c,b);return b}function bnSquare(){var c=nbi();this.squareTo(c);return c}function bnDivide(c){var b=nbi();this.divRemTo(c,b,null);return b}function bnRemainder(c){var b=nbi();this.divRemTo(c,null,b);return b}function bnDivideAndRemainder(c){var b=nbi(),d=nbi();this.divRemTo(c,b,d);return new Array(b,d)}function bnpDMultiply(c){this[this.t]=this.am(0,c-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(e,b){if(e==0){return}while(this.t<=b){this[this.t++]=0}this[b]+=e;while(this[b]>=this.DV){this[b]-=this.DV;if(++b>=this.t){this[this.t++]=0}++this[b]}}function NullExp(){}function nNop(c){return c}function nMulTo(b,g,c){b.multiplyTo(g,c)}function nSqrTo(b,e){b.squareTo(e)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(c){return this.exp(c,new NullExp())}function bnpMultiplyLowerTo(b,f,e){var d=Math.min(this.t+b.t,f);e.s=0;e.t=d;while(d>0){e[--d]=0}var c;for(c=e.t-this.t;d<c;++d){e[d+this.t]=this.am(0,b[d],e,d,0,this.t)}for(c=Math.min(b.t,f);d<c;++d){this.am(0,b[d],e,d,0,f-d)}e.clamp()}function bnpMultiplyUpperTo(c,b,e){--b;var d=e.t=this.t+c.t-b;e.s=0;while(--d>=0){e[d]=0}for(d=Math.max(b-this.t,0);d<c.t;++d){e[this.t+d-b]=this.am(b-d,c[d],e,0,0,this.t+d-b)}e.clamp();e.drShiftTo(1,e)}function Barrett(c){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*c.t,this.r2);this.mu=this.r2.divide(c);this.m=c}function barrettConvert(b){if(b.s<0||b.t>2*this.m.t){return b.mod(this.m)}else{if(b.compareTo(this.m)<0){return b}else{var e=nbi();b.copyTo(e);this.reduce(e);return e}}}function barrettRevert(c){return c}function barrettReduce(c){c.drShiftTo(this.m.t-1,this.r2);if(c.t>this.m.t+1){c.t=this.m.t+1;c.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(c.compareTo(this.r2)<0){c.dAddOffset(1,this.m.t+1)}c.subTo(this.r2,c);while(c.compareTo(this.m)>=0){c.subTo(this.m,c)}}function barrettSqrTo(b,e){b.squareTo(e);this.reduce(e)}function barrettMulTo(b,g,c){b.multiplyTo(g,c);this.reduce(c)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(J,q){var o=J.bitLength(),f,v=nbv(1),I;if(o<=0){return v}else{if(o<18){f=1}else{if(o<48){f=3}else{if(o<144){f=4}else{if(o<768){f=5}else{f=6}}}}}if(o<8){I=new Classic(q)}else{if(q.isEven()){I=new Barrett(q)}else{I=new Montgomery(q)}}var b=new Array(),c=3,p=f-1,u=(1<<f)-1;b[1]=I.convert(this);if(f>1){var x=nbi();I.sqrTo(b[1],x);while(c<=u){b[c]=nbi();I.mulTo(x,b[c-2],b[c]);c+=2}}var A=J.t-1,d,y=true,l=nbi(),s;o=nbits(J[A])-1;while(A>=0){if(o>=p){d=(J[A]>>(o-p))&u}else{d=(J[A]&((1<<(o+1))-1))<<(p-o);if(A>0){d|=J[A-1]>>(this.DB+o-p)}}c=f;while((d&1)==0){d>>=1;--c}if((o-=c)<0){o+=this.DB;--A}if(y){b[d].copyTo(v);y=false}else{while(c>1){I.sqrTo(v,l);I.sqrTo(l,v);c-=2}if(c>0){I.sqrTo(v,l)}else{s=v;v=l;l=s}I.mulTo(l,b[d],v)}while(A>=0&&(J[A]&(1<<o))==0){I.sqrTo(v,l);s=v;v=l;l=s;if(--o<0){o=this.DB-1;--A}}}return I.revert(v)}function bnGCD(b){var n=(this.s<0)?this.negate():this.clone();var f=(b.s<0)?b.negate():b.clone();if(n.compareTo(f)<0){var d=n;n=f;f=d}var c=n.getLowestSetBit(),e=f.getLowestSetBit();if(e<0){return n}if(c<e){e=c}if(e>0){n.rShiftTo(e,n);f.rShiftTo(e,f)}while(n.signum()>0){if((c=n.getLowestSetBit())>0){n.rShiftTo(c,n)}if((c=f.getLowestSetBit())>0){f.rShiftTo(c,f)}if(n.compareTo(f)>=0){n.subTo(f,n);n.rShiftTo(1,n)}else{f.subTo(n,f);f.rShiftTo(1,f)}}if(e>0){f.lShiftTo(e,f)}return f}function bnpModInt(j){if(j<=0){return 0}var e=this.DV%j,c=(this.s<0)?j-1:0;if(this.t>0){if(e==0){c=this[0]%j}else{for(var b=this.t-1;b>=0;--b){c=(e*c+this[b])%j}}}return c}function bnModInverse(i){var k=i.isEven();if((this.isEven()&&k)||i.signum()==0){return BigInteger.ZERO}var f=i.clone(),r=this.clone();var j=nbv(1),l=nbv(0),g=nbv(0),e=nbv(1);while(f.signum()!=0){while(f.isEven()){f.rShiftTo(1,f);if(k){if(!j.isEven()||!l.isEven()){j.addTo(this,j);l.subTo(i,l)}j.rShiftTo(1,j)}else{if(!l.isEven()){l.subTo(i,l)}}l.rShiftTo(1,l)}while(r.isEven()){r.rShiftTo(1,r);if(k){if(!g.isEven()||!e.isEven()){g.addTo(this,g);e.subTo(i,e)}g.rShiftTo(1,g)}else{if(!e.isEven()){e.subTo(i,e)}}e.rShiftTo(1,e)}if(f.compareTo(r)>=0){f.subTo(r,f);if(k){j.subTo(g,j)}l.subTo(e,l)}else{r.subTo(f,r);if(k){g.subTo(j,g)}e.subTo(l,e)}}if(r.compareTo(BigInteger.ONE)!=0){return BigInteger.ZERO}if(e.compareTo(i)>=0){return e.subtract(i)}if(e.signum()<0){e.addTo(i,e)}else{return e}if(e.signum()<0){return e.add(i)}else{return e}}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(e){var d,b=this.abs();if(b.t==1&&b[0]<=lowprimes[lowprimes.length-1]){for(d=0;d<lowprimes.length;++d){if(b[0]==lowprimes[d]){return true}}return false}if(b.isEven()){return false}d=1;while(d<lowprimes.length){var l=lowprimes[d],c=d+1;while(c<lowprimes.length&&l<lplim){l*=lowprimes[c++]}l=b.modInt(l);while(d<c){if(l%lowprimes[d++]==0){return false}}}return b.millerRabin(e)}function bnpMillerRabin(d){var g=this.subtract(BigInteger.ONE);var l=g.getLowestSetBit();if(l<=0){return false}var e=g.shiftRight(l);d=(d+1)>>1;if(d>lowprimes.length){d=lowprimes.length}var b=nbi();for(var f=0;f<d;++f){b.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var r=b.modPow(e,this);if(r.compareTo(BigInteger.ONE)!=0&&r.compareTo(g)!=0){var c=1;while(c++<l&&r.compareTo(g)!=0){r=r.modPowInt(2,this);if(r.compareTo(BigInteger.ONE)==0){return false}}if(r.compareTo(g)!=0){return false}}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;function Arcfour(){this.i=0;this.j=0;this.S=new Array()}function ARC4init(j){var d,b,c;for(d=0;d<256;++d){this.S[d]=d}b=0;for(d=0;d<256;++d){b=(b+this.S[d]+j[d%j.length])&255;c=this.S[d];this.S[d]=this.S[b];this.S[b]=c}this.i=0;this.j=0}function ARC4next(){var c;this.i=(this.i+1)&255;this.j=(this.j+this.S[this.i])&255;c=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=c;return this.S[(c+this.S[this.i])&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour()}var rng_psize=256;var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(c){rng_pool[rng_pptr++]^=c&255;rng_pool[rng_pptr++]^=(c>>8)&255;rng_pool[rng_pptr++]^=(c>>16)&255;rng_pool[rng_pptr++]^=(c>>24)&255;if(rng_pptr>=rng_psize){rng_pptr-=rng_psize}}function rng_seed_time(){rng_seed_int(new Date().getTime())}if(rng_pool==null){rng_pool=new Array();rng_pptr=0;var t;if(window.crypto&&window.crypto.getRandomValues){var ua=new Uint8Array(32);window.crypto.getRandomValues(ua);for(t=0;t<32;++t){rng_pool[rng_pptr++]=ua[t]}}if(navigator.appName=="Netscape"&&navigator.appVersion<"5"&&window.crypto){var z=window.crypto.random(32);for(t=0;t<z.length;++t){rng_pool[rng_pptr++]=z.charCodeAt(t)&255}}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr){rng_pool[rng_pptr]=0}rng_pptr=0}return rng_state.next()}function rng_get_bytes(e){var b;for(b=0;b<e.length;++b){e[b]=rng_get_byte()}}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;function parseBigInt(e,b){return new BigInteger(e,b)}function linebrk(d,j){var b="";var c=0;while(c+j<d.length){b+=d.substring(c,c+j)+"\n";c+=j}return b+d.substring(c,d.length)}function byte2Hex(c){if(c<16){return"0"+c.toString(16)}else{return c.toString(16)}}function pkcs1pad2(d,f){if(f<d.length+11){alert("Message too long for RSA");return null}var p=new Array();var e=d.length-1;while(e>=0&&f>0){var b=d.charCodeAt(e--);if(b<128){p[--f]=b}else{if((b>127)&&(b<2048)){p[--f]=(b&63)|128;p[--f]=(b>>6)|192}else{p[--f]=(b&63)|128;p[--f]=((b>>6)&63)|128;p[--f]=(b>>12)|224}}}p[--f]=0;var o=new SecureRandom();var g=new Array();while(f>2){g[0]=0;while(g[0]==0){o.nextBytes(g)}p[--f]=g[0]}p[--f]=2;p[--f]=0;return new BigInteger(p)}function oaep_mgf1_arr(c,l,e){var b="",d=0;while(b.length<l){b+=e(String.fromCharCode.apply(String,c.concat([(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255])));d+=1}return b}function oaep_pad(G,H,d,g){var e=Ext.crypto.MessageDigest;var k=Ext.crypto.Util;var m=null;if(!d){d="sha1"}if(typeof d==="string"){m=e.getCanonicalAlgName(d);g=e.getHashLength(m);d=function(i){return hextorstr(k.hashString(i,m))}}if(G.length+2*g+2>H){throw"Message too long for RSA"}var f="",c;for(c=0;c<H-G.length-2*g-2;c+=1){f+="\x00"}var p=d("")+f+"\x01"+G;var o=new Array(g);new SecureRandom().nextBytes(o);var q=oaep_mgf1_arr(o,p.length,d);var l=[];for(c=0;c<p.length;c+=1){l[c]=p.charCodeAt(c)^q.charCodeAt(c)}var j=oaep_mgf1_arr(l,o.length,d);var b=[0];for(c=0;c<o.length;c+=1){b[c+1]=o[c]^j.charCodeAt(c)}return new BigInteger(b.concat(l))}function RSAKey(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function RSASetPublic(e,b){this.isPublic=true;this.isPrivate=false;if(typeof e!=="string"){this.n=e;this.e=b}else{if(e!=null&&b!=null&&e.length>0&&b.length>0){this.n=parseBigInt(e,16);this.e=parseInt(b,16)}else{throw"Invalid RSA public key"}}}function RSADoPublic(c){return c.modPowInt(this.e,this.n)}function RSAEncrypt(e){var b=pkcs1pad2(e,(this.n.bitLength()+7)>>3);if(b==null){return null}var j=this.doPublic(b);if(j==null){return null}var d=j.toString(16);if((d.length&1)==0){return d}else{return"0"+d}}function RSAEncryptOAEP(e,d,n){var g=oaep_pad(e,(this.n.bitLength()+7)>>3,d,n);if(g==null){return null}var f=this.doPublic(g);if(f==null){return null}var b=f.toString(16);if((b.length&1)==0){return b}else{return"0"+b}}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";function pkcs1unpad2(n,f){var g=n.toByteArray();var m=0;while(m<g.length&&g[m]==0){++m}if(g.length-m!=f-1||g[m]!=2){return null}++m;while(g[m]!=0){if(++m>=g.length){return null}}var j="";while(++m<g.length){var e=g[m]&255;if(e<128){j+=String.fromCharCode(e)}else{if((e>191)&&(e<224)){j+=String.fromCharCode(((e&31)<<6)|(g[m+1]&63));++m}else{j+=String.fromCharCode(((e&15)<<12)|((g[m+1]&63)<<6)|(g[m+2]&63));m+=2}}}return j}function oaep_mgf1_str(c,l,e){var b="",d=0;while(b.length<l){b+=e(c+String.fromCharCode.apply(String,[(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255]));d+=1}return b}function oaep_unpad(e,j,q,o){var c=Ext.crypto.MessageDigest;var l=Ext.crypto.Util;var m=null;if(!q){q="sha1"}if(typeof q==="string"){m=c.getCanonicalAlgName(q);o=c.getHashLength(m);q=function(d){return hextorstr(l.hashString(d,m))}}e=e.toByteArray();var s;for(s=0;s<e.length;s+=1){e[s]&=255}while(e.length<j){e.unshift(0)}e=String.fromCharCode.apply(String,e);if(e.length<2*o+2){throw"Cipher too short"}var f=e.substr(1,o);var b=e.substr(o+1);var J=oaep_mgf1_str(b,o,q);var p=[],s;for(s=0;s<f.length;s+=1){p[s]=f.charCodeAt(s)^J.charCodeAt(s)}var r=oaep_mgf1_str(String.fromCharCode.apply(String,p),e.length-o,q);var I=[];for(s=0;s<b.length;s+=1){I[s]=b.charCodeAt(s)^r.charCodeAt(s)}I=String.fromCharCode.apply(String,I);if(I.substr(0,o)!==q("")){throw"Hash mismatch"}I=I.substr(o);var k=I.indexOf("\x01");var g=(k!=-1)?I.substr(0,k).lastIndexOf("\x00"):-1;if(g+1!=k){throw"Malformed data"}return I.substr(k+1)}function RSASetPrivate(g,b,c){this.isPrivate=true;if(typeof g!=="string"){this.n=g;this.e=b;this.d=c}else{if(g!=null&&b!=null&&g.length>0&&b.length>0){this.n=parseBigInt(g,16);this.e=parseInt(b,16);this.d=parseBigInt(c,16)}else{alert("Invalid RSA private key")}}}function RSASetPrivateEx(b,f,q,g,r,c,d,e){this.isPrivate=true;this.isPublic=false;if(b==null){throw"RSASetPrivateEx N == null"}if(f==null){throw"RSASetPrivateEx E == null"}if(b.length==0){throw"RSASetPrivateEx N.length == 0"}if(f.length==0){throw"RSASetPrivateEx E.length == 0"}if(b!=null&&f!=null&&b.length>0&&f.length>0){this.n=parseBigInt(b,16);this.e=parseInt(f,16);this.d=parseBigInt(q,16);this.p=parseBigInt(g,16);this.q=parseBigInt(r,16);this.dmp1=parseBigInt(c,16);this.dmq1=parseBigInt(d,16);this.coeff=parseBigInt(e,16)}else{alert("Invalid RSA private key in RSASetPrivateEx")}}function RSAGenerate(i,f){var g=new SecureRandom();var c=i>>1;this.e=parseInt(f,16);var s=new BigInteger(f,16);for(;;){for(;;){this.p=new BigInteger(i-c,1,g);if(this.p.subtract(BigInteger.ONE).gcd(s).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)){break}}for(;;){this.q=new BigInteger(c,1,g);if(this.q.subtract(BigInteger.ONE).gcd(s).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)){break}}if(this.p.compareTo(this.q)<=0){var e=this.p;this.p=this.q;this.q=e}var d=this.p.subtract(BigInteger.ONE);var u=this.q.subtract(BigInteger.ONE);var b=d.multiply(u);if(b.gcd(s).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q);this.d=s.modInverse(b);this.dmp1=this.d.mod(d);this.dmq1=this.d.mod(u);this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=true}function RSADoPrivate(b){if(this.p==null||this.q==null){return b.modPow(this.d,this.n)}var g=b.mod(this.p).modPow(this.dmp1,this.p);var c=b.mod(this.q).modPow(this.dmq1,this.q);while(g.compareTo(c)<0){g=g.add(this.p)}return g.subtract(c).multiply(this.coeff).mod(this.p).multiply(this.q).add(c)}function RSADecrypt(d){var g=parseBigInt(d,16);var b=this.doPrivate(g);if(b==null){return null}return pkcs1unpad2(b,(this.n.bitLength()+7)>>3)}function RSADecryptOAEP(e,d,b){var f=parseBigInt(e,16);var l=this.doPrivate(f);if(l==null){return null}return oaep_unpad(l,(this.n.bitLength()+7)>>3,d,b)}RSAKey.prototype.doPrivate=RSADoPrivate;RSAKey.prototype.setPrivate=RSASetPrivate;RSAKey.prototype.setPrivateEx=RSASetPrivateEx;RSAKey.prototype.generate=RSAGenerate;RSAKey.prototype.decrypt=RSADecrypt;RSAKey.prototype.decryptOAEP=RSADecryptOAEP;function ECFieldElementFp(e,b){this.x=b;this.q=e}function feFpEquals(c){if(c==this){return true}return(this.q.equals(c.q)&&this.x.equals(c.x))}function feFpToBigInteger(){return this.x}function feFpNegate(){return new ECFieldElementFp(this.q,this.x.negate().mod(this.q))}function feFpAdd(c){return new ECFieldElementFp(this.q,this.x.add(c.toBigInteger()).mod(this.q))}function feFpSubtract(c){return new ECFieldElementFp(this.q,this.x.subtract(c.toBigInteger()).mod(this.q))}function feFpMultiply(c){return new ECFieldElementFp(this.q,this.x.multiply(c.toBigInteger()).mod(this.q))}function feFpSquare(){return new ECFieldElementFp(this.q,this.x.square().mod(this.q))}function feFpDivide(c){return new ECFieldElementFp(this.q,this.x.multiply(c.toBigInteger().modInverse(this.q)).mod(this.q))}ECFieldElementFp.prototype.equals=feFpEquals;ECFieldElementFp.prototype.toBigInteger=feFpToBigInteger;ECFieldElementFp.prototype.negate=feFpNegate;ECFieldElementFp.prototype.add=feFpAdd;ECFieldElementFp.prototype.subtract=feFpSubtract;ECFieldElementFp.prototype.multiply=feFpMultiply;ECFieldElementFp.prototype.square=feFpSquare;ECFieldElementFp.prototype.divide=feFpDivide;function ECPointFp(d,b,j,c){this.curve=d;this.x=b;this.y=j;if(c==null){this.z=BigInteger.ONE}else{this.z=c}this.zinv=null}function pointFpGetX(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpGetY(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))}function pointFpEquals(b){if(b==this){return true}if(this.isInfinity()){return b.isInfinity()}if(b.isInfinity()){return this.isInfinity()}var g,c;g=b.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(b.z)).mod(this.curve.q);if(!g.equals(BigInteger.ZERO)){return false}c=b.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(b.z)).mod(this.curve.q);return c.equals(BigInteger.ZERO)}function pointFpIsInfinity(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(BigInteger.ZERO)&&!this.y.toBigInteger().equals(BigInteger.ZERO)}function pointFpNegate(){return new ECPointFp(this.curve,this.x,this.y.negate(),this.z)}function pointFpAdd(i){if(this.isInfinity()){return i}if(i.isInfinity()){return this}var o=i.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(i.z)).mod(this.curve.q);var l=i.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(i.z)).mod(this.curve.q);if(BigInteger.ZERO.equals(l)){if(BigInteger.ZERO.equals(o)){return this.twice()}return this.curve.getInfinity()}var d=new BigInteger("3");var H=this.x.toBigInteger();var e=this.y.toBigInteger();var n=i.x.toBigInteger();var f=i.y.toBigInteger();var g=l.square();var k=g.multiply(l);var p=H.multiply(g);var j=o.square().multiply(this.z);var c=j.subtract(p.shiftLeft(1)).multiply(i.z).subtract(k).multiply(l).mod(this.curve.q);var G=p.multiply(d).multiply(o).subtract(e.multiply(k)).subtract(j.multiply(o)).multiply(i.z).add(o.multiply(k)).mod(this.curve.q);var m=k.multiply(this.z).multiply(i.z).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(G),m)}function pointFpTwice(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var f=new BigInteger("3");var b=this.x.toBigInteger();var g=this.y.toBigInteger();var d=g.multiply(this.z);var j=d.multiply(g).mod(this.curve.q);var i=this.curve.a.toBigInteger();var k=b.square().multiply(f);if(!BigInteger.ZERO.equals(i)){k=k.add(this.z.square().multiply(i))}k=k.mod(this.curve.q);var w=k.square().subtract(b.shiftLeft(3).multiply(j)).shiftLeft(1).multiply(d).mod(this.curve.q);var e=k.multiply(f).multiply(b).subtract(j.shiftLeft(1)).shiftLeft(2).multiply(j).subtract(k.square().multiply(k)).mod(this.curve.q);var c=d.square().multiply(d).shiftLeft(3).mod(this.curve.q);return new ECPointFp(this.curve,this.curve.fromBigInteger(w),this.curve.fromBigInteger(e),c)}function pointFpMultiply(d){if(this.isInfinity()){return this}if(d.signum()==0){return this.curve.getInfinity()}var r=d;var f=r.multiply(new BigInteger("3"));var j=this.negate();var l=this;var c;for(c=f.bitLength()-2;c>0;--c){l=l.twice();var g=f.testBit(c);var b=r.testBit(c);if(g!=b){l=l.add(g?this:j)}}return l}function pointFpMultiplyTwo(b,f,n){var c;if(b.bitLength()>n.bitLength()){c=b.bitLength()-1}else{c=n.bitLength()-1}var e=this.curve.getInfinity();var d=this.add(f);while(c>=0){e=e.twice();if(b.testBit(c)){if(n.testBit(c)){e=e.add(d)}else{e=e.add(this)}}else{if(n.testBit(c)){e=e.add(f)}}--c}return e}ECPointFp.prototype.getX=pointFpGetX;ECPointFp.prototype.getY=pointFpGetY;ECPointFp.prototype.equals=pointFpEquals;ECPointFp.prototype.isInfinity=pointFpIsInfinity;ECPointFp.prototype.negate=pointFpNegate;ECPointFp.prototype.add=pointFpAdd;ECPointFp.prototype.twice=pointFpTwice;ECPointFp.prototype.multiply=pointFpMultiply;ECPointFp.prototype.multiplyTwo=pointFpMultiplyTwo;function ECCurveFp(d,c,e){this.q=d;this.a=this.fromBigInteger(c);this.b=this.fromBigInteger(e);this.infinity=new ECPointFp(this,null,null)}function curveFpGetQ(){return this.q}function curveFpGetA(){return this.a}function curveFpGetB(){return this.b}function curveFpEquals(c){if(c==this){return true}return(this.q.equals(c.q)&&this.a.equals(c.a)&&this.b.equals(c.b))}function curveFpGetInfinity(){return this.infinity}function curveFpFromBigInteger(c){return new ECFieldElementFp(this.q,c)}function curveFpDecodePointHex(j){switch(parseInt(j.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var b=(j.length-2)/2;var d=j.substr(2,b);var c=j.substr(b+2,b);return new ECPointFp(this,this.fromBigInteger(new BigInteger(d,16)),this.fromBigInteger(new BigInteger(c,16)));default:return null}}ECCurveFp.prototype.getQ=curveFpGetQ;ECCurveFp.prototype.getA=curveFpGetA;ECCurveFp.prototype.getB=curveFpGetB;ECCurveFp.prototype.equals=curveFpEquals;ECCurveFp.prototype.getInfinity=curveFpGetInfinity;ECCurveFp.prototype.fromBigInteger=curveFpFromBigInteger;ECCurveFp.prototype.decodePointHex=curveFpDecodePointHex;ECFieldElementFp.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};ECPointFp.prototype.getEncoded=function(c){var d=function(g,i){var f=g.toByteArrayUnsigned();if(i<f.length){f=f.slice(f.length-i)}else{while(i>f.length){f.unshift(0)}}return f};var l=this.getX().toBigInteger();var e=this.getY().toBigInteger();var b=d(l,32);if(c){if(e.isEven()){b.unshift(2)}else{b.unshift(3)}}else{b.unshift(4);b=b.concat(d(e,32))}return b};ECPointFp.decodeFrom=function(b,f){var d=f[0];var g=f.length-1;var q=f.slice(1,1+g/2);var r=f.slice(1+g/2,1+g);q.unshift(0);r.unshift(0);var c=new BigInteger(q);var e=new BigInteger(r);return new ECPointFp(b,b.fromBigInteger(c),b.fromBigInteger(e))};ECPointFp.decodeFromHex=function(b,f){var d=f.substr(0,2);var g=f.length-2;var q=f.substr(2,g/2);var r=f.substr(2+g/2,g/2);var c=new BigInteger(q,16);var e=new BigInteger(r,16);return new ECPointFp(b,b.fromBigInteger(c),b.fromBigInteger(e))};ECPointFp.prototype.add2D=function(f){if(this.isInfinity()){return f}if(f.isInfinity()){return this}if(this.x.equals(f.x)){if(this.y.equals(f.y)){return this.twice()}return this.curve.getInfinity()}var d=f.x.subtract(this.x);var n=f.y.subtract(this.y);var e=n.divide(d);var g=e.square().subtract(this.x).subtract(f.x);var c=e.multiply(this.x.subtract(g)).subtract(this.y);return new ECPointFp(this.curve,g,c)};ECPointFp.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var b=this.curve.fromBigInteger(BigInteger.valueOf(2));var e=this.curve.fromBigInteger(BigInteger.valueOf(3));var l=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(b));var c=l.square().subtract(this.x.multiply(b));var d=l.multiply(this.x.subtract(c)).subtract(this.y);return new ECPointFp(this.curve,c,d)};ECPointFp.prototype.multiply2D=function(d){if(this.isInfinity()){return this}if(d.signum()==0){return this.curve.getInfinity()}var r=d;var f=r.multiply(new BigInteger("3"));var j=this.negate();var l=this;var c;for(c=f.bitLength()-2;c>0;--c){l=l.twice();var g=f.testBit(c);var b=r.testBit(c);if(g!=b){l=l.add2D(g?this:j)}}return l};ECPointFp.prototype.isOnCurve=function(){var p=this.getX().toBigInteger();var d=this.getY().toBigInteger();var e=this.curve.getA().toBigInteger();var i=this.curve.getB().toBigInteger();var g=this.curve.getQ();var c=d.multiply(d).mod(g);var f=p.multiply(p).multiply(p).add(e.multiply(p)).add(i).mod(g);return c.equals(f)};ECPointFp.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};ECPointFp.prototype.validate=function(){var g=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var b=this.getX().toBigInteger();var c=this.getY().toBigInteger();if(b.compareTo(BigInteger.ONE)<0||b.compareTo(g.subtract(BigInteger.ONE))>0){throw new Error("x coordinate out of bounds")}if(c.compareTo(BigInteger.ONE)<0||c.compareTo(g.subtract(BigInteger.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(g).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var jsonParse=(function(){var d="(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)";var b='(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))';var i='(?:"'+b+'*")';var e=new RegExp("(?:false|true|null|[\\{\\}\\[\\]]|"+d+"|"+i+")","g");var k=new RegExp("\\\\(?:([^u])|u(.{4}))","g");var f={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function j(m,n,l){return n?f[n]:String.fromCharCode(parseInt(l,16))}var c=new String("");var x="\\";var g={"{":Object,"[":Array};var y=Object.hasOwnProperty;return function(o,q){var m=o.match(e);var w;var r=m[0];var u=false;if("{"===r){w={}}else{if("["===r){w=[]}else{w=[];u=true}}var B;var v=[w];for(var n=1-u,s=m.length;n<s;++n){r=m[n];var l;switch(r.charCodeAt(0)){default:l=v[0];l[B||l.length]=+(r);B=void 0;break;case 34:r=r.substring(1,r.length-1);if(r.indexOf(x)!==-1){r=r.replace(k,j)}l=v[0];if(!B){if(l instanceof Array){B=l.length}else{B=r||c;break}}l[B]=r;B=void 0;break;case 91:l=v[0];v.unshift(l[B||l.length]=[]);B=void 0;break;case 93:v.shift();break;case 102:l=v[0];l[B||l.length]=false;B=void 0;break;case 110:l=v[0];l[B||l.length]=null;B=void 0;break;case 116:l=v[0];l[B||l.length]=true;B=void 0;break;case 123:l=v[0];v.unshift(l[B||l.length]={});B=void 0;break;case 125:v.shift();break}}if(u){if(v.length!==1){throw new Error()}w=w[0]}else{if(v.length){throw new Error()}}if(q){var p=function(M,A){var K=M[A];if(K&&typeof K==="object"){var J=null;for(var L in K){if(y.call(K,L)&&K!==M){var D=p(K,L);if(D!==void 0){K[L]=D}else{if(!J){J=[]}J.push(L)}}}if(J){for(var N=J.length;--N>=0;){delete K[J[N]]}}}return q.call(M,A,K)};w=p({"":w},"")}return w}})();if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}Ext.asn1.ASN1Util=new function(){this.integerToByteHex=function(b){var e=b.toString(16);if((e.length%2)==1){e="0"+e}return e};this.bigIntToMinTwosComplementsHex=function(e){var d=e.toString(16);if(d.substr(0,1)!="-"){if(d.length%2==1){d="0"+d}else{if(!d.match(/^[0-7]/)){d="00"+d}}}else{var j=d.substr(1);var b=j.length;if(b%2==1){b+=1}else{if(!d.match(/^[0-7]/)){b+=2}}var g="";for(var f=0;f<b;f++){g+="f"}var r=new BigInteger(g,16);var c=r.xor(e).add(BigInteger.ONE);d=c.toString(16).replace(/^-/,"")}return d};this.getPEMStringFromHex=function(b,c){var d=hextob64(b);var j=d.replace(/(.{64})/g,"$1\r\n");j=j.replace(/\r\n$/,"");return"-----BEGIN "+c+"-----\r\n"+j+"\r\n-----END "+c+"-----\r\n"};this.newObject=function(m){var d=Ext.asn1;var b=Object.keys(m);if(b.length!=1){throw"key of param shall be only one."}var g=b[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+g+":")==-1){throw"undefined key: "+g}if(g=="bool"){return new d.DERBoolean(m[g])}if(g=="int"){return new d.DERInteger(m[g])}if(g=="bitstr"){return new d.DERBitString(m[g])}if(g=="octstr"){return new d.DEROctetString(m[g])}if(g=="null"){return new d.DERNull(m[g])}if(g=="oid"){return new d.DERObjectIdentifier(m[g])}if(g=="enum"){return new d.DEREnumerated(m[g])}if(g=="utf8str"){return new d.DERUTF8String(m[g])}if(g=="numstr"){return new d.DERNumericString(m[g])}if(g=="prnstr"){return new d.DERPrintableString(m[g])}if(g=="telstr"){return new d.DERTeletexString(m[g])}if(g=="ia5str"){return new d.DERIA5String(m[g])}if(g=="utctime"){return new d.DERUTCTime(m[g])}if(g=="gentime"){return new d.DERGeneralizedTime(m[g])}if(g=="seq"){var l=m[g];var f=[];for(var c=0;c<l.length;c++){var j=d.ASN1Util.newObject(l[c]);f.push(j)}return new d.DERSequence({array:f})}if(g=="set"){var l=m[g];var f=[];for(var c=0;c<l.length;c++){var j=d.ASN1Util.newObject(l[c]);f.push(j)}return new d.DERSet({array:f})}if(g=="tag"){var y=m[g];if(Object.prototype.toString.call(y)==="[object Array]"&&y.length==3){var e=d.ASN1Util.newObject(y[2]);return new d.DERTaggedObject({tag:y[0],explicit:y[1],obj:e})}else{var k={};if(y.explicit!==undefined){k.explicit=y.explicit}if(y.tag!==undefined){k.tag=y.tag}if(y.obj===undefined){throw"obj shall be specified for 'tag'."}k.obj=d.ASN1Util.newObject(y.obj);return new d.DERTaggedObject(k)}}};this.jsonToASN1HEX=function(e){var b=this.newObject(e);return b.getEncodedHex()}};Ext.asn1.ASN1Util.oidHexToInt=function(v){var j="";var k=parseInt(v.substr(0,2),16);var c=Math.floor(k/40);var b=k%40;var j=c+"."+b;var d="";for(var e=2;e<v.length;e+=2){var f=parseInt(v.substr(e,2),16);var g=("00000000"+f.toString(2)).slice(-8);d=d+g.substr(1,7);if(g.substr(0,1)=="0"){var w=new BigInteger(d,2);j=j+"."+w.toString(10);d=""}}return j};Ext.asn1.ASN1Util.oidIntToHex=function(f){var e=function(i){var k=i.toString(16);if(k.length==1){k="0"+k}return k};var d=function(o){var p="";var i=new BigInteger(o,10);var k=i.toString(2);var m=7-k.length%7;if(m==7){m=0}var n="";for(var l=0;l<m;l++){n+="0"}k=n+k;for(var l=0;l<k.length-1;l+=7){var q=k.substr(l,7);if(l!=k.length-7){q="1"+q}p+=e(parseInt(q,2))}return p};if(!f.match(/^[0-9.]+$/)){throw"malformed oid string: "+f}var g="";var b=f.split(".");var j=parseInt(b[0])*40+parseInt(b[1]);g+=e(j);b.splice(0,2);for(var c=0;c<b.length;c++){g+=d(b[c])}return g};Ext.asn1.ASN1Object=function(){var c=true;var b=null;var d="00";var e="00";var l="";this.getLengthHexFromValue=function(){if(typeof this.hV=="undefined"||this.hV==null){throw"this.hV is null or undefined."}if(this.hV.length%2==1){throw"value hex must be even length: n="+l.length+",v="+this.hV}var i=this.hV.length/2;var g=i.toString(16);if(g.length%2==1){g="0"+g}if(i<128){return g}else{var f=g.length/2;if(f>15){throw"ASN.1 length too long to represent by 8x: n = "+i.toString(16)}var j=128+f;return j.toString(16)+g}};this.getEncodedHex=function(){if(this.hTLV==null||this.isModified){this.hV=this.getFreshValueHex();this.hL=this.getLengthHexFromValue();this.hTLV=this.hT+this.hL+this.hV;this.isModified=false}return this.hTLV};this.getValueHex=function(){this.getEncodedHex();return this.hV};this.getFreshValueHex=function(){return""}};Ext.asn1.DERAbstractString=function(g){Ext.asn1.DERAbstractString.superclass.constructor.call(this);var c=null;var b=null;this.getString=function(){return this.s};this.setString=function(d){this.hTLV=null;this.isModified=true;this.s=d;this.hV=stohex(this.s)};this.setStringHex=function(d){this.hTLV=null;this.isModified=true;this.s=null;this.hV=d};this.getFreshValueHex=function(){return this.hV};if(typeof g!="undefined"){if(typeof g=="string"){this.setString(g)}else{if(typeof g.str!="undefined"){this.setString(g.str)}else{if(typeof g.hex!="undefined"){this.setStringHex(g.hex)}}}}};YAHOO.lang.extend(Ext.asn1.DERAbstractString,Ext.asn1.ASN1Object);Ext.asn1.DERAbstractTime=function(g){Ext.asn1.DERAbstractTime.superclass.constructor.call(this);var c=null;var b=null;this.localDateToUTC=function(d){utc=d.getTime()+(d.getTimezoneOffset()*60000);var e=new Date(utc);return e};this.formatDate=function(q,r,k){var d=this.zeroPadding;var j=this.localDateToUTC(q);var F=String(j.getFullYear());if(r=="utc"){F=F.substr(2,2)}var p=d(String(j.getMonth()+1),2);var m=d(String(j.getDate()),2);var e=d(String(j.getHours()),2);var f=d(String(j.getMinutes()),2);var i=d(String(j.getSeconds()),2);var o=F+p+m+e+f+i;if(k===true){var l=j.getMilliseconds();if(l!=0){var n=d(String(l),3);n=n.replace(/[0]+$/,"");o=o+"."+n}}return o+"Z"};this.zeroPadding=function(d,e){if(d.length>=e){return d}return new Array(e-d.length+1).join("0")+d};this.getString=function(){return this.s};this.setString=function(d){this.hTLV=null;this.isModified=true;this.s=d;this.hV=stohex(d)};this.setByDateValue=function(e,f,j,p,i,o){var d=new Date(Date.UTC(e,f-1,j,p,i,o,0));this.setByDate(d)};this.getFreshValueHex=function(){return this.hV}};YAHOO.lang.extend(Ext.asn1.DERAbstractTime,Ext.asn1.ASN1Object);Ext.asn1.DERAbstractStructured=function(e){Ext.asn1.DERAbstractString.superclass.constructor.call(this);var b=null;this.setByASN1ObjectArray=function(c){this.hTLV=null;this.isModified=true;this.asn1Array=c};this.appendASN1Object=function(c){this.hTLV=null;this.isModified=true;this.asn1Array.push(c)};this.asn1Array=new Array();if(typeof e!="undefined"){if(typeof e.array!="undefined"){this.asn1Array=e.array}}};YAHOO.lang.extend(Ext.asn1.DERAbstractStructured,Ext.asn1.ASN1Object);Ext.asn1.DERBoolean=function(){Ext.asn1.DERBoolean.superclass.constructor.call(this);this.hT="01";this.hTLV="0101ff"};YAHOO.lang.extend(Ext.asn1.DERBoolean,Ext.asn1.ASN1Object);Ext.asn1.DERInteger=function(c){Ext.asn1.DERInteger.superclass.constructor.call(this);this.hT="02";this.setByBigInteger=function(b){this.hTLV=null;this.isModified=true;this.hV=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(b)};this.setByInteger=function(b){var e=new BigInteger(String(b),10);this.setByBigInteger(e)};this.setValueHex=function(b){this.hV=b};this.getFreshValueHex=function(){return this.hV};if(typeof c!="undefined"){if(typeof c.bigint!="undefined"){this.setByBigInteger(c.bigint)}else{if(typeof c["int"]!="undefined"){this.setByInteger(c["int"])}else{if(typeof c=="number"){this.setByInteger(c)}else{if(typeof c.hex!="undefined"){this.setValueHex(c.hex)}}}}}};YAHOO.lang.extend(Ext.asn1.DERInteger,Ext.asn1.ASN1Object);Ext.asn1.DERBitString=function(e){if(e!==undefined&&typeof e.obj!=="undefined"){var b=Ext.asn1.ASN1Util.newObject(e.obj);e.hex="00"+b.getEncodedHex()}Ext.asn1.DERBitString.superclass.constructor.call(this);this.hT="03";this.setHexValueIncludingUnusedBits=function(c){this.hTLV=null;this.isModified=true;this.hV=c};this.setUnusedBitsAndHexValue=function(g,d){if(g<0||7<g){throw"unused bits shall be from 0 to 7: u = "+g}var c="0"+g;this.hTLV=null;this.isModified=true;this.hV=c+d};this.setByBinaryString=function(n){n=n.replace(/0+$/,"");var g=8-n.length%8;if(g==8){g=0}for(var d=0;d<=g;d++){n+="0"}var f="";for(var d=0;d<n.length-1;d+=8){var c=n.substr(d,8);var j=parseInt(c,2).toString(16);if(j.length==1){j="0"+j}f+=j}this.hTLV=null;this.isModified=true;this.hV="0"+g+f};this.setByBooleanArray=function(d){var c="";for(var g=0;g<d.length;g++){if(d[g]==true){c+="1"}else{c+="0"}}this.setByBinaryString(c)};this.newFalseArray=function(d){var g=new Array(d);for(var c=0;c<d;c++){g[c]=false}return g};this.getFreshValueHex=function(){return this.hV};if(typeof e!="undefined"){if(typeof e=="string"&&e.toLowerCase().match(/^[0-9a-f]+$/)){this.setHexValueIncludingUnusedBits(e)}else{if(typeof e.hex!="undefined"){this.setHexValueIncludingUnusedBits(e.hex)}else{if(typeof e.bin!="undefined"){this.setByBinaryString(e.bin)}else{if(typeof e.array!="undefined"){this.setByBooleanArray(e.array)}}}}}};YAHOO.lang.extend(Ext.asn1.DERBitString,Ext.asn1.ASN1Object);Ext.asn1.DEROctetString=function(e){if(e!==undefined&&typeof e.obj!=="undefined"){var b=Ext.asn1.ASN1Util.newObject(e.obj);e.hex=b.getEncodedHex()}Ext.asn1.DEROctetString.superclass.constructor.call(this,e);this.hT="04"};YAHOO.lang.extend(Ext.asn1.DEROctetString,Ext.asn1.DERAbstractString);Ext.asn1.DERNull=function(){Ext.asn1.DERNull.superclass.constructor.call(this);this.hT="05";this.hTLV="0500"};YAHOO.lang.extend(Ext.asn1.DERNull,Ext.asn1.ASN1Object);Ext.asn1.DERObjectIdentifier=function(g){var c=function(e){var d=e.toString(16);if(d.length==1){d="0"+d}return d};var b=function(r){var j="";var d=new BigInteger(r,10);var k=d.toString(2);var e=7-k.length%7;if(e==7){e=0}var m="";for(var f=0;f<e;f++){m+="0"}k=m+k;for(var f=0;f<k.length-1;f+=7){var l=k.substr(f,7);if(f!=k.length-7){l="1"+l}j+=c(parseInt(l,2))}return j};Ext.asn1.DERObjectIdentifier.superclass.constructor.call(this);this.hT="06";this.setValueHex=function(d){this.hTLV=null;this.isModified=true;this.s=null;this.hV=d};this.setValueOidString=function(f){if(!f.match(/^[0-9.]+$/)){throw"malformed oid string: "+f}var j="";var d=f.split(".");var l=parseInt(d[0])*40+parseInt(d[1]);j+=c(l);d.splice(0,2);for(var e=0;e<d.length;e++){j+=b(d[e])}this.hTLV=null;this.isModified=true;this.s=null;this.hV=j};this.setValueName=function(d){var e=Ext.asn1.x509.OID.name2oid(d);if(e!==""){this.setValueOidString(e)}else{throw"DERObjectIdentifier oidName undefined: "+d}};this.getFreshValueHex=function(){return this.hV};if(g!==undefined){if(typeof g==="string"){if(g.match(/^[0-2].[0-9.]+$/)){this.setValueOidString(g)}else{this.setValueName(g)}}else{if(g.oid!==undefined){this.setValueOidString(g.oid)}else{if(g.hex!==undefined){this.setValueHex(g.hex)}else{if(g.name!==undefined){this.setValueName(g.name)}}}}}};YAHOO.lang.extend(Ext.asn1.DERObjectIdentifier,Ext.asn1.ASN1Object);Ext.asn1.DEREnumerated=function(c){Ext.asn1.DEREnumerated.superclass.constructor.call(this);this.hT="0a";this.setByBigInteger=function(b){this.hTLV=null;this.isModified=true;this.hV=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(b)};this.setByInteger=function(b){var e=new BigInteger(String(b),10);this.setByBigInteger(e)};this.setValueHex=function(b){this.hV=b};this.getFreshValueHex=function(){return this.hV};if(typeof c!="undefined"){if(typeof c["int"]!="undefined"){this.setByInteger(c["int"])}else{if(typeof c=="number"){this.setByInteger(c)}else{if(typeof c.hex!="undefined"){this.setValueHex(c.hex)}}}}};YAHOO.lang.extend(Ext.asn1.DEREnumerated,Ext.asn1.ASN1Object);Ext.asn1.DERUTF8String=function(c){Ext.asn1.DERUTF8String.superclass.constructor.call(this,c);this.hT="0c"};YAHOO.lang.extend(Ext.asn1.DERUTF8String,Ext.asn1.DERAbstractString);Ext.asn1.DERNumericString=function(c){Ext.asn1.DERNumericString.superclass.constructor.call(this,c);this.hT="12"};YAHOO.lang.extend(Ext.asn1.DERNumericString,Ext.asn1.DERAbstractString);Ext.asn1.DERPrintableString=function(c){Ext.asn1.DERPrintableString.superclass.constructor.call(this,c);this.hT="13"};YAHOO.lang.extend(Ext.asn1.DERPrintableString,Ext.asn1.DERAbstractString);Ext.asn1.DERTeletexString=function(c){Ext.asn1.DERTeletexString.superclass.constructor.call(this,c);this.hT="14"};YAHOO.lang.extend(Ext.asn1.DERTeletexString,Ext.asn1.DERAbstractString);Ext.asn1.DERIA5String=function(c){Ext.asn1.DERIA5String.superclass.constructor.call(this,c);this.hT="16"};YAHOO.lang.extend(Ext.asn1.DERIA5String,Ext.asn1.DERAbstractString);Ext.asn1.DERUTCTime=function(c){Ext.asn1.DERUTCTime.superclass.constructor.call(this,c);this.hT="17";this.setByDate=function(b){this.hTLV=null;this.isModified=true;this.date=b;this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(typeof this.date=="undefined"&&typeof this.s=="undefined"){this.date=new Date();this.s=this.formatDate(this.date,"utc");this.hV=stohex(this.s)}return this.hV};if(c!==undefined){if(c.str!==undefined){this.setString(c.str)}else{if(typeof c=="string"&&c.match(/^[0-9]{12}Z$/)){this.setString(c)}else{if(c.hex!==undefined){this.setStringHex(c.hex)}else{if(c.date!==undefined){this.setByDate(c.date)}}}}}};YAHOO.lang.extend(Ext.asn1.DERUTCTime,Ext.asn1.DERAbstractTime);Ext.asn1.DERGeneralizedTime=function(c){Ext.asn1.DERGeneralizedTime.superclass.constructor.call(this,c);this.hT="18";this.withMillis=false;this.setByDate=function(b){this.hTLV=null;this.isModified=true;this.date=b;this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)};this.getFreshValueHex=function(){if(this.date===undefined&&this.s===undefined){this.date=new Date();this.s=this.formatDate(this.date,"gen",this.withMillis);this.hV=stohex(this.s)}return this.hV};if(c!==undefined){if(c.str!==undefined){this.setString(c.str)}else{if(typeof c=="string"&&c.match(/^[0-9]{14}Z$/)){this.setString(c)}else{if(c.hex!==undefined){this.setStringHex(c.hex)}else{if(c.date!==undefined){this.setByDate(c.date)}}}}if(c.millis===true){this.withMillis=true}}};YAHOO.lang.extend(Ext.asn1.DERGeneralizedTime,Ext.asn1.DERAbstractTime);Ext.asn1.DERSequence=function(c){Ext.asn1.DERSequence.superclass.constructor.call(this,c);this.hT="30";this.getFreshValueHex=function(){var g="";for(var d=0;d<this.asn1Array.length;d++){var b=this.asn1Array[d];g+=b.getEncodedHex()}this.hV=g;return this.hV}};YAHOO.lang.extend(Ext.asn1.DERSequence,Ext.asn1.DERAbstractStructured);Ext.asn1.DERSet=function(c){Ext.asn1.DERSet.superclass.constructor.call(this,c);this.hT="31";this.sortFlag=true;this.getFreshValueHex=function(){var d=new Array();for(var g=0;g<this.asn1Array.length;g++){var b=this.asn1Array[g];d.push(b.getEncodedHex())}if(this.sortFlag==true){d.sort()}this.hV=d.join("");return this.hV};if(typeof c!="undefined"){if(typeof c.sortflag!="undefined"&&c.sortflag==false){this.sortFlag=false}}};YAHOO.lang.extend(Ext.asn1.DERSet,Ext.asn1.DERAbstractStructured);Ext.asn1.DERTaggedObject=function(c){Ext.asn1.DERTaggedObject.superclass.constructor.call(this);this.hT="a0";this.hV="";this.isExplicit=true;this.asn1Object=null;this.setASN1Object=function(d,g,b){this.hT=g;this.isExplicit=d;this.asn1Object=b;if(this.isExplicit){this.hV=this.asn1Object.getEncodedHex();this.hTLV=null;this.isModified=true}else{this.hV=null;this.hTLV=b.getEncodedHex();this.hTLV=this.hTLV.replace(/^../,g);this.isModified=false}};this.getFreshValueHex=function(){return this.hV};if(typeof c!="undefined"){if(typeof c.tag!="undefined"){this.hT=c.tag}if(typeof c.explicit!="undefined"){this.isExplicit=c.explicit}if(typeof c.obj!="undefined"){this.asn1Object=c.obj;this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)}}};YAHOO.lang.extend(Ext.asn1.DERTaggedObject,Ext.asn1.ASN1Object);var ASN1HEX=new function(){};ASN1HEX.getByteLengthOfL_AtObj=function(c,g){if(c.substring(g+2,g+3)!="8"){return 1}var b=parseInt(c.substring(g+3,g+4));if(b==0){return -1}if(0<b&&b<10){return b+1}return -2};ASN1HEX.getHexOfL_AtObj=function(c,g){var b=ASN1HEX.getByteLengthOfL_AtObj(c,g);if(b<1){return""}return c.substring(g+2,g+2+b*2)};ASN1HEX.getIntOfL_AtObj=function(d,j){var c=ASN1HEX.getHexOfL_AtObj(d,j);if(c==""){return -1}var b;if(parseInt(c.substring(0,1))<8){b=new BigInteger(c,16)}else{b=new BigInteger(c.substring(2),16)}return b.intValue()};ASN1HEX.getStartPosOfV_AtObj=function(c,g){var b=ASN1HEX.getByteLengthOfL_AtObj(c,g);if(b<0){return b}return g+(b+1)*2};ASN1HEX.getHexOfV_AtObj=function(d,j){var c=ASN1HEX.getStartPosOfV_AtObj(d,j);var b=ASN1HEX.getIntOfL_AtObj(d,j);return d.substring(c,c+b*2)};ASN1HEX.getHexOfTLV_AtObj=function(c,e){var b=c.substr(e,2);var d=ASN1HEX.getHexOfL_AtObj(c,e);var l=ASN1HEX.getHexOfV_AtObj(c,e);return b+d+l};ASN1HEX.getPosOfNextSibling_AtObj=function(d,j){var c=ASN1HEX.getStartPosOfV_AtObj(d,j);var b=ASN1HEX.getIntOfL_AtObj(d,j);return c+b*2};ASN1HEX.getPosArrayOfChildren_AtObj=function(d,g){var j=new Array();var f=ASN1HEX.getStartPosOfV_AtObj(d,g);if(d.substr(g,2)=="03"){j.push(f+2)}else{j.push(f)}var i=ASN1HEX.getIntOfL_AtObj(d,g);var e=f;var b=0;while(1){var c=ASN1HEX.getPosOfNextSibling_AtObj(d,e);if(c==null||(c-f>=(i*2))){break}if(b>=200){break}j.push(c);e=c;b++}return j};ASN1HEX.getNthChildIndex_AtObj=function(e,c,b){var d=ASN1HEX.getPosArrayOfChildren_AtObj(e,c);return d[b]};ASN1HEX.getDecendantIndexByNthList=function(e,d,c){if(c.length==0){return d}var f=c.shift();var b=ASN1HEX.getPosArrayOfChildren_AtObj(e,d);return ASN1HEX.getDecendantIndexByNthList(e,b[f],c)};ASN1HEX.getDecendantHexTLVByNthList=function(j,d,c){var b=ASN1HEX.getDecendantIndexByNthList(j,d,c);return ASN1HEX.getHexOfTLV_AtObj(j,b)};ASN1HEX.getDecendantHexVByNthList=function(j,d,c){var b=ASN1HEX.getDecendantIndexByNthList(j,d,c);return ASN1HEX.getHexOfV_AtObj(j,b)};ASN1HEX.getVbyList=function(d,c,b,e){var l=ASN1HEX.getDecendantIndexByNthList(d,c,b);if(l===undefined){throw"can't find nthList object"}if(e!==undefined){if(d.substr(l,2)!=e){throw"checking tag doesn't match: "+d.substr(l,2)+"!="+e}}return ASN1HEX.getHexOfV_AtObj(d,l)};ASN1HEX.hextooidstr=function(g){var l=function(c,b){if(c.length>=b){return c}return new Array(b-c.length+1).join("0")+c};var o=[];var e=g.substr(0,2);var j=parseInt(e,16);o[0]=new String(Math.floor(j/40));o[1]=new String(j%40);var y=g.substr(2);var n=[];for(var k=0;k<y.length/2;k++){n.push(parseInt(y.substr(k*2,2),16))}var m=[];var f="";for(var k=0;k<n.length;k++){if(n[k]&128){f=f+l((n[k]&127).toString(2),7)}else{f=f+l((n[k]&127).toString(2),7);m.push(new String(parseInt(f,2)));f=""}}var d=o.join(".");if(m.length>0){d=d+"."+m.join(".")}return d};ASN1HEX.dump=function(l,d,P,n){var f=l;if(l instanceof Ext.asn1.ASN1Object){f=l.getEncodedHex()}var m=function(i,s){if(i.length<=s*2){return i}else{var v=i.substr(0,s)+"..(total "+i.length/2+"bytes).."+i.substr(i.length-s,s);return v}};if(d===undefined){d={ommit_long_octet:32}}if(P===undefined){P=0}if(n===undefined){n=""}var u=d.ommit_long_octet;if(f.substr(P,2)=="01"){var q=ASN1HEX.getHexOfV_AtObj(f,P);if(q=="00"){return n+"BOOLEAN FALSE\n"}else{return n+"BOOLEAN TRUE\n"}}if(f.substr(P,2)=="02"){var q=ASN1HEX.getHexOfV_AtObj(f,P);return n+"INTEGER "+m(q,u)+"\n"}if(f.substr(P,2)=="03"){var q=ASN1HEX.getHexOfV_AtObj(f,P);return n+"BITSTRING "+m(q,u)+"\n"}if(f.substr(P,2)=="04"){var q=ASN1HEX.getHexOfV_AtObj(f,P);if(ASN1HEX.isASN1HEX(q)){var j=n+"OCTETSTRING, encapsulates\n";j=j+ASN1HEX.dump(q,d,0,n+"  ");return j}else{return n+"OCTETSTRING "+m(q,u)+"\n"}}if(f.substr(P,2)=="05"){return n+"NULL\n"}if(f.substr(P,2)=="06"){var k=ASN1HEX.getHexOfV_AtObj(f,P);var b=Ext.asn1.ASN1Util.oidHexToInt(k);var o=Ext.asn1.x509.OID.oid2name(b);var c=b.replace(/\./g," ");if(o!=""){return n+"ObjectIdentifier "+o+" ("+c+")\n"}else{return n+"ObjectIdentifier ("+c+")\n"}}if(f.substr(P,2)=="0c"){return n+"UTF8String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(f,P))+"'\n"}if(f.substr(P,2)=="13"){return n+"PrintableString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(f,P))+"'\n"}if(f.substr(P,2)=="14"){return n+"TeletexString '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(f,P))+"'\n"}if(f.substr(P,2)=="16"){return n+"IA5String '"+hextoutf8(ASN1HEX.getHexOfV_AtObj(f,P))+"'\n"}if(f.substr(P,2)=="17"){return n+"UTCTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(f,P))+"\n"}if(f.substr(P,2)=="18"){return n+"GeneralizedTime "+hextoutf8(ASN1HEX.getHexOfV_AtObj(f,P))+"\n"}if(f.substr(P,2)=="30"){if(f.substr(P,4)=="3000"){return n+"SEQUENCE {}\n"}var j=n+"SEQUENCE\n";var e=ASN1HEX.getPosArrayOfChildren_AtObj(f,P);var g=d;if((e.length==2||e.length==3)&&f.substr(e[0],2)=="06"&&f.substr(e[e.length-1],2)=="04"){var w=ASN1HEX.getHexOfV_AtObj(f,e[0]);var b=Ext.asn1.ASN1Util.oidHexToInt(w);var o=Ext.asn1.x509.OID.oid2name(b);var Q=JSON.parse(JSON.stringify(d));Q.x509ExtName=o;g=Q}for(var p=0;p<e.length;p++){j=j+ASN1HEX.dump(f,g,e[p],n+"  ")}return j}if(f.substr(P,2)=="31"){var j=n+"SET\n";var e=ASN1HEX.getPosArrayOfChildren_AtObj(f,P);for(var p=0;p<e.length;p++){j=j+ASN1HEX.dump(f,d,e[p],n+"  ")}return j}var R=parseInt(f.substr(P,2),16);if((R&128)!=0){var r=R&31;if((R&32)!=0){var j=n+"["+r+"]\n";var e=ASN1HEX.getPosArrayOfChildren_AtObj(f,P);for(var p=0;p<e.length;p++){j=j+ASN1HEX.dump(f,d,e[p],n+"  ")}return j}else{var q=ASN1HEX.getHexOfV_AtObj(f,P);if(q.substr(0,8)=="68747470"){q=hextoutf8(q)}if(d.x509ExtName==="subjectAltName"&&r==2){q=hextoutf8(q)}var j=n+"["+r+"] "+q+"\n";return j}}return n+"UNKNOWN("+f.substr(P,2)+") "+ASN1HEX.getHexOfV_AtObj(f,P)+"\n"};ASN1HEX.isASN1HEX=function(d){if(d.length%2==1){return false}var c=ASN1HEX.getIntOfL_AtObj(d,0);var b=d.substr(0,2);var e=ASN1HEX.getHexOfL_AtObj(d,0);var l=d.length-b.length-e.length;if(l==c*2){return true}return false};ASN1HEX.pemToHex=function(c,j){if(c.indexOf("-----BEGIN ")==-1){throw"can't find PEM header: "+j}if(j!==undefined){c=c.replace("-----BEGIN "+j+"-----","");c=c.replace("-----END "+j+"-----","")}else{c=c.replace(/-----BEGIN [^-]+-----/,"");c=c.replace(/-----END [^-]+-----/,"")}var d=c.replace(/\s+/g,"");var b=b64tohex(d);return b};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.x509=="undefined"||!Ext.asn1.x509){Ext.asn1.x509={}}Ext.asn1.x509.Certificate=function(b){Ext.asn1.x509.Certificate.superclass.constructor.call(this);var p=null;var f=null;var d=null;var g=null;var e=null;var c=null;this.setRsaPrvKeyByPEMandPass=function(i,k){var l=PKCS5PKEY.getDecryptedKeyHex(i,k);var j=new RSAKey();j.readPrivateKeyFromASN1HexString(l);this.prvKey=j};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;sig=new Ext.crypto.Signature({alg:"SHA1withRSA"});sig.init(this.prvKey);sig.updateHex(this.asn1TBSCert.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var i=new Ext.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=i.getEncodedHex();this.isModified=false};this.setSignatureHex=function(j){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;this.hexSig=j;this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var i=new Ext.asn1.DERSequence({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=i.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var j=this.getEncodedHex();var l=CryptoJS.enc.Hex.parse(j);var i=CryptoJS.enc.Base64.stringify(l);var k=i.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN CERTIFICATE-----\r\n"+k+"\r\n-----END CERTIFICATE-----\r\n"};if(typeof b!="undefined"){if(typeof b.tbscertobj!="undefined"){this.asn1TBSCert=b.tbscertobj}if(typeof b.prvkeyobj!="undefined"){this.prvKey=b.prvkeyobj}else{if(typeof b.rsaprvkey!="undefined"){this.prvKey=b.rsaprvkey}else{if((typeof b.rsaprvpem!="undefined")&&(typeof b.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(b.rsaprvpem,b.rsaprvpas)}}}}};YAHOO.lang.extend(Ext.asn1.x509.Certificate,Ext.asn1.ASN1Object);Ext.asn1.x509.TBSCertificate=function(c){Ext.asn1.x509.TBSCertificate.superclass.constructor.call(this);this._initialize=function(){this.asn1Array=new Array();this.asn1Version=new Ext.asn1.DERTaggedObject({obj:new Ext.asn1.DERInteger({"int":2})});this.asn1SerialNumber=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1NotBefore=null;this.asn1NotAfter=null;this.asn1Subject=null;this.asn1SubjPKey=null;this.extensionsArray=new Array()};this.setSerialNumberByParam=function(b){this.asn1SerialNumber=new Ext.asn1.DERInteger(b)};this.setSignatureAlgByParam=function(b){this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier(b)};this.setIssuerByParam=function(b){this.asn1Issuer=new Ext.asn1.x509.X500Name(b)};this.setNotBeforeByParam=function(b){this.asn1NotBefore=new Ext.asn1.x509.Time(b)};this.setNotAfterByParam=function(b){this.asn1NotAfter=new Ext.asn1.x509.Time(b)};this.setSubjectByParam=function(b){this.asn1Subject=new Ext.asn1.x509.X500Name(b)};this.setSubjectPublicKeyByParam=function(b){this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(b)};this.setSubjectPublicKeyByGetKey=function(b){var e=KEYUTIL.getKey(b);this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(e)};this.appendExtension=function(b){this.extensionsArray.push(b)};this.appendExtensionByName=function(b,e){Ext.asn1.x509.Extension.appendByNameToArray(b,e,this.extensionsArray)};this.getEncodedHex=function(){if(this.asn1NotBefore==null||this.asn1NotAfter==null){throw"notBefore and/or notAfter not set"}var e=new Ext.asn1.DERSequence({array:[this.asn1NotBefore,this.asn1NotAfter]});this.asn1Array=new Array();this.asn1Array.push(this.asn1Version);this.asn1Array.push(this.asn1SerialNumber);this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(e);this.asn1Array.push(this.asn1Subject);this.asn1Array.push(this.asn1SubjPKey);if(this.extensionsArray.length>0){var j=new Ext.asn1.DERSequence({array:this.extensionsArray});var d=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a3",obj:j});this.asn1Array.push(d)}var b=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=b.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize()};YAHOO.lang.extend(Ext.asn1.x509.TBSCertificate,Ext.asn1.ASN1Object);Ext.asn1.x509.Extension=function(e){Ext.asn1.x509.Extension.superclass.constructor.call(this);var b=null;this.getEncodedHex=function(){var f=new Ext.asn1.DERObjectIdentifier({oid:this.oid});var d=new Ext.asn1.DEROctetString({hex:this.getExtnValueHex()});var c=new Array();c.push(f);if(this.critical){c.push(new Ext.asn1.DERBoolean())}c.push(d);var j=new Ext.asn1.DERSequence({array:c});return j.getEncodedHex()};this.critical=false;if(typeof e!="undefined"){if(typeof e.critical!="undefined"){this.critical=e.critical}}};YAHOO.lang.extend(Ext.asn1.x509.Extension,Ext.asn1.ASN1Object);Ext.asn1.x509.Extension.appendByNameToArray=function(b,d,c){if(b.toLowerCase()=="basicconstraints"){var e=new Ext.asn1.x509.BasicConstraints(d);c.push(e)}else{if(b.toLowerCase()=="keyusage"){var e=new Ext.asn1.x509.KeyUsage(d);c.push(e)}else{if(b.toLowerCase()=="crldistributionpoints"){var e=new Ext.asn1.x509.CRLDistributionPoints(d);c.push(e)}else{if(b.toLowerCase()=="extkeyusage"){var e=new Ext.asn1.x509.ExtKeyUsage(d);c.push(e)}else{if(b.toLowerCase()=="authoritykeyidentifier"){var e=new Ext.asn1.x509.AuthorityKeyIdentifier(d);c.push(e)}else{if(b.toLowerCase()=="authorityinfoaccess"){var e=new Ext.asn1.x509.AuthorityInfoAccess(d);c.push(e)}else{if(b.toLowerCase()=="subjectaltname"){var e=new Ext.asn1.x509.SubjectAltName(d);c.push(e)}else{if(b.toLowerCase()=="issueraltname"){var e=new Ext.asn1.x509.IssuerAltName(d);c.push(e)}else{throw"unsupported extension name: "+b}}}}}}}}};Ext.asn1.x509.KeyUsage=function(c){Ext.asn1.x509.KeyUsage.superclass.constructor.call(this,c);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.15";if(typeof c!="undefined"){if(typeof c.bin!="undefined"){this.asn1ExtnValue=new Ext.asn1.DERBitString(c)}}};YAHOO.lang.extend(Ext.asn1.x509.KeyUsage,Ext.asn1.x509.Extension);Ext.asn1.x509.BasicConstraints=function(g){Ext.asn1.x509.BasicConstraints.superclass.constructor.call(this,g);var b=false;var c=-1;this.getExtnValueHex=function(){var d=new Array();if(this.cA){d.push(new Ext.asn1.DERBoolean())}if(this.pathLen>-1){d.push(new Ext.asn1.DERInteger({"int":this.pathLen}))}var e=new Ext.asn1.DERSequence({array:d});this.asn1ExtnValue=e;return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.19";this.cA=false;this.pathLen=-1;if(typeof g!="undefined"){if(typeof g.cA!="undefined"){this.cA=g.cA}if(typeof g.pathLen!="undefined"){this.pathLen=g.pathLen}}};YAHOO.lang.extend(Ext.asn1.x509.BasicConstraints,Ext.asn1.x509.Extension);Ext.asn1.x509.CRLDistributionPoints=function(c){Ext.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,c);this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.setByDPArray=function(b){this.asn1ExtnValue=new Ext.asn1.DERSequence({array:b})};this.setByOneURI=function(b){var d=new Ext.asn1.x509.GeneralNames([{uri:b}]);var j=new Ext.asn1.x509.DistributionPointName(d);var e=new Ext.asn1.x509.DistributionPoint({dpobj:j});this.setByDPArray([e])};this.oid="2.5.29.31";if(typeof c!="undefined"){if(typeof c.array!="undefined"){this.setByDPArray(c.array)}else{if(typeof c.uri!="undefined"){this.setByOneURI(c.uri)}}}};YAHOO.lang.extend(Ext.asn1.x509.CRLDistributionPoints,Ext.asn1.x509.Extension);Ext.asn1.x509.ExtKeyUsage=function(c){Ext.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,c);this.setPurposeArray=function(d){this.asn1ExtnValue=new Ext.asn1.DERSequence();for(var g=0;g<d.length;g++){var b=new Ext.asn1.DERObjectIdentifier(d[g]);this.asn1ExtnValue.appendASN1Object(b)}};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.37";if(typeof c!="undefined"){if(typeof c.array!="undefined"){this.setPurposeArray(c.array)}}};YAHOO.lang.extend(Ext.asn1.x509.ExtKeyUsage,Ext.asn1.x509.Extension);Ext.asn1.x509.AuthorityKeyIdentifier=function(c){Ext.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,c);this.asn1KID=null;this.asn1CertIssuer=null;this.asn1CertSN=null;this.getExtnValueHex=function(){var b=new Array();if(this.asn1KID){b.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"80",obj:this.asn1KID}))}if(this.asn1CertIssuer){b.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"a1",obj:this.asn1CertIssuer}))}if(this.asn1CertSN){b.push(new Ext.asn1.DERTaggedObject({explicit:false,tag:"82",obj:this.asn1CertSN}))}var e=new Ext.asn1.DERSequence({array:b});this.asn1ExtnValue=e;return this.asn1ExtnValue.getEncodedHex()};this.setKIDByParam=function(b){this.asn1KID=new Ext.asn1.DEROctetString(b)};this.setCertIssuerByParam=function(b){this.asn1CertIssuer=new Ext.asn1.x509.X500Name(b)};this.setCertSNByParam=function(b){this.asn1CertSN=new Ext.asn1.DERInteger(b)};this.oid="2.5.29.35";if(typeof c!="undefined"){if(typeof c.kid!="undefined"){this.setKIDByParam(c.kid)}if(typeof c.issuer!="undefined"){this.setCertIssuerByParam(c.issuer)}if(typeof c.sn!="undefined"){this.setCertSNByParam(c.sn)}}};YAHOO.lang.extend(Ext.asn1.x509.AuthorityKeyIdentifier,Ext.asn1.x509.Extension);Ext.asn1.x509.AuthorityInfoAccess=function(c){Ext.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,c);this.setAccessDescriptionArray=function(n){var f=new Array();for(var g=0;g<n.length;g++){var d=new Ext.asn1.DERObjectIdentifier(n[g].accessMethod);var b=new Ext.asn1.x509.GeneralName(n[g].accessLocation);var e=new Ext.asn1.DERSequence({array:[d,b]});f.push(e)}this.asn1ExtnValue=new Ext.asn1.DERSequence({array:f})};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="1.3.6.1.5.5.7.1.1";if(typeof c!="undefined"){if(typeof c.array!="undefined"){this.setAccessDescriptionArray(c.array)}}};YAHOO.lang.extend(Ext.asn1.x509.AuthorityInfoAccess,Ext.asn1.x509.Extension);Ext.asn1.x509.SubjectAltName=function(c){Ext.asn1.x509.SubjectAltName.superclass.constructor.call(this,c);this.setNameArray=function(b){this.asn1ExtnValue=new Ext.asn1.x509.GeneralNames(b)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.17";if(c!==undefined){if(c.array!==undefined){this.setNameArray(c.array)}}};YAHOO.lang.extend(Ext.asn1.x509.SubjectAltName,Ext.asn1.x509.Extension);Ext.asn1.x509.IssuerAltName=function(c){Ext.asn1.x509.IssuerAltName.superclass.constructor.call(this,c);this.setNameArray=function(b){this.asn1ExtnValue=new Ext.asn1.x509.GeneralNames(b)};this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()};this.oid="2.5.29.18";if(c!==undefined){if(c.array!==undefined){this.setNameArray(c.array)}}};YAHOO.lang.extend(Ext.asn1.x509.IssuerAltName,Ext.asn1.x509.Extension);Ext.asn1.x509.CRL=function(e){Ext.asn1.x509.CRL.superclass.constructor.call(this);var f=null;var b=null;var d=null;var n=null;var c=null;this.setRsaPrvKeyByPEMandPass=function(g,j){var k=PKCS5PKEY.getDecryptedKeyHex(g,j);var i=new RSAKey();i.readPrivateKeyFromASN1HexString(k);this.rsaPrvKey=i};this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg;sig=new Ext.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"});sig.initSign(this.rsaPrvKey);sig.updateHex(this.asn1TBSCertList.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var g=new Ext.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=g.getEncodedHex();this.isModified=false};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};this.getPEMString=function(){var i=this.getEncodedHex();var k=CryptoJS.enc.Hex.parse(i);var g=CryptoJS.enc.Base64.stringify(k);var j=g.replace(/(.{64})/g,"$1\r\n");return"-----BEGIN X509 CRL-----\r\n"+j+"\r\n-----END X509 CRL-----\r\n"};if(typeof e!="undefined"){if(typeof e.tbsobj!="undefined"){this.asn1TBSCertList=e.tbsobj}if(typeof e.rsaprvkey!="undefined"){this.rsaPrvKey=e.rsaprvkey}if((typeof e.rsaprvpem!="undefined")&&(typeof e.rsaprvpas!="undefined")){this.setRsaPrvKeyByPEMandPass(e.rsaprvpem,e.rsaprvpas)}}};YAHOO.lang.extend(Ext.asn1.x509.CRL,Ext.asn1.ASN1Object);Ext.asn1.x509.TBSCertList=function(e){Ext.asn1.x509.TBSCertList.superclass.constructor.call(this);var b=null;this.setSignatureAlgByParam=function(c){this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier(c)};this.setIssuerByParam=function(c){this.asn1Issuer=new Ext.asn1.x509.X500Name(c)};this.setThisUpdateByParam=function(c){this.asn1ThisUpdate=new Ext.asn1.x509.Time(c)};this.setNextUpdateByParam=function(c){this.asn1NextUpdate=new Ext.asn1.x509.Time(c)};this.addRevokedCert=function(j,c){var f={};if(j!=undefined&&j!=null){f.sn=j}if(c!=undefined&&c!=null){f.time=c}var d=new Ext.asn1.x509.CRLEntry(f);this.aRevokedCert.push(d)};this.getEncodedHex=function(){this.asn1Array=new Array();if(this.asn1Version!=null){this.asn1Array.push(this.asn1Version)}this.asn1Array.push(this.asn1SignatureAlg);this.asn1Array.push(this.asn1Issuer);this.asn1Array.push(this.asn1ThisUpdate);if(this.asn1NextUpdate!=null){this.asn1Array.push(this.asn1NextUpdate)}if(this.aRevokedCert.length>0){var d=new Ext.asn1.DERSequence({array:this.aRevokedCert});this.asn1Array.push(d)}var c=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=c.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize=function(){this.asn1Version=null;this.asn1SignatureAlg=null;this.asn1Issuer=null;this.asn1ThisUpdate=null;this.asn1NextUpdate=null;this.aRevokedCert=new Array()};this._initialize()};YAHOO.lang.extend(Ext.asn1.x509.TBSCertList,Ext.asn1.ASN1Object);Ext.asn1.x509.CRLEntry=function(g){Ext.asn1.x509.CRLEntry.superclass.constructor.call(this);var c=null;var b=null;this.setCertSerial=function(d){this.sn=new Ext.asn1.DERInteger(d)};this.setRevocationDate=function(d){this.time=new Ext.asn1.x509.Time(d)};this.getEncodedHex=function(){var d=new Ext.asn1.DERSequence({array:[this.sn,this.time]});this.TLV=d.getEncodedHex();return this.TLV};if(typeof g!="undefined"){if(typeof g.time!="undefined"){this.setRevocationDate(g.time)}if(typeof g.sn!="undefined"){this.setCertSerial(g.sn)}}};YAHOO.lang.extend(Ext.asn1.x509.CRLEntry,Ext.asn1.ASN1Object);Ext.asn1.x509.X500Name=function(e){Ext.asn1.x509.X500Name.superclass.constructor.call(this);this.asn1Array=new Array();this.setByString=function(g){var c=g.split("/");c.shift();for(var d=0;d<c.length;d++){this.asn1Array.push(new Ext.asn1.x509.RDN({str:c[d]}))}};this.setByLdapString=function(d){var c=Ext.asn1.x509.X500Name.ldapToOneline(d);this.setByString(c)};this.setByObject=function(d){for(var g in d){if(d.hasOwnProperty(g)){var c=new Ext.asn1.x509.RDN({str:g+"="+d[g]});this.asn1Array?this.asn1Array.push(c):this.asn1Array=[c]}}};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var c=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=c.getEncodedHex();return this.hTLV};if(e!==undefined){if(e.str!==undefined){this.setByString(e.str)}else{if(e.ldapstr!==undefined){this.setByLdapString(e.ldapstr)}else{if(typeof e==="object"){this.setByObject(e)}}}if(e.certissuer!==undefined){var b=new X509();b.hex=ASN1HEX.pemToHex(e.certissuer);this.hTLV=b.getIssuerHex()}if(e.certsubject!==undefined){var b=new X509();b.hex=ASN1HEX.pemToHex(e.certsubject);this.hTLV=b.getSubjectHex()}}};YAHOO.lang.extend(Ext.asn1.x509.X500Name,Ext.asn1.ASN1Object);Ext.asn1.x509.X500Name.onelineToLDAP=function(b){if(b.substr(0,1)!=="/"){throw"malformed input"}var c="";b=b.substr(1);var d=b.split("/");d.reverse();d=d.map(function(e){return e.replace(/,/,"\\,")});return d.join(",")};Ext.asn1.x509.X500Name.ldapToOneline=function(g){var j=g.split(",");var e=false;var b=[];for(var d=0;j.length>0;d++){var f=j.shift();if(e===true){var c=b.pop();var r=(c+","+f).replace(/\\,/g,",");b.push(r);e=false}else{b.push(f)}if(f.substr(-1,1)==="\\"){e=true}}b=b.map(function(i){return i.replace("/","\\/")});b.reverse();return"/"+b.join("/")};Ext.asn1.x509.RDN=function(c){Ext.asn1.x509.RDN.superclass.constructor.call(this);this.asn1Array=new Array();this.addByString=function(b){this.asn1Array.push(new Ext.asn1.x509.AttributeTypeAndValue({str:b}))};this.addByMultiValuedString=function(b){var d=Ext.asn1.x509.RDN.parseString(b);for(var g=0;g<d.length;g++){this.addByString(d[g])}};this.getEncodedHex=function(){var b=new Ext.asn1.DERSet({array:this.asn1Array});this.TLV=b.getEncodedHex();return this.TLV};if(typeof c!="undefined"){if(typeof c.str!="undefined"){this.addByMultiValuedString(c.str)}}};YAHOO.lang.extend(Ext.asn1.x509.RDN,Ext.asn1.ASN1Object);Ext.asn1.x509.RDN.parseString=function(l){var g=l.split(/\+/);var f=false;var c=[];for(var d=0;g.length>0;d++){var j=g.shift();if(f===true){var m=c.pop();var b=(m+"+"+j).replace(/\\\+/g,"+");c.push(b);f=false}else{c.push(j)}if(j.substr(-1,1)==="\\"){f=true}}var k=false;var y=[];for(var d=0;c.length>0;d++){var j=c.shift();if(k===true){var e=y.pop();if(j.match(/"$/)){var b=(e+"+"+j).replace(/^([^=]+)="(.*)"$/,"$1=$2");y.push(b);k=false}else{y.push(e+"+"+j)}}else{y.push(j)}if(j.match(/^[^=]+="/)){k=true}}return y};Ext.asn1.x509.AttributeTypeAndValue=function(c){Ext.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var j=null;var d=null;var b="utf8";this.setByString=function(e){var f=e.match(/^([^=]+)=(.+)$/);if(f){this.setByAttrTypeAndValueStr(f[1],f[2])}else{throw"malformed attrTypeAndValueStr: "+e}};this.setByAttrTypeAndValueStr=function(f,e){this.typeObj=Ext.asn1.x509.OID.atype2obj(f);var g=b;if(f=="C"){g="prn"}this.valueObj=this.getValueObj(g,e)};this.getValueObj=function(e,f){if(e=="utf8"){return new Ext.asn1.DERUTF8String({str:f})}if(e=="prn"){return new Ext.asn1.DERPrintableString({str:f})}if(e=="tel"){return new Ext.asn1.DERTeletexString({str:f})}if(e=="ia5"){return new Ext.asn1.DERIA5String({str:f})}throw"unsupported directory string type: type="+e+" value="+f};this.getEncodedHex=function(){var e=new Ext.asn1.DERSequence({array:[this.typeObj,this.valueObj]});this.TLV=e.getEncodedHex();return this.TLV};if(typeof c!="undefined"){if(typeof c.str!="undefined"){this.setByString(c.str)}}};YAHOO.lang.extend(Ext.asn1.x509.AttributeTypeAndValue,Ext.asn1.ASN1Object);Ext.asn1.x509.SubjectPublicKeyInfo=function(j){Ext.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var c=null;var d=null;var b=null;this.setRSAKey=function(e){if(!RSAKey.prototype.isPrototypeOf(e)){throw"argument is not RSAKey instance"}this.rsaKey=e;var g=new Ext.asn1.DERInteger({bigint:e.n});var f=new Ext.asn1.DERInteger({"int":e.e});var l=new Ext.asn1.DERSequence({array:[g,f]});var i=l.getEncodedHex();this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+i})};this.setRSAPEM=function(w){if(w.match(/-----BEGIN PUBLIC KEY-----/)){var m=w;m=m.replace(/^-----[^-]+-----/,"");m=m.replace(/-----[^-]+-----\s*$/,"");var l=m.replace(/\s+/g,"");var v=CryptoJS.enc.Base64.parse(l);var f=CryptoJS.enc.Hex.stringify(v);var i=RSAKey.getHexValueArrayOfChildrenFromHex(f);var e=i[1];var k=e.substr(2);var n=RSAKey.getHexValueArrayOfChildrenFromHex(k);var g=new RSAKey();g.setPublic(n[0],n[1]);this.setRSAKey(g)}else{throw"key not supported"}};this.getASN1Object=function(){if(this.asn1AlgId==null||this.asn1SubjPKey==null){throw"algId and/or subjPubKey not set"}var e=new Ext.asn1.DERSequence({array:[this.asn1AlgId,this.asn1SubjPKey]});return e};this.getEncodedHex=function(){var e=this.getASN1Object();this.hTLV=e.getEncodedHex();return this.hTLV};this._setRSAKey=function(g){var f=Ext.asn1.ASN1Util.newObject({seq:[{"int":{bigint:g.n}},{"int":{"int":g.e}}]});var e=f.getEncodedHex();this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+e})};this._setEC=function(f){var e=new Ext.asn1.DERObjectIdentifier({name:f.curveName});this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"ecPublicKey",asn1params:e});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+f.pubKeyHex})};this._setDSA=function(g){var e=new Ext.asn1.ASN1Util.newObject({seq:[{"int":{bigint:g.p}},{"int":{bigint:g.q}},{"int":{bigint:g.g}}]});this.asn1AlgId=new Ext.asn1.x509.AlgorithmIdentifier({name:"dsa",asn1params:e});var f=new Ext.asn1.DERInteger({bigint:g.y});this.asn1SubjPKey=new Ext.asn1.DERBitString({hex:"00"+f.getEncodedHex()})};if(typeof j!="undefined"){if(typeof RSAKey!="undefined"&&j instanceof RSAKey){this._setRSAKey(j)}else{if(typeof Ext.crypto.ECDSA!="undefined"&&j instanceof Ext.crypto.ECDSA){this._setEC(j)}else{if(typeof Ext.crypto.DSA!="undefined"&&j instanceof Ext.crypto.DSA){this._setDSA(j)}else{if(typeof j.rsakey!="undefined"){this.setRSAKey(j.rsakey)}else{if(typeof j.rsapem!="undefined"){this.setRSAPEM(j.rsapem)}}}}}}};YAHOO.lang.extend(Ext.asn1.x509.SubjectPublicKeyInfo,Ext.asn1.ASN1Object);Ext.asn1.x509.Time=function(g){Ext.asn1.x509.Time.superclass.constructor.call(this);var c=null;var b=null;this.setTimeParams=function(d){this.timeParams=d};this.getEncodedHex=function(){var d=null;if(this.timeParams!=null){if(this.type=="utc"){d=new Ext.asn1.DERUTCTime(this.timeParams)}else{d=new Ext.asn1.DERGeneralizedTime(this.timeParams)}}else{if(this.type=="utc"){d=new Ext.asn1.DERUTCTime()}else{d=new Ext.asn1.DERGeneralizedTime()}}this.TLV=d.getEncodedHex();return this.TLV};this.type="utc";if(typeof g!="undefined"){if(typeof g.type!="undefined"){this.type=g.type}else{if(typeof g.str!="undefined"){if(g.str.match(/^[0-9]{12}Z$/)){this.type="utc"}if(g.str.match(/^[0-9]{14}Z$/)){this.type="gen"}}}this.timeParams=g}};YAHOO.lang.extend(Ext.asn1.x509.Time,Ext.asn1.ASN1Object);Ext.asn1.x509.AlgorithmIdentifier=function(e){Ext.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this);var l=null;var d=null;var b=null;var c=false;this.getEncodedHex=function(){if(this.nameAlg==null&&this.asn1Alg==null){throw"algorithm not specified"}if(this.nameAlg!=null&&this.asn1Alg==null){this.asn1Alg=Ext.asn1.x509.OID.name2obj(this.nameAlg)}var g=[this.asn1Alg];if(!this.paramEmpty){g.push(this.asn1Params)}var f=new Ext.asn1.DERSequence({array:g});this.hTLV=f.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.name!="undefined"){this.nameAlg=e.name}if(typeof e.asn1params!="undefined"){this.asn1Params=e.asn1params}if(typeof e.paramempty!="undefined"){this.paramEmpty=e.paramempty}}if(this.asn1Params==null){this.asn1Params=new Ext.asn1.DERNull()}};YAHOO.lang.extend(Ext.asn1.x509.AlgorithmIdentifier,Ext.asn1.ASN1Object);Ext.asn1.x509.GeneralName=function(j){Ext.asn1.x509.GeneralName.superclass.constructor.call(this);var d=null;var c=null;var b={rfc822:"81",dns:"82",dn:"a4",uri:"86"};this.explicit=false;this.setByParam=function(i){var f=null;var p=null;if(i===undefined){return}if(i.rfc822!==undefined){this.type="rfc822";p=new Ext.asn1.DERIA5String({str:i[this.type]})}if(i.dns!==undefined){this.type="dns";p=new Ext.asn1.DERIA5String({str:i[this.type]})}if(i.uri!==undefined){this.type="uri";p=new Ext.asn1.DERIA5String({str:i[this.type]})}if(i.dn!==undefined){this.type="dn";p=new Ext.asn1.x509.X500Name({str:i.dn})}if(i.ldapdn!==undefined){this.type="dn";p=new Ext.asn1.x509.X500Name({ldapstr:i.ldapdn})}if(i.certissuer!==undefined){this.type="dn";this.explicit=true;var k=i.certissuer;var g=null;if(k.match(/^[0-9A-Fa-f]+$/)){g==k}if(k.indexOf("-----BEGIN ")!=-1){g=ASN1HEX.pemToHex(k)}if(g==null){throw"certissuer param not cert"}var e=new X509();e.hex=g;var o=e.getIssuerHex();p=new Ext.asn1.ASN1Object();p.hTLV=o}if(i.certsubj!==undefined){this.type="dn";this.explicit=true;var k=i.certsubj;var g=null;if(k.match(/^[0-9A-Fa-f]+$/)){g==k}if(k.indexOf("-----BEGIN ")!=-1){g=ASN1HEX.pemToHex(k)}if(g==null){throw"certsubj param not cert"}var e=new X509();e.hex=g;var o=e.getSubjectHex();p=new Ext.asn1.ASN1Object();p.hTLV=o}if(this.type==null){throw"unsupported type in params="+i}this.asn1Obj=new Ext.asn1.DERTaggedObject({explicit:this.explicit,tag:b[this.type],obj:p})};this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()};if(j!==undefined){this.setByParam(j)}};YAHOO.lang.extend(Ext.asn1.x509.GeneralName,Ext.asn1.ASN1Object);Ext.asn1.x509.GeneralNames=function(e){Ext.asn1.x509.GeneralNames.superclass.constructor.call(this);var b=null;this.setByParamArray=function(d){for(var g=0;g<d.length;g++){var c=new Ext.asn1.x509.GeneralName(d[g]);this.asn1Array.push(c)}};this.getEncodedHex=function(){var c=new Ext.asn1.DERSequence({array:this.asn1Array});return c.getEncodedHex()};this.asn1Array=new Array();if(typeof e!="undefined"){this.setByParamArray(e)}};YAHOO.lang.extend(Ext.asn1.x509.GeneralNames,Ext.asn1.ASN1Object);Ext.asn1.x509.DistributionPointName=function(b){Ext.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=null;var c=null;var l=null;var d=null;this.getEncodedHex=function(){if(this.type!="full"){throw"currently type shall be 'full': "+this.type}this.asn1Obj=new Ext.asn1.DERTaggedObject({explicit:false,tag:this.tag,obj:this.asn1V});this.hTLV=this.asn1Obj.getEncodedHex();return this.hTLV};if(typeof b!="undefined"){if(Ext.asn1.x509.GeneralNames.prototype.isPrototypeOf(b)){this.type="full";this.tag="a0";this.asn1V=b}else{throw"This class supports GeneralNames only as argument"}}};YAHOO.lang.extend(Ext.asn1.x509.DistributionPointName,Ext.asn1.ASN1Object);Ext.asn1.x509.DistributionPoint=function(e){Ext.asn1.x509.DistributionPoint.superclass.constructor.call(this);var b=null;this.getEncodedHex=function(){var d=new Ext.asn1.DERSequence();if(this.asn1DP!=null){var c=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:this.asn1DP});d.appendASN1Object(c)}this.hTLV=d.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.dpobj!="undefined"){this.asn1DP=e.dpobj}}};YAHOO.lang.extend(Ext.asn1.x509.DistributionPoint,Ext.asn1.ASN1Object);Ext.asn1.x509.OID=new function(c){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"};this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",countryName:"2.5.4.6",streetAddress:"2.5.4.9",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14",};this.objCache={};this.name2obj=function(d){if(typeof this.objCache[d]!="undefined"){return this.objCache[d]}if(typeof this.name2oidList[d]=="undefined"){throw"Name of ObjectIdentifier not defined: "+d}var g=this.name2oidList[d];var b=new Ext.asn1.DERObjectIdentifier({oid:g});this.objCache[d]=b;return b};this.atype2obj=function(d){if(typeof this.objCache[d]!="undefined"){return this.objCache[d]}if(typeof this.atype2oidList[d]=="undefined"){throw"AttributeType name undefined: "+d}var g=this.atype2oidList[d];var b=new Ext.asn1.DERObjectIdentifier({oid:g});this.objCache[d]=b;return b}};Ext.asn1.x509.OID.oid2name=function(c){var g=Ext.asn1.x509.OID.name2oidList;for(var b in g){if(g[b]==c){return b}}return""};Ext.asn1.x509.OID.oid2atype=function(c){var g=Ext.asn1.x509.OID.atype2oidList;for(var b in g){if(g[b]==c){return b}}return c};Ext.asn1.x509.OID.name2oid=function(b){var e=Ext.asn1.x509.OID.name2oidList;if(e[b]===undefined){return""}return e[b]};Ext.asn1.x509.X509Util=new function(){this.getPKCS8PubKeyPEMfromRSAKey=function(d){var c=null;var B=Ext.asn1.ASN1Util.bigIntToMinTwosComplementsHex(d.n);var e=Ext.asn1.ASN1Util.integerToByteHex(d.e);var i=new Ext.asn1.DERInteger({hex:B});var b=new Ext.asn1.DERInteger({hex:e});var g=new Ext.asn1.DERSequence({array:[i,b]});var k=g.getEncodedHex();var l=new Ext.asn1.x509.AlgorithmIdentifier({name:"rsaEncryption"});var j=new Ext.asn1.DERBitString({hex:"00"+k});var f=new Ext.asn1.DERSequence({array:[l,j]});var A=f.getEncodedHex();var c=Ext.asn1.ASN1Util.getPEMStringFromHex(A,"PUBLIC KEY");return c}};Ext.asn1.x509.X509Util.newCertPEM=function(e){var b=Ext.asn1.x509;var d=new b.TBSCertificate();if(e.serial!==undefined){d.setSerialNumberByParam(e.serial)}else{throw"serial number undefined."}if(typeof e.sigalg.name=="string"){d.setSignatureAlgByParam(e.sigalg)}else{throw"unproper signature algorithm name"}if(e.issuer!==undefined){d.setIssuerByParam(e.issuer)}else{throw"issuer name undefined."}if(e.notbefore!==undefined){d.setNotBeforeByParam(e.notbefore)}else{throw"notbefore undefined."}if(e.notafter!==undefined){d.setNotAfterByParam(e.notafter)}else{throw"notafter undefined."}if(e.subject!==undefined){d.setSubjectByParam(e.subject)}else{throw"subject name undefined."}if(e.sbjpubkey!==undefined){d.setSubjectPublicKeyByGetKey(e.sbjpubkey)}else{throw"subject public key undefined."}if(e.ext!==undefined&&e.ext.length!==undefined){for(var n=0;n<e.ext.length;n++){for(key in e.ext[n]){d.appendExtensionByName(key,e.ext[n][key])}}}if(e.cakey===undefined&&e.sighex===undefined){throw"param cakey and sighex undefined."}var c=null;var f=null;if(e.cakey){c=KEYUTIL.getKey.apply(null,e.cakey);f=new b.Certificate({tbscertobj:d,prvkeyobj:c});f.sign()}if(e.sighex){f=new b.Certificate({tbscertobj:d});f.setSignatureHex(e.sighex)}return f.getPEMString()};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.cms=="undefined"||!Ext.asn1.cms){Ext.asn1.cms={}}Ext.asn1.cms.Attribute=function(e){Ext.asn1.cms.Attribute.superclass.constructor.call(this);var b=[];this.getEncodedHex=function(){var f,d,j;f=new Ext.asn1.DERObjectIdentifier({oid:this.attrTypeOid});d=new Ext.asn1.DERSet({array:this.valueList});try{d.getEncodedHex()}catch(c){throw"fail valueSet.getEncodedHex in Attribute(1)/"+c}j=new Ext.asn1.DERSequence({array:[f,d]});try{this.hTLV=j.getEncodedHex()}catch(c){throw"failed seq.getEncodedHex in Attribute(2)/"+c}return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.Attribute,Ext.asn1.ASN1Object);Ext.asn1.cms.ContentType=function(e){Ext.asn1.cms.ContentType.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.3";var b=null;if(typeof e!="undefined"){var b=new Ext.asn1.DERObjectIdentifier(e);this.valueList=[b]}};YAHOO.lang.extend(Ext.asn1.cms.ContentType,Ext.asn1.cms.Attribute);Ext.asn1.cms.MessageDigest=function(e){Ext.asn1.cms.MessageDigest.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.4";if(typeof e!="undefined"){if(e.eciObj instanceof Ext.asn1.cms.EncapsulatedContentInfo&&typeof e.hashAlg=="string"){var b=e.eciObj.eContentValueHex;var l=e.hashAlg;var c=Ext.crypto.Util.hashHex(b,l);var d=new Ext.asn1.DEROctetString({hex:c});d.getEncodedHex();this.valueList=[d]}else{var d=new Ext.asn1.DEROctetString(e);d.getEncodedHex();this.valueList=[d]}}};YAHOO.lang.extend(Ext.asn1.cms.MessageDigest,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningTime=function(g){Ext.asn1.cms.SigningTime.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.5";if(typeof g!="undefined"){var b=new Ext.asn1.x509.Time(g);try{b.getEncodedHex()}catch(c){throw"SigningTime.getEncodedHex() failed/"+c}this.valueList=[b]}};YAHOO.lang.extend(Ext.asn1.cms.SigningTime,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningCertificate=function(j){Ext.asn1.cms.SigningCertificate.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.12";var b=Ext.asn1;var d=Ext.asn1.cms;var c=Ext.crypto;this.setCerts=function(k){var g=[];for(var f=0;f<k.length;f++){var u=ASN1HEX.pemToHex(k[f]);var n=c.Util.hashHex(u,"sha1");var l=new b.DEROctetString({hex:n});l.getEncodedHex();var i=new d.IssuerAndSerialNumber({cert:k[f]});i.getEncodedHex();var m=new b.DERSequence({array:[l,i]});m.getEncodedHex();g.push(m)}var e=new b.DERSequence({array:g});e.getEncodedHex();this.valueList=[e]};if(typeof j!="undefined"){if(typeof j.array=="object"){this.setCerts(j.array)}}};YAHOO.lang.extend(Ext.asn1.cms.SigningCertificate,Ext.asn1.cms.Attribute);Ext.asn1.cms.SigningCertificateV2=function(d){Ext.asn1.cms.SigningCertificateV2.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.47";var n=Ext.asn1;var e=Ext.asn1.x509;var b=Ext.asn1.cms;var c=Ext.crypto;this.setCerts=function(q,i){var o=[];for(var m=0;m<q.length;m++){var k=ASN1HEX.pemToHex(q[m]);var g=[];if(i!="sha256"){g.push(new e.AlgorithmIdentifier({name:i}))}var y=c.Util.hashHex(k,i);var r=new n.DEROctetString({hex:y});r.getEncodedHex();g.push(r);var j=new b.IssuerAndSerialNumber({cert:q[m]});j.getEncodedHex();g.push(j);var p=new n.DERSequence({array:g});p.getEncodedHex();o.push(p)}var l=new n.DERSequence({array:o});l.getEncodedHex();this.valueList=[l]};if(typeof d!="undefined"){if(typeof d.array=="object"){var f="sha256";if(typeof d.hashAlg=="string"){f=d.hashAlg}this.setCerts(d.array,f)}}};YAHOO.lang.extend(Ext.asn1.cms.SigningCertificateV2,Ext.asn1.cms.Attribute);Ext.asn1.cms.IssuerAndSerialNumber=function(c){Ext.asn1.cms.IssuerAndSerialNumber.superclass.constructor.call(this);var e=null;var b=null;var l=Ext.asn1;var d=l.x509;this.setByCertPEM=function(j){var g=ASN1HEX.pemToHex(j);var f=new X509();f.hex=g;var k=f.getIssuerHex();this.dIssuer=new d.X500Name();this.dIssuer.hTLV=k;var i=f.getSerialNumberHex();this.dSerial=new l.DERInteger({hex:i})};this.getEncodedHex=function(){var f=new Ext.asn1.DERSequence({array:[this.dIssuer,this.dSerial]});this.hTLV=f.getEncodedHex();return this.hTLV};if(typeof c!="undefined"){if(typeof c=="string"&&c.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(c)}if(c.issuer&&c.serial){if(c.issuer instanceof Ext.asn1.x509.X500Name){this.dIssuer=c.issuer}else{this.dIssuer=new Ext.asn1.x509.X500Name(c.issuer)}if(c.serial instanceof Ext.asn1.DERInteger){this.dSerial=c.serial}else{this.dSerial=new Ext.asn1.DERInteger(c.serial)}}if(typeof c.cert=="string"){this.setByCertPEM(c.cert)}}};YAHOO.lang.extend(Ext.asn1.cms.IssuerAndSerialNumber,Ext.asn1.ASN1Object);Ext.asn1.cms.AttributeList=function(c){Ext.asn1.cms.AttributeList.superclass.constructor.call(this);this.list=new Array();this.sortFlag=true;this.add=function(b){if(b instanceof Ext.asn1.cms.Attribute){this.list.push(b)}};this.length=function(){return this.list.length};this.clear=function(){this.list=new Array();this.hTLV=null;this.hV=null};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var b=new Ext.asn1.DERSet({array:this.list,sortflag:this.sortFlag});this.hTLV=b.getEncodedHex();return this.hTLV};if(typeof c!="undefined"){if(typeof c.sortflag!="undefined"&&c.sortflag==false){this.sortFlag=false}}};YAHOO.lang.extend(Ext.asn1.cms.AttributeList,Ext.asn1.ASN1Object);Ext.asn1.cms.SignerInfo=function(d){Ext.asn1.cms.SignerInfo.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.cms;var j=Ext.asn1.x509;this.dCMSVersion=new b.DERInteger({"int":1});this.dSignerIdentifier=null;this.dDigestAlgorithm=null;this.dSignedAttrs=new c.AttributeList();this.dSigAlg=null;this.dSig=null;this.dUnsignedAttrs=new c.AttributeList();this.setSignerIdentifier=function(e){if(typeof e=="string"&&e.indexOf("CERTIFICATE")!=-1&&e.indexOf("BEGIN")!=-1&&e.indexOf("END")!=-1){var f=e;this.dSignerIdentifier=new c.IssuerAndSerialNumber({cert:e})}};this.setForContentAndHash=function(e){if(typeof e!="undefined"){if(e.eciObj instanceof Ext.asn1.cms.EncapsulatedContentInfo){this.dSignedAttrs.add(new c.ContentType({oid:"1.2.840.113549.1.7.1"}));this.dSignedAttrs.add(new c.MessageDigest({eciObj:e.eciObj,hashAlg:e.hashAlg}))}if(typeof e.sdObj!="undefined"&&e.sdObj instanceof Ext.asn1.cms.SignedData){if(e.sdObj.digestAlgNameList.join(":").indexOf(e.hashAlg)==-1){e.sdObj.digestAlgNameList.push(e.hashAlg)}}if(typeof e.hashAlg=="string"){this.dDigestAlgorithm=new j.AlgorithmIdentifier({name:e.hashAlg})}}};this.sign=function(m,n){this.dSigAlg=new j.AlgorithmIdentifier({name:n});var e=this.dSignedAttrs.getEncodedHex();var i=KEYUTIL.getKey(m);var g=new Ext.crypto.Signature({alg:n});g.init(i);g.updateHex(e);var f=g.sign();this.dSig=new b.DEROctetString({hex:f})};this.addUnsigned=function(e){this.hTLV=null;this.dUnsignedAttrs.hTLV=null;this.dUnsignedAttrs.add(e)};this.getEncodedHex=function(){if(this.dSignedAttrs instanceof Ext.asn1.cms.AttributeList&&this.dSignedAttrs.length()==0){throw"SignedAttrs length = 0 (empty)"}var i=new b.DERTaggedObject({obj:this.dSignedAttrs,tag:"a0",explicit:false});var g=null;if(this.dUnsignedAttrs.length()>0){g=new b.DERTaggedObject({obj:this.dUnsignedAttrs,tag:"a1",explicit:false})}var f=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,i,this.dSigAlg,this.dSig,];if(g!=null){f.push(g)}var e=new b.DERSequence({array:f});this.hTLV=e.getEncodedHex();return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.SignerInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.EncapsulatedContentInfo=function(d){Ext.asn1.cms.EncapsulatedContentInfo.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.cms;var j=Ext.asn1.x509;this.dEContentType=new b.DERObjectIdentifier({name:"data"});this.dEContent=null;this.isDetached=false;this.eContentValueHex=null;this.setContentType=function(e){if(e.match(/^[0-2][.][0-9.]+$/)){this.dEContentType=new b.DERObjectIdentifier({oid:e})}else{this.dEContentType=new b.DERObjectIdentifier({name:e})}};this.setContentValue=function(e){if(typeof e!="undefined"){if(typeof e.hex=="string"){this.eContentValueHex=e.hex}else{if(typeof e.str=="string"){this.eContentValueHex=utf8tohex(e.str)}}}};this.setContentValueHex=function(e){this.eContentValueHex=e};this.setContentValueStr=function(e){this.eContentValueHex=utf8tohex(e)};this.getEncodedHex=function(){if(typeof this.eContentValueHex!="string"){throw"eContentValue not yet set"}var f=new b.DEROctetString({hex:this.eContentValueHex});this.dEContent=new b.DERTaggedObject({obj:f,tag:"a0",explicit:true});var g=[this.dEContentType];if(!this.isDetached){g.push(this.dEContent)}var e=new b.DERSequence({array:g});this.hTLV=e.getEncodedHex();return this.hTLV}};YAHOO.lang.extend(Ext.asn1.cms.EncapsulatedContentInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.ContentInfo=function(d){Ext.asn1.cms.ContentInfo.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.cms;var j=Ext.asn1.x509;this.dContentType=null;this.dContent=null;this.setContentType=function(e){if(typeof e=="string"){this.dContentType=j.OID.name2obj(e)}};this.getEncodedHex=function(){var e=new b.DERTaggedObject({obj:this.dContent,tag:"a0",explicit:true});var f=new b.DERSequence({array:[this.dContentType,e]});this.hTLV=f.getEncodedHex();return this.hTLV};if(typeof d!="undefined"){if(d.type){this.setContentType(d.type)}if(d.obj&&d.obj instanceof b.ASN1Object){this.dContent=d.obj}}};YAHOO.lang.extend(Ext.asn1.cms.ContentInfo,Ext.asn1.ASN1Object);Ext.asn1.cms.SignedData=function(d){Ext.asn1.cms.SignedData.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.cms;var j=Ext.asn1.x509;this.dCMSVersion=new b.DERInteger({"int":1});this.dDigestAlgs=null;this.digestAlgNameList=[];this.dEncapContentInfo=new c.EncapsulatedContentInfo();this.dCerts=null;this.certificateList=[];this.crlList=[];this.signerInfoList=[new c.SignerInfo()];this.addCertificatesByPEM=function(g){var e=ASN1HEX.pemToHex(g);var f=new b.ASN1Object();f.hTLV=e;this.certificateList.push(f)};this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}if(this.dDigestAlgs==null){var l=[];for(var r=0;r<this.digestAlgNameList.length;r++){var m=this.digestAlgNameList[r];var g=new j.AlgorithmIdentifier({name:m});l.push(g)}this.dDigestAlgs=new b.DERSet({array:l})}var f=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(this.dCerts==null){if(this.certificateList.length>0){var e=new b.DERSet({array:this.certificateList});this.dCerts=new b.DERTaggedObject({obj:e,tag:"a0",explicit:false})}}if(this.dCerts!=null){f.push(this.dCerts)}var i=new b.DERSet({array:this.signerInfoList});f.push(i);var k=new b.DERSequence({array:f});this.hTLV=k.getEncodedHex();return this.hTLV};this.getContentInfo=function(){this.getEncodedHex();var e=new c.ContentInfo({type:"signed-data",obj:this});return e};this.getContentInfoEncodedHex=function(){var f=this.getContentInfo();var e=f.getEncodedHex();return e};this.getPEM=function(){var f=this.getContentInfoEncodedHex();var e=b.ASN1Util.getPEMStringFromHex(f,"CMS");return e}};YAHOO.lang.extend(Ext.asn1.cms.SignedData,Ext.asn1.ASN1Object);Ext.asn1.cms.CMSUtil=new function(){};Ext.asn1.cms.CMSUtil.newSignedData=function(g){var e=Ext.asn1.cms;var d=Ext.asn1.cades;var c=new e.SignedData();c.dEncapContentInfo.setContentValue(g.content);if(typeof g.certs=="object"){for(var j=0;j<g.certs.length;j++){c.addCertificatesByPEM(g.certs[j])}}c.signerInfoList=[];for(var j=0;j<g.signerInfos.length;j++){var u=g.signerInfos[j];var s=new e.SignerInfo();s.setSignerIdentifier(u.signerCert);s.setForContentAndHash({sdObj:c,eciObj:c.dEncapContentInfo,hashAlg:u.hashAlg});for(attrName in u.sAttr){var f=u.sAttr[attrName];if(attrName=="SigningTime"){var b=new e.SigningTime(f);s.dSignedAttrs.add(b)}if(attrName=="SigningCertificate"){var b=new e.SigningCertificate(f);s.dSignedAttrs.add(b)}if(attrName=="SigningCertificateV2"){var b=new e.SigningCertificateV2(f);s.dSignedAttrs.add(b)}if(attrName=="SignaturePolicyIdentifier"){var b=new d.SignaturePolicyIdentifier(f);s.dSignedAttrs.add(b)}}s.sign(u.signerPrvKey,u.sigAlg);c.signerInfoList.push(s)}return c};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.tsp=="undefined"||!Ext.asn1.tsp){Ext.asn1.tsp={}}Ext.asn1.tsp.Accuracy=function(e){Ext.asn1.tsp.Accuracy.superclass.constructor.call(this);var b=Ext.asn1;this.seconds=null;this.millis=null;this.micros=null;this.getEncodedHex=function(){var d=null;var c=null;var f=null;var p=[];if(this.seconds!=null){d=new b.DERInteger({"int":this.seconds});p.push(d)}if(this.millis!=null){var o=new b.DERInteger({"int":this.millis});c=new b.DERTaggedObject({obj:o,tag:"80",explicit:false});p.push(c)}if(this.micros!=null){var i=new b.DERInteger({"int":this.micros});f=new b.DERTaggedObject({obj:i,tag:"81",explicit:false});p.push(f)}var g=new b.DERSequence({array:p});this.hTLV=g.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.seconds=="number"){this.seconds=e.seconds}if(typeof e.millis=="number"){this.millis=e.millis}if(typeof e.micros=="number"){this.micros=e.micros}}};YAHOO.lang.extend(Ext.asn1.tsp.Accuracy,Ext.asn1.ASN1Object);Ext.asn1.tsp.MessageImprint=function(c){Ext.asn1.tsp.MessageImprint.superclass.constructor.call(this);var b=Ext.asn1;var g=Ext.asn1.x509;this.dHashAlg=null;this.dHashValue=null;this.getEncodedHex=function(){if(typeof this.hTLV=="string"){return this.hTLV}var d=new b.DERSequence({array:[this.dHashAlg,this.dHashValue]});return d.getEncodedHex()};if(typeof c!="undefined"){if(typeof c.hashAlg=="string"){this.dHashAlg=new g.AlgorithmIdentifier({name:c.hashAlg})}if(typeof c.hashValue=="string"){this.dHashValue=new b.DEROctetString({hex:c.hashValue})}}};YAHOO.lang.extend(Ext.asn1.tsp.MessageImprint,Ext.asn1.ASN1Object);Ext.asn1.tsp.TimeStampReq=function(g){Ext.asn1.tsp.TimeStampReq.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.tsp;this.dVersion=new b.DERInteger({"int":1});this.dMessageImprint=null;this.dPolicy=null;this.dNonce=null;this.certReq=true;this.setMessageImprint=function(d){if(d instanceof Ext.asn1.tsp.MessageImprint){this.dMessageImprint=d;return}if(typeof d=="object"){this.dMessageImprint=new c.MessageImprint(d)}};this.getEncodedHex=function(){if(this.dMessageImprint==null){throw"messageImprint shall be specified"}var e=[this.dVersion,this.dMessageImprint];if(this.dPolicy!=null){e.push(this.dPolicy)}if(this.dNonce!=null){e.push(this.dNonce)}if(this.certReq){e.push(new b.DERBoolean())}var d=new b.DERSequence({array:e});this.hTLV=d.getEncodedHex();return this.hTLV};if(typeof g!="undefined"){if(typeof g.mi=="object"){this.setMessageImprint(g.mi)}if(typeof g.policy=="object"){this.dPolicy=new b.DERObjectIdentifier(g.policy)}if(typeof g.nonce=="object"){this.dNonce=new b.DERInteger(g.nonce)}if(typeof g.certreq=="boolean"){this.certReq=g.certreq}}};YAHOO.lang.extend(Ext.asn1.tsp.TimeStampReq,Ext.asn1.ASN1Object);Ext.asn1.tsp.TSTInfo=function(d){Ext.asn1.tsp.TSTInfo.superclass.constructor.call(this);var b=Ext.asn1;var j=Ext.asn1.x509;var c=Ext.asn1.tsp;this.dVersion=new b.DERInteger({"int":1});this.dPolicy=null;this.dMessageImprint=null;this.dSerialNumber=null;this.dGenTime=null;this.dAccuracy=null;this.dOrdering=null;this.dNonce=null;this.dTsa=null;this.getEncodedHex=function(){var f=[this.dVersion];if(this.dPolicy==null){throw"policy shall be specified."}f.push(this.dPolicy);if(this.dMessageImprint==null){throw"messageImprint shall be specified."}f.push(this.dMessageImprint);if(this.dSerialNumber==null){throw"serialNumber shall be specified."}f.push(this.dSerialNumber);if(this.dGenTime==null){throw"genTime shall be specified."}f.push(this.dGenTime);if(this.dAccuracy!=null){f.push(this.dAccuracy)}if(this.dOrdering!=null){f.push(this.dOrdering)}if(this.dNonce!=null){f.push(this.dNonce)}if(this.dTsa!=null){f.push(this.dTsa)}var e=new b.DERSequence({array:f});this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof d!="undefined"){if(typeof d.policy=="string"){if(!d.policy.match(/^[0-9.]+$/)){throw"policy shall be oid like 0.1.4.134"}this.dPolicy=new b.DERObjectIdentifier({oid:d.policy})}if(typeof d.messageImprint!="undefined"){this.dMessageImprint=new c.MessageImprint(d.messageImprint)}if(typeof d.serialNumber!="undefined"){this.dSerialNumber=new b.DERInteger(d.serialNumber)}if(typeof d.genTime!="undefined"){this.dGenTime=new b.DERGeneralizedTime(d.genTime)}if(typeof d.accuracy!="undefind"){this.dAccuracy=new c.Accuracy(d.accuracy)}if(typeof d.ordering!="undefined"&&d.ordering==true){this.dOrdering=new b.DERBoolean()}if(typeof d.nonce!="undefined"){this.dNonce=new b.DERInteger(d.nonce)}if(typeof d.tsa!="undefined"){this.dTsa=new j.X500Name(d.tsa)}}};YAHOO.lang.extend(Ext.asn1.tsp.TSTInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.TimeStampResp=function(g){Ext.asn1.tsp.TimeStampResp.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.tsp;this.dStatus=null;this.dTST=null;this.getEncodedHex=function(){if(this.dStatus==null){throw"status shall be specified"}var e=[this.dStatus];if(this.dTST!=null){e.push(this.dTST)}var d=new b.DERSequence({array:e});this.hTLV=d.getEncodedHex();return this.hTLV};if(typeof g!="undefined"){if(typeof g.status=="object"){this.dStatus=new c.PKIStatusInfo(g.status)}if(typeof g.tst!="undefined"&&g.tst instanceof Ext.asn1.ASN1Object){this.dTST=g.tst.getContentInfo()}}};YAHOO.lang.extend(Ext.asn1.tsp.TimeStampResp,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatusInfo=function(g){Ext.asn1.tsp.PKIStatusInfo.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.tsp;this.dStatus=null;this.dStatusString=null;this.dFailureInfo=null;this.getEncodedHex=function(){if(this.dStatus==null){throw"status shall be specified"}var e=[this.dStatus];if(this.dStatusString!=null){e.push(this.dStatusString)}if(this.dFailureInfo!=null){e.push(this.dFailureInfo)}var d=new b.DERSequence({array:e});this.hTLV=d.getEncodedHex();return this.hTLV};if(typeof g!="undefined"){if(typeof g.status=="object"){this.dStatus=new c.PKIStatus(g.status)}if(typeof g.statstr=="object"){this.dStatusString=new c.PKIFreeText({array:g.statstr})}if(typeof g.failinfo=="object"){this.dFailureInfo=new c.PKIFailureInfo(g.failinfo)}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIStatusInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatus=function(e){Ext.asn1.tsp.PKIStatus.superclass.constructor.call(this);var l=Ext.asn1;var b=Ext.asn1.tsp;var d=null;this.getEncodedHex=function(){this.hTLV=this.dStatus.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.name!="undefined"){var c=b.PKIStatus.valueList;if(typeof c[e.name]=="undefined"){throw"name undefined: "+e.name}this.dStatus=new l.DERInteger({"int":c[e.name]})}else{this.dStatus=new l.DERInteger(e)}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIStatus,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5};Ext.asn1.tsp.PKIFreeText=function(e){Ext.asn1.tsp.PKIFreeText.superclass.constructor.call(this);var b=Ext.asn1;this.textList=[];this.getEncodedHex=function(){var g=[];for(var d=0;d<this.textList.length;d++){g.push(new b.DERUTF8String({str:this.textList[d]}))}var c=new b.DERSequence({array:g});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof e!="undefined"){if(typeof e.array=="object"){this.textList=e.array}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIFreeText,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIFailureInfo=function(j){Ext.asn1.tsp.PKIFailureInfo.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.tsp;this.value=null;this.getEncodedHex=function(){if(this.value==null){throw"value shall be specified"}var f=new Number(this.value).toString(2);var e=new b.DERBitString();e.setByBinaryString(f);this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof j!="undefined"){if(typeof j.name=="string"){var d=c.PKIFailureInfo.valueList;if(typeof d[j.name]=="undefined"){throw"name undefined: "+j.name}this.value=d[j.name]}else{if(typeof j["int"]=="number"){this.value=j["int"]}}}};YAHOO.lang.extend(Ext.asn1.tsp.PKIFailureInfo,Ext.asn1.ASN1Object);Ext.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25};Ext.asn1.tsp.AbstractTSAAdapter=function(c){this.getTSTHex=function(b,e){throw"not implemented yet"}};Ext.asn1.tsp.SimpleTSAAdapter=function(c){Ext.asn1.tsp.SimpleTSAAdapter.superclass.constructor.call(this);this.params=null;this.serial=0;this.getTSTHex=function(b,d){var f=Ext.crypto.Util.hashHex(b,d);this.params.tstInfo.messageImprint={hashAlg:d,hashValue:f};this.params.tstInfo.serialNumber={"int":this.serial++};var e=Math.floor(Math.random()*1000000000);this.params.tstInfo.nonce={"int":e};var l=Ext.asn1.tsp.TSPUtil.newTimeStampToken(this.params);return l.getContentInfoEncodedHex()};if(typeof c!="undefined"){this.params=c}};YAHOO.lang.extend(Ext.asn1.tsp.SimpleTSAAdapter,Ext.asn1.tsp.AbstractTSAAdapter);Ext.asn1.tsp.FixedTSAAdapter=function(c){Ext.asn1.tsp.FixedTSAAdapter.superclass.constructor.call(this);this.params=null;this.getTSTHex=function(e,d){var j=Ext.crypto.Util.hashHex(e,d);this.params.tstInfo.messageImprint={hashAlg:d,hashValue:j};var b=Ext.asn1.tsp.TSPUtil.newTimeStampToken(this.params);return b.getContentInfoEncodedHex()};if(typeof c!="undefined"){this.params=c}};YAHOO.lang.extend(Ext.asn1.tsp.FixedTSAAdapter,Ext.asn1.tsp.AbstractTSAAdapter);Ext.asn1.tsp.TSPUtil=new function(){};Ext.asn1.tsp.TSPUtil.newTimeStampToken=function(j){var f=Ext.asn1.cms;var g=Ext.asn1.tsp;var d=new f.SignedData();var b=new g.TSTInfo(j.tstInfo);var c=b.getEncodedHex();d.dEncapContentInfo.setContentValue({hex:c});d.dEncapContentInfo.setContentType("tstinfo");if(typeof j.certs=="object"){for(var s=0;s<j.certs.length;s++){d.addCertificatesByPEM(j.certs[s])}}var u=d.signerInfoList[0];u.setSignerIdentifier(j.signerCert);u.setForContentAndHash({sdObj:d,eciObj:d.dEncapContentInfo,hashAlg:j.hashAlg});var e=new f.SigningCertificate({array:[j.signerCert]});u.dSignedAttrs.add(e);u.sign(j.signerPrvKey,j.sigAlg);return d};Ext.asn1.tsp.TSPUtil.parseTimeStampReq=function(f){var b={};b.certreq=false;var c=ASN1HEX.getPosArrayOfChildren_AtObj(f,0);if(c.length<2){throw"TimeStampReq must have at least 2 items"}var q=ASN1HEX.getHexOfTLV_AtObj(f,c[1]);b.mi=Ext.asn1.tsp.TSPUtil.parseMessageImprint(q);for(var g=2;g<c.length;g++){var r=c[g];var d=f.substr(r,2);if(d=="06"){var e=ASN1HEX.getHexOfV_AtObj(f,r);b.policy=ASN1HEX.hextooidstr(e)}if(d=="02"){b.nonce=ASN1HEX.getHexOfV_AtObj(f,r)}if(d=="01"){b.certreq=true}}return b};Ext.asn1.tsp.TSPUtil.parseMessageImprint=function(s){var e={};if(s.substr(0,2)!="30"){throw"head of messageImprint hex shall be '30'"}var g=ASN1HEX.getPosArrayOfChildren_AtObj(s,0);var f=ASN1HEX.getDecendantIndexByNthList(s,0,[0,0]);var u=ASN1HEX.getHexOfV_AtObj(s,f);var b=ASN1HEX.hextooidstr(u);var d=Ext.asn1.x509.OID.oid2name(b);if(d==""){throw"hashAlg name undefined: "+b}var i=d;var c=ASN1HEX.getDecendantIndexByNthList(s,0,[1]);e.hashAlg=i;e.hashValue=ASN1HEX.getHexOfV_AtObj(s,c);return e};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.cades=="undefined"||!Ext.asn1.cades){Ext.asn1.cades={}}Ext.asn1.cades.SignaturePolicyIdentifier=function(d){Ext.asn1.cades.SignaturePolicyIdentifier.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.15";var n=Ext.asn1;var b=Ext.asn1.cades;if(typeof d!="undefined"){if(typeof d.oid=="string"&&typeof d.hash=="object"){var e=new n.DERObjectIdentifier({oid:d.oid});var f=new b.OtherHashAlgAndValue(d.hash);var c=new n.DERSequence({array:[e,f]});this.valueList=[c]}}};YAHOO.lang.extend(Ext.asn1.cades.SignaturePolicyIdentifier,Ext.asn1.cms.Attribute);Ext.asn1.cades.OtherHashAlgAndValue=function(c){Ext.asn1.cades.OtherHashAlgAndValue.superclass.constructor.call(this);var b=Ext.asn1;var g=Ext.asn1.x509;this.dAlg=null;this.dHash=null;this.getEncodedHex=function(){var d=new b.DERSequence({array:[this.dAlg,this.dHash]});this.hTLV=d.getEncodedHex();return this.hTLV};if(typeof c!="undefined"){if(typeof c.alg=="string"&&typeof c.hash=="string"){this.dAlg=new g.AlgorithmIdentifier({name:c.alg});this.dHash=new b.DEROctetString({hex:c.hash})}}};YAHOO.lang.extend(Ext.asn1.cades.OtherHashAlgAndValue,Ext.asn1.ASN1Object);Ext.asn1.cades.SignatureTimeStamp=function(g){Ext.asn1.cades.SignatureTimeStamp.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.14";this.tstHex=null;var b=Ext.asn1;if(typeof g!="undefined"){if(typeof g.res!="undefined"){if(typeof g.res=="string"&&g.res.match(/^[0-9A-Fa-f]+$/)){}else{if(g.res instanceof Ext.asn1.ASN1Object){}else{throw"res param shall be ASN1Object or hex string"}}}if(typeof g.tst!="undefined"){if(typeof g.tst=="string"&&g.tst.match(/^[0-9A-Fa-f]+$/)){var c=new b.ASN1Object();this.tstHex=g.tst;c.hTLV=this.tstHex;c.getEncodedHex();this.valueList=[c]}else{if(g.tst instanceof Ext.asn1.ASN1Object){}else{throw"tst param shall be ASN1Object or hex string"}}}}};YAHOO.lang.extend(Ext.asn1.cades.SignatureTimeStamp,Ext.asn1.cms.Attribute);Ext.asn1.cades.CompleteCertificateRefs=function(g){Ext.asn1.cades.CompleteCertificateRefs.superclass.constructor.call(this);this.attrTypeOid="1.2.840.113549.1.9.16.2.21";var b=Ext.asn1;var c=Ext.asn1.cades;this.setByArray=function(f){this.valueList=[];for(var d=0;d<f.length;d++){var e=new c.OtherCertID(f[d]);this.valueList.push(e)}};if(typeof g!="undefined"){if(typeof g=="object"&&typeof g.length=="number"){this.setByArray(g)}}};YAHOO.lang.extend(Ext.asn1.cades.CompleteCertificateRefs,Ext.asn1.cms.Attribute);Ext.asn1.cades.OtherCertID=function(j){Ext.asn1.cades.OtherCertID.superclass.constructor.call(this);var b=Ext.asn1;var d=Ext.asn1.cms;var c=Ext.asn1.cades;this.hasIssuerSerial=true;this.dOtherCertHash=null;this.dIssuerSerial=null;this.setByCertPEM=function(e){this.dOtherCertHash=new c.OtherHash(e);if(this.hasIssuerSerial){this.dIssuerSerial=new d.IssuerAndSerialNumber(e)}};this.getEncodedHex=function(){if(this.hTLV!=null){return this.hTLV}if(this.dOtherCertHash==null){throw"otherCertHash not set"}var f=[this.dOtherCertHash];if(this.dIssuerSerial!=null){f.push(this.dIssuerSerial)}var e=new b.DERSequence({array:f});this.hTLV=e.getEncodedHex();return this.hTLV};if(typeof j!="undefined"){if(typeof j=="string"&&j.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(j)}if(typeof j=="object"){if(j.hasis===false){this.hasIssuerSerial=false}if(typeof j.cert=="string"){this.setByCertPEM(j.cert)}}}};YAHOO.lang.extend(Ext.asn1.cades.OtherCertID,Ext.asn1.ASN1Object);Ext.asn1.cades.OtherHash=function(g){Ext.asn1.cades.OtherHash.superclass.constructor.call(this);var b=Ext.asn1;var c=Ext.asn1.cades;this.alg="sha256";this.dOtherHash=null;this.setByCertPEM=function(f){if(f.indexOf("-----BEGIN ")==-1){throw"certPEM not to seem PEM format"}var d=ASN1HEX.pemToHex(f);var e=Ext.crypto.Util.hashHex(d,this.alg);this.dOtherHash=new c.OtherHashAlgAndValue({alg:this.alg,hash:e})};this.getEncodedHex=function(){if(this.dOtherHash==null){throw"OtherHash not set"}return this.dOtherHash.getEncodedHex()};if(typeof g!="undefined"){if(typeof g=="string"){if(g.indexOf("-----BEGIN ")!=-1){this.setByCertPEM(g)}else{if(g.match(/^[0-9A-Fa-f]+$/)){this.dOtherHash=new b.DEROctetString({hex:g})}else{throw"unsupported string value for params"}}}else{if(typeof g=="object"){if(typeof g.cert=="string"){if(typeof g.alg=="string"){this.alg=g.alg}this.setByCertPEM(g.cert)}else{this.dOtherHash=new c.OtherHashAlgAndValue(g)}}}}};YAHOO.lang.extend(Ext.asn1.cades.OtherHash,Ext.asn1.ASN1Object);Ext.asn1.cades.CAdESUtil=new function(){};Ext.asn1.cades.CAdESUtil.addSigTS=function(g,c,b){};Ext.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(j){var K=Ext.asn1;var f=Ext.asn1.cms;var d=Ext.asn1.cades.CAdESUtil;var k={};if(ASN1HEX.getDecendantHexTLVByNthList(j,0,[0])!="06092a864886f70d010702"){throw"hex is not CMS SignedData"}var l=ASN1HEX.getDecendantIndexByNthList(j,0,[1,0]);var L=ASN1HEX.getPosArrayOfChildren_AtObj(j,l);if(L.length<4){throw"num of SignedData elem shall be 4 at least"}var s=L.shift();k.version=ASN1HEX.getHexOfTLV_AtObj(j,s);var n=L.shift();k.algs=ASN1HEX.getHexOfTLV_AtObj(j,n);var p=L.shift();k.encapcontent=ASN1HEX.getHexOfTLV_AtObj(j,p);k.certs=null;k.revs=null;k.si=[];var c=L.shift();if(j.substr(c,2)=="a0"){k.certs=ASN1HEX.getHexOfTLV_AtObj(j,c);c=L.shift()}if(j.substr(c,2)=="a1"){k.revs=ASN1HEX.getHexOfTLV_AtObj(j,c);c=L.shift()}var e=c;if(j.substr(e,2)!="31"){throw"Can't find signerInfos"}var b=ASN1HEX.getPosArrayOfChildren_AtObj(j,e);for(var m=0;m<b.length;m++){var o=b[m];var g=d.parseSignerInfoForAddingUnsigned(j,o,m);k.si[m]=g}var q=null;k.obj=new f.SignedData();q=new K.ASN1Object();q.hTLV=k.version;k.obj.dCMSVersion=q;q=new K.ASN1Object();q.hTLV=k.algs;k.obj.dDigestAlgs=q;q=new K.ASN1Object();q.hTLV=k.encapcontent;k.obj.dEncapContentInfo=q;q=new K.ASN1Object();q.hTLV=k.certs;k.obj.dCerts=q;k.obj.signerInfoList=[];for(var m=0;m<k.si.length;m++){k.obj.signerInfoList.push(k.si[m].obj)}return k};Ext.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(c,k,E){var b=Ext.asn1;var e=Ext.asn1.cms;var F={};var d=ASN1HEX.getPosArrayOfChildren_AtObj(c,k);if(d.length!=6){throw"not supported items for SignerInfo (!=6)"}var l=d.shift();F.version=ASN1HEX.getHexOfTLV_AtObj(c,l);var n=d.shift();F.si=ASN1HEX.getHexOfTLV_AtObj(c,n);var j=d.shift();F.digalg=ASN1HEX.getHexOfTLV_AtObj(c,j);var i=d.shift();F.sattrs=ASN1HEX.getHexOfTLV_AtObj(c,i);var g=d.shift();F.sigalg=ASN1HEX.getHexOfTLV_AtObj(c,g);var f=d.shift();F.sig=ASN1HEX.getHexOfTLV_AtObj(c,f);F.sigval=ASN1HEX.getHexOfV_AtObj(c,f);var m=null;F.obj=new e.SignerInfo();m=new b.ASN1Object();m.hTLV=F.version;F.obj.dCMSVersion=m;m=new b.ASN1Object();m.hTLV=F.si;F.obj.dSignerIdentifier=m;m=new b.ASN1Object();m.hTLV=F.digalg;F.obj.dDigestAlgorithm=m;m=new b.ASN1Object();m.hTLV=F.sattrs;F.obj.dSignedAttrs=m;m=new b.ASN1Object();m.hTLV=F.sigalg;F.obj.dSigAlg=m;m=new b.ASN1Object();m.hTLV=F.sig;F.obj.dSig=m;F.obj.dUnsignedAttrs=new e.AttributeList();return F};if(typeof Ext.asn1.csr=="undefined"||!Ext.asn1.csr){Ext.asn1.csr={}}Ext.asn1.csr.CertificationRequest=function(e){Ext.asn1.csr.CertificationRequest.superclass.constructor.call(this);var n=null;var b=null;var d=null;var c=null;var f=null;this.sign=function(i,g){if(this.prvKey==null){this.prvKey=g}this.asn1SignatureAlg=new Ext.asn1.x509.AlgorithmIdentifier({name:i});sig=new Ext.crypto.Signature({alg:i});sig.initSign(this.prvKey);sig.updateHex(this.asn1CSRInfo.getEncodedHex());this.hexSig=sig.sign();this.asn1Sig=new Ext.asn1.DERBitString({hex:"00"+this.hexSig});var j=new Ext.asn1.DERSequence({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=j.getEncodedHex();this.isModified=false};this.getPEMString=function(){var g=Ext.asn1.ASN1Util.getPEMStringFromHex(this.getEncodedHex(),"CERTIFICATE REQUEST");return g};this.getEncodedHex=function(){if(this.isModified==false&&this.hTLV!=null){return this.hTLV}throw"not signed yet"};if(typeof e!="undefined"){if(typeof e.csrinfo!="undefined"){this.asn1CSRInfo=e.csrinfo}}};YAHOO.lang.extend(Ext.asn1.csr.CertificationRequest,Ext.asn1.ASN1Object);Ext.asn1.csr.CertificationRequestInfo=function(c){Ext.asn1.csr.CertificationRequestInfo.superclass.constructor.call(this);this._initialize=function(){this.asn1Array=new Array();this.asn1Version=new Ext.asn1.DERInteger({"int":0});this.asn1Subject=null;this.asn1SubjPKey=null;this.extensionsArray=new Array()};this.setSubjectByParam=function(b){this.asn1Subject=new Ext.asn1.x509.X500Name(b)};this.setSubjectPublicKeyByGetKey=function(b){var e=KEYUTIL.getKey(b);this.asn1SubjPKey=new Ext.asn1.x509.SubjectPublicKeyInfo(e)};this.appendExtensionByName=function(b,e){Ext.asn1.x509.Extension.appendByNameToArray(b,e,this.extensionsArray)};this.getEncodedHex=function(){this.asn1Array=new Array();this.asn1Array.push(this.asn1Version);this.asn1Array.push(this.asn1Subject);this.asn1Array.push(this.asn1SubjPKey);if(this.extensionsArray.length>0){var f=new Ext.asn1.DERSequence({array:this.extensionsArray});var e=new Ext.asn1.DERSet({array:[f]});var b=new Ext.asn1.DERSequence({array:[new Ext.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.9.14"}),e]});var d=new Ext.asn1.DERTaggedObject({explicit:true,tag:"a0",obj:b});this.asn1Array.push(d)}else{var d=new Ext.asn1.DERTaggedObject({explicit:false,tag:"a0",obj:new Ext.asn1.DERNull()});this.asn1Array.push(d)}var l=new Ext.asn1.DERSequence({array:this.asn1Array});this.hTLV=l.getEncodedHex();this.isModified=false;return this.hTLV};this._initialize()};YAHOO.lang.extend(Ext.asn1.csr.CertificationRequestInfo,Ext.asn1.ASN1Object);Ext.asn1.csr.CSRUtil=new function(){};Ext.asn1.csr.CSRUtil.newCSRPEM=function(b){var f=Ext.asn1.csr;if(b.subject===undefined){throw"parameter subject undefined"}if(b.sbjpubkey===undefined){throw"parameter sbjpubkey undefined"}if(b.sigalg===undefined){throw"parameter sigalg undefined"}if(b.sbjprvkey===undefined){throw"parameter sbjpubkey undefined"}var p=new f.CertificationRequestInfo();p.setSubjectByParam(b.subject);p.setSubjectPublicKeyByGetKey(b.sbjpubkey);if(b.ext!==undefined&&b.ext.length!==undefined){for(var d=0;d<b.ext.length;d++){for(key in b.ext[d]){p.appendExtensionByName(key,b.ext[d][key])}}}var e=new f.CertificationRequest({csrinfo:p});var c=KEYUTIL.getKey(b.sbjprvkey);e.sign(b.sigalg,c);var g=e.getPEMString();return g};Ext.asn1.csr.CSRUtil.getInfo=function(c){var b={};b.subject={};b.pubkey={};if(c.indexOf("-----BEGIN CERTIFICATE REQUEST")==-1){throw"argument is not PEM file"}var g=ASN1HEX.pemToHex(c,"CERTIFICATE REQUEST");b.subject.hex=ASN1HEX.getDecendantHexTLVByNthList(g,0,[0,1]);b.subject.name=X509.hex2dn(b.subject.hex);b.pubkey.hex=ASN1HEX.getDecendantHexTLVByNthList(g,0,[0,2]);b.pubkey.obj=KEYUTIL.getKey(b.pubkey.hex,null,"pkcs8pub");return b};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.asn1=="undefined"||!Ext.asn1){Ext.asn1={}}if(typeof Ext.asn1.ocsp=="undefined"||!Ext.asn1.ocsp){Ext.asn1.ocsp={}}Ext.asn1.ocsp.DEFAULT_HASH="sha1";Ext.asn1.ocsp.CertID=function(c){Ext.asn1.ocsp.CertID.superclass.constructor.call(this);var l=Ext.asn1;var e=Ext.asn1.x509;this.dHashAlg=null;this.dIssuerNameHash=null;this.dIssuerKeyHash=null;this.dSerialNumber=null;this.setByValue=function(i,g,j,f){if(f===undefined){f=Ext.asn1.ocsp.DEFAULT_HASH}this.dHashAlg=new e.AlgorithmIdentifier({name:f});this.dIssuerNameHash=new l.DEROctetString({hex:i});this.dIssuerKeyHash=new l.DEROctetString({hex:g});this.dSerialNumber=new l.DERInteger({hex:j})};this.setByCert=function(k,f,i){if(i===undefined){i=Ext.asn1.ocsp.DEFAULT_HASH}var o=new X509();o.readCertPEM(f);var m=new X509();m.readCertPEM(k);var n=X509.getPublicKeyInfoPropOfCertPEM(k);var j=n.keyhex;var v=o.getSerialNumberHex();var w=Ext.crypto.Util.hashHex(m.getSubjectHex(),i);var g=Ext.crypto.Util.hashHex(j,i);this.setByValue(w,g,v,i);this.hoge=o.getSerialNumberHex()};this.getEncodedHex=function(){if(this.dHashAlg===null&&this.dIssuerNameHash===null&&this.dIssuerKeyHash===null&&this.dSerialNumber===null){throw"not yet set values"}var g=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber];var f=new l.DERSequence({array:g});this.hTLV=f.getEncodedHex();return this.hTLV};if(typeof c!=="undefined"){var b=c;if(typeof b.issuerCert!=="undefined"&&typeof b.subjectCert!=="undefined"){var d=Ext.asn1.ocsp.DEFAULT_HASH;if(typeof b.alg==="undefined"){d=undefined}this.setByCert(b.issuerCert,b.subjectCert,d)}else{if(typeof b.namehash!=="undefined"&&typeof b.keyhash!=="undefined"&&typeof b.serial!=="undefined"){var d=Ext.asn1.ocsp.DEFAULT_HASH;if(typeof b.alg==="undefined"){d=undefined}this.setByValue(b.namehash,b.keyhash,b.serial,d)}else{throw"invalid constructor arguments"}}}};YAHOO.lang.extend(Ext.asn1.ocsp.CertID,Ext.asn1.ASN1Object);Ext.asn1.ocsp.Request=function(e){Ext.asn1.ocsp.Request.superclass.constructor.call(this);this.dReqCert=null;this.dExt=null;this.getEncodedHex=function(){var d=[];if(this.dReqCert===null){throw"reqCert not set"}d.push(this.dReqCert);var c=new Ext.asn1.DERSequence({array:d});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof e!=="undefined"){var b=new Ext.asn1.ocsp.CertID(e);this.dReqCert=b}};YAHOO.lang.extend(Ext.asn1.ocsp.Request,Ext.asn1.ASN1Object);Ext.asn1.ocsp.TBSRequest=function(c){Ext.asn1.ocsp.TBSRequest.superclass.constructor.call(this);this.version=0;this.dRequestorName=null;this.dRequestList=[];this.dRequestExt=null;this.setRequestListByParam=function(j){var d=[];for(var e=0;e<j.length;e++){var b=new Ext.asn1.ocsp.Request(j[0]);d.push(b)}this.dRequestList=d};this.getEncodedHex=function(){var d=[];if(this.version!==0){throw"not supported version: "+this.version}if(this.dRequestorName!==null){throw"requestorName not supported"}var b=new Ext.asn1.DERSequence({array:this.dRequestList});d.push(b);if(this.dRequestExt!==null){throw"requestExtensions not supported"}var g=new Ext.asn1.DERSequence({array:d});this.hTLV=g.getEncodedHex();return this.hTLV};if(typeof c!=="undefined"){if(typeof c.reqList!=="undefined"){this.setRequestListByParam(c.reqList)}}};YAHOO.lang.extend(Ext.asn1.ocsp.TBSRequest,Ext.asn1.ASN1Object);Ext.asn1.ocsp.OCSPRequest=function(e){Ext.asn1.ocsp.OCSPRequest.superclass.constructor.call(this);this.dTbsRequest=null;this.dOptionalSignature=null;this.getEncodedHex=function(){var d=[];if(this.dTbsRequest!==null){d.push(this.dTbsRequest)}else{throw"tbsRequest not set"}if(this.dOptionalSignature!==null){throw"optionalSignature not supported"}var c=new Ext.asn1.DERSequence({array:d});this.hTLV=c.getEncodedHex();return this.hTLV};if(typeof e!=="undefined"){if(typeof e.reqList!=="undefined"){var b=new Ext.asn1.ocsp.TBSRequest(e);this.dTbsRequest=b}}};YAHOO.lang.extend(Ext.asn1.ocsp.OCSPRequest,Ext.asn1.ASN1Object);Ext.asn1.ocsp.OCSPUtil={};Ext.asn1.ocsp.OCSPUtil.getRequestHex=function(l,b,e){if(e===undefined){e=Ext.asn1.ocsp.DEFAULT_HASH}var d={alg:e,issuerCert:l,subjectCert:b};var c=new Ext.asn1.ocsp.OCSPRequest({reqList:[d]});return c.getEncodedHex()};Ext.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(p){var f={};try{var b=ASN1HEX.getVbyList(p,0,[0],"0a");f.responseStatus=parseInt(b,16)}catch(d){}if(f.responseStatus!==0){return f}try{var c=ASN1HEX.getDecendantIndexByNthList(p,0,[1,0,1,0,0,2,0,1]);if(p.substr(c,2)==="80"){f.certStatus="good"}else{if(p.substr(c,2)==="a1"){f.certStatus="revoked";f.revocationTime=hextoutf8(ASN1HEX.getDecendantHexVByNthList(p,c,[0]))}else{if(p.substr(c,2)==="82"){f.certStatus="unknown"}}}}catch(d){}try{var g=ASN1HEX.getDecendantIndexByNthList(p,0,[1,0,1,0,0,2,0,2]);f.thisUpdate=hextoutf8(ASN1HEX.getHexOfV_AtObj(p,g))}catch(d){}try{var e=ASN1HEX.getDecendantIndexByNthList(p,0,[1,0,1,0,0,2,0,3]);if(p.substr(e,2)==="a0"){f.nextUpdate=hextoutf8(ASN1HEX.getDecendantHexVByNthList(p,e,[0]))}}catch(d){}return f};var Ext;if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.lang=="undefined"||!Ext.lang){Ext.lang={}}Ext.lang.String=function(){};function Base64x(){}function stoBA(b){var c=new Array();for(var d=0;d<b.length;d++){c[d]=b.charCodeAt(d)}return c}function BAtos(c){var b="";for(var d=0;d<c.length;d++){b=b+String.fromCharCode(c[d])}return b}function BAtohex(c){var b="";for(var e=0;e<c.length;e++){var d=c[e].toString(16);if(d.length==1){d="0"+d}b=b+d}return b}function stohex(c){return BAtohex(stoBA(c))}function stob64(c){return hex2b64(stohex(c))}function stob64u(c){return b64tob64u(hex2b64(stohex(c)))}function b64utos(c){return BAtos(b64toBA(b64utob64(c)))}function b64tob64u(c){c=c.replace(/\=/g,"");c=c.replace(/\+/g,"-");c=c.replace(/\//g,"_");return c}function b64utob64(c){if(c.length%4==2){c=c+"=="}else{if(c.length%4==3){c=c+"="}}c=c.replace(/-/g,"+");c=c.replace(/_/g,"/");return c}function hextob64u(c){if(c.length%2==1){c="0"+c}return b64tob64u(hex2b64(c))}function b64utohex(c){return b64tohex(b64utob64(c))}var utf8tob64u,b64utoutf8;if(typeof Buffer==="function"){utf8tob64u=function(c){return b64tob64u(new Buffer(c,"utf8").toString("base64"))};b64utoutf8=function(c){return new Buffer(b64utob64(c),"base64").toString("utf8")}}else{utf8tob64u=function(c){return hextob64u(uricmptohex(encodeURIComponentAll(c)))};b64utoutf8=function(c){return decodeURIComponent(hextouricmp(b64utohex(c)))}}function utf8tob64(c){return hex2b64(uricmptohex(encodeURIComponentAll(c)))}function b64toutf8(c){return decodeURIComponent(hextouricmp(b64tohex(c)))}function utf8tohex(c){return uricmptohex(encodeURIComponentAll(c))}function hextoutf8(c){return decodeURIComponent(hextouricmp(c))}function hextorstr(g){var c="";for(var b=0;b<g.length-1;b+=2){c+=String.fromCharCode(parseInt(g.substr(b,2),16))}return c}function rstrtohex(g){var b="";for(var c=0;c<g.length;c++){b+=("0"+g.charCodeAt(c).toString(16)).slice(-2)}return b}function hextob64(c){return hex2b64(c)}function hextob64nl(c){var b=hextob64(c);var g=b.replace(/(.{64})/g,"$1\r\n");g=g.replace(/\r\n$/,"");return g}function b64nltohex(c){var b=c.replace(/[^0-9A-Za-z\/+=]*/g,"");var g=b64tohex(b);return g}function hextoArrayBuffer(j){if(j.length%2!=0){throw"input is not even length"}if(j.match(/^[0-9A-Fa-f]+$/)==null){throw"input is not hexadecimal"}var c=new ArrayBuffer(j.length/2);var b=new DataView(c);for(var d=0;d<j.length/2;d++){b.setUint8(d,parseInt(j.substr(d*2,2),16))}return c}function ArrayBuffertohex(c){var j="";var b=new DataView(c);for(var d=0;d<c.byteLength;d++){j+=("00"+b.getUint8(d).toString(16)).slice(-2)}return j}function uricmptohex(c){return c.replace(/%/g,"")}function hextouricmp(c){return c.replace(/(..)/g,"%$1")}function encodeURIComponentAll(b){var j=encodeURIComponent(b);var c="";for(var d=0;d<j.length;d++){if(j[d]=="%"){c=c+j.substr(d,3);d=d+2}else{c=c+"%"+stohex(j[d])}}return c}function newline_toUnix(c){c=c.replace(/\r\n/mg,"\n");return c}function newline_toDos(c){c=c.replace(/\r\n/mg,"\n");c=c.replace(/\n/mg,"\r\n");return c}Ext.lang.String.isInteger=function(c){if(c.match(/^[0-9]+$/)){return true}else{if(c.match(/^-[0-9]+$/)){return true}else{return false}}};Ext.lang.String.isHex=function(c){if(c.length%2==0&&(c.match(/^[0-9a-f]+$/)||c.match(/^[0-9A-F]+$/))){return true}else{return false}};Ext.lang.String.isBase64=function(c){c=c.replace(/\s+/g,"");if(c.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&c.length%4==0){return true}else{return false}};Ext.lang.String.isBase64URL=function(c){if(c.match(/[+/=]/)){return false}c=b64utob64(c);return Ext.lang.String.isBase64(c)};Ext.lang.String.isIntegerArray=function(c){c=c.replace(/\s+/g,"");if(c.match(/^\[[0-9,]+\]$/)){return true}else{return false}};function intarystrtohex(c){c=c.replace(/^\s*\[\s*/,"");c=c.replace(/\s*\]\s*$/,"");c=c.replace(/\s*/g,"");try{var g=c.split(/,/).map(function(k,e,l){var f=parseInt(k);if(f<0||255<f){throw"integer not in range 0-255"}var d=("00"+f.toString(16)).slice(-2);return d}).join("");return g}catch(b){throw"malformed integer array string: "+b}}var strdiffidx=function(d,b){var j=d.length;if(d.length>b.length){j=b.length}for(var c=0;c<j;c++){if(d.charCodeAt(c)!=b.charCodeAt(c)){return c}}if(d.length!=b.length){return j}return -1};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414",};this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa",};this.CRYPTOJSMESSAGEDIGESTNAME={md5:CryptoJS.algo.MD5,sha1:CryptoJS.algo.SHA1,sha224:CryptoJS.algo.SHA224,sha256:CryptoJS.algo.SHA256,sha384:CryptoJS.algo.SHA384,sha512:CryptoJS.algo.SHA512,ripemd160:CryptoJS.algo.RIPEMD160};this.getDigestInfoHex=function(b,e){if(typeof this.DIGESTINFOHEAD[e]=="undefined"){throw"alg not supported in Util.DIGESTINFOHEAD: "+e}return this.DIGESTINFOHEAD[e]+b};this.getPaddedDigestInfoHex=function(k,y,j){var c=this.getDigestInfoHex(k,y);var d=j/4;if(c.length+22>d){throw"key is too short for SigAlg: keylen="+j+","+y}var b="0001";var l="00"+c;var f="";var x=d-b.length-l.length;for(var g=0;g<x;g+=2){f+="ff"}var e=b+f+l;return e};this.hashString=function(b,g){var c=new Ext.crypto.MessageDigest({alg:g});return c.digestString(b)};this.hashHex=function(c,g){var b=new Ext.crypto.MessageDigest({alg:g});return b.digestHex(c)};this.sha1=function(b){var e=new Ext.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"});return e.digestString(b)};this.sha256=function(b){var e=new Ext.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return e.digestString(b)};this.sha256Hex=function(b){var e=new Ext.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"});return e.digestHex(b)};this.sha512=function(b){var e=new Ext.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return e.digestString(b)};this.sha512Hex=function(b){var e=new Ext.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"});return e.digestHex(b)}};Ext.crypto.Util.md5=function(b){var e=new Ext.crypto.MessageDigest({alg:"md5",prov:"cryptojs"});return e.digestString(b)};Ext.crypto.Util.ripemd160=function(b){var e=new Ext.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"});return e.digestString(b)};Ext.crypto.Util.SECURERANDOMGEN=new SecureRandom();Ext.crypto.Util.getRandomHexOfNbytes=function(e){var b=new Array(e);Ext.crypto.Util.SECURERANDOMGEN.nextBytes(b);return BAtohex(b)};Ext.crypto.Util.getRandomBigIntegerOfNbytes=function(c){return new BigInteger(Ext.crypto.Util.getRandomHexOfNbytes(c),16)};Ext.crypto.Util.getRandomHexOfNbits=function(j){var d=j%8;var b=(j-d)/8;var c=new Array(b+1);Ext.crypto.Util.SECURERANDOMGEN.nextBytes(c);c[0]=(((255<<d)&255)^255)&c[0];return BAtohex(c)};Ext.crypto.Util.getRandomBigIntegerOfNbits=function(c){return new BigInteger(Ext.crypto.Util.getRandomHexOfNbits(c),16)};Ext.crypto.Util.getRandomBigIntegerZeroToMax=function(c){var b=c.bitLength();while(1){var g=Ext.crypto.Util.getRandomBigIntegerOfNbits(b);if(c.compareTo(g)!=-1){return g}}};Ext.crypto.Util.getRandomBigIntegerMinToMax=function(e,b){var c=e.compareTo(b);if(c==1){throw"biMin is greater than biMax"}if(c==0){return e}var l=b.subtract(e);var d=Ext.crypto.Util.getRandomBigIntegerZeroToMax(l);return d.add(e)};Ext.crypto.MessageDigest=function(d){var c=null;var b=null;var j=null;this.setAlgAndProvider=function(f,e){f=Ext.crypto.MessageDigest.getCanonicalAlgName(f);if(f!==null&&e===undefined){e=Ext.crypto.Util.DEFAULTPROVIDER[f]}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(f)!=-1&&e=="cryptojs"){try{this.md=Ext.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[f].create()}catch(g){throw"setAlgAndProvider hash alg set fail alg="+f+"/"+g}this.updateString=function(i){this.md.update(i)};this.updateHex=function(i){var l=CryptoJS.enc.Hex.parse(i);this.md.update(l)};this.digest=function(){var i=this.md.finalize();return i.toString(CryptoJS.enc.Hex)};this.digestString=function(i){this.updateString(i);return this.digest()};this.digestHex=function(i){this.updateHex(i);return this.digest()}}if(":sha256:".indexOf(f)!=-1&&e=="sjcl"){try{this.md=new sjcl.hash.sha256()}catch(g){throw"setAlgAndProvider hash alg set fail alg="+f+"/"+g}this.updateString=function(i){this.md.update(i)};this.updateHex=function(l){var i=sjcl.codec.hex.toBits(l);this.md.update(i)};this.digest=function(){var i=this.md.finalize();return sjcl.codec.hex.fromBits(i)};this.digestString=function(i){this.updateString(i);return this.digest()};this.digestHex=function(i){this.updateHex(i);return this.digest()}}};this.updateString=function(e){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.updateHex=function(e){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestString=function(e){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName};this.digestHex=function(e){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName};if(d!==undefined){if(d.alg!==undefined){this.algName=d.alg;if(d.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};Ext.crypto.MessageDigest.getCanonicalAlgName=function(c){if(typeof c==="string"){c=c.toLowerCase();c=c.replace(/-/,"")}return c};Ext.crypto.MessageDigest.getHashLength=function(g){var c=Ext.crypto.MessageDigest;var b=c.getCanonicalAlgName(g);if(c.HASHLENGTH[b]===undefined){throw"not supported algorithm: "+g}return c.HASHLENGTH[b]};Ext.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20};Ext.crypto.Mac=function(n){var e=null;var b=null;var f=null;var d=null;var c=null;this.setAlgAndProvider=function(l,j){l=l.toLowerCase();if(l==null){l="hmacsha1"}l=l.toLowerCase();if(l.substr(0,4)!="hmac"){throw"setAlgAndProvider unsupported HMAC alg: "+l}if(j===undefined){j=Ext.crypto.Util.DEFAULTPROVIDER[l]}this.algProv=l+"/"+j;var g=l.substr(4);if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(g)!=-1&&j=="cryptojs"){try{var k=Ext.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[g];this.mac=CryptoJS.algo.HMAC.create(k,this.pass)}catch(i){throw"setAlgAndProvider hash alg set fail hashAlg="+g+"/"+i}this.updateString=function(m){this.mac.update(m)};this.updateHex=function(m){var p=CryptoJS.enc.Hex.parse(m);this.mac.update(p)};this.doFinal=function(){var m=this.mac.finalize();return m.toString(CryptoJS.enc.Hex)};this.doFinalString=function(m){this.updateString(m);return this.doFinal()};this.doFinalHex=function(m){this.updateHex(m);return this.doFinal()}}};this.updateString=function(g){throw"updateString(str) not supported for this alg/prov: "+this.algProv};this.updateHex=function(g){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv};this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv};this.doFinalString=function(g){throw"digestString(str) not supported for this alg/prov: "+this.algProv};this.doFinalHex=function(g){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv};this.setPassword=function(g){if(typeof g=="string"){var i=g;if(g.length%2==1||!g.match(/^[0-9A-Fa-f]+$/)){i=rstrtohex(g)}this.pass=CryptoJS.enc.Hex.parse(i);return}if(typeof g!="object"){throw"Ext.crypto.Mac unsupported password type: "+g}var i=null;if(g.hex!==undefined){if(g.hex.length%2!=0||!g.hex.match(/^[0-9A-Fa-f]+$/)){throw"Mac: wrong hex password: "+g.hex}i=g.hex}if(g.utf8!==undefined){i=utf8tohex(g.utf8)}if(g.rstr!==undefined){i=rstrtohex(g.rstr)}if(g.b64!==undefined){i=b64tohex(g.b64)}if(g.b64u!==undefined){i=b64utohex(g.b64u)}if(i==null){throw"Ext.crypto.Mac unsupported password type: "+g}this.pass=CryptoJS.enc.Hex.parse(i)};if(n!==undefined){if(n.pass!==undefined){this.setPassword(n.pass)}if(n.alg!==undefined){this.algName=n.alg;if(n.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}this.setAlgAndProvider(this.algName,this.provName)}}};Ext.crypto.Signature=function(N){var e=null;var m=null;var i=null;var g=null;var f=null;var k=null;var o=null;var p=null;var l=null;var q=null;var c=-1;var j=null;var r=null;var b=null;var n=null;var M=null;this._setAlgNames=function(){var s=this.algName.match(/^(.+)with(.+)$/);if(s){this.mdAlgName=s[1].toLowerCase();this.pubkeyAlgName=s[2].toLowerCase()}};this._zeroPaddingOfSignature=function(x,w){var v="";var s=w/4-x.length;for(var u=0;u<s;u++){v=v+"0"}return v+x};this.setAlgAndProvider=function(u,s){this._setAlgNames();if(s!="cryptojs/jsrsa"){throw"provider not supported: "+s}if(":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)!=-1){try{this.md=new Ext.crypto.MessageDigest({alg:this.mdAlgName})}catch(v){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+v}this.init=function(w,y){var x=null;try{if(y===undefined){x=KEYUTIL.getKey(w)}else{x=KEYUTIL.getKey(w,y)}}catch(A){throw"init failed:"+A}if(x.isPrivate===true){this.prvKey=x;this.state="SIGN"}else{if(x.isPublic===true){this.pubKey=x;this.state="VERIFY"}else{throw"init failed.:"+x}}};this.initSign=function(w){if(typeof w.ecprvhex=="string"&&typeof w.eccurvename=="string"){this.ecprvhex=w.ecprvhex;this.eccurvename=w.eccurvename}else{this.prvKey=w}this.state="SIGN"};this.initVerifyByPublicKey=function(w){if(typeof w.ecpubhex=="string"&&typeof w.eccurvename=="string"){this.ecpubhex=w.ecpubhex;this.eccurvename=w.eccurvename}else{if(w instanceof Ext.crypto.ECDSA){this.pubKey=w}else{if(w instanceof RSAKey){this.pubKey=w}}}this.state="VERIFY"};this.initVerifyByCertificatePEM=function(w){var x=new X509();x.readCertPEM(w);this.pubKey=x.subjectPublicKeyRSA;this.state="VERIFY"};this.updateString=function(w){this.md.updateString(w)};this.updateHex=function(w){this.md.updateHex(w)};this.sign=function(){this.sHashHex=this.md.digest();if(typeof this.ecprvhex!="undefined"&&typeof this.eccurvename!="undefined"){var w=new Ext.crypto.ECDSA({curve:this.eccurvename});this.hSign=w.signHex(this.sHashHex,this.ecprvhex)}else{if(this.prvKey instanceof RSAKey&&this.pubkeyAlgName=="rsaandmgf1"){this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen)}else{if(this.prvKey instanceof RSAKey&&this.pubkeyAlgName=="rsa"){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName)}else{if(this.prvKey instanceof Ext.crypto.ECDSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{if(this.prvKey instanceof Ext.crypto.DSA){this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}return this.hSign};this.signString=function(w){this.updateString(w);return this.sign()};this.signHex=function(w){this.updateHex(w);return this.sign()};this.verify=function(w){this.sHashHex=this.md.digest();if(typeof this.ecpubhex!="undefined"&&typeof this.eccurvename!="undefined"){var x=new Ext.crypto.ECDSA({curve:this.eccurvename});return x.verifyHex(this.sHashHex,w,this.ecpubhex)}else{if(this.pubKey instanceof RSAKey&&this.pubkeyAlgName=="rsaandmgf1"){return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,w,this.mdAlgName,this.pssSaltLen)}else{if(this.pubKey instanceof RSAKey&&this.pubkeyAlgName=="rsa"){return this.pubKey.verifyWithMessageHash(this.sHashHex,w)}else{if(this.pubKey instanceof Ext.crypto.ECDSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,w)}else{if(this.pubKey instanceof Ext.crypto.DSA){return this.pubKey.verifyWithMessageHash(this.sHashHex,w)}else{throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}}}}}}};this.init=function(u,s){throw"init(key, pass) not supported for this alg:prov="+this.algProvName};this.initVerifyByPublicKey=function(s){throw"initVerifyByPublicKey(rsaPubKeyy) not supported for this alg:prov="+this.algProvName};this.initVerifyByCertificatePEM=function(s){throw"initVerifyByCertificatePEM(certPEM) not supported for this alg:prov="+this.algProvName};this.initSign=function(s){throw"initSign(prvKey) not supported for this alg:prov="+this.algProvName};this.updateString=function(s){throw"updateString(str) not supported for this alg:prov="+this.algProvName};this.updateHex=function(s){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName};this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName};this.signString=function(s){throw"digestString(str) not supported for this alg:prov="+this.algProvName};this.signHex=function(s){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName};this.verify=function(s){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName};this.initParams=N;if(N!==undefined){if(N.alg!==undefined){this.algName=N.alg;if(N.prov===undefined){this.provName=Ext.crypto.Util.DEFAULTPROVIDER[this.algName]}else{this.provName=N.prov}this.algProvName=this.algName+":"+this.provName;this.setAlgAndProvider(this.algName,this.provName);this._setAlgNames()}if(N.psssaltlen!==undefined){this.pssSaltLen=N.psssaltlen}if(N.prvkeypem!==undefined){if(N.prvkeypas!==undefined){throw"both prvkeypem and prvkeypas parameters not supported"}else{try{var e=new RSAKey();e.readPrivateKeyFromPEMString(N.prvkeypem);this.initSign(e)}catch(d){throw"fatal error to load pem private key: "+d}}}}};Ext.crypto.Cipher=function(c){};Ext.crypto.Cipher.encrypt=function(e,f,d){if(f instanceof RSAKey&&f.isPublic){var c=Ext.crypto.Cipher.getAlgByKeyAndName(f,d);if(c==="RSA"){return f.encrypt(e)}if(c==="RSAOAEP"){return f.encryptOAEP(e,"sha1")}var b=c.match(/^RSAOAEP(\d+)$/);if(b!==null){return f.encryptOAEP(e,"sha"+b[1])}throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+d}else{throw"Cipher.encrypt: unsupported key or algorithm"}};Ext.crypto.Cipher.decrypt=function(e,f,d){if(f instanceof RSAKey&&f.isPrivate){var c=Ext.crypto.Cipher.getAlgByKeyAndName(f,d);if(c==="RSA"){return f.decrypt(e)}if(c==="RSAOAEP"){return f.decryptOAEP(e,"sha1")}var b=c.match(/^RSAOAEP(\d+)$/);if(b!==null){return f.decryptOAEP(e,"sha"+b[1])}throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+d}else{throw"Cipher.decrypt: unsupported key or algorithm"}};Ext.crypto.Cipher.getAlgByKeyAndName=function(e,b){if(e instanceof RSAKey){if(":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(b)!=-1){return b}if(b===null||b===undefined){return"RSA"}throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+b}throw"getAlgByKeyAndName: not supported algorithm name: "+b};Ext.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA",}};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.ECDSA=function(b){var f="secp256r1";var d=null;var q=null;var c=null;var e=new SecureRandom();var g=null;this.type="EC";this.isPrivate=false;this.isPublic=false;function r(i,m,o,k){var p=Math.max(m.bitLength(),k.bitLength());var n=i.add2D(o);var l=i.curve.getInfinity();for(var j=p-1;j>=0;--j){l=l.twice2D();l.z=BigInteger.ONE;if(m.testBit(j)){if(k.testBit(j)){l=l.add2D(n)}else{l=l.add2D(i)}}else{if(k.testBit(j)){l=l.add2D(o)}}}return l}this.getBigRandom=function(i){return new BigInteger(i.bitLength(),e).mod(i.subtract(BigInteger.ONE)).add(BigInteger.ONE)};this.setNamedCurve=function(i){this.ecparams=Ext.crypto.ECParameterDB.getByName(i);this.prvKeyHex=null;this.pubKeyHex=null;this.curveName=i};this.setPrivateKeyHex=function(i){this.isPrivate=true;this.prvKeyHex=i};this.setPublicKeyHex=function(i){this.isPublic=true;this.pubKeyHex=i};this.getPublicKeyXYHex=function(){var j=this.pubKeyHex;if(j.substr(0,2)!=="04"){throw"this method supports uncompressed format(04) only"}var i=this.ecparams.keylen/4;if(j.length!==2+i*2){throw"malformed public key hex length"}var k={};k.x=j.substr(2,i);k.y=j.substr(2+i);return k};this.getShortNISTPCurveName=function(){var i=this.curveName;if(i==="secp256r1"||i==="NIST P-256"||i==="P-256"||i==="prime256v1"){return"P-256"}if(i==="secp384r1"||i==="NIST P-384"||i==="P-384"){return"P-384"}return null};this.generateKeyPairHex=function(){var v=this.ecparams.n;var j=this.getBigRandom(v);var w=this.ecparams.G.multiply(j);var m=w.getX().toBigInteger();var k=w.getY().toBigInteger();var o=this.ecparams.keylen/4;var i=("0000000000"+j.toString(16)).slice(-o);var n=("0000000000"+m.toString(16)).slice(-o);var l=("0000000000"+k.toString(16)).slice(-o);var p="04"+n+l;this.setPrivateKeyHex(i);this.setPublicKeyHex(p);return{ecprvhex:i,ecpubhex:p}};this.signWithMessageHash=function(i){return this.signHex(i,this.prvKeyHex)};this.signHex=function(m,j){var p=new BigInteger(j,16);var k=this.ecparams.n;var o=new BigInteger(m,16);do{var l=this.getBigRandom(k);var u=this.ecparams.G;var n=u.multiply(l);var i=n.getX().toBigInteger().mod(k)}while(i.compareTo(BigInteger.ZERO)<=0);var v=l.modInverse(k).multiply(o.add(p.multiply(i))).mod(k);return Ext.crypto.ECDSA.biRSSigToASN1Sig(i,v)};this.sign=function(l,u){var o=u;var j=this.ecparams.n;var n=BigInteger.fromByteArrayUnsigned(l);do{var k=this.getBigRandom(j);var p=this.ecparams.G;var m=p.multiply(k);var i=m.getX().toBigInteger().mod(j)}while(i.compareTo(BigInteger.ZERO)<=0);var v=k.modInverse(j).multiply(n.add(o.multiply(i))).mod(j);return this.serializeSig(i,v)};this.verifyWithMessageHash=function(i,j){return this.verifyHex(i,j,this.pubKeyHex)};this.verifyHex=function(i,m,l){var o,p;var k=Ext.crypto.ECDSA.parseSigHex(m);o=k.r;p=k.s;var n;n=ECPointFp.decodeFromHex(this.ecparams.curve,l);var j=new BigInteger(i,16);return this.verifyRaw(j,o,p,n)};this.verify=function(m,l,i){var p,k;if(Bitcoin.Util.isArray(l)){var j=this.parseSig(l);p=j.r;k=j.s}else{if("object"===typeof l&&l.r&&l.s){p=l.r;k=l.s}else{throw"Invalid value for signature"}}var o;if(i instanceof ECPointFp){o=i}else{if(Bitcoin.Util.isArray(i)){o=ECPointFp.decodeFrom(this.ecparams.curve,i)}else{throw"Invalid format for pubkey value, must be byte array or ECPointFp"}}var n=BigInteger.fromByteArrayUnsigned(m);return this.verifyRaw(n,p,k,o)};this.verifyRaw=function(l,n,w,k){var j=this.ecparams.n;var u=this.ecparams.G;if(n.compareTo(BigInteger.ONE)<0||n.compareTo(j)>=0){return false}if(w.compareTo(BigInteger.ONE)<0||w.compareTo(j)>=0){return false}var m=w.modInverse(j);var i=l.multiply(m).mod(j);var y=n.multiply(m).mod(j);var p=u.multiply(i).add(k.multiply(y));var o=p.getX().toBigInteger().mod(j);return o.equals(n)};this.serializeSig=function(k,j){var l=k.toByteArraySigned();var i=j.toByteArraySigned();var m=[];m.push(2);m.push(l.length);m=m.concat(l);m.push(2);m.push(i.length);m=m.concat(i);m.unshift(m.length);m.unshift(48);return m};this.parseSig=function(l){var k;if(l[0]!=48){throw new Error("Signature not a valid DERSequence")}k=2;if(l[k]!=2){throw new Error("First element in signature must be a DERInteger")}var j=l.slice(k+2,k+2+l[k+1]);k+=2+l[k+1];if(l[k]!=2){throw new Error("Second element in signature must be a DERInteger")}var m=l.slice(k+2,k+2+l[k+1]);k+=2+l[k+1];var i=BigInteger.fromByteArrayUnsigned(j);var n=BigInteger.fromByteArrayUnsigned(m);return{r:i,s:n}};this.parseSigCompact=function(m){if(m.length!==65){throw"Signature has the wrong length"}var j=m[0]-27;if(j<0||j>7){throw"Invalid signature type"}var i=this.ecparams.n;var l=BigInteger.fromByteArrayUnsigned(m.slice(1,33)).mod(i);var k=BigInteger.fromByteArrayUnsigned(m.slice(33,65)).mod(i);return{r:l,s:k,i:j}};this.readPKCS5PrvKeyHex=function(i){var m=ASN1HEX;var o=Ext.crypto.ECDSA.getName;var k=m.getVbyList;if(m.isASN1HEX(i)===false){throw"not ASN.1 hex string"}var l,p,j;try{l=k(i,0,[2,0],"06");p=k(i,0,[1],"04");try{j=k(i,0,[3,0],"03").substr(2)}catch(n){}}catch(n){throw"malformed PKCS#1/5 plain ECC private key"}this.curveName=o(l);if(this.curveName===undefined){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(j);this.setPrivateKeyHex(p);this.isPublic=false};this.readPKCS8PrvKeyHex=function(j){var o=ASN1HEX;var p=Ext.crypto.ECDSA.getName;var l=o.getVbyList;if(o.isASN1HEX(j)===false){throw"not ASN.1 hex string"}var u,n,k,i;try{u=l(j,0,[1,0],"06");n=l(j,0,[1,1],"06");k=l(j,0,[2,0,1],"04");try{i=l(j,0,[2,0,2,0],"03").substr(2)}catch(m){}}catch(m){throw"malformed PKCS#8 plain ECC private key"}this.curveName=p(n);if(this.curveName===undefined){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(i);this.setPrivateKeyHex(k);this.isPublic=false};this.readPKCS8PubKeyHex=function(i){var m=ASN1HEX;var o=Ext.crypto.ECDSA.getName;var k=m.getVbyList;if(m.isASN1HEX(i)===false){throw"not ASN.1 hex string"}var p,l,j;try{p=k(i,0,[0,0],"06");l=k(i,0,[0,1],"06");j=k(i,0,[1],"03").substr(2)}catch(n){throw"malformed PKCS#8 ECC public key"}this.curveName=o(l);if(this.curveName===null){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(j)};this.readCertPubKeyHex=function(i,m){if(m!==5){m=6}var p=ASN1HEX;var o=Ext.crypto.ECDSA.getName;var l=p.getVbyList;if(p.isASN1HEX(i)===false){throw"not ASN.1 hex string"}var k,j;try{k=l(i,0,[0,m,0,1],"06");j=l(i,0,[0,m,1],"03").substr(2)}catch(n){throw"malformed X.509 certificate ECC public key"}this.curveName=o(k);if(this.curveName===null){throw"unsupported curve name"}this.setNamedCurve(this.curveName);this.setPublicKeyHex(j)};if(b!==undefined){if(b.curve!==undefined){this.curveName=b.curve}}if(this.curveName===undefined){this.curveName=f}this.setNamedCurve(this.curveName);if(b!==undefined){if(b.prv!==undefined){this.setPrivateKeyHex(b.prv)}if(b.pub!==undefined){this.setPublicKeyHex(b.pub)}}};Ext.crypto.ECDSA.parseSigHex=function(b){var c=Ext.crypto.ECDSA.parseSigHexInHexRS(b);var j=new BigInteger(c.r,16);var d=new BigInteger(c.s,16);return{r:j,s:d}};Ext.crypto.ECDSA.parseSigHexInHexRS=function(e){if(e.substr(0,2)!="30"){throw"signature is not a ASN.1 sequence"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);if(d.length!=2){throw"number of signature ASN.1 sequence elements seem wrong"}var c=d[0];var b=d[1];if(e.substr(c,2)!="02"){throw"1st item of sequene of signature is not ASN.1 integer"}if(e.substr(b,2)!="02"){throw"2nd item of sequene of signature is not ASN.1 integer"}var g=ASN1HEX.getHexOfV_AtObj(e,c);var f=ASN1HEX.getHexOfV_AtObj(e,b);return{r:g,s:f}};Ext.crypto.ECDSA.asn1SigToConcatSig=function(d){var j=Ext.crypto.ECDSA.parseSigHexInHexRS(d);var c=j.r;var b=j.s;if(c.substr(0,2)=="00"&&(((c.length/2)*8)%(16*8))==8){c=c.substr(2)}if(b.substr(0,2)=="00"&&(((b.length/2)*8)%(16*8))==8){b=b.substr(2)}if((((c.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig r length error"}if((((b.length/2)*8)%(16*8))!=0){throw"unknown ECDSA sig s length error"}return c+b};Ext.crypto.ECDSA.concatSigToASN1Sig=function(b){if((((b.length/2)*8)%(16*8))!=0){throw"unknown ECDSA concatinated r-s sig  length error"}var g=b.substr(0,b.length/2);var c=b.substr(b.length/2);return Ext.crypto.ECDSA.hexRSSigToASN1Sig(g,c)};Ext.crypto.ECDSA.hexRSSigToASN1Sig=function(c,b){var j=new BigInteger(c,16);var d=new BigInteger(b,16);return Ext.crypto.ECDSA.biRSSigToASN1Sig(j,d)};Ext.crypto.ECDSA.biRSSigToASN1Sig=function(e,c){var b=new Ext.asn1.DERInteger({bigint:e});var l=new Ext.asn1.DERInteger({bigint:c});var d=new Ext.asn1.DERSequence({array:[b,l]});return d.getEncodedHex()};Ext.crypto.ECDSA.getName=function(c){if(c==="2a8648ce3d030107"){return"secp256r1"}if(c==="2b8104000a"){return"secp256k1"}if(c==="2b81040022"){return"secp384r1"}if("|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(c)!==-1){return"secp256r1"}if("|secp256k1|".indexOf(c)!==-1){return"secp256k1"}if("|secp384r1|NIST P-384|P-384|".indexOf(c)!==-1){return"secp384r1"}return null};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.ECParameterDB=new function(){var c={};var g={};function b(d){return new BigInteger(d,16)}this.getByName=function(d){var e=d;if(typeof g[e]!="undefined"){e=g[d]}if(typeof c[e]!="undefined"){return c[e]}throw"unregistered EC curve name: "+e};this.regist=function(A,m,y,j,o,e,k,f,l,v,d,P){c[A]={};var s=b(y);var R=b(j);var Q=b(o);var u=b(e);var x=b(k);var r=new ECCurveFp(s,R,Q);var q=r.decodePointHex("04"+f+l);c[A]["name"]=A;c[A]["keylen"]=m;c[A]["curve"]=r;c[A]["G"]=q;c[A]["n"]=u;c[A]["h"]=x;c[A]["oid"]=d;c[A]["info"]=P;for(var w=0;w<v.length;w++){g[v[w]]=A}}};Ext.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field");Ext.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field");Ext.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field");Ext.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]);Ext.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]);Ext.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]);Ext.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]);Ext.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]);Ext.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]);Ext.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]);if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.crypto=="undefined"||!Ext.crypto){Ext.crypto={}}Ext.crypto.DSA=function(){this.p=null;this.q=null;this.g=null;this.y=null;this.x=null;this.type="DSA";this.isPrivate=false;this.isPublic=false;this.setPrivate=function(d,c,b,e,l){this.isPrivate=true;this.p=d;this.q=c;this.g=b;this.y=e;this.x=l};this.setPrivateHex=function(c,w,e,i,j){var b,v,d,f,g;b=new BigInteger(c,16);v=new BigInteger(w,16);d=new BigInteger(e,16);if(typeof i==="string"&&i.length>1){f=new BigInteger(i,16)}else{f=null}g=new BigInteger(j,16);this.setPrivate(b,v,d,f,g)};this.setPublic=function(d,c,b,j){this.isPublic=true;this.p=d;this.q=c;this.g=b;this.y=j;this.x=null};this.setPublicHex=function(b,f,q,d){var g,c,e,r;g=new BigInteger(b,16);c=new BigInteger(f,16);e=new BigInteger(q,16);r=new BigInteger(d,16);this.setPublic(g,c,e,r)};this.signWithMessageHash=function(n){var m=this.p;var l=this.q;var B=this.g;var c=this.y;var d=this.x;var A=Ext.crypto.Util.getRandomBigIntegerMinToMax(BigInteger.ONE.add(BigInteger.ONE),l.subtract(BigInteger.ONE));var e=n.substr(0,l.bitLength()/4);var b=new BigInteger(e,16);var j=(B.modPow(A,m)).mod(l);var i=(A.modInverse(l).multiply(b.add(d.multiply(j)))).mod(l);var f=Ext.asn1.ASN1Util.jsonToASN1HEX({seq:[{"int":{bigint:j}},{"int":{bigint:i}}]});return f};this.verifyWithMessageHash=function(H,m){var F=this.p;var e=this.q;var c=this.g;var d=this.y;var l=this.parseASN1Signature(m);var j=l[0];var o=l[1];var i=H.substr(0,e.bitLength()/4);var G=new BigInteger(i,16);if(BigInteger.ZERO.compareTo(j)>0||j.compareTo(e)>0){throw"invalid DSA signature"}if(BigInteger.ZERO.compareTo(o)>0||o.compareTo(e)>0){throw"invalid DSA signature"}var b=o.modInverse(e);var k=G.multiply(b).mod(e);var n=j.multiply(b).mod(e);var f=c.modPow(k,F).multiply(d.modPow(n,F)).mod(F).mod(e);return f.compareTo(j)==0};this.parseASN1Signature=function(b){try{var j=new BigInteger(ASN1HEX.getVbyList(b,0,[0],"02"),16);var d=new BigInteger(ASN1HEX.getVbyList(b,0,[1],"02"),16);return[j,d]}catch(c){throw"malformed ASN.1 DSA signature"}};this.readPKCS5PrvKeyHex=function(c){var b,u,f,g,i;var j=ASN1HEX;var d=j.getVbyList;if(j.isASN1HEX(c)===false){throw"not ASN.1 hex string"}try{b=d(c,0,[1],"02");u=d(c,0,[2],"02");f=d(c,0,[3],"02");g=d(c,0,[4],"02");i=d(c,0,[5],"02")}catch(e){console.log("EXCEPTION:"+e);throw"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(b,u,f,g,i)};this.readPKCS8PrvKeyHex=function(d){var b,i,g,e;var c=ASN1HEX;var f=c.getVbyList;if(c.isASN1HEX(d)===false){throw"not ASN.1 hex string"}try{b=f(d,0,[1,1,0],"02");i=f(d,0,[1,1,1],"02");g=f(d,0,[1,1,2],"02");e=f(d,0,[2,0],"02")}catch(r){console.log("EXCEPTION:"+r);throw"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(b,i,g,null,e)};this.readPKCS8PubKeyHex=function(d){var b,i,g,e;var c=ASN1HEX;var f=c.getVbyList;if(c.isASN1HEX(d)===false){throw"not ASN.1 hex string"}try{b=f(d,0,[0,1,0],"02");i=f(d,0,[0,1,1],"02");g=f(d,0,[0,1,2],"02");e=f(d,0,[1,0],"02")}catch(r){console.log("EXCEPTION:"+r);throw"malformed PKCS#8 DSA public key"}this.setPublicHex(b,i,g,e)};this.readCertPubKeyHex=function(c,f){if(f!==5){f=6}var b,u,g,i;var j=ASN1HEX;var d=j.getVbyList;if(j.isASN1HEX(c)===false){throw"not ASN.1 hex string"}try{b=d(c,0,[0,f,0,1,0],"02");u=d(c,0,[0,f,0,1,1],"02");g=d(c,0,[0,f,0,1,2],"02");i=d(c,0,[0,f,1,0],"02")}catch(e){console.log("EXCEPTION:"+e);throw"malformed X.509 certificate DSA public key"}this.setPublicHex(b,u,g,i)}};var PKCS5PKEY=function(){var m=function(q,p,o){return i(CryptoJS.AES,q,p,o)};var l=function(q,p,o){return i(CryptoJS.TripleDES,q,p,o)};var i=function(w,r,o,u){var v=CryptoJS.enc.Hex.parse(r);var q=CryptoJS.enc.Hex.parse(o);var s=CryptoJS.enc.Hex.parse(u);var x={};x.key=q;x.iv=s;x.ciphertext=v;var p=w.decrypt(x,q,{iv:s});return CryptoJS.enc.Hex.stringify(p)};var k=function(q,p,o){return f(CryptoJS.AES,q,p,o)};var D=function(q,p,o){return f(CryptoJS.TripleDES,q,p,o)};var f=function(u,y,v,q){var s=CryptoJS.enc.Hex.parse(y);var x=CryptoJS.enc.Hex.parse(v);var p=CryptoJS.enc.Hex.parse(q);var o={};var A=u.encrypt(s,x,{iv:p});var r=CryptoJS.enc.Hex.parse(A.toString());var w=CryptoJS.enc.Base64.stringify(r);return w};var d={"AES-256-CBC":{proc:m,eproc:k,keylen:32,ivlen:16},"AES-192-CBC":{proc:m,eproc:k,keylen:24,ivlen:16},"AES-128-CBC":{proc:m,eproc:k,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:l,eproc:D,keylen:24,ivlen:8}};var c=function(o){return d[o]["proc"]};var b=function(q){var p=CryptoJS.lib.WordArray.random(q);var o=CryptoJS.enc.Hex.stringify(p);return o};var g=function(o){var p={};var s=o.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));if(s){p.cipher=s[1];p.ivsalt=s[2]}var r=o.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));if(r){p.type=r[1]}var w=-1;var q=0;if(o.indexOf("\r\n\r\n")!=-1){w=o.indexOf("\r\n\r\n");q=2}if(o.indexOf("\n\n")!=-1){w=o.indexOf("\n\n");q=1}var v=o.indexOf("-----END");if(w!=-1&&v!=-1){var u=o.substring(w+q*2,v-q);u=u.replace(/\s+/g,"");p.data=u}return p};var n=function(p,y,o){var v=o.substring(0,16);var s=CryptoJS.enc.Hex.parse(v);var q=CryptoJS.enc.Utf8.parse(y);var u=d[p]["keylen"]+d[p]["ivlen"];var x="";var r=null;for(;;){var w=CryptoJS.algo.MD5.create();if(r!=null){w.update(r)}w.update(q);w.update(s);r=w.finalize();x=x+CryptoJS.enc.Hex.stringify(r);if(x.length>=u*2){break}}var A={};A.keyhex=x.substr(0,d[p]["keylen"]*2);A.ivhex=x.substr(d[p]["keylen"]*2,d[p]["ivlen"]*2);return A};var e=function(r,p,u,q){var v=CryptoJS.enc.Base64.parse(r);var s=CryptoJS.enc.Hex.stringify(v);var o=d[p]["proc"];var w=o(s,u,q);return w};var j=function(u,q,o,s){var p=d[q]["eproc"];var r=p(u,o,s);return r};return{version:"1.0.5",getHexFromPEM:function(p,o){return ASN1HEX.pemToHex(p,o)},getDecryptedKeyHexByKeyIV:function(p,s,r,q){var o=c(s);return o(p,r,q)},parsePKCS5PEM:function(o){return g(o)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(o,q,p){return n(o,q,p)},decryptKeyB64:function(r,p,o,q){return e(r,p,o,q)},getDecryptedKeyHex:function(y,x){var p=g(y);var s=p.type;var q=p.cipher;var o=p.ivsalt;var r=p.data;var w=n(q,x,o);var v=w.keyhex;var u=e(r,q,v,o);return u},getRSAKeyFromEncryptedPKCS5PEM:function(p,o){var q=this.getDecryptedKeyHex(p,o);var r=new RSAKey();r.readPrivateKeyFromASN1HexString(q);return r},getEncryptedPKCS5PEMFromPrvKeyHex:function(q,o,s,p){if(typeof s=="undefined"||s==null){s="AES-256-CBC"}if(typeof d[s]=="undefined"){throw"PKCS5PKEY unsupported algorithm: "+s}if(typeof p=="undefined"||p==null){var v=d[s]["ivlen"];var u=b(v);p=u.toUpperCase()}var y=n(s,o,p);var x=y.keyhex;var w=j(q,s,x,p);var A=w.replace(/(.{64})/g,"$1\r\n");var r="-----BEGIN RSA PRIVATE KEY-----\r\n";r+="Proc-Type: 4,ENCRYPTED\r\n";r+="DEK-Info: "+s+","+p+"\r\n";r+="\r\n";r+=A;r+="\r\n-----END RSA PRIVATE KEY-----\r\n";return r},getEncryptedPKCS5PEMFromRSAKey:function(s,E,x,v){var H=new Ext.asn1.DERInteger({"int":0});var p=new Ext.asn1.DERInteger({bigint:s.n});var q=new Ext.asn1.DERInteger({"int":s.e});var A=new Ext.asn1.DERInteger({bigint:s.d});var y=new Ext.asn1.DERInteger({bigint:s.p});var B=new Ext.asn1.DERInteger({bigint:s.q});var C=new Ext.asn1.DERInteger({bigint:s.dmp1});var u=new Ext.asn1.DERInteger({bigint:s.dmq1});var w=new Ext.asn1.DERInteger({bigint:s.coeff});var o=new Ext.asn1.DERSequence({array:[H,p,q,A,y,B,C,u,w]});var r=o.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex(r,E,x,v)},newEncryptedPKCS5PEM:function(u,o,r,s){if(typeof o=="undefined"||o==null){o=1024}if(typeof r=="undefined"||r==null){r="10001"}var p=new RSAKey();p.generate(o,r);var q=null;if(typeof s=="undefined"||s==null){q=this.getEncryptedPKCS5PEMFromRSAKey(pkey,u)}else{q=this.getEncryptedPKCS5PEMFromRSAKey(pkey,u,s)}return q},getRSAKeyFromPlainPKCS8PEM:function(p){if(p.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var o=ASN1HEX.pemToHex(p,"PRIVATE KEY");var q=this.getRSAKeyFromPlainPKCS8Hex(o);return q},getRSAKeyFromPlainPKCS8Hex:function(o){var p=new RSAKey();p.readPKCS8PrvKeyHex(o);return p},parseHexOfEncryptedPKCS8:function(w){var r={};var q=ASN1HEX.getPosArrayOfChildren_AtObj(w,0);if(q.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+q.length}r.ciphertext=ASN1HEX.getHexOfV_AtObj(w,q[1]);var y=ASN1HEX.getPosArrayOfChildren_AtObj(w,q[0]);if(y.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+y.length}if(ASN1HEX.getHexOfV_AtObj(w,y[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var o=ASN1HEX.getPosArrayOfChildren_AtObj(w,y[1]);if(y.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+o.length}var p=ASN1HEX.getPosArrayOfChildren_AtObj(w,o[1]);if(p.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+p.length}if(ASN1HEX.getHexOfV_AtObj(w,p[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}r.encryptionSchemeAlg="TripleDES";r.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(w,p[1]);var s=ASN1HEX.getPosArrayOfChildren_AtObj(w,o[0]);if(s.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+s.length}if(ASN1HEX.getHexOfV_AtObj(w,s[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var x=ASN1HEX.getPosArrayOfChildren_AtObj(w,s[1]);if(x.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+x.length}r.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(w,x[0]);var u=ASN1HEX.getHexOfV_AtObj(w,x[1]);try{r.pbkdf2Iter=parseInt(u,16)}catch(v){throw"malformed format pbkdf2Iter: "+u}return r},getPBKDF2KeyHexFromParam:function(s,u){var r=CryptoJS.enc.Hex.parse(s.pbkdf2Salt);var o=s.pbkdf2Iter;var q=CryptoJS.PBKDF2(u,r,{keySize:192/32,iterations:o});var p=CryptoJS.enc.Hex.stringify(q);return p},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(x,y){var q=ASN1HEX.pemToHex(x,"ENCRYPTED PRIVATE KEY");var o=this.parseHexOfEncryptedPKCS8(q);var u=PKCS5PKEY.getPBKDF2KeyHexFromParam(o,y);var v={};v.ciphertext=CryptoJS.enc.Hex.parse(o.ciphertext);var s=CryptoJS.enc.Hex.parse(u);var r=CryptoJS.enc.Hex.parse(o.encryptionSchemeIV);var w=CryptoJS.TripleDES.decrypt(v,s,{iv:r});var p=CryptoJS.enc.Hex.stringify(w);return p},getRSAKeyFromEncryptedPKCS8PEM:function(q,p){var o=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(q,p);var r=this.getRSAKeyFromPlainPKCS8Hex(o);return r},getKeyFromEncryptedPKCS8PEM:function(q,o){var r=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(q,o);var p=this.getKeyFromPlainPrivatePKCS8Hex(r);return p},parsePlainPrivatePKCS8Hex:function(q){var o={};o.algparam=null;if(q.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(p.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(q.substr(p[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var r=ASN1HEX.getPosArrayOfChildren_AtObj(q,p[1]);if(r.length!=2){throw"malformed PKCS8 private key(code:004)"}if(q.substr(r[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}o.algoid=ASN1HEX.getHexOfV_AtObj(q,r[0]);if(q.substr(r[1],2)=="06"){o.algparam=ASN1HEX.getHexOfV_AtObj(q,r[1])}if(q.substr(p[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}o.keyidx=ASN1HEX.getStartPosOfV_AtObj(q,p[2]);return o},getKeyFromPlainPrivatePKCS8PEM:function(o){var q=ASN1HEX.pemToHex(o,"PRIVATE KEY");var p=this.getKeyFromPlainPrivatePKCS8Hex(q);return p},getKeyFromPlainPrivatePKCS8Hex:function(q){var o=this.parsePlainPrivatePKCS8Hex(q);var p;if(o.algoid=="2a864886f70d010101"){p=new RSAKey()}else{if(o.algoid=="2a8648ce380401"){p=new Ext.crypto.DSA()}else{if(o.algoid=="2a8648ce3d0201"){p=new Ext.crypto.ECDSA()}else{throw"unsupported private key algorithm"}}}p.readPKCS8PrvKeyHex(q);return p},getRSAKeyFromPublicPKCS8PEM:function(o){var p=ASN1HEX.pemToHex(o,"PUBLIC KEY");var q=this.getRSAKeyFromPublicPKCS8Hex(p);return q},getKeyFromPublicPKCS8PEM:function(o){var p=ASN1HEX.pemToHex(o,"PUBLIC KEY");var q=this.getKeyFromPublicPKCS8Hex(p);return q},getKeyFromPublicPKCS8Hex:function(q){var o;var p=ASN1HEX.getVbyList(h,0,[0,0],"06");if(p==="2a864886f70d010101"){o=new RSAKey()}else{if(p==="2a8648ce380401"){o=new Ext.crypto.DSA()}else{if(p==="2a8648ce3d0201"){o=new Ext.crypto.ECDSA()}else{throw"unsupported PKCS#8 public key hex"}}}o.readPKCS8PubKeyHex(h);return o},parsePublicRawRSAKeyHex:function(p){var q={};if(p.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var o=ASN1HEX.getPosArrayOfChildren_AtObj(p,0);if(o.length!=2){throw"malformed RSA key(code:002)"}if(p.substr(o[0],2)!="02"){throw"malformed RSA key(code:003)"}q.n=ASN1HEX.getHexOfV_AtObj(p,o[0]);if(p.substr(o[1],2)!="02"){throw"malformed RSA key(code:004)"}q.e=ASN1HEX.getHexOfV_AtObj(p,o[1]);return q},parsePrivateRawRSAKeyHexAtObj:function(o,q){var p=q.keyidx;if(o.substr(p,2)!="30"){throw"malformed RSA private key(code:001)"}var r=ASN1HEX.getPosArrayOfChildren_AtObj(o,p);if(r.length!=9){throw"malformed RSA private key(code:002)"}q.key={};q.key.n=ASN1HEX.getHexOfV_AtObj(o,r[1]);q.key.e=ASN1HEX.getHexOfV_AtObj(o,r[2]);q.key.d=ASN1HEX.getHexOfV_AtObj(o,r[3]);q.key.p=ASN1HEX.getHexOfV_AtObj(o,r[4]);q.key.q=ASN1HEX.getHexOfV_AtObj(o,r[5]);q.key.dp=ASN1HEX.getHexOfV_AtObj(o,r[6]);q.key.dq=ASN1HEX.getHexOfV_AtObj(o,r[7]);q.key.co=ASN1HEX.getHexOfV_AtObj(o,r[8])},parsePrivateRawECKeyHexAtObj:function(o,q){var p=q.keyidx;if(o.substr(p,2)!="30"){throw"malformed ECC private key(code:001)"}var r=ASN1HEX.getPosArrayOfChildren_AtObj(o,p);if(r.length!=3){throw"malformed ECC private key(code:002)"}if(o.substr(r[1],2)!="04"){throw"malformed ECC private key(code:003)"}q.key=ASN1HEX.getHexOfV_AtObj(o,r[1])},parsePublicPKCS8Hex:function(r){var p={};p.algparam=null;var q=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(q.length!=2){throw"outer DERSequence shall have 2 elements: "+q.length}var s=q[0];if(r.substr(s,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var o=ASN1HEX.getPosArrayOfChildren_AtObj(r,s);if(o.length!=2){throw"malformed PKCS8 public key(code:002)"}if(r.substr(o[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}p.algoid=ASN1HEX.getHexOfV_AtObj(r,o[0]);if(r.substr(o[1],2)=="06"){p.algparam=ASN1HEX.getHexOfV_AtObj(r,o[1])}if(r.substr(q[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}p.key=ASN1HEX.getHexOfV_AtObj(r,q[1]).substr(2);return p},getRSAKeyFromPublicPKCS8Hex:function(p){var o=new RSAKey();o.readPKCS8PubKeyHex(p);return o},}}();var KEYUTIL=function(){var g=function(r,q,p){return G(CryptoJS.AES,r,q,p)};var l=function(r,q,p){return G(CryptoJS.TripleDES,r,q,p)};var i=function(r,q,p){return G(CryptoJS.DES,r,q,p)};var G=function(w,r,y,u){var v=CryptoJS.enc.Hex.parse(r);var q=CryptoJS.enc.Hex.parse(y);var s=CryptoJS.enc.Hex.parse(u);var x={};x.key=q;x.iv=s;x.ciphertext=v;var p=w.decrypt(x,q,{iv:s});return CryptoJS.enc.Hex.stringify(p)};var e=function(r,q,p){return k(CryptoJS.AES,r,q,p)};var H=function(r,q,p){return k(CryptoJS.TripleDES,r,q,p)};var n=function(r,q,p){return k(CryptoJS.DES,r,q,p)};var k=function(A,u,q,w){var y=CryptoJS.enc.Hex.parse(u);var s=CryptoJS.enc.Hex.parse(q);var v=CryptoJS.enc.Hex.parse(w);var r=A.encrypt(y,s,{iv:v});var x=CryptoJS.enc.Hex.parse(r.toString());var p=CryptoJS.enc.Base64.stringify(x);return p};var o={"AES-256-CBC":{proc:g,eproc:e,keylen:32,ivlen:16},"AES-192-CBC":{proc:g,eproc:e,keylen:24,ivlen:16},"AES-128-CBC":{proc:g,eproc:e,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:l,eproc:H,keylen:24,ivlen:8},"DES-CBC":{proc:i,eproc:n,keylen:8,ivlen:8}};var f=function(p){return o[p]["proc"]};var d=function(r){var q=CryptoJS.lib.WordArray.random(r);var p=CryptoJS.enc.Hex.stringify(q);return p};var c=function(p){var q={};var u=p.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));if(u){q.cipher=u[1];q.ivsalt=u[2]}var s=p.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));if(s){q.type=s[1]}var x=-1;var r=0;if(p.indexOf("\r\n\r\n")!=-1){x=p.indexOf("\r\n\r\n");r=2}if(p.indexOf("\n\n")!=-1){x=p.indexOf("\n\n");r=1}var w=p.indexOf("-----END");if(x!=-1&&w!=-1){var v=p.substring(x+r*2,w-r);v=v.replace(/\s+/g,"");q.data=v}return q};var m=function(q,A,r){var w=r.substring(0,16);var u=CryptoJS.enc.Hex.parse(w);var s=CryptoJS.enc.Utf8.parse(A);var x=o[q]["keylen"]+o[q]["ivlen"];var p="";var y=null;for(;;){var v=CryptoJS.algo.MD5.create();if(y!=null){v.update(y)}v.update(s);v.update(u);y=v.finalize();p=p+CryptoJS.enc.Hex.stringify(y);if(p.length>=x*2){break}}var B={};B.keyhex=p.substr(0,o[q]["keylen"]*2);B.ivhex=p.substr(o[q]["keylen"]*2,o[q]["ivlen"]*2);return B};var j=function(s,q,v,r){var w=CryptoJS.enc.Base64.parse(s);var u=CryptoJS.enc.Hex.stringify(w);var p=o[q]["proc"];var x=p(u,v,r);return x};var b=function(v,r,p,u){var q=o[r]["eproc"];var s=q(v,p,u);return s};return{version:"1.0.0",getHexFromPEM:function(q,p){return ASN1HEX.pemToHex(q,p)},getDecryptedKeyHexByKeyIV:function(q,u,s,r){var p=f(u);return p(q,s,r)},parsePKCS5PEM:function(p){return c(p)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(p,r,q){return m(p,r,q)},decryptKeyB64:function(s,q,p,r){return j(s,q,p,r)},getDecryptedKeyHex:function(u,s){var w=c(u);var A=w.type;var x=w.cipher;var v=w.ivsalt;var y=w.data;var r=m(x,s,v);var q=r.keyhex;var p=j(y,x,q,v);return p},getRSAKeyFromEncryptedPKCS5PEM:function(q,p){var r=this.getDecryptedKeyHex(q,p);var s=new RSAKey();s.readPrivateKeyFromASN1HexString(r);return s},getEncryptedPKCS5PEMFromPrvKeyHex:function(p,s,B,u,A){var q="";if(typeof u=="undefined"||u==null){u="AES-256-CBC"}if(typeof o[u]=="undefined"){throw"KEYUTIL unsupported algorithm: "+u}if(typeof A=="undefined"||A==null){var w=o[u]["ivlen"];var x=d(w);A=x.toUpperCase()}var y=m(u,B,A);var r=y.keyhex;var v=b(s,u,r,A);var C=v.replace(/(.{64})/g,"$1\r\n");var q="-----BEGIN "+p+" PRIVATE KEY-----\r\n";q+="Proc-Type: 4,ENCRYPTED\r\n";q+="DEK-Info: "+u+","+A+"\r\n";q+="\r\n";q+=C;q+="\r\n-----END "+p+" PRIVATE KEY-----\r\n";return q},getEncryptedPKCS5PEMFromRSAKey:function(A,q,p,s){var u=new Ext.asn1.DERInteger({"int":0});var E=new Ext.asn1.DERInteger({bigint:A.n});var x=new Ext.asn1.DERInteger({"int":A.e});var w=new Ext.asn1.DERInteger({bigint:A.d});var F=new Ext.asn1.DERInteger({bigint:A.p});var B=new Ext.asn1.DERInteger({bigint:A.q});var C=new Ext.asn1.DERInteger({bigint:A.dmp1});var v=new Ext.asn1.DERInteger({bigint:A.dmq1});var y=new Ext.asn1.DERInteger({bigint:A.coeff});var r=new Ext.asn1.DERSequence({array:[u,E,x,w,F,B,C,v,y]});var D=r.getEncodedHex();return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",D,q,p,s)},newEncryptedPKCS5PEM:function(v,p,s,u){if(typeof p=="undefined"||p==null){p=1024}if(typeof s=="undefined"||s==null){s="10001"}var q=new RSAKey();q.generate(p,s);var r=null;if(typeof u=="undefined"||u==null){r=this.getEncryptedPKCS5PEMFromRSAKey(q,v)}else{r=this.getEncryptedPKCS5PEMFromRSAKey(q,v,u)}return r},getRSAKeyFromPlainPKCS8PEM:function(q){if(q.match(/ENCRYPTED/)){throw"pem shall be not ENCRYPTED"}var p=ASN1HEX.pemToHex(q,"PRIVATE KEY");var r=this.getRSAKeyFromPlainPKCS8Hex(p);return r},getRSAKeyFromPlainPKCS8Hex:function(p){var q=new RSAKey();q.readPKCS8PrvKeyHex(p);return q},parseHexOfEncryptedPKCS8:function(r){var y={};var x=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(x.length!=2){throw"malformed format: SEQUENCE(0).items != 2: "+x.length}y.ciphertext=ASN1HEX.getHexOfV_AtObj(r,x[1]);var u=ASN1HEX.getPosArrayOfChildren_AtObj(r,x[0]);if(u.length!=2){throw"malformed format: SEQUENCE(0.0).items != 2: "+u.length}if(ASN1HEX.getHexOfV_AtObj(r,u[0])!="2a864886f70d01050d"){throw"this only supports pkcs5PBES2"}var v=ASN1HEX.getPosArrayOfChildren_AtObj(r,u[1]);if(u.length!=2){throw"malformed format: SEQUENCE(0.0.1).items != 2: "+v.length}var w=ASN1HEX.getPosArrayOfChildren_AtObj(r,v[1]);if(w.length!=2){throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+w.length}if(ASN1HEX.getHexOfV_AtObj(r,w[0])!="2a864886f70d0307"){throw"this only supports TripleDES"}y.encryptionSchemeAlg="TripleDES";y.encryptionSchemeIV=ASN1HEX.getHexOfV_AtObj(r,w[1]);var A=ASN1HEX.getPosArrayOfChildren_AtObj(r,v[0]);if(A.length!=2){throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+A.length}if(ASN1HEX.getHexOfV_AtObj(r,A[0])!="2a864886f70d01050c"){throw"this only supports pkcs5PBKDF2"}var s=ASN1HEX.getPosArrayOfChildren_AtObj(r,A[1]);if(s.length<2){throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+s.length}y.pbkdf2Salt=ASN1HEX.getHexOfV_AtObj(r,s[0]);var p=ASN1HEX.getHexOfV_AtObj(r,s[1]);try{y.pbkdf2Iter=parseInt(p,16)}catch(q){throw"malformed format pbkdf2Iter: "+p}return y},getPBKDF2KeyHexFromParam:function(u,v){var s=CryptoJS.enc.Hex.parse(u.pbkdf2Salt);var p=u.pbkdf2Iter;var r=CryptoJS.PBKDF2(v,s,{keySize:192/32,iterations:p});var q=CryptoJS.enc.Hex.stringify(r);return q},getPlainPKCS8HexFromEncryptedPKCS8PEM:function(s,u){var x=ASN1HEX.pemToHex(s,"ENCRYPTED PRIVATE KEY");var v=this.parseHexOfEncryptedPKCS8(x);var p=KEYUTIL.getPBKDF2KeyHexFromParam(v,u);var q={};q.ciphertext=CryptoJS.enc.Hex.parse(v.ciphertext);var A=CryptoJS.enc.Hex.parse(p);var y=CryptoJS.enc.Hex.parse(v.encryptionSchemeIV);var r=CryptoJS.TripleDES.decrypt(q,A,{iv:y});var w=CryptoJS.enc.Hex.stringify(r);return w},getRSAKeyFromEncryptedPKCS8PEM:function(r,q){var p=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(r,q);var s=this.getRSAKeyFromPlainPKCS8Hex(p);return s},getKeyFromEncryptedPKCS8PEM:function(r,p){var s=this.getPlainPKCS8HexFromEncryptedPKCS8PEM(r,p);var q=this.getKeyFromPlainPrivatePKCS8Hex(s);return q},parsePlainPrivatePKCS8Hex:function(r){var p={};p.algparam=null;if(r.substr(0,2)!="30"){throw"malformed plain PKCS8 private key(code:001)"}var q=ASN1HEX.getPosArrayOfChildren_AtObj(r,0);if(q.length!=3){throw"malformed plain PKCS8 private key(code:002)"}if(r.substr(q[1],2)!="30"){throw"malformed PKCS8 private key(code:003)"}var s=ASN1HEX.getPosArrayOfChildren_AtObj(r,q[1]);if(s.length!=2){throw"malformed PKCS8 private key(code:004)"}if(r.substr(s[0],2)!="06"){throw"malformed PKCS8 private key(code:005)"}p.algoid=ASN1HEX.getHexOfV_AtObj(r,s[0]);if(r.substr(s[1],2)=="06"){p.algparam=ASN1HEX.getHexOfV_AtObj(r,s[1])}if(r.substr(q[2],2)!="04"){throw"malformed PKCS8 private key(code:006)"}p.keyidx=ASN1HEX.getStartPosOfV_AtObj(r,q[2]);return p},getKeyFromPlainPrivatePKCS8PEM:function(p){var r=ASN1HEX.pemToHex(p,"PRIVATE KEY");var q=this.getKeyFromPlainPrivatePKCS8Hex(r);return q},getKeyFromPlainPrivatePKCS8Hex:function(r){var p=this.parsePlainPrivatePKCS8Hex(r);var q;if(p.algoid=="2a864886f70d010101"){q=new RSAKey()}else{if(p.algoid=="2a8648ce380401"){q=new Ext.crypto.DSA()}else{if(p.algoid=="2a8648ce3d0201"){q=new Ext.crypto.ECDSA()}else{throw"unsupported private key algorithm"}}}q.readPKCS8PrvKeyHex(r);return q},getRSAKeyFromPublicPKCS8PEM:function(p){var q=ASN1HEX.pemToHex(p,"PUBLIC KEY");var r=this.getRSAKeyFromPublicPKCS8Hex(q);return r},getKeyFromPublicPKCS8PEM:function(p){var q=ASN1HEX.pemToHex(p,"PUBLIC KEY");var r=this.getKeyFromPublicPKCS8Hex(q);return r},getKeyFromPublicPKCS8Hex:function(p){var r;var q=ASN1HEX.getVbyList(p,0,[0,0],"06");if(q==="2a864886f70d010101"){r=new RSAKey()}else{if(q==="2a8648ce380401"){r=new Ext.crypto.DSA()}else{if(q==="2a8648ce3d0201"){r=new Ext.crypto.ECDSA()}else{throw"unsupported PKCS#8 public key hex"}}}r.readPKCS8PubKeyHex(p);return r},parsePublicRawRSAKeyHex:function(q){var r={};if(q.substr(0,2)!="30"){throw"malformed RSA key(code:001)"}var p=ASN1HEX.getPosArrayOfChildren_AtObj(q,0);if(p.length!=2){throw"malformed RSA key(code:002)"}if(q.substr(p[0],2)!="02"){throw"malformed RSA key(code:003)"}r.n=ASN1HEX.getHexOfV_AtObj(q,p[0]);if(q.substr(p[1],2)!="02"){throw"malformed RSA key(code:004)"}r.e=ASN1HEX.getHexOfV_AtObj(q,p[1]);return r},parsePrivateRawRSAKeyHexAtObj:function(p,u){var s=ASN1HEX;var q=s.getHexOfV_AtObj;var r=s.getDecendantIndexByNthList(p,0,[2,0]);var v=s.getPosArrayOfChildren_AtObj(p,r);if(v.length!==9){throw"malformed PKCS#8 plain RSA private key"}u.key={};u.key.n=q(p,v[1]);u.key.e=q(p,v[2]);u.key.d=q(p,v[3]);u.key.p=q(p,v[4]);u.key.q=q(p,v[5]);u.key.dp=q(p,v[6]);u.key.dq=q(p,v[7]);u.key.co=q(p,v[8])},parsePrivateRawECKeyHexAtObj:function(p,u){var s=ASN1HEX;var q=u.keyidx;var r=new Ext.crypto.ECDSA();r.readPKCS8PrvKeyHex(p);u.key=r.prvKeyHex;u.pubkey=r.pubKeyHex},parsePublicPKCS8Hex:function(s){var q={};q.algparam=null;var r=ASN1HEX.getPosArrayOfChildren_AtObj(s,0);if(r.length!=2){throw"outer DERSequence shall have 2 elements: "+r.length}var u=r[0];if(s.substr(u,2)!="30"){throw"malformed PKCS8 public key(code:001)"}var p=ASN1HEX.getPosArrayOfChildren_AtObj(s,u);if(p.length!=2){throw"malformed PKCS8 public key(code:002)"}if(s.substr(p[0],2)!="06"){throw"malformed PKCS8 public key(code:003)"}q.algoid=ASN1HEX.getHexOfV_AtObj(s,p[0]);if(s.substr(p[1],2)=="06"){q.algparam=ASN1HEX.getHexOfV_AtObj(s,p[1])}else{if(s.substr(p[1],2)=="30"){q.algparam={};q.algparam.p=ASN1HEX.getVbyList(s,p[1],[0],"02");q.algparam.q=ASN1HEX.getVbyList(s,p[1],[1],"02");q.algparam.g=ASN1HEX.getVbyList(s,p[1],[2],"02")}}if(s.substr(r[1],2)!="03"){throw"malformed PKCS8 public key(code:004)"}q.key=ASN1HEX.getHexOfV_AtObj(s,r[1]).substr(2);return q},getRSAKeyFromPublicPKCS8Hex:function(q){var p=new RSAKey();p.readPKCS8PubKeyHex(q);return p},}}();KEYUTIL.getKey=function(i,f,j){if(typeof RSAKey!="undefined"&&i instanceof RSAKey){return i}if(typeof Ext.crypto.ECDSA!="undefined"&&i instanceof Ext.crypto.ECDSA){return i}if(typeof Ext.crypto.DSA!="undefined"&&i instanceof Ext.crypto.DSA){return i}if(i.curve!==undefined&&i.xy!==undefined&&i.d===undefined){return new Ext.crypto.ECDSA({pub:i.xy,curve:i.curve})}if(i.curve!==undefined&&i.d!==undefined){return new Ext.crypto.ECDSA({prv:i.d,curve:i.curve})}if(i.kty===undefined&&i.n!==undefined&&i.e!==undefined&&i.d===undefined){var w=new RSAKey();w.setPublic(i.n,i.e);return w}if(i.kty===undefined&&i.n!==undefined&&i.e!==undefined&&i.d!==undefined&&i.p!==undefined&&i.q!==undefined&&i.dp!==undefined&&i.dq!==undefined&&i.co!==undefined&&i.qi===undefined){var w=new RSAKey();w.setPrivateEx(i.n,i.e,i.d,i.p,i.q,i.dp,i.dq,i.co);return w}if(i.kty===undefined&&i.n!==undefined&&i.e!==undefined&&i.d!==undefined&&i.p===undefined){var w=new RSAKey();w.setPrivate(i.n,i.e,i.d);return w}if(i.p!==undefined&&i.q!==undefined&&i.g!==undefined&&i.y!==undefined&&i.x===undefined){var w=new Ext.crypto.DSA();w.setPublic(i.p,i.q,i.g,i.y);return w}if(i.p!==undefined&&i.q!==undefined&&i.g!==undefined&&i.y!==undefined&&i.x!==undefined){var w=new Ext.crypto.DSA();w.setPrivate(i.p,i.q,i.g,i.y,i.x);return w}if(i.kty==="RSA"&&i.n!==undefined&&i.e!==undefined&&i.d===undefined){var w=new RSAKey();w.setPublic(b64utohex(i.n),b64utohex(i.e));return w}if(i.kty==="RSA"&&i.n!==undefined&&i.e!==undefined&&i.d!==undefined&&i.p!==undefined&&i.q!==undefined&&i.dp!==undefined&&i.dq!==undefined&&i.qi!==undefined){var w=new RSAKey();w.setPrivateEx(b64utohex(i.n),b64utohex(i.e),b64utohex(i.d),b64utohex(i.p),b64utohex(i.q),b64utohex(i.dp),b64utohex(i.dq),b64utohex(i.qi));return w}if(i.kty==="RSA"&&i.n!==undefined&&i.e!==undefined&&i.d!==undefined){var w=new RSAKey();w.setPrivate(b64utohex(i.n),b64utohex(i.e),b64utohex(i.d));return w}if(i.kty==="EC"&&i.crv!==undefined&&i.x!==undefined&&i.y!==undefined&&i.d===undefined){var e=new Ext.crypto.ECDSA({curve:i.crv});var n=e.ecparams.keylen/4;var B=("0000000000"+b64utohex(i.x)).slice(-n);var s=("0000000000"+b64utohex(i.y)).slice(-n);var o="04"+B+s;e.setPublicKeyHex(o);return e}if(i.kty==="EC"&&i.crv!==undefined&&i.x!==undefined&&i.y!==undefined&&i.d!==undefined){var e=new Ext.crypto.ECDSA({curve:i.crv});var n=e.ecparams.keylen/4;var B=("0000000000"+b64utohex(i.x)).slice(-n);var s=("0000000000"+b64utohex(i.y)).slice(-n);var o="04"+B+s;var b=("0000000000"+b64utohex(i.d)).slice(-n);e.setPublicKeyHex(o);e.setPrivateKeyHex(b);return e}if(j==="pkcs5prv"){var u=i,W=ASN1HEX,D,w;D=W.getPosArrayOfChildren_AtObj(u,0);if(D.length===9){w=new RSAKey();w.readPrivateKeyFromASN1HexString(i)}else{if(D.length===6){w=new Ext.crypto.DSA();w.readPKCS5PrvKeyHex(u)}else{if(D.length>2&&u.substr(D[1],2)==="04"){w=new Ext.crypto.ECDSA();w.readPKCS5PrvKeyHex(u)}else{throw"unsupported PKCS#1/5 hexadecimal key"}}}return w}if(j==="pkcs8prv"){var w=KEYUTIL.getKeyFromPlainPrivatePKCS8Hex(i);return w}if(j==="pkcs8pub"){return KEYUTIL.getKeyFromPublicPKCS8Hex(i)}if(j==="x509pub"){return X509.getPublicKeyFromCertHex(i)}if(i.indexOf("-END CERTIFICATE-",0)!=-1||i.indexOf("-END X509 CERTIFICATE-",0)!=-1||i.indexOf("-END TRUSTED CERTIFICATE-",0)!=-1){return X509.getPublicKeyFromCertPEM(i)}if(i.indexOf("-END PUBLIC KEY-")!=-1){return KEYUTIL.getKeyFromPublicPKCS8PEM(i)}if(i.indexOf("-END RSA PRIVATE KEY-")!=-1&&i.indexOf("4,ENCRYPTED")==-1){var k=ASN1HEX.pemToHex(i,"RSA PRIVATE KEY");return KEYUTIL.getKey(k,null,"pkcs5prv")}if(i.indexOf("-END DSA PRIVATE KEY-")!=-1&&i.indexOf("4,ENCRYPTED")==-1){var X=ASN1HEX.pemToHex(i,"DSA PRIVATE KEY");var C=ASN1HEX.getVbyList(X,0,[1],"02");var v=ASN1HEX.getVbyList(X,0,[2],"02");var A=ASN1HEX.getVbyList(X,0,[3],"02");var l=ASN1HEX.getVbyList(X,0,[4],"02");var m=ASN1HEX.getVbyList(X,0,[5],"02");var w=new Ext.crypto.DSA();w.setPrivate(new BigInteger(C,16),new BigInteger(v,16),new BigInteger(A,16),new BigInteger(l,16),new BigInteger(m,16));return w}if(i.indexOf("-END PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromPlainPrivatePKCS8PEM(i)}if(i.indexOf("-END RSA PRIVATE KEY-")!=-1&&i.indexOf("4,ENCRYPTED")!=-1){return KEYUTIL.getRSAKeyFromEncryptedPKCS5PEM(i,f)}if(i.indexOf("-END EC PRIVATE KEY-")!=-1&&i.indexOf("4,ENCRYPTED")!=-1){var X=KEYUTIL.getDecryptedKeyHex(i,f);var w=ASN1HEX.getVbyList(X,0,[1],"04");var d=ASN1HEX.getVbyList(X,0,[2,0],"06");var r=ASN1HEX.getVbyList(X,0,[3,0],"03").substr(2);var c="";if(Ext.crypto.OID.oidhex2name[d]!==undefined){c=Ext.crypto.OID.oidhex2name[d]}else{throw"undefined OID(hex) in Ext.crypto.OID: "+d}var e=new Ext.crypto.ECDSA({curve:c});e.setPublicKeyHex(r);e.setPrivateKeyHex(w);e.isPublic=false;return e}if(i.indexOf("-END DSA PRIVATE KEY-")!=-1&&i.indexOf("4,ENCRYPTED")!=-1){var X=KEYUTIL.getDecryptedKeyHex(i,f);var C=ASN1HEX.getVbyList(X,0,[1],"02");var v=ASN1HEX.getVbyList(X,0,[2],"02");var A=ASN1HEX.getVbyList(X,0,[3],"02");var l=ASN1HEX.getVbyList(X,0,[4],"02");var m=ASN1HEX.getVbyList(X,0,[5],"02");var w=new Ext.crypto.DSA();w.setPrivate(new BigInteger(C,16),new BigInteger(v,16),new BigInteger(A,16),new BigInteger(l,16),new BigInteger(m,16));return w}if(i.indexOf("-END ENCRYPTED PRIVATE KEY-")!=-1){return KEYUTIL.getKeyFromEncryptedPKCS8PEM(i,f)}throw"not supported argument"};KEYUTIL.generateKeypair=function(y,c){if(y=="RSA"){var b=c;var j=new RSAKey();j.generate(b,"10001");j.isPrivate=true;j.isPublic=true;var f=new RSAKey();var d=j.n.toString(16);var i=j.e.toString(16);f.setPublic(d,i);f.isPrivate=false;f.isPublic=true;var k={};k.prvKeyObj=j;k.pubKeyObj=f;return k}else{if(y=="EC"){var e=c;var g=new Ext.crypto.ECDSA({curve:e});var x=g.generateKeyPairHex();var j=new Ext.crypto.ECDSA({curve:e});j.setPublicKeyHex(x.ecpubhex);j.setPrivateKeyHex(x.ecprvhex);j.isPrivate=true;j.isPublic=false;var f=new Ext.crypto.ECDSA({curve:e});f.setPublicKeyHex(x.ecpubhex);f.isPrivate=false;f.isPublic=true;var k={};k.prvKeyObj=j;k.pubKeyObj=f;return k}else{throw"unknown algorithm: "+y}}};KEYUTIL.getPEM=function(b,n,p,i,R){var u=Ext.asn1;var r=Ext.crypto;function o(w){var s=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:w.n}},{"int":w.e},{"int":{bigint:w.d}},{"int":{bigint:w.p}},{"int":{bigint:w.q}},{"int":{bigint:w.dmp1}},{"int":{bigint:w.dmq1}},{"int":{bigint:w.coeff}}]});return s}function T(s){var w=Ext.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:s.prvKeyHex}},{tag:["a0",true,{oid:{name:s.curveName}}]},{tag:["a1",true,{bitstr:{hex:"00"+s.pubKeyHex}}]}]});return w}function l(w){var s=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{"int":{bigint:w.p}},{"int":{bigint:w.q}},{"int":{bigint:w.g}},{"int":{bigint:w.y}},{"int":{bigint:w.x}}]});return s}if(((typeof RSAKey!="undefined"&&b instanceof RSAKey)||(typeof r.DSA!="undefined"&&b instanceof r.DSA)||(typeof r.ECDSA!="undefined"&&b instanceof r.ECDSA))&&b.isPublic==true&&(n===undefined||n=="PKCS8PUB")){var v=new Ext.asn1.x509.SubjectPublicKeyInfo(b);var S=v.getEncodedHex();return u.ASN1Util.getPEMStringFromHex(S,"PUBLIC KEY")}if(n=="PKCS1PRV"&&typeof RSAKey!="undefined"&&b instanceof RSAKey&&(p===undefined||p==null)&&b.isPrivate==true){var v=o(b);var S=v.getEncodedHex();return u.ASN1Util.getPEMStringFromHex(S,"RSA PRIVATE KEY")}if(n=="PKCS1PRV"&&typeof RSAKey!="undefined"&&b instanceof Ext.crypto.ECDSA&&(p===undefined||p==null)&&b.isPrivate==true){var g=new Ext.asn1.DERObjectIdentifier({name:b.curveName});var m=g.getEncodedHex();var f=T(b);var k=f.getEncodedHex();var q="";q+=u.ASN1Util.getPEMStringFromHex(m,"EC PARAMETERS");q+=u.ASN1Util.getPEMStringFromHex(k,"EC PRIVATE KEY");return q}if(n=="PKCS1PRV"&&typeof Ext.crypto.DSA!="undefined"&&b instanceof Ext.crypto.DSA&&(p===undefined||p==null)&&b.isPrivate==true){var v=l(b);var S=v.getEncodedHex();return u.ASN1Util.getPEMStringFromHex(S,"DSA PRIVATE KEY")}if(n=="PKCS5PRV"&&typeof RSAKey!="undefined"&&b instanceof RSAKey&&(p!==undefined&&p!=null)&&b.isPrivate==true){var v=o(b);var S=v.getEncodedHex();if(i===undefined){i="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",S,p,i)}if(n=="PKCS5PRV"&&typeof Ext.crypto.ECDSA!="undefined"&&b instanceof Ext.crypto.ECDSA&&(p!==undefined&&p!=null)&&b.isPrivate==true){var v=T(b);var S=v.getEncodedHex();if(i===undefined){i="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",S,p,i)}if(n=="PKCS5PRV"&&typeof Ext.crypto.DSA!="undefined"&&b instanceof Ext.crypto.DSA&&(p!==undefined&&p!=null)&&b.isPrivate==true){var v=l(b);var S=v.getEncodedHex();if(i===undefined){i="DES-EDE3-CBC"}return this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",S,p,i)}var j=function(y,x){var w=c(y,x);var s=new Ext.asn1.ASN1Util.newObject({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:w.pbkdf2Salt}},{"int":w.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:w.encryptionSchemeIV}}]}]}]},{octstr:{hex:w.ciphertext}}]});return s.getEncodedHex()};var c=function(B,C){var E=100;var A=CryptoJS.lib.WordArray.random(8);var y="DES-EDE3-CBC";var s=CryptoJS.lib.WordArray.random(8);var F=CryptoJS.PBKDF2(C,A,{keySize:192/32,iterations:E});var w=CryptoJS.enc.Hex.parse(B);var x=CryptoJS.TripleDES.encrypt(w,F,{iv:s})+"";var D={};D.ciphertext=x;D.pbkdf2Salt=CryptoJS.enc.Hex.stringify(A);D.pbkdf2Iter=E;D.encryptionSchemeAlg=y;D.encryptionSchemeIV=CryptoJS.enc.Hex.stringify(s);return D};if(n=="PKCS8PRV"&&typeof RSAKey!="undefined"&&b instanceof RSAKey&&b.isPrivate==true){var e=o(b);var d=e.getEncodedHex();var v=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"rsaEncryption"}},{"null":true}]},{octstr:{hex:d}}]});var S=v.getEncodedHex();if(p===undefined||p==null){return u.ASN1Util.getPEMStringFromHex(S,"PRIVATE KEY")}else{var k=j(S,p);return u.ASN1Util.getPEMStringFromHex(k,"ENCRYPTED PRIVATE KEY")}}if(n=="PKCS8PRV"&&typeof Ext.crypto.ECDSA!="undefined"&&b instanceof Ext.crypto.ECDSA&&b.isPrivate==true){var e=new Ext.asn1.ASN1Util.newObject({seq:[{"int":1},{octstr:{hex:b.prvKeyHex}},{tag:["a1",true,{bitstr:{hex:"00"+b.pubKeyHex}}]}]});var d=e.getEncodedHex();var v=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:b.curveName}}]},{octstr:{hex:d}}]});var S=v.getEncodedHex();if(p===undefined||p==null){return u.ASN1Util.getPEMStringFromHex(S,"PRIVATE KEY")}else{var k=j(S,p);return u.ASN1Util.getPEMStringFromHex(k,"ENCRYPTED PRIVATE KEY")}}if(n=="PKCS8PRV"&&typeof Ext.crypto.DSA!="undefined"&&b instanceof Ext.crypto.DSA&&b.isPrivate==true){var e=new Ext.asn1.DERInteger({bigint:b.x});var d=e.getEncodedHex();var v=Ext.asn1.ASN1Util.newObject({seq:[{"int":0},{seq:[{oid:{name:"dsa"}},{seq:[{"int":{bigint:b.p}},{"int":{bigint:b.q}},{"int":{bigint:b.g}}]}]},{octstr:{hex:d}}]});var S=v.getEncodedHex();if(p===undefined||p==null){return u.ASN1Util.getPEMStringFromHex(S,"PRIVATE KEY")}else{var k=j(S,p);return u.ASN1Util.getPEMStringFromHex(k,"ENCRYPTED PRIVATE KEY")}}throw"unsupported object nor format"};KEYUTIL.getKeyFromCSRPEM=function(c){var b=ASN1HEX.pemToHex(c,"CERTIFICATE REQUEST");var g=KEYUTIL.getKeyFromCSRHex(b);return g};KEYUTIL.getKeyFromCSRHex=function(b){var g=KEYUTIL.parseCSRHex(b);var c=KEYUTIL.getKey(g.p8pubkeyhex,null,"pkcs8pub");return c};KEYUTIL.parseCSRHex=function(c){var b={};var e=c;if(e.substr(0,2)!="30"){throw"malformed CSR(code:001)"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);if(d.length<1){throw"malformed CSR(code:002)"}if(e.substr(d[0],2)!="30"){throw"malformed CSR(code:003)"}var l=ASN1HEX.getPosArrayOfChildren_AtObj(e,d[0]);if(l.length<3){throw"malformed CSR(code:004)"}b.p8pubkeyhex=ASN1HEX.getHexOfTLV_AtObj(e,l[2]);return b};KEYUTIL.getJWKFromKey=function(j){var c={};if(j instanceof RSAKey&&j.isPrivate){c.kty="RSA";c.n=hextob64u(j.n.toString(16));c.e=hextob64u(j.e.toString(16));c.d=hextob64u(j.d.toString(16));c.p=hextob64u(j.p.toString(16));c.q=hextob64u(j.q.toString(16));c.dp=hextob64u(j.dmp1.toString(16));c.dq=hextob64u(j.dmq1.toString(16));c.qi=hextob64u(j.coeff.toString(16));return c}else{if(j instanceof RSAKey&&j.isPublic){c.kty="RSA";c.n=hextob64u(j.n.toString(16));c.e=hextob64u(j.e.toString(16));return c}else{if(j instanceof Ext.crypto.ECDSA&&j.isPrivate){var b=j.getShortNISTPCurveName();if(b!=="P-256"&&b!=="P-384"){throw"unsupported curve name for JWT: "+b}var d=j.getPublicKeyXYHex();c.kty="EC";c.crv=b;c.x=hextob64u(d.x);c.y=hextob64u(d.y);c.d=hextob64u(j.prvKeyHex);return c}else{if(j instanceof Ext.crypto.ECDSA&&j.isPublic){var b=j.getShortNISTPCurveName();if(b!=="P-256"&&b!=="P-384"){throw"unsupported curve name for JWT: "+b}var d=j.getPublicKeyXYHex();c.kty="EC";c.crv=b;c.x=hextob64u(d.x);c.y=hextob64u(d.y);return c}}}}throw"not supported key object"};RSAKey.pemToBase64=function(e){var b=e;b=b.replace("-----BEGIN RSA PRIVATE KEY-----","");b=b.replace("-----END RSA PRIVATE KEY-----","");b=b.replace(/[ \n]+/g,"");return b};RSAKey.getPosArrayOfChildrenFromHex=function(d){var b=new Array();var g=ASN1HEX.getStartPosOfV_AtObj(d,0);var l=ASN1HEX.getPosOfNextSibling_AtObj(d,g);var c=ASN1HEX.getPosOfNextSibling_AtObj(d,l);var f=ASN1HEX.getPosOfNextSibling_AtObj(d,c);var k=ASN1HEX.getPosOfNextSibling_AtObj(d,f);var i=ASN1HEX.getPosOfNextSibling_AtObj(d,k);var y=ASN1HEX.getPosOfNextSibling_AtObj(d,i);var e=ASN1HEX.getPosOfNextSibling_AtObj(d,y);var j=ASN1HEX.getPosOfNextSibling_AtObj(d,e);b.push(g,l,c,f,k,i,y,e,j);return b};RSAKey.getHexValueArrayOfChildrenFromHex=function(f){var d=RSAKey.getPosArrayOfChildrenFromHex(f);var e=ASN1HEX.getHexOfV_AtObj(f,d[0]);var k=ASN1HEX.getHexOfV_AtObj(f,d[1]);var b=ASN1HEX.getHexOfV_AtObj(f,d[2]);var c=ASN1HEX.getHexOfV_AtObj(f,d[3]);var l=ASN1HEX.getHexOfV_AtObj(f,d[4]);var j=ASN1HEX.getHexOfV_AtObj(f,d[5]);var m=ASN1HEX.getHexOfV_AtObj(f,d[6]);var i=ASN1HEX.getHexOfV_AtObj(f,d[7]);var B=ASN1HEX.getHexOfV_AtObj(f,d[8]);var g=new Array();g.push(e,k,b,c,l,j,m,i,B);return g};RSAKey.prototype.readPrivateKeyFromPEMString=function(b){var d=RSAKey.pemToBase64(b);var e=b64tohex(d);var c=RSAKey.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])};RSAKey.prototype.readPrivateKeyFromASN1HexString=function(c){this.readPKCS5PrvKeyHex(c)};RSAKey.prototype.readPKCS5PrvKeyHex=function(b){var c=RSAKey.getHexValueArrayOfChildrenFromHex(b);this.setPrivateEx(c[1],c[2],c[3],c[4],c[5],c[6],c[7],c[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function(f){var d,k,m,c,b,j,l,e;var B=ASN1HEX;var i=B.getVbyList;if(B.isASN1HEX(f)===false){throw"not ASN.1 hex string"}try{d=i(f,0,[2,0,1],"02");k=i(f,0,[2,0,2],"02");m=i(f,0,[2,0,3],"02");c=i(f,0,[2,0,4],"02");b=i(f,0,[2,0,5],"02");j=i(f,0,[2,0,6],"02");l=i(f,0,[2,0,7],"02");e=i(f,0,[2,0,8],"02")}catch(g){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(d,k,m,c,b,j,l,e)};RSAKey.prototype.readPKCS5PubKeyHex=function(c){if(ASN1HEX.isASN1HEX(c)===false){throw"keyHex is not ASN.1 hex string"}var b=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(b.length!==2||c.substr(b[0],2)!=="02"||c.substr(b[1],2)!=="02"){throw"wrong hex for PKCS#5 public key"}var j=ASN1HEX.getHexOfV_AtObj(c,b[0]);var d=ASN1HEX.getHexOfV_AtObj(c,b[1]);this.setPublic(j,d)};RSAKey.prototype.readPKCS8PubKeyHex=function(e){if(ASN1HEX.isASN1HEX(e)===false){throw"not ASN.1 hex string"}if(ASN1HEX.getDecendantHexTLVByNthList(e,0,[0,0])!=="06092a864886f70d010101"){throw"not PKCS8 RSA public key"}var b=ASN1HEX.getDecendantHexTLVByNthList(e,0,[1,0]);this.readPKCS5PubKeyHex(b)};RSAKey.prototype.readCertPubKeyHex=function(c,g){if(g!==5){g=6}if(ASN1HEX.isASN1HEX(c)===false){throw"not ASN.1 hex string"}var b=ASN1HEX.getDecendantHexTLVByNthList(c,0,[0,g]);this.readPKCS8PubKeyHex(b)};var _RE_HEXDECONLY=new RegExp("");_RE_HEXDECONLY.compile("[^0-9a-f]","gi");function _rsasign_getHexPaddedDigestInfoForString(d,e,l){var b=function(f){return Ext.crypto.Util.hashString(f,l)};var c=b(d);return Ext.crypto.Util.getPaddedDigestInfoHex(c,l,e)}function _zeroPaddingOfSignature(e,d){var c="";var l=d/4-e.length;for(var b=0;b<l;b++){c=c+"0"}return c+e}function _rsasign_signString(j,b){var c=function(e){return Ext.crypto.Util.hashString(e,b)};var d=c(j);return this.signWithMessageHash(d,b)}function _rsasign_signWithMessageHash(d,b){var e=Ext.crypto.Util.getPaddedDigestInfoHex(d,b,this.n.bitLength());var n=parseBigInt(e,16);var c=this.doPrivate(n);var f=c.toString(16);return _zeroPaddingOfSignature(f,this.n.bitLength())}function _rsasign_signStringWithSHA1(c){return _rsasign_signString.call(this,c,"sha1")}function _rsasign_signStringWithSHA256(c){return _rsasign_signString.call(this,c,"sha256")}function pss_mgf1_str(c,l,e){var b="",d=0;while(b.length<l){b+=hextorstr(e(rstrtohex(c+String.fromCharCode.apply(String,[(d&4278190080)>>24,(d&16711680)>>16,(d&65280)>>8,d&255]))));d+=1}return b}function _rsasign_signStringPSS(e,l,d){var c=function(f){return Ext.crypto.Util.hashHex(f,l)};var b=c(rstrtohex(e));if(d===undefined){d=-1}return this.signWithMessageHashPSS(b,l,d)}function _rsasign_signWithMessageHashPSS(l,J,k){var o=hextorstr(l);var g=o.length;var c=this.n.bitLength()-1;var d=Math.ceil(c/8);var p;var I=function(i){return Ext.crypto.Util.hashHex(i,J)};if(k===-1||k===undefined){k=g}else{if(k===-2){k=d-g-2}else{if(k<-2){throw"invalid salt length"}}}if(d<(g+k+2)){throw"data too long"}var f="";if(k>0){f=new Array(k);new SecureRandom().nextBytes(f);f=String.fromCharCode.apply(String,f)}var n=hextorstr(I(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+o+f)));var j=[];for(p=0;p<d-k-g-2;p+=1){j[p]=0}var m=String.fromCharCode.apply(String,j)+"\x01"+f;var q=pss_mgf1_str(n,m.length,I);var b=[];for(p=0;p<m.length;p+=1){b[p]=m.charCodeAt(p)^q.charCodeAt(p)}var e=(65280>>(8*d-c))&255;b[0]&=~e;for(p=0;p<g;p++){b.push(n.charCodeAt(p))}b.push(188);return _zeroPaddingOfSignature(this.doPrivate(new BigInteger(b)).toString(16),this.n.bitLength())}function _rsasign_getDecryptSignatureBI(l,d,c){var b=new RSAKey();b.setPublic(d,c);var e=b.doPublic(l);return e}function _rsasign_getHexDigestInfoFromSig(l,c,b){var e=_rsasign_getDecryptSignatureBI(l,c,b);var d=e.toString(16).replace(/^1f+00/,"");return d}function _rsasign_getAlgNameAndHashFromHexDisgestInfo(f){for(var e in Ext.crypto.Util.DIGESTINFOHEAD){var d=Ext.crypto.Util.DIGESTINFOHEAD[e];var b=d.length;if(f.substring(0,b)==d){var c=[e,f.substring(b)];return c}}return[]}function _rsasign_verifySignatureWithArgs(e,w,f,j){var d=_rsasign_getHexDigestInfoFromSig(w,f,j);var g=_rsasign_getAlgNameAndHashFromHexDisgestInfo(d);if(g.length==0){return false}var c=g[0];var i=g[1];var v=function(k){return Ext.crypto.Util.hashString(k,c)};var b=v(e);return(i==b)}function _rsasign_verifyHexSignatureForMessage(d,c){var j=parseBigInt(d,16);var b=_rsasign_verifySignatureWithArgs(c,j,this.n.toString(16),this.e.toString(16));return b}function _rsasign_verifyString(e,j){j=j.replace(_RE_HEXDECONLY,"");j=j.replace(/[ \n]+/g,"");var w=parseBigInt(j,16);if(w.bitLength()>this.n.bitLength()){return 0}var i=this.doPublic(w);var d=i.toString(16).replace(/^1f+00/,"");var f=_rsasign_getAlgNameAndHashFromHexDisgestInfo(d);if(f.length==0){return false}var c=f[0];var g=f[1];var v=function(k){return Ext.crypto.Util.hashString(k,c)};var b=v(e);return(g==b)}function _rsasign_verifyWithMessageHash(f,b){b=b.replace(_RE_HEXDECONLY,"");b=b.replace(/[ \n]+/g,"");var q=parseBigInt(b,16);if(q.bitLength()>this.n.bitLength()){return 0}var d=this.doPublic(q);var c=d.toString(16).replace(/^1f+00/,"");var g=_rsasign_getAlgNameAndHashFromHexDisgestInfo(c);if(g.length==0){return false}var r=g[0];var e=g[1];return(e==f)}function _rsasign_verifyStringPSS(b,n,f,e){var d=function(g){return Ext.crypto.Util.hashHex(g,f)};var c=d(rstrtohex(b));if(e===undefined){e=-1}return this.verifyWithMessageHashPSS(c,n,f,e)}function _rsasign_verifyWithMessageHashPSS(q,N,j,d){var s=new BigInteger(N,16);if(s.bitLength()>this.n.bitLength()){return false}var o=function(i){return Ext.crypto.Util.hashHex(i,j)};var g=hextorstr(q);var r=g.length;var f=this.n.bitLength()-1;var M=Math.ceil(f/8);var n;if(d===-1||d===undefined){d=r}else{if(d===-2){d=M-r-2}else{if(d<-2){throw"invalid salt length"}}}if(M<(r+d+2)){throw"data too long"}var b=this.doPublic(s).toByteArray();for(n=0;n<b.length;n+=1){b[n]&=255}while(b.length<M){b.unshift(0)}if(b[M-1]!==188){throw"encoded message does not end in 0xbc"}b=String.fromCharCode.apply(String,b);var p=b.substr(0,M-r-1);var e=b.substr(p.length,r);var m=(65280>>(8*M-f))&255;if((p.charCodeAt(0)&m)!==0){throw"bits beyond keysize not zero"}var k=pss_mgf1_str(e,p.length,o);var l=[];for(n=0;n<p.length;n+=1){l[n]=p.charCodeAt(n)^k.charCodeAt(n)}l[0]&=~m;var c=M-r-d-2;for(n=0;n<c;n+=1){if(l[n]!==0){throw"leftmost octets not zero"}}if(l[c]!==1){throw"0x01 marker not found"}return e===hextorstr(o(rstrtohex("\x00\x00\x00\x00\x00\x00\x00\x00"+g+String.fromCharCode.apply(String,l.slice(-d)))))}RSAKey.prototype.signWithMessageHash=_rsasign_signWithMessageHash;RSAKey.prototype.signString=_rsasign_signString;RSAKey.prototype.signStringWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signStringWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.sign=_rsasign_signString;RSAKey.prototype.signWithSHA1=_rsasign_signStringWithSHA1;RSAKey.prototype.signWithSHA256=_rsasign_signStringWithSHA256;RSAKey.prototype.signWithMessageHashPSS=_rsasign_signWithMessageHashPSS;RSAKey.prototype.signStringPSS=_rsasign_signStringPSS;RSAKey.prototype.signPSS=_rsasign_signStringPSS;RSAKey.SALT_LEN_HLEN=-1;RSAKey.SALT_LEN_MAX=-2;RSAKey.prototype.verifyWithMessageHash=_rsasign_verifyWithMessageHash;RSAKey.prototype.verifyString=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verify=_rsasign_verifyString;RSAKey.prototype.verifyHexSignatureForByteArrayMessage=_rsasign_verifyHexSignatureForMessage;RSAKey.prototype.verifyWithMessageHashPSS=_rsasign_verifyWithMessageHashPSS;RSAKey.prototype.verifyStringPSS=_rsasign_verifyStringPSS;RSAKey.prototype.verifyPSS=_rsasign_verifyStringPSS;RSAKey.SALT_LEN_RECOVER=-2;function X509(){this.subjectPublicKeyRSA=null;this.subjectPublicKeyRSA_hN=null;this.subjectPublicKeyRSA_hE=null;this.hex=null;this.getSerialNumberHex=function(){return ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,1])};this.getSignatureAlgorithmField=function(){var c=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,2,0]);var b=Ext.asn1.ASN1Util.oidHexToInt(c);var g=Ext.asn1.x509.OID.oid2name(b);return g};this.getIssuerHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3])};this.getIssuerString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,3]))};this.getSubjectHex=function(){return ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5])};this.getSubjectString=function(){return X509.hex2dn(ASN1HEX.getDecendantHexTLVByNthList(this.hex,0,[0,5]))};this.getNotBefore=function(){var c=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,0]);c=c.replace(/(..)/g,"%$1");c=decodeURIComponent(c);return c};this.getNotAfter=function(){var c=ASN1HEX.getDecendantHexVByNthList(this.hex,0,[0,4,1]);c=c.replace(/(..)/g,"%$1");c=decodeURIComponent(c);return c};this.readCertPEM=function(d){var b=ASN1HEX.pemToHex(d);var c=X509.getPublicKeyHexArrayFromCertHex(b);var e=new RSAKey();e.setPublic(c[0],c[1]);this.subjectPublicKeyRSA=e;this.subjectPublicKeyRSA_hN=c[0];this.subjectPublicKeyRSA_hE=c[1];this.hex=b};this.readCertPEMWithoutRSAInit=function(d){var b=ASN1HEX.pemToHex(d);var c=X509.getPublicKeyHexArrayFromCertHex(b);if(typeof this.subjectPublicKeyRSA.setPublic==="function"){this.subjectPublicKeyRSA.setPublic(c[0],c[1])}this.subjectPublicKeyRSA_hN=c[0];this.subjectPublicKeyRSA_hE=c[1];this.hex=b};this.getInfo=function(){var H="Basic Fields\n";H+="  serial number: "+this.getSerialNumberHex()+"\n";H+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n";H+="  issuer: "+this.getIssuerString()+"\n";H+="  notBefore: "+this.getNotBefore()+"\n";H+="  notAfter: "+this.getNotAfter()+"\n";H+="  subject: "+this.getSubjectString()+"\n";H+="  subject public key info: \n";var G=X509.getSubjectPublicKeyInfoPosFromCertHex(this.hex);var e=ASN1HEX.getHexOfTLV_AtObj(this.hex,G);var g=KEYUTIL.getKey(e,null,"pkcs8pub");if(g instanceof RSAKey){H+="    key algorithm: RSA\n";H+="    n="+g.n.toString(16).substr(0,16)+"...\n";H+="    e="+g.e.toString(16)+"\n"}H+="X509v3 Extensions:\n";var p=X509.getV3ExtInfoListOfCertHex(this.hex);for(var o=0;o<p.length;o++){var j=p[o];var l=Ext.asn1.x509.OID.oid2name(j.oid);if(l===""){l=j.oid}var d="";if(j.critical===true){d="CRITICAL"}H+="  "+l+" "+d+":\n";if(l==="basicConstraints"){var c=X509.getExtBasicConstraints(this.hex);if(c.cA===undefined){H+="    {}\n"}else{H+="    cA=true";if(c.pathLen!==undefined){H+=", pathLen="+c.pathLen}H+="\n"}}else{if(l==="keyUsage"){H+="    "+X509.getExtKeyUsageString(this.hex)+"\n"}else{if(l==="subjectKeyIdentifier"){H+="    "+X509.getExtSubjectKeyIdentifier(this.hex)+"\n"}else{if(l==="authorityKeyIdentifier"){var m=X509.getExtAuthorityKeyIdentifier(this.hex);if(m.kid!==undefined){H+="    kid="+m.kid+"\n"}}else{if(l==="extKeyUsage"){var k=X509.getExtExtKeyUsageName(this.hex);H+="    "+k.join(", ")+"\n"}else{if(l==="subjectAltName"){var f=X509.getExtSubjectAltName(this.hex);H+="    "+f.join(", ")+"\n"}else{if(l==="cRLDistributionPoints"){var n=X509.getExtCRLDistributionPointsURI(this.hex);H+="    "+n+"\n"}else{if(l==="authorityInfoAccess"){var b=X509.getExtAIAInfo(this.hex);if(b.ocsp!==undefined){H+="    ocsp: "+b.ocsp.join(",")+"\n"}if(b.caissuer!==undefined){H+="    caissuer: "+b.caissuer.join(",")+"\n"}}}}}}}}}}H+="signature algorithm: "+X509.getSignatureAlgorithmName(this.hex)+"\n";H+="signature: "+X509.getSignatureValueHex(this.hex).substr(0,16)+"...\n";return H}}X509.pemToBase64=function(b){var e=b;e=e.replace("-----BEGIN CERTIFICATE-----","");e=e.replace("-----END CERTIFICATE-----","");e=e.replace(/[ \n]+/g,"");return e};X509.pemToHex=function(c){return ASN1HEX.pemToHex(c)};X509.getSubjectPublicKeyPosFromCertHex=function(f){var e=X509.getSubjectPublicKeyInfoPosFromCertHex(f);if(e==-1){return -1}var b=ASN1HEX.getPosArrayOfChildren_AtObj(f,e);if(b.length!=2){return -1}var d=b[1];if(f.substring(d,d+2)!="03"){return -1}var c=ASN1HEX.getStartPosOfV_AtObj(f,d);if(f.substring(c,c+2)!="00"){return -1}return c+2};X509.getSubjectPublicKeyInfoPosFromCertHex=function(b){var d=ASN1HEX.getStartPosOfV_AtObj(b,0);var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,d);if(c.length<1){return -1}if(b.substring(c[0],c[0]+10)=="a003020102"){if(c.length<6){return -1}return c[6]}else{if(c.length<5){return -1}return c[5]}};X509.getPublicKeyHexArrayFromCertHex=function(f){var e=X509.getSubjectPublicKeyPosFromCertHex(f);var b=ASN1HEX.getPosArrayOfChildren_AtObj(f,e);if(b.length!=2){return[]}var d=ASN1HEX.getHexOfV_AtObj(f,b[0]);var c=ASN1HEX.getHexOfV_AtObj(f,b[1]);if(d!=null&&c!=null){return[d,c]}else{return[]}};X509.getHexTbsCertificateFromCert=function(e){var b=ASN1HEX.getStartPosOfV_AtObj(e,0);return b};X509.getPublicKeyHexArrayFromCertPEM=function(d){var b=ASN1HEX.pemToHex(d);var c=X509.getPublicKeyHexArrayFromCertHex(b);return c};X509.hex2dn=function(f,b){if(b===undefined){b=0}if(f.substr(b,2)!=="30"){throw"malformed DN"}var c=new Array();var d=ASN1HEX.getPosArrayOfChildren_AtObj(f,b);for(var e=0;e<d.length;e++){c.push(X509.hex2rdn(f,d[e]))}c=c.map(function(g){return g.replace("/","\\/")});return"/"+c.join("/")};X509.hex2rdn=function(f,b){if(b===undefined){b=0}if(f.substr(b,2)!=="31"){throw"malformed RDN"}var c=new Array();var d=ASN1HEX.getPosArrayOfChildren_AtObj(f,b);for(var e=0;e<d.length;e++){c.push(X509.hex2attrTypeValue(f,d[e]))}c=c.map(function(g){return g.replace("+","\\+")});return c.join("+")};X509.hex2attrTypeValue=function(b,f){if(f===undefined){f=0}if(b.substr(f,2)!=="30"){throw"malformed attribute type and value"}var q=ASN1HEX.getPosArrayOfChildren_AtObj(b,f);if(q.length!==2||b.substr(q[0],2)!=="06"){"malformed attribute type and value"}var g=ASN1HEX.getHexOfV_AtObj(b,q[0]);var d=Ext.asn1.ASN1Util.oidHexToInt(g);var c=Ext.asn1.x509.OID.oid2atype(d);var e=ASN1HEX.getHexOfV_AtObj(b,q[1]);var r=hextorstr(e);return c+"="+r};X509.getPublicKeyFromCertHex=function(b){var f,d,p;var e=6;var c=ASN1HEX;var g=c.getVbyList;p=c.getDecendantHexTLVByNthList(b,0,[0,0]);if(p!=="a003020102"){e=5}d=g(b,0,[0,e,0,0],"06");if(d==="2a864886f70d010101"){f=new RSAKey()}else{if(d==="2a8648ce380401"){f=new Ext.crypto.DSA()}else{if(d==="2a8648ce3d0201"){f=new Ext.crypto.ECDSA()}else{throw"unsupported public key in X.509 cert"}}}f.readCertPubKeyHex(b,e);return f};X509.getPublicKeyFromCertPEM=function(b){var g=ASN1HEX;var c=g.pemToHex(b);return X509.getPublicKeyFromCertHex(c)};X509.getPublicKeyInfoPropOfCertPEM=function(b){var f={};f.algparam=null;var c=ASN1HEX.pemToHex(b);var u=ASN1HEX.getPosArrayOfChildren_AtObj(c,0);if(u.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(c.substr(u[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var s=ASN1HEX.getPosArrayOfChildren_AtObj(c,u[0]);var d=6;if(c.substr(s[0],2)!=="a0"){d=5}if(s.length<d+1){throw"malformed X.509 certificate PEM (code:003)"}var g=ASN1HEX.getPosArrayOfChildren_AtObj(c,s[d]);if(g.length!=2){throw"malformed X.509 certificate PEM (code:004)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(c,g[0]);if(e.length!=2){throw"malformed X.509 certificate PEM (code:005)"}f.algoid=ASN1HEX.getHexOfV_AtObj(c,e[0]);if(c.substr(e[1],2)=="06"){f.algparam=ASN1HEX.getHexOfV_AtObj(c,e[1])}else{if(c.substr(e[1],2)=="30"){f.algparam=ASN1HEX.getHexOfTLV_AtObj(c,e[1])}}if(c.substr(g[1],2)!="03"){throw"malformed X.509 certificate PEM (code:006)"}var i=ASN1HEX.getHexOfV_AtObj(c,g[1]);f.keyhex=i.substr(2);return f};X509.getPublicKeyInfoPosOfCertHEX=function(g){var c=ASN1HEX.getPosArrayOfChildren_AtObj(g,0);if(c.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(g.substr(c[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var b=ASN1HEX.getPosArrayOfChildren_AtObj(g,c[0]);if(b.length<7){throw"malformed X.509 certificate PEM (code:003)"}return b[6]};X509.getV3ExtInfoListOfCertHex=function(b){var f=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);if(f.length!=3){throw"malformed X.509 certificate PEM (code:001)"}if(b.substr(f[0],2)!="30"){throw"malformed X.509 certificate PEM (code:002)"}var c=ASN1HEX.getPosArrayOfChildren_AtObj(b,f[0]);if(c.length<8){throw"malformed X.509 certificate PEM (code:003)"}if(b.substr(c[7],2)!="a3"){throw"malformed X.509 certificate PEM (code:004)"}var d=ASN1HEX.getPosArrayOfChildren_AtObj(b,c[7]);if(d.length!=1){throw"malformed X.509 certificate PEM (code:005)"}if(b.substr(d[0],2)!="30"){throw"malformed X.509 certificate PEM (code:006)"}var e=ASN1HEX.getPosArrayOfChildren_AtObj(b,d[0]);var q=e.length;var g=new Array(q);for(var r=0;r<q;r++){g[r]=X509.getV3ExtItemInfo_AtObj(b,e[r])}return g};X509.getV3ExtItemInfo_AtObj=function(b,c){var g={};g.posTLV=c;var d=ASN1HEX.getPosArrayOfChildren_AtObj(b,c);if(d.length!=2&&d.length!=3){throw"malformed X.509v3 Ext (code:001)"}if(b.substr(d[0],2)!="06"){throw"malformed X.509v3 Ext (code:002)"}var f=ASN1HEX.getHexOfV_AtObj(b,d[0]);g.oid=ASN1HEX.hextooidstr(f);g.critical=false;if(d.length==3){g.critical=true}var e=d[d.length-1];if(b.substr(e,2)!="04"){throw"malformed X.509v3 Ext (code:003)"}g.posV=ASN1HEX.getStartPosOfV_AtObj(b,e);return g};X509.getHexOfTLV_V3ExtValue=function(c,b){var g=X509.getPosOfTLV_V3ExtValue(c,b);if(g==-1){return null}return ASN1HEX.getHexOfTLV_AtObj(c,g)};X509.getHexOfV_V3ExtValue=function(c,b){var g=X509.getPosOfTLV_V3ExtValue(c,b);if(g==-1){return null}return ASN1HEX.getHexOfV_AtObj(c,g)};X509.getPosOfTLV_V3ExtValue=function(e,n){var b=n;if(!n.match(/^[0-9.]+$/)){b=Ext.asn1.x509.OID.name2oid(n)}if(b==""){return -1}var c=X509.getV3ExtInfoListOfCertHex(e);for(var f=0;f<c.length;f++){var d=c[f];if(d.oid==b){return d.posV}}return -1};X509.getExtBasicConstraints=function(j){var b=X509.getHexOfV_V3ExtValue(j,"basicConstraints");if(b===null){return null}if(b===""){return{}}if(b==="0101ff"){return{cA:true}}if(b.substr(0,8)==="0101ff02"){var d=ASN1HEX.getHexOfV_AtObj(b,6);var c=parseInt(d,16);return{cA:true,pathLen:c}}throw"unknown error"};X509.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"];X509.getExtKeyUsageBin=function(j){var c=X509.getHexOfV_V3ExtValue(j,"keyUsage");if(c==""){return""}if(c.length%2!=0||c.length<=2){throw"malformed key usage value"}var b=parseInt(c.substr(0,2));var d=parseInt(c.substr(2),16).toString(2);return d.substr(0,d.length-b)};X509.getExtKeyUsageString=function(b){var e=X509.getExtKeyUsageBin(b);var c=new Array();for(var d=0;d<e.length;d++){if(e.substr(d,1)=="1"){c.push(X509.KEYUSAGE_NAME[d])}}return c.join(",")};X509.getExtSubjectKeyIdentifier=function(e){var b=X509.getHexOfV_V3ExtValue(e,"subjectKeyIdentifier");return b};X509.getExtAuthorityKeyIdentifier=function(f){var b={};var e=X509.getHexOfTLV_V3ExtValue(f,"authorityKeyIdentifier");if(e===null){return null}var c=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);for(var d=0;d<c.length;d++){if(e.substr(c[d],2)==="80"){b.kid=ASN1HEX.getHexOfV_AtObj(e,c[d])}}return b};X509.getExtExtKeyUsageName=function(g){var j=new Array();var d=X509.getHexOfTLV_V3ExtValue(g,"extKeyUsage");if(d===null){return null}var k=ASN1HEX.getPosArrayOfChildren_AtObj(d,0);for(var c=0;c<k.length;c++){var f=ASN1HEX.getHexOfV_AtObj(d,k[c]);var e=Ext.asn1.ASN1Util.oidHexToInt(f);var b=Ext.asn1.x509.OID.oid2name(e);j.push(b)}return j};X509.getExtSubjectAltName=function(c){var d=new Array();var b=X509.getHexOfTLV_V3ExtValue(c,"subjectAltName");var e=ASN1HEX.getPosArrayOfChildren_AtObj(b,0);for(var g=0;g<e.length;g++){if(b.substr(e[g],2)==="82"){var f=hextoutf8(ASN1HEX.getHexOfV_AtObj(b,e[g]));d.push(f)}}return d};X509.getExtCRLDistributionPointsURI=function(g){var l=new Array();var d=X509.getHexOfTLV_V3ExtValue(g,"cRLDistributionPoints");var k=ASN1HEX.getPosArrayOfChildren_AtObj(d,0);for(var p=0;p<k.length;p++){var e=ASN1HEX.getHexOfTLV_AtObj(d,k[p]);var m=ASN1HEX.getPosArrayOfChildren_AtObj(e,0);for(var c=0;c<m.length;c++){if(e.substr(m[c],2)==="a0"){var o=ASN1HEX.getHexOfV_AtObj(e,m[c]);if(o.substr(0,2)==="a0"){var n=ASN1HEX.getHexOfV_AtObj(o,0);if(n.substr(0,2)==="86"){var f=ASN1HEX.getHexOfV_AtObj(n,0);var b=hextoutf8(f);l.push(b)}}}}}return l};X509.getExtAIAInfo=function(d){var f={};f.ocsp=[];f.caissuer=[];var e=X509.getPosOfTLV_V3ExtValue(d,"authorityInfoAccess");if(e==-1){return null}if(d.substr(e,2)!="30"){throw"malformed AIA Extn Value"}var u=ASN1HEX.getPosArrayOfChildren_AtObj(d,e);for(var s=0;s<u.length;s++){var g=u[s];var j=ASN1HEX.getPosArrayOfChildren_AtObj(d,g);if(j.length!=2){throw"malformed AccessDescription of AIA Extn"}var b=j[0];var c=j[1];if(ASN1HEX.getHexOfV_AtObj(d,b)=="2b06010505073001"){if(d.substr(c,2)=="86"){f.ocsp.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(d,c)))}}if(ASN1HEX.getHexOfV_AtObj(d,b)=="2b06010505073002"){if(d.substr(c,2)=="86"){f.caissuer.push(hextoutf8(ASN1HEX.getHexOfV_AtObj(d,c)))}}}return f};X509.getSignatureAlgorithmName=function(j){var c=ASN1HEX.getDecendantHexVByNthList(j,0,[1,0]);var b=Ext.asn1.ASN1Util.oidHexToInt(c);var d=Ext.asn1.x509.OID.oid2name(b);return d};X509.getSignatureValueHex=function(e){var b=ASN1HEX.getDecendantHexVByNthList(e,0,[2]);if(b.substr(0,2)!=="00"){throw"can't get signature value"}return b.substr(2)};X509.getSerialNumberHex=function(c){return ASN1HEX.getDecendantHexVByNthList(c,0,[0,1])};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.utils=="undefined"||!Ext.utils){Ext.utils={}}Ext.utils.JWS=function(){var c=Ext.utils.JWS;this.parseJWS=function(e,f){if((this.parsedJWS!==undefined)&&(f||(this.parsedJWS.sigvalH!==undefined))){return}var d=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(d==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}var i=d[1];var l=d[2];var g=d[3];var j=i+"."+l;this.parsedJWS={};this.parsedJWS.headB64U=i;this.parsedJWS.payloadB64U=l;this.parsedJWS.sigvalB64U=g;this.parsedJWS.si=j;if(!f){var b=b64utohex(g);var y=parseBigInt(b,16);this.parsedJWS.sigvalH=b;this.parsedJWS.sigvalBI=y}var x=b64utoutf8(i);var k=b64utoutf8(l);this.parsedJWS.headS=x;this.parsedJWS.payloadS=k;if(!c.isSafeJSONString(x,this.parsedJWS,"headP")){throw"malformed JSON string for JWS Head: "+x}}};Ext.utils.JWS.sign=function(f,c,n,L,l){var m=Ext.utils.JWS;var p,j,i;if(typeof c!="string"&&typeof c!="object"){throw"spHeader must be JSON string or object: "+c}if(typeof c=="object"){j=c;p=JSON.stringify(j)}if(typeof c=="string"){p=c;if(!m.isSafeJSONString(p)){throw"JWS Head is not safe JSON string: "+p}j=m.readSafeJSONString(p)}i=n;if(typeof n=="object"){i=JSON.stringify(n)}if((f==""||f==null)&&j.alg!==undefined){f=j.alg}if((f!=""&&f!=null)&&j.alg===undefined){j.alg=f;p=JSON.stringify(j)}if(f!==j.alg){throw"alg and sHeader.alg doesn't match: "+f+"!="+j.alg}var e=null;if(m.jwsalg2sigalg[f]===undefined){throw"unsupported alg name: "+f}else{e=m.jwsalg2sigalg[f]}var K=utf8tob64u(p);var d=utf8tob64u(i);var k=K+"."+d;var b="";if(e.substr(0,4)=="Hmac"){if(L===undefined){throw"mac key shall be specified for HS* alg"}var g=new Ext.crypto.Mac({alg:e,prov:"cryptojs",pass:L});g.updateString(k);b=g.doFinal()}else{if(e.indexOf("withECDSA")!=-1){var o=new Ext.crypto.Signature({alg:e});o.init(L,l);o.updateString(k);hASN1Sig=o.sign();b=Ext.crypto.ECDSA.asn1SigToConcatSig(hASN1Sig)}else{if(e!="none"){var o=new Ext.crypto.Signature({alg:e});o.init(L,l);o.updateString(k);b=o.sign()}}}var q=hextob64u(b);return k+"."+q};Ext.utils.JWS.verify=function(l,p,i){var O=Ext.utils.JWS;var m=l.split(".");var d=m[0];var j=m[1];var b=d+"."+j;var n=b64utohex(m[2]);var g=O.readSafeJSONString(b64utoutf8(m[0]));var P=null;var o=null;if(g.alg===undefined){throw"algorithm not specified in header"}else{P=g.alg;o=P.substr(0,2)}if(i!=null&&Object.prototype.toString.call(i)==="[object Array]"&&i.length>0){var c=":"+i.join(":")+":";if(c.indexOf(":"+P+":")==-1){throw"algorithm '"+P+"' not accepted in the list"}}if(P!="none"&&p===null){throw"key shall be specified to verify."}if(typeof p=="string"&&p.indexOf("-----BEGIN ")!=-1){p=KEYUTIL.getKey(p)}if(o=="RS"||o=="PS"){if(!(p instanceof RSAKey)){throw"key shall be a RSAKey obj for RS* and PS* algs"}}if(o=="ES"){if(!(p instanceof Ext.crypto.ECDSA)){throw"key shall be a ECDSA obj for ES* algs"}}if(P=="none"){}var k=null;if(O.jwsalg2sigalg[g.alg]===undefined){throw"unsupported alg name: "+P}else{k=O.jwsalg2sigalg[P]}if(k=="none"){throw"not supported"}else{if(k.substr(0,4)=="Hmac"){var s=null;if(p===undefined){throw"hexadecimal key shall be specified for HMAC"}var q=new Ext.crypto.Mac({alg:k,pass:p});q.updateString(b);s=q.doFinal();return n==s}else{if(k.indexOf("withECDSA")!=-1){var f=null;try{f=Ext.crypto.ECDSA.concatSigToASN1Sig(n)}catch(r){return false}var e=new Ext.crypto.Signature({alg:k});e.init(p);e.updateString(b);return e.verify(f)}else{var e=new Ext.crypto.Signature({alg:k});e.init(p);e.updateString(b);return e.verify(n)}}}};Ext.utils.JWS.parse=function(c){var e=c.split(".");var d={};var b,g,f;if(e.length!=2&&e.length!=3){throw"malformed sJWS: wrong number of '.' splitted elements"}b=e[0];g=e[1];if(e.length==3){f=e[2]}d.headerObj=Ext.utils.JWS.readSafeJSONString(b64utoutf8(b));d.payloadObj=Ext.utils.JWS.readSafeJSONString(b64utoutf8(g));d.headerPP=JSON.stringify(d.headerObj,null,"  ");if(d.payloadObj==null){d.payloadPP=b64utoutf8(g)}else{d.payloadPP=JSON.stringify(d.payloadObj,null,"  ")}if(f!==undefined){d.sigHex=b64utohex(f)}return d};Ext.utils.JWS.verifyJWT=function(d,k,b){var l=Ext.utils.JWS;var j=d.split(".");var f=j[0];var g=j[1];var B=f+"."+g;var i=b64utohex(j[2]);var c=l.readSafeJSONString(b64utoutf8(f));var e=l.readSafeJSONString(b64utoutf8(g));if(c.alg===undefined){return false}if(b.alg===undefined){throw"acceptField.alg shall be specified"}if(!l.inArray(c.alg,b.alg)){return false}if(e.iss!==undefined&&typeof b.iss==="object"){if(!l.inArray(e.iss,b.iss)){return false}}if(e.sub!==undefined&&typeof b.sub==="object"){if(!l.inArray(e.sub,b.sub)){return false}}if(e.aud!==undefined&&typeof b.aud==="object"){if(typeof e.aud=="string"){if(!l.inArray(e.aud,b.aud)){return false}}else{if(typeof e.aud=="object"){if(!l.includedArray(e.aud,b.aud)){return false}}}}var m=Ext.utils.IntDate.getNow();if(b.verifyAt!==undefined&&typeof b.verifyAt==="number"){m=b.verifyAt}if(b.gracePeriod===undefined||typeof b.gracePeriod!=="number"){b.gracePeriod=0}if(e.exp!==undefined&&typeof e.exp=="number"){if(e.exp+b.gracePeriod<m){return false}}if(e.nbf!==undefined&&typeof e.nbf=="number"){if(m<e.nbf-b.gracePeriod){return false}}if(e.iat!==undefined&&typeof e.iat=="number"){if(m<e.iat-b.gracePeriod){return false}}if(e.jti!==undefined&&b.jti!==undefined){if(e.jti!==b.jti){return false}}if(!Ext.utils.JWS.verify(d,k,b.alg)){return false}return true};Ext.utils.JWS.includedArray=function(c,b){var j=Ext.utils.JWS.inArray;if(c===null){return false}if(typeof c!=="object"){return false}if(typeof c.length!=="number"){return false}for(var d=0;d<c.length;d++){if(!j(c[d],b)){return false}}return true};Ext.utils.JWS.inArray=function(b,c){if(c===null){return false}if(typeof c!=="object"){return false}if(typeof c.length!=="number"){return false}for(var d=0;d<c.length;d++){if(c[d]==b){return true}}return false};Ext.utils.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none",};Ext.utils.JWS.isSafeJSONString=function(c,b,d){var e=null;try{e=jsonParse(c);if(typeof e!="object"){return 0}if(e.constructor===Array){return 0}if(b){b[d]=e}return 1}catch(l){return 0}};Ext.utils.JWS.readSafeJSONString=function(c){var g=null;try{g=jsonParse(c);if(typeof g!="object"){return null}if(g.constructor===Array){return null}return g}catch(b){return null}};Ext.utils.JWS.getEncodedSignatureValueFromJWS=function(e){var b=e.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(b==null){throw"JWS signature is not a form of 'Head.Payload.SigValue'."}return b[1]};Ext.utils.JWS.getJWKthumbprint=function(d){if(d.kty!=="RSA"&&d.kty!=="EC"&&d.kty!=="oct"){throw"unsupported algorithm for JWK Thumprint"}var l="{";if(d.kty==="RSA"){if(typeof d.n!="string"||typeof d.e!="string"){throw"wrong n and e value for RSA key"}l+='"e":"'+d.e+'",';l+='"kty":"'+d.kty+'",';l+='"n":"'+d.n+'"}'}else{if(d.kty==="EC"){if(typeof d.crv!="string"||typeof d.x!="string"||typeof d.y!="string"){throw"wrong crv, x and y value for EC key"}l+='"crv":"'+d.crv+'",';l+='"kty":"'+d.kty+'",';l+='"x":"'+d.x+'",';l+='"y":"'+d.y+'"}'}else{if(d.kty==="oct"){if(typeof d.k!="string"){throw"wrong k value for oct(symmetric) key"}l+='"kty":"'+d.kty+'",';l+='"k":"'+d.k+'"}'}}}var b=rstrtohex(l);var c=Ext.crypto.Util.hashHex(b,"sha256");var e=hextob64u(c);return e};Ext.utils.IntDate={};Ext.utils.IntDate.get=function(c){if(c=="now"){return Ext.utils.IntDate.getNow()}else{if(c=="now + 1hour"){return Ext.utils.IntDate.getNow()+60*60}else{if(c=="now + 1day"){return Ext.utils.IntDate.getNow()+60*60*24}else{if(c=="now + 1month"){return Ext.utils.IntDate.getNow()+60*60*24*30}else{if(c=="now + 1year"){return Ext.utils.IntDate.getNow()+60*60*24*365}else{if(c.match(/Z$/)){return Ext.utils.IntDate.getZulu(c)}else{if(c.match(/^[0-9]+$/)){return parseInt(c)}}}}}}}throw"unsupported format: "+c};Ext.utils.IntDate.getZulu=function(k){var w=k.match(/(\d+)(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)Z/);if(w){var v=w[1];var i=parseInt(v);if(v.length==4){}else{if(v.length==2){if(50<=i&&i<100){i=1900+i}else{if(0<=i&&i<50){i=2000+i}else{throw"malformed year string for UTCTime"}}}else{throw"malformed year string"}}var f=parseInt(w[2])-1;var j=parseInt(w[3]);var b=parseInt(w[4]);var c=parseInt(w[5]);var e=parseInt(w[6]);var g=new Date(Date.UTC(i,f,j,b,c,e));return ~~(g/1000)}throw"unsupported format: "+k};Ext.utils.IntDate.getNow=function(){var c=~~(new Date()/1000);return c};Ext.utils.IntDate.intDate2UTCString=function(b){var e=new Date(b*1000);return e.toUTCString()};Ext.utils.IntDate.intDate2Zulu=function(c){var g=new Date(c*1000);var r=("0000"+g.getUTCFullYear()).slice(-4);var e=("00"+(g.getUTCMonth()+1)).slice(-2);var q=("00"+g.getUTCDate()).slice(-2);var f=("00"+g.getUTCHours()).slice(-2);var i=("00"+g.getUTCMinutes()).slice(-2);var b=("00"+g.getUTCSeconds()).slice(-2);return r+e+q+f+i+b+"Z"};if(typeof Ext=="undefined"||!Ext){Ext={}}if(typeof Ext.utils=="undefined"||!Ext.utils){Ext.utils={}}Ext.utils.JWSJS=function(){var e=Ext.utils.JWS;var b=Ext.utils.JWS;this.aHeader=[];this.sPayload="";this.aSignature=[];this.init=function(){this.aHeader=[];this.sPayload=undefined;this.aSignature=[]};this.initWithJWS=function(c){this.init();var d=c.split(".");if(d.length!=3){throw"malformed input JWS"}this.aHeader.push(d[0]);this.sPayload=d[1];this.aSignature.push(d[2])};this.addSignature=function(l,c,j,g){if(this.sPayload===undefined||this.sPayload===null){throw"there's no JSON-JS signature to add."}var i=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length){throw"aHeader.length != aSignature.length"}try{var v=Ext.utils.JWS.sign(l,c,this.sPayload,j,g);var f=v.split(".");var k=f[0];var w=f[2];this.aHeader.push(f[0]);this.aSignature.push(f[2])}catch(d){if(this.aHeader.length>i){this.aHeader.pop()}if(this.aSignature.length>i){this.aSignature.pop()}throw"addSignature failed: "+d}};this.addSignatureByHeaderKey=function(g,c){var f=b64utoutf8(this.sPayload);var d=new Ext.utils.JWS();var l=d.generateJWSByP1PrvKey(g,f,c);this.aHeader.push(d.parsedJWS.headB64U);this.aSignature.push(d.parsedJWS.sigvalB64U)};this.addSignatureByHeaderPayloadKey=function(g,f,c){var d=new Ext.utils.JWS();var l=d.generateJWSByP1PrvKey(g,f,c);this.aHeader.push(d.parsedJWS.headB64U);this.sPayload=d.parsedJWS.payloadB64U;this.aSignature.push(d.parsedJWS.sigvalB64U)};this.verifyAll=function(f){if(this.aHeader.length!==f.length||this.aSignature.length!==f.length){return false}for(var d=0;d<f.length;d++){var c=f[d];if(c.length!==2){return false}var j=this.verifyNth(d,c[0],c[1]);if(j===false){return false}}return true};this.verifyNth=function(f,q,j){if(this.aHeader.length<=f||this.aSignature.length<=f){return false}var r=this.aHeader[f];var g=this.aSignature[f];var d=r+"."+this.sPayload+"."+g;var c=false;try{c=b.verify(d,q,j)}catch(i){return false}return c};this.verifyWithCerts=function(j){if(this.aHeader.length!=j.length){throw"num headers does not match with num certs"}if(this.aSignature.length!=j.length){throw"num signatures does not match with num certs"}var c=this.sPayload;var n="";for(var k=0;k<j.length;k++){var m=j[k];var l=this.aHeader[k];var f=this.aSignature[k];var g=l+"."+c+"."+f;var y=new Ext.utils.JWS();try{var d=y.verifyJWSByPemX509Cert(g,m);if(d!=1){n+=(k+1)+"th signature unmatch. "}}catch(x){n+=(k+1)+"th signature fail("+x+"). "}}if(n==""){return 1}else{throw n}};this.readJWSJS=function(d){if(typeof d==="string"){var c=e.readSafeJSONString(d);if(c==null){throw"argument is not safe JSON object string"}this.aHeader=c.headers;this.sPayload=c.payload;this.aSignature=c.signatures}else{try{if(d.headers.length>0){this.aHeader=d.headers}else{throw"malformed header"}if(typeof d.payload==="string"){this.sPayload=d.payload}else{throw"malformed signatures"}if(d.signatures.length>0){this.signatures=d.signatures}else{throw"malformed signatures"}}catch(g){throw"malformed JWS-JS JSON object: "+g}}};this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}};this.isEmpty=function(){if(this.aHeader.length==0){return 1}return 0}};